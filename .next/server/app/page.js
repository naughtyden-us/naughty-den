(()=>{var exports={};exports.id=974,exports.ids=[974],exports.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},456:(a,b,c)=>{"use strict";a.exports=c(56796).vendored.contexts.ImageConfigContext},1400:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getErrorCode=b.getErrorMessage=void 0,b.getErrorMessage=function(a){return a instanceof Error?a.message:String(a)},b.getErrorCode=function(a){return"object"==typeof a&&null!==a&&"code"in a&&"number"==typeof a.code?a.code:null}},1887:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionAlgorithms=void 0,function(a){a[a.identity=0]="identity",a[a.deflate=1]="deflate",a[a.gzip=2]="gzip"}(c||(b.CompressionAlgorithms=c={}))},3001:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{VALID_LOADERS:function(){return c},imageConfigDefault:function(){return d}});let c=["default","imgix","cloudinary","akamai","custom"],d={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4755:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)this[b[c]]=a[b[c]]}e.create=function(a){return this.$type.create(a)},e.encode=function(a,b){return this.$type.encode(a,b)},e.encodeDelimited=function(a,b){return this.$type.encodeDelimited(a,b)},e.decode=function(a){return this.$type.decode(a)},e.decodeDelimited=function(a){return this.$type.decodeDelimited(a)},e.verify=function(a){return this.$type.verify(a)},e.fromObject=function(a){return this.$type.fromObject(a)},e.toObject=function(a,b){return this.$type.toObject(a,b)},e.prototype.toJSON=function(){return this.$type.toObject(this,d.toJSONOptions)}},6620:(a,b,c)=>{"use strict";a.exports=i;var d=c(27791),e=c(90290);function f(a,b){return a.name+": "+b+(a.repeated&&"array"!==b?"[]":a.map&&"object"!==b?"{k:"+a.keyType+"}":"")+" expected"}function g(a,b,c,e){if(b.resolvedType)if(b.resolvedType instanceof d){a("switch(%s){",e)("default:")("return%j",f(b,"enum value"));for(var g=Object.keys(b.resolvedType.values),h=0;h<g.length;++h)a("case %i:",b.resolvedType.values[g[h]]);a("break")("}")}else a("{")("var e=types[%i].verify(%s);",c,e)("if(e)")("return%j+e",b.name+".")("}");else switch(b.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.isInteger(%s))",e)("return%j",f(b,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",e,e,e,e)("return%j",f(b,"integer|Long"));break;case"float":case"double":a('if(typeof %s!=="number")',e)("return%j",f(b,"number"));break;case"bool":a('if(typeof %s!=="boolean")',e)("return%j",f(b,"boolean"));break;case"string":a("if(!util.isString(%s))",e)("return%j",f(b,"string"));break;case"bytes":a('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',e,e,e)("return%j",f(b,"buffer"))}return a}function h(a,b,c){switch(b.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.key32Re.test(%s))",c)("return%j",f(b,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.key64Re.test(%s))",c)("return%j",f(b,"integer|Long key"));break;case"bool":a("if(!util.key2Re.test(%s))",c)("return%j",f(b,"boolean key"))}return a}function i(a){var b=e.codegen(["m"],a.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),c=a.oneofsArray,d={};c.length&&b("var p={}");for(var i=0;i<a.fieldsArray.length;++i){var j=a._fieldsArray[i].resolve(),k="m"+e.safeProp(j.name);if(j.optional&&b("if(%s!=null&&m.hasOwnProperty(%j)){",k,j.name),j.map)b("if(!util.isObject(%s))",k)("return%j",f(j,"object"))("var k=Object.keys(%s)",k)("for(var i=0;i<k.length;++i){"),h(b,j,"k[i]"),g(b,j,i,k+"[k[i]]")("}");else if(j.repeated)b("if(!Array.isArray(%s))",k)("return%j",f(j,"array"))("for(var i=0;i<%s.length;++i){",k),g(b,j,i,k+"[i]")("}");else{if(j.partOf){var l=e.safeProp(j.partOf.name);1===d[j.partOf.name]&&b("if(p%s===1)",l)("return%j",j.partOf.name+": multiple values"),d[j.partOf.name]=1,b("p%s=1",l)}g(b,j,i,k)}j.optional&&b("}")}return b("return null")}},6792:(a,b,c)=>{"use strict";var d=b,e=c(27791),f=c(90290);function g(a,b,c,d){var f=!1;if(b.resolvedType)if(b.resolvedType instanceof e){a("switch(d%s){",d);for(var g=b.resolvedType.values,h=Object.keys(g),i=0;i<h.length;++i)g[h[i]]!==b.typeDefault||f||(a("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',d,d,d),b.repeated||a("break"),f=!0),a("case%j:",h[i])("case %i:",g[h[i]])("m%s=%j",d,g[h[i]])("break");a("}")}else a('if(typeof d%s!=="object")',d)("throw TypeError(%j)",b.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",d,c,d);else{var j=!1;switch(b.type){case"double":case"float":a("m%s=Number(d%s)",d,d);break;case"uint32":case"fixed32":a("m%s=d%s>>>0",d,d);break;case"int32":case"sint32":case"sfixed32":a("m%s=d%s|0",d,d);break;case"uint64":j=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",d,d,j)('else if(typeof d%s==="string")',d)("m%s=parseInt(d%s,10)",d,d)('else if(typeof d%s==="number")',d)("m%s=d%s",d,d)('else if(typeof d%s==="object")',d)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",d,d,d,j?"true":"");break;case"bytes":a('if(typeof d%s==="string")',d)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",d,d,d)("else if(d%s.length >= 0)",d)("m%s=d%s",d,d);break;case"string":a("m%s=String(d%s)",d,d);break;case"bool":a("m%s=Boolean(d%s)",d,d)}}return a}function h(a,b,c,d){if(b.resolvedType)b.resolvedType instanceof e?a("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",d,c,d,d,c,d,d):a("d%s=types[%i].toObject(m%s,o)",d,c,d);else{var f=!1;switch(b.type){case"double":case"float":a("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",d,d,d,d);break;case"uint64":f=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a('if(typeof m%s==="number")',d)("d%s=o.longs===String?String(m%s):m%s",d,d,d)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",d,d,d,d,f?"true":"",d);break;case"bytes":a("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",d,d,d,d,d);break;default:a("d%s=m%s",d,d)}}return a}d.fromObject=function(a){var b=a.fieldsArray,c=f.codegen(["d"],a.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!b.length)return c("return new this.ctor");c("var m=new this.ctor");for(var d=0;d<b.length;++d){var h=b[d].resolve(),i=f.safeProp(h.name);h.map?(c("if(d%s){",i)('if(typeof d%s!=="object")',i)("throw TypeError(%j)",h.fullName+": object expected")("m%s={}",i)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",i),g(c,h,d,i+"[ks[i]]")("}")("}")):h.repeated?(c("if(d%s){",i)("if(!Array.isArray(d%s))",i)("throw TypeError(%j)",h.fullName+": array expected")("m%s=[]",i)("for(var i=0;i<d%s.length;++i){",i),g(c,h,d,i+"[i]")("}")("}")):(h.resolvedType instanceof e||c("if(d%s!=null){",i),g(c,h,d,i),h.resolvedType instanceof e||c("}"))}return c("return m")},d.toObject=function(a){var b=a.fieldsArray.slice().sort(f.compareFieldsById);if(!b.length)return f.codegen()("return {}");for(var c=f.codegen(["m","o"],a.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],g=[],i=[],j=0;j<b.length;++j)b[j].partOf||(b[j].resolve().repeated?d:b[j].map?g:i).push(b[j]);if(d.length){for(c("if(o.arrays||o.defaults){"),j=0;j<d.length;++j)c("d%s=[]",f.safeProp(d[j].name));c("}")}if(g.length){for(c("if(o.objects||o.defaults){"),j=0;j<g.length;++j)c("d%s={}",f.safeProp(g[j].name));c("}")}if(i.length){for(c("if(o.defaults){"),j=0;j<i.length;++j){var k=i[j],l=f.safeProp(k.name);if(k.resolvedType instanceof e)c("d%s=o.enums===String?%j:%j",l,k.resolvedType.valuesById[k.typeDefault],k.typeDefault);else if(k.long)c("if(util.Long){")("var n=new util.Long(%i,%i,%j)",k.typeDefault.low,k.typeDefault.high,k.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,k.typeDefault.toString(),k.typeDefault.toNumber());else if(k.bytes){var m="["+Array.prototype.slice.call(k.typeDefault).join(",")+"]";c("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,k.typeDefault))("else{")("d%s=%s",l,m)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else c("d%s=%j",l,k.typeDefault)}c("}")}var n=!1;for(j=0;j<b.length;++j){var k=b[j],o=a._fieldsArray.indexOf(k),l=f.safeProp(k.name);k.map?(n||(n=!0,c("var ks2")),c("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),h(c,k,o,l+"[ks2[j]]")("}")):k.repeated?(c("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),h(c,k,o,l+"[j]")("}")):(c("if(m%s!=null&&m.hasOwnProperty(%j)){",l,k.name),h(c,k,o,l),k.partOf&&c("if(o.oneofs)")("d%s=%j",f.safeProp(k.partOf.name),k.name)),c("}")}return c("return d")}},8380:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getNextCallNumber=void 0;let c=0;b.getNextCallNumber=function(){return c++}},9114:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.mapUriDefaultScheme=b.getDefaultAuthority=b.createResolver=b.registerDefaultScheme=b.registerResolver=void 0;let d=c(25554),e={},f=null;b.registerResolver=function(a,b){e[a]=b},b.registerDefaultScheme=function(a){f=a},b.createResolver=function(a,b,c){if(void 0!==a.scheme&&a.scheme in e)return new e[a.scheme](a,b,c);throw Error(`No resolver could be created for target ${(0,d.uriToString)(a)}`)},b.getDefaultAuthority=function(a){if(void 0!==a.scheme&&a.scheme in e)return e[a.scheme].getDefaultAuthority(a);throw Error(`Invalid target ${(0,d.uriToString)(a)}`)},b.mapUriDefaultScheme=function(a){if(void 0===a.scheme||!(a.scheme in e))if(null!==f)return{scheme:f,authority:void 0,path:(0,d.uriToString)(a)};else return null;return a}},9122:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingCall=void 0;let d=c(50615),e=c(62556),f=c(64105),g=c(18031),h=c(29383),i="resolving_call";class j{constructor(a,b,c,f,g,h){this.channel=a,this.method=b,this.filterStackFactory=f,this.credentials=g,this.callNumber=h,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=c.deadline,this.host=c.host,c.parentCall&&(c.flags&d.Propagate.CANCELLATION&&c.parentCall.on("cancelled",()=>{this.cancelWithStatus(d.Status.CANCELLED,"Cancelled by parent call")}),c.flags&d.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+c.parentCall.getDeadline()),this.deadline=(0,e.minDeadline)(this.deadline,c.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(a){g.trace(d.LogVerbosity.DEBUG,i,"["+this.callNumber+"] "+a)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,e.deadlineToString)(this.deadline));let a=(0,e.getRelativeTimeout)(this.deadline);if(a!==1/0){this.trace("Deadline will be reached in "+a+"ms");let b=()=>{this.cancelWithStatus(d.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};a<=0?process.nextTick(b):this.deadlineTimer=setTimeout(b,a)}}outputStatus(a){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let b=this.filterStack.receiveTrailers(a);this.trace("ended with status: code="+b.code+' details="'+b.details+'"'),this.statusWatchers.forEach(a=>a(b)),process.nextTick(()=>{var a;null==(a=this.listener)||a.onReceiveStatus(b)})}}sendMessageOnChild(a,b){if(!this.child)throw Error("sendMessageonChild called with child not populated");let c=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:b,flags:a.flags})).then(b=>{this.writeFilterPending=!1,c.sendMessageWithContext(a,b.message),this.pendingHalfClose&&c.halfClose()},a=>{this.cancelWithStatus(a.code,a.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let a=this.channel.getConfig(this.method,this.metadata);if("NONE"===a.type)return void this.channel.queueCallForConfig(this);if("ERROR"===a.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(a.error));let b=a.config;if(b.status!==d.Status.OK){let{code:a,details:c}=(0,h.restrictControlPlaneStatusCode)(b.status,"Failed to route call to method "+this.method);this.outputStatus({code:a,details:c,metadata:new f.Metadata});return}if(b.methodConfig.timeout){let a=new Date;a.setSeconds(a.getSeconds()+b.methodConfig.timeout.seconds),a.setMilliseconds(a.getMilliseconds()+b.methodConfig.timeout.nanos/1e6),this.deadline=(0,e.minDeadline)(this.deadline,a),this.runDeadlineTimer()}this.filterStackFactory.push(b.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(a=>{this.child=this.channel.createInnerCall(b,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(a,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(a))},onReceiveMessage:a=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(a).then(a=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(a),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},a=>{this.cancelWithStatus(a.code,a.details)})},onReceiveStatus:a=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=a:this.outputStatus(a)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},a=>{this.outputStatus(a)})}reportResolverError(a){var b;(null==(b=this.metadata)?void 0:b.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(a)}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new f.Metadata})}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.metadata=a.clone(),this.listener=b,this.getConfig()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.sendMessageOnChild(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){this.credentials=this.credentials.compose(a)}addStatusWatcher(a){this.statusWatchers.push(a)}getCallNumber(){return this.callNumber}}b.ResolvingCall=j},9259:(a,b,c)=>{"use strict";a.exports=y,y.filename=null,y.defaults={keepCase:!1};var d=c(76043),e=c(31502),f=c(68134),g=c(99408),h=c(49316),i=c(67369),j=c(27791),k=c(25811),l=c(23455),m=c(72481),n=c(18657),o=c(90290),p=/^[1-9][0-9]*$/,q=/^-?[1-9][0-9]*$/,r=/^0[x][0-9a-fA-F]+$/,s=/^-?0[x][0-9a-fA-F]+$/,t=/^0[0-7]+$/,u=/^-?0[0-7]+$/,v=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,x=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function y(a,b,c){b instanceof e||(c=b,b=new e),c||(c=y.defaults);var z,A,B,C,D=c.preferTrailingComment||!1,E=d(a,c.alternateCommentMode||!1),F=E.next,G=E.push,H=E.peek,I=E.skip,J=E.cmnt,K=!0,L="proto2",M=b,N=[],O={},P=c.keepCase?function(a){return a}:o.camelCase;function Q(){N.forEach(a=>{a._edition=L,Object.keys(O).forEach(b=>{void 0===a.getOption(b)&&a.setOption(b,O[b],!0)})})}function R(a,b,c){var d=y.filename;return c||(y.filename=null),Error("illegal "+(b||"token")+" '"+a+"' ("+(d?d+", ":"")+"line "+E.line+")")}function S(){var a,b=[];do{if('"'!==(a=F())&&"'"!==a)throw R(a);b.push(F()),I(a),a=H()}while('"'===a||"'"===a);return b.join("")}function T(a){var b=F();switch(b){case"'":case'"':return G(b),S();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return V(b,!0)}catch(c){if(a&&x.test(b))return b;throw R(b,"value")}}function U(a,b){do if(b&&('"'===(c=H())||"'"===c)){var c,d,e=S();if(a.push(e),L>=2023)throw R(e,"id")}else try{a.push([d=W(F()),I("to",!0)?W(F()):d])}catch(d){if(b&&x.test(c)&&L>=2023)a.push(c);else throw d}while(I(",",!0));var f={options:void 0};f.setOption=function(a,b){void 0===this.options&&(this.options={}),this.options[a]=b},aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)})}function V(a,b){var c=1;switch("-"===a.charAt(0)&&(c=-1,a=a.substring(1)),a){case"inf":case"INF":case"Inf":return 1/0*c;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(a))return c*parseInt(a,10);if(r.test(a))return c*parseInt(a,16);if(t.test(a))return c*parseInt(a,8);if(v.test(a))return c*parseFloat(a);throw R(a,"number",b)}function W(a,b){switch(a){case"max":case"MAX":case"Max":return 0x1fffffff;case"0":return 0}if(!b&&"-"===a.charAt(0))throw R(a,"id");if(q.test(a))return parseInt(a,10);if(s.test(a))return parseInt(a,16);if(u.test(a))return parseInt(a,8);throw R(a,"id")}function X(){if(void 0!==A)throw R("package");if(A=F(),!x.test(A))throw R(A,"name");M=M.define(A),I(";")}function Y(){var a,b=H();switch(b){case"weak":a=C||(C=[]),F();break;case"public":F();default:a=B||(B=[])}b=S(),I(";"),a.push(b)}function Z(){if(I("="),(L=S())<2023)throw R(L,"syntax");I(";")}function $(){if(I("="),!["2023"].includes(L=S()))throw R(L,"edition");I(";")}function _(a,b){switch(b){case"option":return ai(a,b),I(";"),!0;case"message":return ab(a,b),!0;case"enum":return ag(a,b),!0;case"service":return an(a,b),!0;case"extend":return ap(a,b),!0}return!1}function aa(a,b,c){var d,e=E.line;if(a&&("string"!=typeof a.comment&&(a.comment=J()),a.filename=y.filename),I("{",!0)){for(;"}"!==(d=F());)b(d);I(";",!0)}else c&&c(),I(";"),a&&("string"!=typeof a.comment||D)&&(a.comment=J(e)||a.comment)}function ab(a,b){if(!w.test(b=F()))throw R(b,"type name");var c=new f(b);aa(c,function(a){if(!_(c,a))switch(a){case"map":ae(c,a);break;case"required":if("proto2"!==L)throw R(a);case"repeated":ac(c,a);break;case"optional":if("proto3"===L)ac(c,"proto3_optional");else if("proto2"!==L)throw R(a);else ac(c,"optional");break;case"oneof":af(c,a);break;case"extensions":U(c.extensions||(c.extensions=[]));break;case"reserved":U(c.reserved||(c.reserved=[]),!0);break;default:if("proto2"===L||!x.test(a))throw R(a);G(a),ac(c,"optional")}}),a.add(c),a===M&&N.push(c)}function ac(a,b,c){var d=F();if("group"===d)return void ad(a,b);for(;d.endsWith(".")||H().startsWith(".");)d+=F();if(!x.test(d))throw R(d,"type");var e=F();if(!w.test(e))throw R(e,"name");e=P(e),I("=");var f=new g(e,W(F()),d,b,c);if(aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)}),"proto3_optional"===b){var h=new i("_"+e);f.setOption("proto3_optional",!0),h.add(f),a.add(h)}else a.add(f);a===M&&N.push(f)}function ad(a,b){if(L>=2023)throw R("group");var c=F();if(!w.test(c))throw R(c,"name");var d=o.lcFirst(c);c===d&&(c=o.ucFirst(c)),I("=");var e=W(F()),h=new f(c);h.group=!0;var i=new g(d,e,c,b);i.filename=y.filename,aa(h,function(a){switch(a){case"option":ai(h,a),I(";");break;case"required":case"repeated":ac(h,a);break;case"optional":"proto3"===L?ac(h,"proto3_optional"):ac(h,"optional");break;case"message":ab(h,a);break;case"enum":ag(h,a);break;case"reserved":U(h.reserved||(h.reserved=[]),!0);break;default:throw R(a)}}),a.add(h).add(i)}function ae(a){I("<");var b=F();if(void 0===n.mapKey[b])throw R(b,"type");I(",");var c=F();if(!x.test(c))throw R(c,"type");I(">");var d=F();if(!w.test(d))throw R(d,"name");I("=");var e=new h(P(d),W(F()),b,c);aa(e,function(a){if("option"===a)ai(e,a),I(";");else throw R(a)},function(){am(e)}),a.add(e)}function af(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new i(P(b));aa(c,function(a){"option"===a?(ai(c,a),I(";")):(G(a),ac(c,"optional"))}),a.add(c)}function ag(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new j(b);aa(c,function(a){switch(a){case"option":ai(c,a),I(";");break;case"reserved":U(c.reserved||(c.reserved=[]),!0),void 0===c.reserved&&(c.reserved=[]);break;default:ah(c,a)}}),a.add(c),a===M&&N.push(c)}function ah(a,b){if(!w.test(b))throw R(b,"name");I("=");var c=W(F(),!0),d={options:void 0};d.getOption=function(a){return this.options[a]},d.setOption=function(a,b){m.prototype.setOption.call(d,a,b)},d.setParsedOption=function(){},aa(d,function(a){if("option"===a)ai(d,a),I(";");else throw R(a)},function(){am(d)}),a.add(b,c,d.comment,d.parsedOptions||d.options)}function ai(a,b){var c,d,e=!0;for("option"===b&&(b=F());"="!==b;){if("("===b){var f=F();I(")"),b="("+f+")"}if(e){if(e=!1,b.includes(".")&&!b.includes("(")){var g=b.split(".");c=g[0]+".",b=g[1];continue}c=b}else d=d?d+=b:b;b=F()}var h=aj(a,d?c.concat(d):c);d=d&&"."===d[0]?d.slice(1):d,al(a,c=c&&"."===c[c.length-1]?c.slice(0,-1):c,h,d)}function aj(a,b){if(I("{",!0)){for(var c={};!I("}",!0);){if(!w.test(z=F()))throw R(z,"name");if(null===z)throw R(z,"end of input");var d,e,f=z;if(I(":",!0),"{"===H())d=aj(a,b+"."+z);else if("["===H()){if(d=[],I("[",!0)){do e=T(!0),d.push(e);while(I(",",!0));I("]"),void 0!==e&&ak(a,b+"."+z,e)}}else d=T(!0),ak(a,b+"."+z,d);var g=c[f];g&&(d=[].concat(g).concat(d)),c[f]=d,I(",",!0),I(";",!0)}return c}var h=T(!0);return ak(a,b,h),h}function ak(a,b,c){if(M===a&&/^features\./.test(b)){O[b]=c;return}a.setOption&&a.setOption(b,c)}function al(a,b,c,d){a.setParsedOption&&a.setParsedOption(b,c,d)}function am(a){if(I("[",!0)){do ai(a,"option");while(I(",",!0));I("]")}return a}function an(a,b){if(!w.test(b=F()))throw R(b,"service name");var c=new k(b);aa(c,function(a){if(!_(c,a))if("rpc"===a)ao(c,a);else throw R(a)}),a.add(c),a===M&&N.push(c)}function ao(a,b){var c=J(),d=b;if(!w.test(b=F()))throw R(b,"name");var e,f,g,h,i=b;if(I("("),I("stream",!0)&&(f=!0),!x.test(b=F())||(e=b,I(")"),I("returns"),I("("),I("stream",!0)&&(h=!0),!x.test(b=F())))throw R(b);g=b,I(")");var j=new l(i,d,e,g,f,h);j.comment=c,aa(j,function(a){if("option"===a)ai(j,a),I(";");else throw R(a)}),a.add(j)}function ap(a,b){if(!x.test(b=F()))throw R(b,"reference");var c=b;aa(null,function(b){switch(b){case"required":case"repeated":ac(a,b,c);break;case"optional":"proto3"===L?ac(a,"proto3_optional",c):ac(a,"optional",c);break;default:if("proto2"===L||!x.test(b))throw R(b);G(b),ac(a,"optional",c)}})}for(;null!==(z=F());)switch(z){case"package":if(!K)throw R(z);X();break;case"import":if(!K)throw R(z);Y();break;case"syntax":if(!K)throw R(z);Z();break;case"edition":if(!K)throw R(z);$();break;case"option":ai(M,z),I(";",!0);break;default:if(_(M,z)){K=!1;continue}throw R(z)}return Q(),y.filename=null,{package:A,imports:B,weakImports:C,root:b}}},10584:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.extractAndSelectServiceConfig=b.validateServiceConfig=b.validateRetryThrottling=void 0;let d=c(21820),e=c(50615),f=c(68367),g=/^\d+(\.\d{1,9})?s$/,h="node";function i(a){if("service"in a&&""!==a.service){if("string"!=typeof a.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof a.service}`);if(!("method"in a)||""===a.method)return{service:a.service};if("string"!=typeof a.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof a.service}`);return{service:a.service,method:a.method}}if("method"in a&&void 0!==a.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function j(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in a)||"string"!=typeof a.initialBackoff||!g.test(a.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in a)||"string"!=typeof a.maxBackoff||!g.test(a.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in a)||"number"!=typeof a.backoffMultiplier||a.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in a&&Array.isArray(a.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===a.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let b of a.retryableStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:a.maxAttempts,initialBackoff:a.initialBackoff,maxBackoff:a.maxBackoff,backoffMultiplier:a.backoffMultiplier,retryableStatusCodes:a.retryableStatusCodes}}function k(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in a&&("string"!=typeof a.hedgingDelay||!g.test(a.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in a&&Array.isArray(a.nonFatalStatusCodes))for(let b of a.nonFatalStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let b={maxAttempts:a.maxAttempts};return a.hedgingDelay&&(b.hedgingDelay=a.hedgingDelay),a.nonFatalStatusCodes&&(b.nonFatalStatusCodes=a.nonFatalStatusCodes),b}function l(a){var b;let c={name:[]};if(!("name"in a)||!Array.isArray(a.name))throw Error("Invalid method config: invalid name array");for(let b of a.name)c.name.push(i(b));if("waitForReady"in a){if("boolean"!=typeof a.waitForReady)throw Error("Invalid method config: invalid waitForReady");c.waitForReady=a.waitForReady}if("timeout"in a)if("object"==typeof a.timeout){if(!("seconds"in a.timeout)||"number"!=typeof a.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in a.timeout)||"number"!=typeof a.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");c.timeout=a.timeout}else if("string"==typeof a.timeout&&g.test(a.timeout)){let d=a.timeout.substring(0,a.timeout.length-1).split(".");c.timeout={seconds:0|d[0],nanos:(null!=(b=d[1])?b:0)|0}}else throw Error("Invalid method config: invalid timeout");if("maxRequestBytes"in a){if("number"!=typeof a.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxRequestBytes=a.maxRequestBytes}if("maxResponseBytes"in a){if("number"!=typeof a.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxResponseBytes=a.maxResponseBytes}if("retryPolicy"in a)if("hedgingPolicy"in a)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");else c.retryPolicy=j(a.retryPolicy);else"hedgingPolicy"in a&&(c.hedgingPolicy=k(a.hedgingPolicy));return c}function m(a){if(!("maxTokens"in a)||"number"!=typeof a.maxTokens||a.maxTokens<=0||a.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in a)||"number"!=typeof a.tokenRatio||a.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+a.maxTokens.toFixed(3),tokenRatio:+a.tokenRatio.toFixed(3)}}function n(a){let b={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in a)if("string"==typeof a.loadBalancingPolicy)b.loadBalancingPolicy=a.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in a)if(Array.isArray(a.loadBalancingConfig))for(let c of a.loadBalancingConfig)b.loadBalancingConfig.push((0,f.validateLoadBalancingConfig)(c));else throw Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in a&&Array.isArray(a.methodConfig))for(let c of a.methodConfig)b.methodConfig.push(l(c));"retryThrottling"in a&&(b.retryThrottling=m(a.retryThrottling));let c=[];for(let a of b.methodConfig)for(let b of a.name){for(let a of c)if(b.service===a.service&&b.method===a.method)throw Error(`Invalid service config: duplicate name ${b.service}/${b.method}`);c.push(b)}return b}function o(a){if(!("serviceConfig"in a))throw Error("Invalid service config choice: missing service config");let b={serviceConfig:n(a.serviceConfig)};if("clientLanguage"in a)if(Array.isArray(a.clientLanguage))for(let c of(b.clientLanguage=[],a.clientLanguage))if("string"==typeof c)b.clientLanguage.push(c);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in a)if(Array.isArray(a.clientHostname))for(let c of(b.clientHostname=[],a.clientHostname))if("string"==typeof c)b.clientHostname.push(c);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname");if("percentage"in a)if("number"==typeof a.percentage&&0<=a.percentage&&a.percentage<=100)b.percentage=a.percentage;else throw Error("Invalid service config choice: invalid percentage");let c=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let b in a)if(!c.includes(b))throw Error(`Invalid service config choice: unexpected field ${b}`);return b}function p(a,b){if(!Array.isArray(a))throw Error("Invalid service config list");for(let c of a){let a=o(c);if("number"!=typeof a.percentage||!(b>a.percentage)){if(Array.isArray(a.clientHostname)){let b=!1;for(let c of a.clientHostname)c===d.hostname()&&(b=!0);if(!b)continue}if(Array.isArray(a.clientLanguage)){let b=!1;for(let c of a.clientLanguage)c===h&&(b=!0);if(!b)continue}return a.serviceConfig}}throw Error("No matching service config found")}b.validateRetryThrottling=m,b.validateServiceConfig=n,b.extractAndSelectServiceConfig=function(a,b){for(let c of a)if(c.length>0&&c[0].startsWith("grpc_config="))return p(JSON.parse(c.join("").substring(12)),b);return null}},10811:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.getChannelzServiceDefinition=b.getChannelzHandlers=b.unregisterChannelzRef=b.registerChannelzSocket=b.registerChannelzServer=b.registerChannelzSubchannel=b.registerChannelzChannel=b.ChannelzCallTracker=b.ChannelzChildrenTracker=b.ChannelzTrace=void 0;let d=c(91645),e=c(96699),f=c(50615),g=c(24204),h=c(64149),i=c(32888);function j(a){return{channel_id:a.id,name:a.name}}function k(a){return{subchannel_id:a.id,name:a.name}}function l(a){return{server_id:a.id}}function m(a){return{socket_id:a.id,name:a.name}}let n=32;class o{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(a,b,c){let d=new Date;this.events.push({description:b,severity:a,timestamp:d,childChannel:(null==c?void 0:c.kind)==="channel"?c:void 0,childSubchannel:(null==c?void 0:c.kind)==="subchannel"?c:void 0}),this.events.length>=2*n&&(this.events=this.events.slice(n)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:B(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(a=>({description:a.description,severity:a.severity,timestamp:B(a.timestamp),channel_ref:a.childChannel?j(a.childChannel):null,subchannel_ref:a.childSubchannel?k(a.childSubchannel):null}))}}}b.ChannelzTrace=o;class p{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(a){var b,c,d;switch(a.kind){case"channel":{let c=null!=(b=this.channelChildren.get(a.id))?b:{ref:a,count:0};c.count+=1,this.channelChildren.set(a.id,c);break}case"subchannel":{let b=null!=(c=this.subchannelChildren.get(a.id))?c:{ref:a,count:0};b.count+=1,this.subchannelChildren.set(a.id,b);break}case"socket":{let b=null!=(d=this.socketChildren.get(a.id))?d:{ref:a,count:0};b.count+=1,this.socketChildren.set(a.id,b)}}}unrefChild(a){switch(a.kind){case"channel":{let b=this.channelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.channelChildren.delete(a.id):this.channelChildren.set(a.id,b));break}case"subchannel":{let b=this.subchannelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.subchannelChildren.delete(a.id):this.subchannelChildren.set(a.id,b));break}case"socket":{let b=this.socketChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.socketChildren.delete(a.id):this.socketChildren.set(a.id,b))}}}getChildLists(){let a=[];for(let{ref:b}of this.channelChildren.values())a.push(b);let b=[];for(let{ref:a}of this.subchannelChildren.values())b.push(a);let c=[];for(let{ref:a}of this.socketChildren.values())c.push(a);return{channels:a,subchannels:b,sockets:c}}}b.ChannelzChildrenTracker=p;class q{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}b.ChannelzCallTracker=q;let r=1;function s(){return r++}let t=[],u=[],v=[],w=[];function x(a){let b=Number.parseInt(a,16);return[b/256|0,b%256]}function y(a){return""===a?[]:[].concat(...a.split(":").map(a=>x(a)))}function z(a){if((0,d.isIPv4)(a))return Buffer.from(Uint8Array.from(a.split(".").map(a=>Number.parseInt(a))));if(!(0,d.isIPv6)(a))return null;{let b,c,d=a.indexOf("::");-1===d?(b=a,c=""):(b=a.substring(0,d),c=a.substring(d+2));let e=Buffer.from(y(b)),f=Buffer.from(y(c)),g=Buffer.alloc(16-e.length-f.length,0);return Buffer.concat([e,g,f])}}function A(a){switch(a){case e.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case e.ConnectivityState.IDLE:return{state:"IDLE"};case e.ConnectivityState.READY:return{state:"READY"};case e.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case e.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function B(a){if(!a)return null;let b=a.getTime();return{seconds:b/1e3|0,nanos:b%1e3*1e6}}function C(a){let b=a.getInfo();return{ref:j(a.ref),data:{target:b.target,state:A(b.state),calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},channel_ref:b.children.channels.map(a=>j(a)),subchannel_ref:b.children.subchannels.map(a=>k(a))}}function D(a,b){let c=Number.parseInt(a.request.channel_id),d=t[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No channel data found for id "+c});b(null,{channel:C(d)})}function E(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_channel_id);for(;e<t.length;e++){let a=t[e];if(void 0!==a&&(d.push(C(a)),d.length>=c))break}b(null,{channel:d,end:e>=v.length})}function F(a){let b=a.getInfo();return{ref:l(a.ref),data:{calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},listen_socket:b.listenerChildren.sockets.map(a=>m(a))}}function G(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});b(null,{server:F(d)})}function H(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_server_id);for(;e<v.length;e++){let a=v[e];if(void 0!==a&&(d.push(F(a)),d.length>=c))break}b(null,{server:d,end:e>=v.length})}function I(a,b){let c=Number.parseInt(a.request.subchannel_id),d=u[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No subchannel data found for id "+c});let e=d.getInfo();b(null,{subchannel:{ref:k(d.ref),data:{target:e.target,state:A(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:B(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},socket_ref:e.children.sockets.map(a=>m(a))}})}function J(a){var b;return(0,g.isTcpSubchannelAddress)(a)?{address:"tcpip_address",tcpip_address:{ip_address:null!=(b=z(a.host))?b:void 0,port:a.port}}:{address:"uds_address",uds_address:{filename:a.path}}}function K(a,b){var c,d,e,g,h;let i=Number.parseInt(a.request.socket_id),j=w[i];if(void 0===j)return void b({code:f.Status.NOT_FOUND,details:"No socket data found for id "+i});let k=j.getInfo(),l=k.security?{model:"tls",tls:{cipher_suite:k.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!=(c=k.security.cipherSuiteStandardName)?c:void 0,other_name:null!=(d=k.security.cipherSuiteOtherName)?d:void 0,local_certificate:null!=(e=k.security.localCertificate)?e:void 0,remote_certificate:null!=(g=k.security.remoteCertificate)?g:void 0}}:null;b(null,{socket:{ref:m(j.ref),local:k.localAddress?J(k.localAddress):null,remote:k.remoteAddress?J(k.remoteAddress):null,remote_name:null!=(h=k.remoteName)?h:void 0,security:l,data:{keep_alives_sent:k.keepAlivesSent,streams_started:k.streamsStarted,streams_succeeded:k.streamsSucceeded,streams_failed:k.streamsFailed,last_local_stream_created_timestamp:B(k.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:B(k.lastRemoteStreamCreatedTimestamp),messages_received:k.messagesReceived,messages_sent:k.messagesSent,last_message_received_timestamp:B(k.lastMessageReceivedTimestamp),last_message_sent_timestamp:B(k.lastMessageSentTimestamp),local_flow_control_window:k.localFlowControlWindow?{value:k.localFlowControlWindow}:null,remote_flow_control_window:k.remoteFlowControlWindow?{value:k.remoteFlowControlWindow}:null}}})}function L(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});let e=Number.parseInt(a.request.start_socket_id),g=Number.parseInt(a.request.max_results),h=d.getInfo().sessionChildren.sockets.sort((a,b)=>a.id-b.id),i=[],j=0;for(;j<h.length&&(!(h[j].id>=e)||(i.push(m(h[j])),!(i.length>=g)));j++);b(null,{socket_ref:i,end:j>=h.length})}function M(){return{GetChannel:D,GetTopChannels:E,GetServer:G,GetServers:H,GetSubchannel:I,GetSocket:K,GetServerSockets:L}}b.registerChannelzChannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"channel"};return c&&(t[d]={ref:e,getInfo:b}),e},b.registerChannelzSubchannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"subchannel"};return c&&(u[d]={ref:e,getInfo:b}),e},b.registerChannelzServer=function(a,b){let c=s(),d={id:c,kind:"server"};return b&&(v[c]={ref:d,getInfo:a}),d},b.registerChannelzSocket=function(a,b,c){let d=s(),e={id:d,name:a,kind:"socket"};return c&&(w[d]={ref:e,getInfo:b}),e},b.unregisterChannelzRef=function(a){switch(a.kind){case"channel":delete t[a.id];return;case"subchannel":delete u[a.id];return;case"server":delete v[a.id];return;case"socket":delete w[a.id];return}},b.getChannelzHandlers=M;let N=null;function O(){if(N)return N;let a=(0,c(47372).Yi)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return N=(0,i.loadPackageDefinition)(a).grpc.channelz.v1.Channelz.service}b.getChannelzServiceDefinition=O,b.setup=function(){(0,h.registerAdminService)(O,M)}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10975:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseSubchannelWrapper=void 0;class c{constructor(a){this.child=a}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(a){this.child.addConnectivityStateListener(a)}removeConnectivityStateListener(a){this.child.removeConnectivityStateListener(a)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(a){this.child.throttleKeepalive(a)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(a){return this.getRealSubchannel()===a.getRealSubchannel()}}b.BaseSubchannelWrapper=c},12715:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RetryingCall=b.MessageBufferTracker=b.RetryThrottler=void 0;let d=c(50615),e=c(64105),f=c(18031),g="retrying_call";class h{constructor(a,b,c){this.maxTokens=a,this.tokenRatio=b,c?this.tokens=c.tokens*(a/c.maxTokens):this.tokens=a}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}b.RetryThrottler=h;class i{constructor(a,b){this.totalLimit=a,this.limitPerCall=b,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(a,b){var c;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;return!(this.limitPerCall-d<a)&&!(this.totalLimit-this.totalAllocated<a)&&(this.allocatedPerCall.set(b,d+a),this.totalAllocated+=a,!0)}free(a,b){var c;if(this.totalAllocated<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > total allocated ${this.totalAllocated}`);this.totalAllocated-=a;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;if(d<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > allocated for call ${d}`);this.allocatedPerCall.set(b,d-a)}freeAll(a){var b;let c=null!=(b=this.allocatedPerCall.get(a))?b:0;if(this.totalAllocated<c)throw Error(`Invalid buffer allocation state: call ${a} allocated ${c} > total allocated ${this.totalAllocated}`);this.totalAllocated-=c,this.allocatedPerCall.delete(a)}}b.MessageBufferTracker=i;let j="grpc-previous-rpc-attempts";class k{constructor(a,b,c,d,e,f,g,h,i){if(this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.bufferTracker=h,this.retryThrottler=i,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,b.methodConfig.retryPolicy){this.state="RETRY";let a=b.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(a.initialBackoff.substring(0,a.initialBackoff.length-1))}else b.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(a){f.trace(d.LogVerbosity.DEBUG,g,"["+this.callNumber+"] "+a)}reportStatus(a){this.trace("ended with status: code="+a.code+' details="'+a.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var b;null==(b=this.listener)||b.onReceiveStatus({code:a.code,details:a.details,metadata:a.metadata})})}cancelWithStatus(a,b){for(let{call:c}of(this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.reportStatus({code:a,details:b,metadata:new e.Metadata}),this.underlyingCalls))c.cancelWithStatus(a,b)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(a){var b;return null!=(b=this.writeBuffer[a-this.writeBufferOffset])?b:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let a=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let b=this.writeBufferOffset;b<a;b++){let a=this.getBufferEntry(b);a.allocated&&this.bufferTracker.free(a.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(a-this.writeBufferOffset),this.writeBufferOffset=a}commitCall(a){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[a].state){this.trace("Committing call ["+this.underlyingCalls[a].call.getCallNumber()+"] at index "+a),this.state="COMMITTED",this.committedCallIndex=a;for(let b=0;b<this.underlyingCalls.length;b++)b!==a&&"COMPLETED"!==this.underlyingCalls[b].state&&(this.underlyingCalls[b].state="COMPLETED",this.underlyingCalls[b].call.cancelWithStatus(d.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let a=-1,b=-1;for(let[c,d]of this.underlyingCalls.entries())"ACTIVE"===d.state&&d.nextMessageToSend>a&&(a=d.nextMessageToSend,b=c);-1===b?this.state="TRANSPARENT_ONLY":this.commitCall(b)}isStatusCodeInList(a,b){return a.some(a=>a===b||a.toString().toLowerCase()===d.Status[b].toLowerCase())}getNextRetryBackoffMs(){var a;let b=null==(a=this.callConfig)?void 0:a.methodConfig.retryPolicy;if(!b)return 0;let c=Math.random()*this.nextRetryBackoffSec*1e3,d=Number(b.maxBackoff.substring(0,b.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*b.backoffMultiplier,d),c}maybeRetryCall(a,b){let c;if("RETRY"!==this.state)return void b(!1);let d=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return void b(!1);if(null===a)c=this.getNextRetryBackoffMs();else if(a<0){this.state="TRANSPARENT_ONLY",b(!1);return}else c=a,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var a,c;if("RETRY"!==this.state)return void b(!1);(null==(c=null==(a=this.retryThrottler)?void 0:a.canRetryCall())||c)&&(b(!0),this.attempts+=1,this.startNewAttempt())},c)}countActiveCalls(){let a=0;for(let b of this.underlyingCalls)(null==b?void 0:b.state)==="ACTIVE"&&(a+=1);return a}handleProcessedStatus(a,b,c){var d,e,f;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(b),this.reportStatus(a);break;case"HEDGING":if(this.isStatusCodeInList(null!=(d=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)?d:[],a.code)){let d;if(null==(e=this.retryThrottler)||e.addCallFailed(),null===c)d=0;else if(c<0){this.state="TRANSPARENT_ONLY",this.commitCall(b),this.reportStatus(a);return}else d=c;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(b),this.reportStatus(a))},d)}else this.commitCall(b),this.reportStatus(a);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,a.code)?(null==(f=this.retryThrottler)||f.addCallFailed(),this.maybeRetryCall(c,c=>{c||(this.commitCall(b),this.reportStatus(a))})):(this.commitCall(b),this.reportStatus(a))}}getPushback(a){let b=a.get("grpc-retry-pushback-ms");if(0===b.length)return null;try{return parseInt(b[0])}catch(a){return -1}}handleChildStatus(a,b){var c;if("COMPLETED"===this.underlyingCalls[b].state)return;if(this.trace("state="+this.state+" handling status with progress "+a.progress+" from child ["+this.underlyingCalls[b].call.getCallNumber()+"] in state "+this.underlyingCalls[b].state),this.underlyingCalls[b].state="COMPLETED",a.code===d.Status.OK){null==(c=this.retryThrottler)||c.addCallSucceeded(),this.commitCall(b),this.reportStatus(a);return}if("COMMITTED"===this.state)return void this.reportStatus(a);let e=this.getPushback(a.metadata);switch(a.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(a,b,e):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(b),this.reportStatus(a);break;case"PROCESSED":this.handleProcessedStatus(a,b,e)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let a=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(a.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var a,b,c;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let d=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return;let e=null!=(a=d.hedgingDelay)?a:"0s",f=Number(e.substring(0,e.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*f),null==(c=(b=this.hedgingTimer).unref)||c.call(b)}startNewAttempt(){let a=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+a.getCallNumber()+"] for attempt "+this.attempts);let b=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:a,nextMessageToSend:0});let c=this.attempts-1,d=this.initialMetadata.clone();c>0&&d.set(j,`${c}`);let e=!1;a.start(d,{onReceiveMetadata:d=>{this.trace("Received metadata from child ["+a.getCallNumber()+"]"),this.commitCall(b),e=!0,c>0&&d.set(j,`${c}`),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMetadata(d)},onReceiveMessage:c=>{this.trace("Received message from child ["+a.getCallNumber()+"]"),this.commitCall(b),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMessage(c)},onReceiveStatus:d=>{this.trace("Received status from child ["+a.getCallNumber()+"]"),!e&&c>0&&d.metadata.set(j,`${c}`),this.handleChildStatus(d,b)}}),this.sendNextChildMessage(b),this.readStarted&&a.startRead()}start(a,b){this.trace("start called"),this.listener=b,this.initialMetadata=a,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(a){var b,c;let d=this.underlyingCalls[a],e=d.nextMessageToSend;null==(c=(b=this.getBufferEntry(e)).callback)||c.call(b),this.clearSentMessages(),d.nextMessageToSend+=1,this.sendNextChildMessage(a)}sendNextChildMessage(a){let b=this.underlyingCalls[a];if("COMPLETED"!==b.state&&this.getBufferEntry(b.nextMessageToSend)){let c=this.getBufferEntry(b.nextMessageToSend);switch(c.entryType){case"MESSAGE":b.call.sendMessageWithContext({callback:b=>{this.handleChildWriteCompleted(a)}},c.message.message);break;case"HALF_CLOSE":b.nextMessageToSend+=1,b.call.halfClose()}}}sendMessageWithContext(a,b){var c;this.trace("write() called with message of length "+b.length);let d={message:b,flags:a.flags},e=this.getNextBufferIndex(),f={entryType:"MESSAGE",message:d,allocated:this.bufferTracker.allocate(b.length,this.callNumber)};if(this.writeBuffer.push(f),f.allocated)for(let[d,f]of(null==(c=a.callback)||c.call(a),this.underlyingCalls.entries()))"ACTIVE"===f.state&&f.nextMessageToSend===e&&f.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(d)}},b);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let c=this.underlyingCalls[this.committedCallIndex];f.callback=a.callback,"ACTIVE"===c.state&&c.nextMessageToSend===e&&c.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(this.committedCallIndex)}},b)}}startRead(){for(let a of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==a?void 0:a.state)==="ACTIVE"&&a.call.startRead()}halfClose(){this.trace("halfClose called");let a=this.getNextBufferIndex();for(let b of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==b?void 0:b.state)==="ACTIVE"&&b.nextMessageToSend===a&&(b.nextMessageToSend+=1,b.call.halfClose())}setCredentials(a){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}b.RetryingCall=k},12812:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BackoffTimeout=void 0;let c=1e3,d=1.6,e=12e4,f=.2;function g(a,b){return Math.random()*(b-a)+a}class h{constructor(a,b){this.callback=a,this.initialDelay=c,this.multiplier=d,this.maxDelay=e,this.jitter=f,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,b&&(b.initialDelay&&(this.initialDelay=b.initialDelay),b.multiplier&&(this.multiplier=b.multiplier),b.jitter&&(this.jitter=b.jitter),b.maxDelay&&(this.maxDelay=b.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(a){var b,c;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},a),this.hasRef||null==(c=(b=this.timerId).unref)||c.call(b)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let a=Math.min(this.nextDelay*this.multiplier,this.maxDelay),b=a*this.jitter;this.nextDelay=a+g(-b,b)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let a=new Date,b=this.startTime;b.setMilliseconds(b.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),a<b?this.runTimer(b.getTime()-a.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var a,b;this.hasRef=!0,null==(b=(a=this.timerId).ref)||b.call(a)}unref(){var a,b;this.hasRef=!1,null==(b=(a=this.timerId).unref)||b.call(a)}getEndTime(){return this.endTime}}b.BackoffTimeout=h},14299:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelConnector=void 0;let d=c(73496),e=c(34631),f=c(10811),g=c(50615),h=c(57311),i=c(18031),j=c(9114),k=c(24204),l=c(25554),m=c(91645),n=c(68306),o=c(8380),p="transport",q="transport_flowctrl",r=c(86243).rE,{HTTP2_HEADER_AUTHORITY:s,HTTP2_HEADER_CONTENT_TYPE:t,HTTP2_HEADER_METHOD:u,HTTP2_HEADER_PATH:v,HTTP2_HEADER_TE:w,HTTP2_HEADER_USER_AGENT:x}=d.constants,y=2e4,z=Buffer.from("too_many_pings","ascii");class A{constructor(a,b,c,e){this.session=a,this.options=c,this.remoteName=e,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=y,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new f.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,k.subchannelAddressToString)(b),0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,f.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[c["grpc.primary_user_agent"],`grpc-node-js/${r}`,c["grpc.secondary_user_agent"]].filter(a=>a).join(" "),"grpc.keepalive_time_ms"in c&&(this.keepaliveTimeMs=c["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in c&&(this.keepaliveTimeoutMs=c["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in c?this.keepaliveWithoutCalls=1===c["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,a.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),a.once("goaway",(a,b,c)=>{let e=!1;a===d.constants.NGHTTP2_ENHANCE_YOUR_CALM&&c&&c.equals(z)&&(e=!0),this.trace("connection closed by GOAWAY with code "+a+" and data "+(null==c?void 0:c.toString())),this.reportDisconnectToOwner(e)}),a.once("error",a=>{this.trace("connection closed with error "+a.message)}),i.isTracerEnabled(p)&&(a.on("remoteSettings",b=>{this.trace("new settings received"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))}),a.on("localSettings",b=>{this.trace("local settings acknowledged by remote"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var a,b,c;let d,e=this.session.socket,f=e.remoteAddress?(0,k.stringToSubchannelAddress)(e.remoteAddress,e.remotePort):null,g=e.localAddress?(0,k.stringToSubchannelAddress)(e.localAddress,e.localPort):null;if(this.session.encrypted){let b=e,c=b.getCipher(),f=b.getCertificate(),g=b.getPeerCertificate();d={cipherSuiteStandardName:null!=(a=c.standardName)?a:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else d=null;return{remoteAddress:f,localAddress:g,security:d,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(b=this.session.state.localWindowSize)?b:null,remoteFlowControlWindow:null!=(c=this.session.state.remoteWindowSize)?c:null}}trace(a){i.trace(g.LogVerbosity.DEBUG,p,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}keepaliveTrace(a){i.trace(g.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}flowControlTrace(a){i.trace(g.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}internalsTrace(a){i.trace(g.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}reportDisconnectToOwner(a){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(b=>b(a)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let a of this.activeCalls)a.onDisconnect()})}addDisconnectListener(a){this.disconnectListeners.push(a)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var a,b;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null==(b=(a=this.keepaliveTimeoutId).unref)||b.call(a));try{this.session.ping((a,b,c)=>{a&&(this.keepaliveTrace("Ping failed with error "+a.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(a){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var a,b;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null==(b=(a=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)?void 0:b.call(a)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(a){this.activeCalls.delete(a),0===this.activeCalls.size&&this.session.unref()}addActiveCall(a){this.activeCalls.add(a),1===this.activeCalls.size&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(a,b,c,d,e){let f,g,h,i=a.toHttp2Headers();i[s]=b,i[x]=this.userAgent,i[t]="application/grpc",i[u]="POST",i[v]=c,i[w]="trailers";try{f=this.session.request(i)}catch(a){throw this.handleDisconnect(),a}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),g={addMessageSent:()=>{var a;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;a?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null==(b=e.onStreamEnd)||b.call(e,a)}}):g={addMessageSent:()=>{var a;null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;null==(b=e.onStreamEnd)||b.call(e,a)}},h=new n.Http2SubchannelCall(f,g,d,this,(0,o.getNextCallNumber)()),this.addActiveCall(h),h}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,f.unregisterChannelzRef)(this.channelzRef)}}class B{constructor(a){this.channelTarget=a,this.session=null,this.isShutdown=!1}trace(a){i.trace(g.LogVerbosity.DEBUG,p,(0,l.uriToString)(this.channelTarget)+" "+a)}createSession(a,b,c,f){return this.isShutdown?Promise.reject():new Promise((g,h)=>{var i,n,o;let p;f.realTarget?(p=(0,l.uriToString)(f.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,l.uriToString)(f.realTarget))):(p=null,this.trace("creating HTTP/2 session to "+(0,k.subchannelAddressToString)(a)));let q=(0,j.getDefaultAuthority)(null!=(i=f.realTarget)?i:this.channelTarget),r=b._getConnectionOptions()||{};r.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in c?r.maxSessionMemory=c["grpc-node.max_session_memory"]:r.maxSessionMemory=Number.MAX_SAFE_INTEGER;let s="http://";if("secureContext"in r){if(s="https://",c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];r.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),r.servername=a}else{let a=null!=(o=null==(n=(0,l.splitHostPort)(q))?void 0:n.host)?o:"localhost";r.servername=a}f.socket&&(r.createConnection=(a,b)=>f.socket)}else r.createConnection=(b,c)=>f.socket?f.socket:m.connect(a);r=Object.assign(Object.assign(Object.assign({},r),a),{enableTrace:1===c["grpc-node.tls_enable_trace"]});let t=d.connect(s+q,r);this.session=t;let u="Failed to connect";t.unref(),t.once("connect",()=>{t.removeAllListeners(),g(new A(t,a,c,p)),this.session=null}),t.once("close",()=>{this.session=null,setImmediate(()=>{h(`${u} (${new Date().toISOString()})`)})}),t.once("error",a=>{u=a.message,this.trace("connection failed with error "+u)})})}connect(a,b,c){var d,f;if(this.isShutdown)return Promise.reject();let g=b._getConnectionOptions()||{};if("secureContext"in g){if(g.ALPNProtocols=["h2"],c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];g.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),g.servername=a}else if("grpc.http_connect_target"in c){let a=(0,j.getDefaultAuthority)(null!=(d=(0,l.parseUri)(c["grpc.http_connect_target"]))?d:{path:"localhost"}),b=(0,l.splitHostPort)(a);g.servername=null!=(f=null==b?void 0:b.host)?f:a}c["grpc-node.tls_enable_trace"]&&(g.enableTrace=!0)}return(0,h.getProxiedConnection)(a,c,g).then(d=>this.createSession(a,b,c,d))}shutdown(){var a;this.isShutdown=!0,null==(a=this.session)||a.close(),this.session=null}}b.Http2SubchannelConnector=B},14456:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ClientDuplexStreamImpl=b.ClientWritableStreamImpl=b.ClientReadableStreamImpl=b.ClientUnaryCallImpl=b.callErrorFromStatus=void 0;let d=c(94735),e=c(27910),f=c(50615);b.callErrorFromStatus=function(a,b){let c=`${a.code} ${f.Status[a.code]}: ${a.details}`,d=Error(c),e=`${d.stack}
for call at
${b}`;return Object.assign(Error(c),a,{stack:e})};class g extends d.EventEmitter{constructor(){super()}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}}b.ClientUnaryCallImpl=g;class h extends e.Readable{constructor(a){super({objectMode:!0}),this.deserialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}}b.ClientReadableStreamImpl=h;class i extends e.Writable{constructor(a){super({objectMode:!0}),this.serialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientWritableStreamImpl=i;class j extends e.Duplex{constructor(a,b){super({objectMode:!0}),this.serialize=a,this.deserialize=b}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientDuplexStreamImpl=j},14985:a=>{"use strict";a.exports=require("dns")},15217:(a,b)=>{"use strict";function c(a){let{ampFirst:b=!1,hybrid:c=!1,hasQuery:d=!1}=void 0===a?{}:a;return b||c&&d}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isInAmpMode",{enumerable:!0,get:function(){return c}})},16452:a=>{var b=1/0,c="[object Symbol]",d=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,e=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,f="\ud800-\udfff",g="\\u0300-\\u036f\\ufe20-\\ufe23",h="\\u20d0-\\u20f0",i="\\u2700-\\u27bf",j="a-z\\xdf-\\xf6\\xf8-\\xff",k="A-Z\\xc0-\\xd6\\xd8-\\xde",l="\\ufe0e\\ufe0f",m="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",n="['’]",o="["+f+"]",p="["+m+"]",q="["+g+h+"]",r="\\d+",s="["+i+"]",t="["+j+"]",u="[^"+f+m+r+i+j+k+"]",v="\ud83c[\udffb-\udfff]",w="[^"+f+"]",x="(?:\ud83c[\udde6-\uddff]){2}",y="[\ud800-\udbff][\udc00-\udfff]",z="["+k+"]",A="\\u200d",B="(?:"+t+"|"+u+")",C="(?:"+z+"|"+u+")",D="(?:"+n+"(?:d|ll|m|re|s|t|ve))?",E="(?:"+n+"(?:D|LL|M|RE|S|T|VE))?",F="(?:"+q+"|"+v+")?",G="["+l+"]?",H="(?:"+A+"(?:"+[w,x,y].join("|")+")"+G+F+")*",I=G+F+H,J="(?:"+[s,x,y].join("|")+")"+I,K="(?:"+[w+q+"?",q,x,y,o].join("|")+")",L=RegExp(n,"g"),M=RegExp(q,"g"),N=RegExp(v+"(?="+v+")|"+K+I,"g"),O=RegExp([z+"?"+t+"+"+D+"(?="+[p,z,"$"].join("|")+")",C+"+"+E+"(?="+[p,z+B,"$"].join("|")+")",z+"?"+B+"+"+D,z+"+"+E,r,J].join("|"),"g"),P=RegExp("["+A+f+g+h+l+"]"),Q=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,R={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"ss"},S="object"==typeof global&&global&&global.Object===Object&&global,T="object"==typeof self&&self&&self.Object===Object&&self,U=S||T||Function("return this")();function V(a,b,c,d){var e=-1,f=a?a.length:0;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function W(a){return a.split("")}function X(a){return a.match(d)||[]}var Y=function(a){return function(b){return null==a?void 0:a[b]}}(R);function Z(a){return P.test(a)}function $(a){return Q.test(a)}function _(a){return Z(a)?aa(a):W(a)}function aa(a){return a.match(N)||[]}function ab(a){return a.match(O)||[]}var ac=Object.prototype.toString,ad=U.Symbol,ae=ad?ad.prototype:void 0,af=ae?ae.toString:void 0;function ag(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),(c=c>e?e:c)<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function ah(a){if("string"==typeof a)return a;if(al(a))return af?af.call(a):"";var c=a+"";return"0"==c&&1/a==-b?"-0":c}function ai(a,b,c){var d=a.length;return c=void 0===c?d:c,!b&&c>=d?a:ag(a,b,c)}function aj(a){return function(b){var c=Z(b=am(b))?_(b):void 0,d=c?c[0]:b.charAt(0),e=c?ai(c,1).join(""):b.slice(1);return d[a]()+e}}function ak(a){return!!a&&"object"==typeof a}function al(a){return"symbol"==typeof a||ak(a)&&ac.call(a)==c}function am(a){return null==a?"":ah(a)}var an=function(a){return function(b){return V(ar(ap(b).replace(L,"")),a,"")}}(function(a,b,c){return b=b.toLowerCase(),a+(c?ao(b):b)});function ao(a){return aq(am(a).toLowerCase())}function ap(a){return(a=am(a))&&a.replace(e,Y).replace(M,"")}var aq=aj("toUpperCase");function ar(a,b,c){return(a=am(a),void 0===(b=c?void 0:b))?$(a)?ab(a):X(a):a.match(b)||[]}a.exports=an},16889:(a,b,c)=>{Promise.resolve().then(c.bind(c,79622))},17900:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ServerCredentials=void 0;let d=c(38939);class e{static createInsecure(){return new f}static createSsl(a,b,c=!1){if(null!==a&&!Buffer.isBuffer(a))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(b))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof c)throw TypeError("checkClientCertificate must be a boolean");let e=[],f=[];for(let a=0;a<b.length;a++){let c=b[a];if(null===c||"object"!=typeof c)throw TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(c.private_key))throw TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(c.cert_chain))throw TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);e.push(c.cert_chain),f.push(c.private_key)}return new g({ca:a||(0,d.getDefaultRootsData)()||void 0,cert:e,key:f,requestCert:c,ciphers:d.CIPHER_SUITES})}}b.ServerCredentials=e;class f extends e{_isSecure(){return!1}_getSettings(){return null}}class g extends e{constructor(a){super(),this.options=a}_isSecure(){return!0}_getSettings(){return this.options}}},18031:(a,b,c)=>{"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.isTracerEnabled=b.trace=b.log=b.setLoggerVerbosity=b.setLogger=b.getLogger=void 0;let h=c(50615),i=c(19771),j=c(86243).rE,k={error:(a,...b)=>{console.error("E "+a,...b)},info:(a,...b)=>{console.error("I "+a,...b)},debug:(a,...b)=>{console.error("D "+a,...b)}},l=h.LogVerbosity.ERROR;switch((null!=(e=null!=(d=process.env.GRPC_NODE_VERBOSITY)?d:process.env.GRPC_VERBOSITY)?e:"").toUpperCase()){case"DEBUG":l=h.LogVerbosity.DEBUG;break;case"INFO":l=h.LogVerbosity.INFO;break;case"ERROR":l=h.LogVerbosity.ERROR;break;case"NONE":l=h.LogVerbosity.NONE}b.getLogger=()=>k,b.setLogger=a=>{k=a},b.setLoggerVerbosity=a=>{l=a},b.log=(a,...b)=>{let c;if(a>=l){switch(a){case h.LogVerbosity.DEBUG:c=k.debug;break;case h.LogVerbosity.INFO:c=k.info;break;case h.LogVerbosity.ERROR:c=k.error}c||(c=k.error),c&&c.bind(k)(...b)}};let m=null!=(g=null!=(f=process.env.GRPC_NODE_TRACE)?f:process.env.GRPC_TRACE)?g:"",n=new Set,o=new Set;for(let a of m.split(","))a.startsWith("-")?o.add(a.substring(1)):n.add(a);let p=n.has("all");function q(a,c,d){r(c)&&(0,b.log)(a,new Date().toISOString()+" | v"+j+" "+i.pid+" | "+c+" | "+d)}function r(a){return!o.has(a)&&(p||n.has(a))}b.trace=q,b.isTracerEnabled=r},18355:(a,b,c)=>{"use strict";a.exports=c(56796).vendored.contexts.RouterContext},18657:(a,b,c)=>{"use strict";var d=b,e=c(90290),f=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function g(a,b){var c=0,d={};for(b|=0;c<a.length;)d[f[c+b]]=a[c++];return d}d.basic=g([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),d.defaults=g([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",e.emptyArray,null]),d.long=g([0,0,0,1,1],7),d.mapKey=g([0,0,0,5,5,0,0,0,1,1,0,2],2),d.packed=g([1,5,0,0,0,5,5,0,0,0,1,1,0])},19006:(a,b,c)=>{"use strict";var d=b,e=c(4755);d[".google.protobuf.Any"]={fromObject:function(a){if(a&&a["@type"]){var b=a["@type"].substring(a["@type"].lastIndexOf("/")+1),c=this.lookup(b);if(c){var d="."===a["@type"].charAt(0)?a["@type"].slice(1):a["@type"];return -1===d.indexOf("/")&&(d="/"+d),this.create({type_url:d,value:c.encode(c.fromObject(a)).finish()})}}return this.fromObject(a)},toObject:function(a,b){var c="type.googleapis.com/",d="",f="";if(b&&b.json&&a.type_url&&a.value){f=a.type_url.substring(a.type_url.lastIndexOf("/")+1),d=a.type_url.substring(0,a.type_url.lastIndexOf("/")+1);var g=this.lookup(f);g&&(a=g.decode(a.value))}if(!(a instanceof this.ctor)&&a instanceof e){var h=a.$type.toObject(a,b),i="."===a.$type.fullName[0]?a.$type.fullName.slice(1):a.$type.fullName;return""===d&&(d=c),f=d+i,h["@type"]=f,h}return this.toObject(a,b)}}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19746:(a,b,c)=>{"use strict";a.exports=c(56796).vendored.contexts.HeadManagerContext},19771:a=>{"use strict";a.exports=require("process")},21820:a=>{"use strict";a.exports=require("os")},23455:(a,b,c)=>{"use strict";a.exports=f;var d=c(72481);((f.prototype=Object.create(d.prototype)).constructor=f).className="Method";var e=c(90290);function f(a,b,c,f,g,h,i,j,k){if(e.isObject(g)?(i=g,g=h=void 0):e.isObject(h)&&(i=h,h=void 0),!(void 0===b||e.isString(b)))throw TypeError("type must be a string");if(!e.isString(c))throw TypeError("requestType must be a string");if(!e.isString(f))throw TypeError("responseType must be a string");d.call(this,a,i),this.type=b||"rpc",this.requestType=c,this.requestStream=!!g||void 0,this.responseType=f,this.responseStream=!!h||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=j,this.parsedOptions=k}f.fromJSON=function(a,b){return new f(a,b.type,b.requestType,b.responseType,b.requestStream,b.responseStream,b.options,b.comment,b.parsedOptions)},f.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return e.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",b?this.comment:void 0,"parsedOptions",this.parsedOptions])},f.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),d.prototype.resolve.call(this))}},23464:(a,b,c)=>{"use strict";a.exports=h;var d=c(27791),e=c(18657),f=c(90290);function g(a,b,c,d){return b.delimited?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,d,(b.id<<3|3)>>>0,(b.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,d,(b.id<<3|2)>>>0)}function h(a){for(var b,c,h=f.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),i=a.fieldsArray.slice().sort(f.compareFieldsById),b=0;b<i.length;++b){var j=i[b].resolve(),k=a._fieldsArray.indexOf(j),l=j.resolvedType instanceof d?"int32":j.type,m=e.basic[l];c="m"+f.safeProp(j.name),j.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",c,j.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",c)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(j.id<<3|2)>>>0,8|e.mapKey[j.keyType],j.keyType),void 0===m?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",k,c):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|m,l,c),h("}")("}")):j.repeated?(h("if(%s!=null&&%s.length){",c,c),j.packed&&void 0!==e.packed[l]?h("w.uint32(%i).fork()",(j.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",c)("w.%s(%s[i])",l,c)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",c),void 0===m?g(h,j,k,c+"[i]"):h("w.uint32(%i).%s(%s[i])",(j.id<<3|m)>>>0,l,c)),h("}")):(j.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",c,j.name),void 0===m?g(h,j,k,c):h("w.uint32(%i).%s(%s)",(j.id<<3|m)>>>0,l,c))}return h("return w")}},24204:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.stringToSubchannelAddress=b.subchannelAddressToString=b.subchannelAddressEqual=b.isTcpSubchannelAddress=void 0;let d=c(91645);function e(a){return"port"in a}b.isTcpSubchannelAddress=e,b.subchannelAddressEqual=function(a,b){return!a&&!b||!!a&&!!b&&(e(a)?e(b)&&a.host===b.host&&a.port===b.port:!e(b)&&a.path===b.path)},b.subchannelAddressToString=function(a){return e(a)?a.host+":"+a.port:a.path};let f=443;b.stringToSubchannelAddress=function(a,b){return(0,d.isIP)(a)?{host:a,port:null!=b?b:f}:{path:a}}},24286:a=>{"use strict";function b(a){return"undefined"!=typeof Float32Array?!function(){var b=new Float32Array([-0]),c=new Uint8Array(b.buffer),d=128===c[3];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3]}function f(a,d,e){b[0]=a,d[e]=c[3],d[e+1]=c[2],d[e+2]=c[1],d[e+3]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],b[0]}function h(a,d){return c[3]=a[d],c[2]=a[d+1],c[1]=a[d+2],c[0]=a[d+3],b[0]}a.writeFloatLE=d?e:f,a.writeFloatBE=d?f:e,a.readFloatLE=d?g:h,a.readFloatBE=d?h:g}():!function(){function b(a,b,c,d){var e=+(b<0);if(e&&(b=-b),0===b)a(1/b>0?0:0x80000000,c,d);else if(isNaN(b))a(0x7fc00000,c,d);else if(b>34028234663852886e22)a((e<<31|0x7f800000)>>>0,c,d);else if(b<11754943508222875e-54)a((e<<31|Math.round(b/1401298464324817e-60))>>>0,c,d);else{var f=Math.floor(Math.log(b)/Math.LN2),g=8388607&Math.round(b*Math.pow(2,-f)*8388608);a((e<<31|f+127<<23|g)>>>0,c,d)}}function g(a,b,c){var d=a(b,c),e=(d>>31)*2+1,f=d>>>23&255,g=8388607&d;return 255===f?g?NaN:1/0*e:0===f?1401298464324817e-60*e*g:e*Math.pow(2,f-150)*(g+8388608)}a.writeFloatLE=b.bind(null,c),a.writeFloatBE=b.bind(null,d),a.readFloatLE=g.bind(null,e),a.readFloatBE=g.bind(null,f)}(),"undefined"!=typeof Float64Array?!function(){var b=new Float64Array([-0]),c=new Uint8Array(b.buffer),d=128===c[7];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3],d[e+4]=c[4],d[e+5]=c[5],d[e+6]=c[6],d[e+7]=c[7]}function f(a,d,e){b[0]=a,d[e]=c[7],d[e+1]=c[6],d[e+2]=c[5],d[e+3]=c[4],d[e+4]=c[3],d[e+5]=c[2],d[e+6]=c[1],d[e+7]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],c[4]=a[d+4],c[5]=a[d+5],c[6]=a[d+6],c[7]=a[d+7],b[0]}function h(a,d){return c[7]=a[d],c[6]=a[d+1],c[5]=a[d+2],c[4]=a[d+3],c[3]=a[d+4],c[2]=a[d+5],c[1]=a[d+6],c[0]=a[d+7],b[0]}a.writeDoubleLE=d?e:f,a.writeDoubleBE=d?f:e,a.readDoubleLE=d?g:h,a.readDoubleBE=d?h:g}():!function(){function b(a,b,c,d,e,f){var g,h=+(d<0);if(h&&(d=-d),0===d)a(0,e,f+b),a(1/d>0?0:0x80000000,e,f+c);else if(isNaN(d))a(0,e,f+b),a(0x7ff80000,e,f+c);else if(d>17976931348623157e292)a(0,e,f+b),a((h<<31|0x7ff00000)>>>0,e,f+c);else if(d<22250738585072014e-324)a((g=d/5e-324)>>>0,e,f+b),a((h<<31|g/0x100000000)>>>0,e,f+c);else{var i=Math.floor(Math.log(d)/Math.LN2);1024===i&&(i=1023),a(0x10000000000000*(g=d*Math.pow(2,-i))>>>0,e,f+b),a((h<<31|i+1023<<20|1048576*g&1048575)>>>0,e,f+c)}}function g(a,b,c,d,e){var f=a(d,e+b),g=a(d,e+c),h=(g>>31)*2+1,i=g>>>20&2047,j=0x100000000*(1048575&g)+f;return 2047===i?j?NaN:1/0*h:0===i?5e-324*h*j:h*Math.pow(2,i-1075)*(j+0x10000000000000)}a.writeDoubleLE=b.bind(null,c,0,4),a.writeDoubleBE=b.bind(null,d,4,0),a.readDoubleLE=g.bind(null,e,0,4),a.readDoubleBE=g.bind(null,f,4,0)}(),a}function c(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}function d(a,b,c){b[c]=a>>>24,b[c+1]=a>>>16&255,b[c+2]=a>>>8&255,b[c+3]=255&a}function e(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0}function f(a,b){return(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}a.exports=b(b)},25554:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.uriToString=b.splitHostPort=b.parseUri=void 0;let c=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;b.parseUri=function(a){let b=c.exec(a);return null===b?null:{scheme:b[1],authority:b[2],path:b[3]}};let d=/^\d+$/;b.splitHostPort=function(a){if(a.startsWith("[")){let b=a.indexOf("]");if(-1===b)return null;let c=a.substring(1,b);if(-1===c.indexOf(":"))return null;if(!(a.length>b+1))return{host:c};if(":"!==a[b+1])return null;{let e=a.substring(b+2);return d.test(e)?{host:c,port:+e}:null}}{let b=a.split(":");return 2!==b.length?{host:a}:d.test(b[1])?{host:b[0],port:+b[1]}:null}},b.uriToString=function(a){let b="";return void 0!==a.scheme&&(b+=a.scheme+":"),void 0!==a.authority&&(b+="//"+a.authority+"/"),b+=a.path}},25811:(a,b,c)=>{"use strict";a.exports=h;var d=c(26991);((h.prototype=Object.create(d.prototype)).constructor=h).className="Service";var e=c(23455),f=c(90290),g=c(74915);function h(a,b){d.call(this,a,b),this.methods={},this._methodsArray=null}function i(a){return a._methodsArray=null,a}h.fromJSON=function(a,b){var c=new h(a,b.options);if(b.methods)for(var d=Object.keys(b.methods),f=0;f<d.length;++f)c.add(e.fromJSON(d[f],b.methods[d[f]]));return b.nested&&c.addJSON(b.nested),b.edition&&(c._edition=b.edition),c.comment=b.comment,c._defaultEdition="proto3",c},h.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"methods",d.arrayToJSON(this.methodsArray,a)||{},"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},Object.defineProperty(h.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=f.toArray(this.methods))}}),h.prototype.get=function(a){return this.methods[a]||d.prototype.get.call(this,a)},h.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolve.call(this);for(var a=this.methodsArray,b=0;b<a.length;++b)a[b].resolve();return this},h.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.methodsArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},h.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);return a instanceof e?(this.methods[a.name]=a,a.parent=this,i(this)):d.prototype.add.call(this,a)},h.prototype.remove=function(a){if(a instanceof e){if(this.methods[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.methods[a.name],a.parent=null,i(this)}return d.prototype.remove.call(this,a)},h.prototype.create=function(a,b,c){for(var d,e=new g.Service(a,b,c),h=0;h<this.methodsArray.length;++h){var i=f.lcFirst((d=this._methodsArray[h]).resolve().name).replace(/[^$\w_]/g,"");e[i]=f.codegen(["r","c"],f.isReserved(i)?i+"_":i)("return this.rpcCall(m,q,s,r,c)")({m:d,q:d.resolvedRequestType.ctor,s:d.resolvedResponseType.ctor})}return e}},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},26740:(a,b,c)=>{"use strict";a.exports=f;var d=c(81165),e=c(32497)("fs");function f(a,b,c){return("function"==typeof b?(c=b,b={}):b||(b={}),c)?!b.xhr&&e&&e.readFile?e.readFile(a,function(d,e){return d&&"undefined"!=typeof XMLHttpRequest?f.xhr(a,b,c):d?c(d):c(null,b.binary?e:e.toString("utf8"))}):f.xhr(a,b,c):d(f,this,a,b)}f.xhr=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(0!==d.status&&200!==d.status)return c(Error("status "+d.status));if(b.binary){var a=d.response;if(!a){a=[];for(var e=0;e<d.responseText.length;++e)a.push(255&d.responseText.charCodeAt(e))}return c(null,"undefined"!=typeof Uint8Array?new Uint8Array(a):a)}return c(null,d.responseText)}},b.binary&&("overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.responseType="arraybuffer"),d.open("GET",a),d.send()}},26991:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(72481);((l.prototype=Object.create(g.prototype)).constructor=l).className="Namespace";var h=c(99408),i=c(90290),j=c(67369);function k(a,b){if(a&&a.length){for(var c={},d=0;d<a.length;++d)c[a[d].name]=a[d].toJSON(b);return c}}function l(a,b){g.call(this,a,b),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function m(a){a._nestedArray=null,a._lookupCache={};for(var b=a;b=b.parent;)b._lookupCache={};return a}l.fromJSON=function(a,b){return new l(a,b.options).addJSON(b.nested)},l.arrayToJSON=k,l.isReservedId=function(a,b){if(a){for(var c=0;c<a.length;++c)if("string"!=typeof a[c]&&a[c][0]<=b&&a[c][1]>b)return!0}return!1},l.isReservedName=function(a,b){if(a){for(var c=0;c<a.length;++c)if(a[c]===b)return!0}return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=i.toArray(this.nested))}}),l.prototype.toJSON=function(a){return i.toObject(["options",this.options,"nested",k(this.nestedArray,a)])},l.prototype.addJSON=function(a){var b=this;if(a)for(var c,g=Object.keys(a),i=0;i<g.length;++i)c=a[g[i]],b.add((void 0!==c.fields?d.fromJSON:void 0!==c.values?f.fromJSON:void 0!==c.methods?e.fromJSON:void 0!==c.id?h.fromJSON:l.fromJSON)(g[i],c));return this},l.prototype.get=function(a){return this.nested&&this.nested[a]||null},l.prototype.getEnum=function(a){if(this.nested&&this.nested[a]instanceof f)return this.nested[a].values;throw Error("no such enum: "+a)},l.prototype.add=function(a){if(!(a instanceof h&&void 0!==a.extend||a instanceof d||a instanceof j||a instanceof f||a instanceof e||a instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var b=this.get(a.name);if(b)if(b instanceof l&&a instanceof l&&!(b instanceof d||b instanceof e)){for(var c=b.nestedArray,g=0;g<c.length;++g)a.add(c[g]);this.remove(b),this.nested||(this.nested={}),a.setOptions(b.options,!0)}else throw Error("duplicate name '"+a.name+"' in "+this)}else this.nested={};this.nested[a.name]=a,this instanceof d||this instanceof e||this instanceof f||this instanceof h||a._edition||(a._edition=a._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var i=this;i=i.parent;)i._needsRecursiveFeatureResolution=!0,i._needsRecursiveResolve=!0;return a.onAdd(this),m(this)},l.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("object must be a ReflectionObject");if(a.parent!==this)throw Error(a+" is not a member of "+this);return delete this.nested[a.name],Object.keys(this.nested).length||(this.nested=void 0),a.onRemove(this),m(this)},l.prototype.define=function(a,b){if(i.isString(a))a=a.split(".");else if(!Array.isArray(a))throw TypeError("illegal path");if(a&&a.length&&""===a[0])throw Error("path must be relative");for(var c=this;a.length>0;){var d=a.shift();if(c.nested&&c.nested[d]){if(!((c=c.nested[d])instanceof l))throw Error("path conflicts with non-namespace objects")}else c.add(c=new l(d))}return b&&c.addJSON(b),c},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var a=this.nestedArray,b=0;for(this.resolve();b<a.length;)a[b]instanceof l?a[b++].resolveAll():a[b++].resolve();return this._needsRecursiveResolve=!1,this},l.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,a=this._edition||a,g.prototype._resolveFeaturesRecursive.call(this,a),this.nestedArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},l.prototype.lookup=function(a,b,c){if("boolean"==typeof b?(c=b,b=void 0):b&&!Array.isArray(b)&&(b=[b]),i.isString(a)&&a.length){if("."===a)return this.root;a=a.split(".")}else if(!a.length)return this;var d=a.join(".");if(""===a[0])return this.root.lookup(a.slice(1),b);var e=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+d];if(e&&(!b||b.indexOf(e.constructor)>-1)||(e=this._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;if(c)return null;for(var f=this;f.parent;){if((e=f.parent._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;f=f.parent}return null},l.prototype._lookupImpl=function(a,b){if(Object.prototype.hasOwnProperty.call(this._lookupCache,b))return this._lookupCache[b];var c=this.get(a[0]),d=null;if(c)1===a.length?d=c:c instanceof l&&(a=a.slice(1),d=c._lookupImpl(a,a.join(".")));else for(var e=0;e<this.nestedArray.length;++e)this._nestedArray[e]instanceof l&&(c=this._nestedArray[e]._lookupImpl(a,b))&&(d=c);return this._lookupCache[b]=d,d},l.prototype.lookupType=function(a){var b=this.lookup(a,[d]);if(!b)throw Error("no such type: "+a);return b},l.prototype.lookupEnum=function(a){var b=this.lookup(a,[f]);if(!b)throw Error("no such Enum '"+a+"' in "+this);return b},l.prototype.lookupTypeOrEnum=function(a){var b=this.lookup(a,[d,f]);if(!b)throw Error("no such Type or Enum '"+a+"' in "+this);return b},l.prototype.lookupService=function(a){var b=this.lookup(a,[e]);if(!b)throw Error("no such Service '"+a+"' in "+this);return b},l._configure=function(a,b,c){d=a,e=b,f=c}},27203:(a,b)=>{"use strict";var c=b;c.length=function(a){var b=a.length;if(!b)return 0;for(var c=0;--b%4>1&&"="===a.charAt(b);)++c;return Math.ceil(3*a.length)/4-c};for(var d=Array(64),e=Array(123),f=0;f<64;)e[d[f]=f<26?f+65:f<52?f+71:f<62?f-4:f-59|43]=f++;c.encode=function(a,b,c){for(var e,f=null,g=[],h=0,i=0;b<c;){var j=a[b++];switch(i){case 0:g[h++]=d[j>>2],e=(3&j)<<4,i=1;break;case 1:g[h++]=d[e|j>>4],e=(15&j)<<2,i=2;break;case 2:g[h++]=d[e|j>>6],g[h++]=d[63&j],i=0}h>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,g)),h=0)}return(i&&(g[h++]=d[e],g[h++]=61,1===i&&(g[h++]=61)),f)?(h&&f.push(String.fromCharCode.apply(String,g.slice(0,h))),f.join("")):String.fromCharCode.apply(String,g.slice(0,h))};var g="invalid encoding";c.decode=function(a,b,c){for(var d,f=c,h=0,i=0;i<a.length;){var j=a.charCodeAt(i++);if(61===j&&h>1)break;if(void 0===(j=e[j]))throw Error(g);switch(h){case 0:d=j,h=1;break;case 1:b[c++]=d<<2|(48&j)>>4,d=j,h=2;break;case 2:b[c++]=(15&d)<<4|(60&j)>>2,d=j,h=3;break;case 3:b[c++]=(3&d)<<6|j,h=0}}if(1===h)throw Error(g);return c-f},c.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}},27481:a=>{"use strict";a.exports={}},27791:(a,b,c)=>{"use strict";a.exports=g;var d=c(72481);((g.prototype=Object.create(d.prototype)).constructor=g).className="Enum";var e=c(26991),f=c(90290);function g(a,b,c,e,f,g){if(d.call(this,a,c),b&&"object"!=typeof b)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=e,this.comments=f||{},this.valuesOptions=g,this._valuesFeatures={},this.reserved=void 0,b)for(var h=Object.keys(b),i=0;i<h.length;++i)"number"==typeof b[h[i]]&&(this.valuesById[this.values[h[i]]=b[h[i]]]=h[i])}g.prototype._resolveFeatures=function(a){return a=this._edition||a,d.prototype._resolveFeatures.call(this,a),Object.keys(this.values).forEach(a=>{var b=Object.assign({},this._features);this._valuesFeatures[a]=Object.assign(b,this.valuesOptions&&this.valuesOptions[a]&&this.valuesOptions[a].features)}),this},g.fromJSON=function(a,b){var c=new g(a,b.values,b.options,b.comment,b.comments);return c.reserved=b.reserved,b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",b?this.comment:void 0,"comments",b?this.comments:void 0])},g.prototype.add=function(a,b,c,d){if(!f.isString(a))throw TypeError("name must be a string");if(!f.isInteger(b))throw TypeError("id must be an integer");if(void 0!==this.values[a])throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(b))throw Error("id "+b+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(void 0!==this.valuesById[b]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+b+" in "+this);this.values[a]=b}else this.valuesById[this.values[a]=b]=a;return d&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[a]=d||null),this.comments[a]=c||null,this},g.prototype.remove=function(a){if(!f.isString(a))throw TypeError("name must be a string");var b=this.values[a];if(null==b)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[b],delete this.values[a],delete this.comments[a],this.valuesOptions&&delete this.valuesOptions[a],this},g.prototype.isReservedId=function(a){return e.isReservedId(this.reserved,a)},g.prototype.isReservedName=function(a){return e.isReservedName(this.reserved,a)}},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},28601:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},29021:a=>{"use strict";a.exports=require("fs")},29178:a=>{"use strict";function b(){this._listeners={}}a.exports=b,b.prototype.on=function(a,b,c){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:b,ctx:c||this}),this},b.prototype.off=function(a,b){if(void 0===a)this._listeners={};else if(void 0===b)this._listeners[a]=[];else for(var c=this._listeners[a],d=0;d<c.length;)c[d].fn===b?c.splice(d,1):++d;return this},b.prototype.emit=function(a){var b=this._listeners[a];if(b){for(var c=[],d=1;d<arguments.length;)c.push(arguments[d++]);for(d=0;d<b.length;)b[d].fn.apply(b[d++].ctx,c)}return this}},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29383:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.restrictControlPlaneStatusCode=void 0;let d=c(50615),e=[d.Status.OK,d.Status.INVALID_ARGUMENT,d.Status.NOT_FOUND,d.Status.ALREADY_EXISTS,d.Status.FAILED_PRECONDITION,d.Status.ABORTED,d.Status.OUT_OF_RANGE,d.Status.DATA_LOSS];b.restrictControlPlaneStatusCode=function(a,b){return e.includes(a)?{code:d.Status.INTERNAL,details:`Invalid status from control plane: ${a} ${d.Status[a]} ${b}`}:{code:a,details:b}}},31502:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(26991);((l.prototype=Object.create(g.prototype)).constructor=l).className="Root";var h=c(99408),i=c(27791),j=c(67369),k=c(90290);function l(a){g.call(this,"",a),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function m(){}l.fromJSON=function(a,b){return b||(b=new l),a.options&&b.setOptions(a.options),b.addJSON(a.nested).resolveAll()},l.prototype.resolvePath=k.path.resolve,l.prototype.fetch=k.fetch,l.prototype.load=function a(b,c,d){"function"==typeof c&&(d=c,c=void 0);var g=this;if(!d)return k.asPromise(a,g,b,c);var h=d===m;function i(a,b){if(d){if(h)throw a;b&&b.resolveAll();var c=d;d=null,c(a,b)}}function j(a){var b=a.lastIndexOf("google/protobuf/");if(b>-1){var c=a.substring(b);if(c in f)return c}return null}function l(a,b){try{if(k.isString(b)&&"{"===b.charAt(0)&&(b=JSON.parse(b)),k.isString(b)){e.filename=a;var d,f=e(b,g,c),l=0;if(f.imports)for(;l<f.imports.length;++l)(d=j(f.imports[l])||g.resolvePath(a,f.imports[l]))&&n(d);if(f.weakImports)for(l=0;l<f.weakImports.length;++l)(d=j(f.weakImports[l])||g.resolvePath(a,f.weakImports[l]))&&n(d,!0)}else g.setOptions(b.options).addJSON(b.nested)}catch(a){i(a)}h||o||i(null,g)}function n(a,b){if(a=j(a)||a,!(g.files.indexOf(a)>-1)){if(g.files.push(a),a in f)return void(h?l(a,f[a]):(++o,setTimeout(function(){--o,l(a,f[a])})));if(h){var c;try{c=k.fs.readFileSync(a).toString("utf8")}catch(a){b||i(a);return}l(a,c)}else++o,g.fetch(a,function(c,e){if(--o,d){if(c)return void(b?o||i(null,g):i(c));l(a,e)}})}}var o=0;k.isString(b)&&(b=[b]);for(var p,q=0;q<b.length;++q)(p=g.resolvePath("",b[q]))&&n(p);return h?g.resolveAll():o||i(null,g),g},l.prototype.loadSync=function(a,b){if(!k.isNode)throw Error("not supported");return this.load(a,b,m)},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(a){return"'extend "+a.extend+"' in "+a.parent.fullName}).join(", "));return g.prototype.resolveAll.call(this)};var n=/^[A-Z]/;function o(a,b){var c=b.parent.lookup(b.extend);if(c){var d=new h(b.fullName,b.id,b.type,b.rule,void 0,b.options);return!!c.get(d.name)||(d.declaringField=b,b.extensionField=d,c.add(d),!0)}return!1}l.prototype._handleAdd=function(a){if(a instanceof h)void 0===a.extend||a.extensionField||o(this,a)||this.deferred.push(a);else if(a instanceof i)n.test(a.name)&&(a.parent[a.name]=a.values);else if(!(a instanceof j)){if(a instanceof d)for(var b=0;b<this.deferred.length;)o(this,this.deferred[b])?this.deferred.splice(b,1):++b;for(var c=0;c<a.nestedArray.length;++c)this._handleAdd(a._nestedArray[c]);n.test(a.name)&&(a.parent[a.name]=a)}(a instanceof d||a instanceof i||a instanceof h)&&(this._fullyQualifiedObjects[a.fullName]=a)},l.prototype._handleRemove=function(a){if(a instanceof h){if(void 0!==a.extend)if(a.extensionField)a.extensionField.parent.remove(a.extensionField),a.extensionField=null;else{var b=this.deferred.indexOf(a);b>-1&&this.deferred.splice(b,1)}}else if(a instanceof i)n.test(a.name)&&delete a.parent[a.name];else if(a instanceof g){for(var c=0;c<a.nestedArray.length;++c)this._handleRemove(a._nestedArray[c]);n.test(a.name)&&delete a.parent[a.name]}delete this._fullyQualifiedObjects[a.fullName]},l._configure=function(a,b,c){d=a,e=b,f=c}},31834:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.PickFirstLoadBalancer=b.shuffled=b.PickFirstLoadBalancingConfig=void 0;let d=c(68367),e=c(96699),f=c(82142),g=c(18031),h=c(50615),i="pick_first";function j(a){g.trace(h.LogVerbosity.DEBUG,i,a)}let k="pick_first",l=250;class m{constructor(a){this.shuffleAddressList=a}getLoadBalancerName(){return k}toJsonObject(){return{[k]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(a){if("shuffleAddressList"in a&&"boolean"!=typeof a.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new m(!0===a.shuffleAddressList)}}b.PickFirstLoadBalancingConfig=m;class n{constructor(a){this.subchannel=a}pick(a){return{pickResultType:f.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function o(a){let b=a.slice();for(let a=b.length-1;a>1;a--){let c=Math.floor(Math.random()*(a+1)),d=b[a];b[a]=b[c],b[c]=d}return b}b.shuffled=o;class p{constructor(a){this.channelControlHelper=a,this.children=[],this.currentState=e.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(a,b,c,d,e)=>{this.onSubchannelStateUpdate(a,b,c,e)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(a=>a.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(e.ConnectivityState.READY,new n(this.currentPick)):0===this.children.length?this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:a}of(this.stickyTransientFailureMode=!0,this.children))a.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let a=this.currentPick;this.currentPick=null,a.unref(),a.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(a.getChannelzRef())}}onSubchannelStateUpdate(a,b,c,d){var f;if(null==(f=this.currentPick)?void 0:f.realSubchannelEquals(a)){c!==e.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[b,f]of this.children.entries())if(a.realSubchannelEquals(f.subchannel)){c===e.ConnectivityState.READY&&this.pickSubchannel(f.subchannel),c===e.ConnectivityState.TRANSIENT_FAILURE&&(f.hasReportedTransientFailure=!0,d&&(this.lastError=d),this.maybeEnterStickyTransientFailureMode(),b===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(b+1)),f.subchannel.startConnecting();return}}startNextSubchannelConnecting(a){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[b,c]of this.children.entries())if(b>=a){let a=c.subchannel.getConnectivityState();if(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.CONNECTING)return void this.startConnecting(b)}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(a){var b,c;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=a,this.children[a].subchannel.getConnectivityState()===e.ConnectivityState.IDLE&&(j("Start connecting to subchannel with address "+this.children[a].subchannel.getAddress()),process.nextTick(()=>{var b;null==(b=this.children[a])||b.subchannel.startConnecting()})),this.connectionDelayTimeout=null==(c=(b=setTimeout(()=>{this.startNextSubchannelConnecting(a+1)},l)).unref)?void 0:c.call(b)}pickSubchannel(a){this.currentPick&&a.realSubchannelEquals(this.currentPick)||(j("Pick subchannel with address "+a.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=a,a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(a,b){j(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.children)this.currentPick&&a.subchannel.realSubchannelEquals(this.currentPick)||a.subchannel.removeConnectivityStateListener(this.subchannelStateListener),a.subchannel.unref(),this.channelControlHelper.removeChannelzChild(a.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(a){let b=a.map(a=>({subchannel:this.channelControlHelper.createSubchannel(a,{}),hasReportedTransientFailure:!1}));for(let{subchannel:a}of b)a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef());for(let{subchannel:a}of(this.resetSubchannelList(),this.children=b,this.children))if(a.addConnectivityStateListener(this.subchannelStateListener),a.getConnectivityState()===e.ConnectivityState.READY)return void this.pickSubchannel(a);for(let a of this.children)a.subchannel.getConnectivityState()===e.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(a,b){b instanceof m&&(b.getShuffleAddressList()&&(a=o(a)),this.latestAddressList=a,this.connectToAddressList(a))}exitIdle(){this.currentState===e.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return k}}b.PickFirstLoadBalancer=p,b.setup=function(){(0,d.registerLoadBalancerType)(k,p,m),(0,d.registerDefaultLoadBalancerType)(k)}},32497:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},32888:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.loadPackageDefinition=b.makeClientConstructor=void 0;let d=c(44719),e={unary:d.Client.prototype.makeUnaryRequest,server_stream:d.Client.prototype.makeServerStreamRequest,client_stream:d.Client.prototype.makeClientStreamRequest,bidi:d.Client.prototype.makeBidiStreamRequest};function f(a){return["__proto__","prototype","constructor"].includes(a)}function g(a,b,c){c||(c={});class g extends d.Client{}return Object.keys(a).forEach(b=>{let c;if(f(b))return;let d=a[b];if("string"==typeof b&&"$"===b.charAt(0))throw Error("Method names cannot start with $");c=d.requestStream?d.responseStream?"bidi":"client_stream":d.responseStream?"server_stream":"unary";let i=d.requestSerialize,j=d.responseDeserialize,k=h(e[c],d.path,i,j);g.prototype[b]=k,Object.assign(g.prototype[b],d),d.originalName&&!f(d.originalName)&&(g.prototype[d.originalName]=g.prototype[b])}),g.service=a,g.serviceName=b,g}function h(a,b,c,d){return function(...e){return a.call(this,b,c,d,...e)}}function i(a){return"format"in a}b.makeClientConstructor=g,b.loadPackageDefinition=function(a){let b={};for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c],e=c.split(".");if(e.some(a=>f(a)))continue;let h=e[e.length-1],j=b;for(let a of e.slice(0,-1))j[a]||(j[a]={}),j=j[a];i(d)?j[h]=d:j[h]=g(d,h,{})}return b}},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},34816:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,60967)),"C:\\Users\\mmmed\\Desktop\\Github\\naughty-den\\src\\app\\page.tsx"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"C:\\Users\\mmmed\\Desktop\\Github\\naughty-den\\src\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["C:\\Users\\mmmed\\Desktop\\Github\\naughty-den\\src\\app\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/page";"/index"===G&&(G="/");let M=!1,N=(0,h.getRequestMeta)(a,"postponed"),O=(0,h.getRequestMeta)(a,"minimalMode"),P=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:M});if(!P)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:Q,query:R,params:S,parsedUrl:T,pageIsDynamic:U,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,serverActionsManifest:Y,clientReferenceManifest:Z,subresourceIntegrityManifest:$,prerenderManifest:_,isDraftMode:aa,resolvedPathname:ab,revalidateOnlyGenerated:ac,routerServerContext:ad,nextConfig:ae,interceptionRoutePatterns:af}=P,ag=T.pathname||"/",ah=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ai}=P,aj=K.match(ag,_),ak=!!_.routes[ab],al=!!(aj||ak||_.routes[ah]),am=a.headers["user-agent"]||"",an=(0,u.getBotType)(am),ao=(0,p.isHtmlBotRequest)(a),ap=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],aq=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],ar=(0,s.getIsPossibleServerAction)(a),as=(0,m.checkIsAppPPREnabled)(ae.experimental.ppr),at=!1,au=!1,av=as&&((null==(C=_.routes[ah]??_.dynamicRoutes[ah])?void 0:C.renderingMode)==="PARTIALLY_STATIC"||at&&(!0===K.isDev||(null==ad?void 0:ad.experimentalTestProxy)===!0)),aw=at&&av,ax=aw&&!0===K.isDev,ay=au&&av,az=av?N:void 0,aA=av&&aq&&!ap,aB=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),aC=!am||(0,p.shouldServeStreamingMetadata)(am,ae.htmlLimitedBots);ao&&av&&(al=!1,aC=!1);let aD=!0===K.isDev||!al||"string"==typeof N||aA,aE=ao&&av,aF=null;aa||!al||aD||ar||az||aA||(aF=ab);let aG=aF;!aG&&K.isDev&&(aG=ab),K.isDev||aa||!al||!aq||aA||(0,k.d)(a.headers);let aH={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};Y&&Z&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Z,serverActionsManifest:Y,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:Y})});let aI=a.method||"GET",aJ=(0,g.getTracer)(),aK=aJ.getActiveScopeSpan();try{let f=K.getVaryHeader(ab,af);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aJ.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aI} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aI} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:R,params:S,page:ah,sharedContext:{buildId:Q},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aH,Component:(0,j.T)(aH),params:S,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:aE,serveStreamingMetadata:aC,supportsDynamicResponse:"string"==typeof f||aD,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,subresourceIntegrityManifest:$,serverActionsManifest:Y,clientReferenceManifest:Z,setIsrStatus:null==ad?void 0:ad.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:aa,isRevalidate:al&&!f&&!aA,botType:an,isOnDemandRevalidate:ai,isPossibleServerAction:ar,assetPrefix:ae.assetPrefix,nextConfigOutput:ae.output,crossOrigin:ae.crossOrigin,trailingSlash:ae.trailingSlash,previewProps:_.preview,deploymentId:ae.deploymentId,enableTainting:ae.experimental.taint,htmlLimitedBots:ae.htmlLimitedBots,devtoolSegmentExplorer:ae.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ae.reactMaxHeadersLength,multiZoneDraftMode:M,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ae.experimental.cacheLife,basePath:ae.basePath,serverActions:ae.experimental.serverActions,...aw||ax?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:ax}:{},experimental:{isRoutePPREnabled:av,expireTime:ae.expireTime,staleTimes:ae.experimental.staleTimes,cacheComponents:!!ae.experimental.cacheComponents,clientSegmentCache:!!ae.experimental.clientSegmentCache,clientParamParsing:!!ae.experimental.clientParamParsing,dynamicOnHover:!!ae.experimental.dynamicOnHover,inlineCss:!!ae.experimental.inlineCss,authInterrupts:!!ae.experimental.authInterrupts,clientTraceMetadata:ae.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ad),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,al&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!av){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${ab}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ai&&ac&&!f&&!O)return(null==ad?void 0:ad.render404)?await ad.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(aj&&(j=(0,w.parseFallbackField)(aj.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(am)&&(!av||ao)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ai=!0),ai&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!O&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aG&&!l&&!aa&&U&&(k||!ak)){let b;if((k||aj)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(av&&!aq){let c="string"==typeof(null==aj?void 0:aj.fallback)?aj.fallback:k?ah:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ae,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:_,isRoutePPREnabled:av,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||ay?(0,n.u)(ah):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ai||g||!az?void 0:az;if((aw||ax)&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=U&&av&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ay)?(0,n.u)(ag):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aF,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ai,isRoutePPREnabled:av,req:a,nextConfig:ae,prerenderManifest:_,waitUntil:d.waitUntil});if(aa&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aF)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;al&&!aA&&(!p||ap)&&(O||b.setHeader("x-nextjs-cache",ai?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(az)l={revalidate:0,expire:void 0};else if(O&&aq&&!ap&&av)l={revalidate:0,expire:void 0};else if(!K.isDev)if(aa)l={revalidate:0,expire:void 0};else if(al){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ae.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aB&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];O&&al&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aB);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&az)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(O&&al||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(O&&al&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||aq&&av||(b.statusCode=q.status),!O&&q.status&&F.RedirectStatusCode[q.status]&&aq&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),aq&&!aa){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:q.html,cacheControl:aA?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||O||aq)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:n.cacheControl});if(aw||ax)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aK)return await aJ.withPropagatedContext(a.headers,()=>aJ.trace(i.BaseServerSpan.handleRequest,{spanName:`${aI} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aI,"http.target":a.url}},p));await p(aK)}catch(b){throw aK||b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:al,isOnDemandRevalidate:ai})},ad),b}}},35370:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OutlierDetectionLoadBalancingConfig=b.BaseSubchannelWrapper=b.registerAdminService=b.FilterStackFactory=b.BaseFilter=b.PickResultType=b.QueuePicker=b.UnavailablePicker=b.ChildLoadBalancerHandler=b.subchannelAddressToString=b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.registerLoadBalancerType=b.createChildChannelControlHelper=b.BackoffTimeout=b.durationToMs=b.uriToString=b.createResolver=b.registerResolver=b.log=b.trace=void 0;var d=c(18031);Object.defineProperty(b,"trace",{enumerable:!0,get:function(){return d.trace}}),Object.defineProperty(b,"log",{enumerable:!0,get:function(){return d.log}});var e=c(9114);Object.defineProperty(b,"registerResolver",{enumerable:!0,get:function(){return e.registerResolver}}),Object.defineProperty(b,"createResolver",{enumerable:!0,get:function(){return e.createResolver}});var f=c(25554);Object.defineProperty(b,"uriToString",{enumerable:!0,get:function(){return f.uriToString}});var g=c(75956);Object.defineProperty(b,"durationToMs",{enumerable:!0,get:function(){return g.durationToMs}});var h=c(12812);Object.defineProperty(b,"BackoffTimeout",{enumerable:!0,get:function(){return h.BackoffTimeout}});var i=c(68367);Object.defineProperty(b,"createChildChannelControlHelper",{enumerable:!0,get:function(){return i.createChildChannelControlHelper}}),Object.defineProperty(b,"registerLoadBalancerType",{enumerable:!0,get:function(){return i.registerLoadBalancerType}}),Object.defineProperty(b,"getFirstUsableConfig",{enumerable:!0,get:function(){return i.getFirstUsableConfig}}),Object.defineProperty(b,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return i.validateLoadBalancingConfig}});var j=c(24204);Object.defineProperty(b,"subchannelAddressToString",{enumerable:!0,get:function(){return j.subchannelAddressToString}});var k=c(69285);Object.defineProperty(b,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return k.ChildLoadBalancerHandler}});var l=c(82142);Object.defineProperty(b,"UnavailablePicker",{enumerable:!0,get:function(){return l.UnavailablePicker}}),Object.defineProperty(b,"QueuePicker",{enumerable:!0,get:function(){return l.QueuePicker}}),Object.defineProperty(b,"PickResultType",{enumerable:!0,get:function(){return l.PickResultType}});var m=c(37842);Object.defineProperty(b,"BaseFilter",{enumerable:!0,get:function(){return m.BaseFilter}});var n=c(82915);Object.defineProperty(b,"FilterStackFactory",{enumerable:!0,get:function(){return n.FilterStackFactory}});var o=c(64149);Object.defineProperty(b,"registerAdminService",{enumerable:!0,get:function(){return o.registerAdminService}});var p=c(10975);Object.defineProperty(b,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return p.BaseSubchannelWrapper}});var q=c(92812);Object.defineProperty(b,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return q.OutlierDetectionLoadBalancingConfig}})},36827:(a,b,c)=>{"use strict";var d=c(64869);a.exports=b=d.descriptor=d.Root.fromJSON(c(97659)).lookup(".google.protobuf");var e=d.Namespace,f=d.Root,g=d.Enum,h=d.Type,i=d.Field,j=d.MapField,k=d.OneOf,l=d.Service,m=d.Method;function n(a,c,d){var j=b.FileDescriptorProto.create({name:a.filename||(a.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});E(d,j),a instanceof f||(j.package=a.fullName.substring(1));for(var k,m=0;m<a.nestedArray.length;++m)(k=a._nestedArray[m])instanceof h?j.messageType.push(k.toDescriptor(d)):k instanceof g?j.enumType.push(k.toDescriptor()):k instanceof i?j.extension.push(k.toDescriptor(d)):k instanceof l?j.service.push(k.toDescriptor()):k instanceof e&&n(k,c,d);j.options=A(a.options,b.FileOptions),j.messageType.length+j.enumType.length+j.extension.length+j.service.length&&c.push(j)}f.fromDescriptor=function(a){"number"==typeof a.length&&(a=b.FileDescriptorSet.decode(a));var c=new f;if(a.file)for(var d,e,j,k=0;k<a.file.length;++k){e=c,(d=a.file[k]).package&&d.package.length&&(e=c.define(d.package));var m=D(d);if(d.name&&d.name.length&&c.files.push(e.filename=d.name),d.messageType)for(j=0;j<d.messageType.length;++j)e.add(h.fromDescriptor(d.messageType[j],m));if(d.enumType)for(j=0;j<d.enumType.length;++j)e.add(g.fromDescriptor(d.enumType[j],m));if(d.extension)for(j=0;j<d.extension.length;++j)e.add(i.fromDescriptor(d.extension[j],m));if(d.service)for(j=0;j<d.service.length;++j)e.add(l.fromDescriptor(d.service[j],m));var n=y(d.options,b.FileOptions);if(n){var o=Object.keys(n);for(j=0;j<o.length;++j)e.setOption(o[j],n[o[j]])}}return c.resolveAll()},f.prototype.toDescriptor=function(a){var c=b.FileDescriptorSet.create();return n(this,c.file,a),c};var o=0;h.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.DescriptorProto.decode(a));var e,f=new h(a.name.length?a.name:"Type"+o++,y(a.options,b.MessageOptions));if(d||(f._edition=c),a.oneofDecl)for(e=0;e<a.oneofDecl.length;++e)f.add(k.fromDescriptor(a.oneofDecl[e]));if(a.field)for(e=0;e<a.field.length;++e){var j=i.fromDescriptor(a.field[e],c,!0);f.add(j),a.field[e].hasOwnProperty("oneofIndex")&&f.oneofsArray[a.field[e].oneofIndex].add(j)}if(a.extension)for(e=0;e<a.extension.length;++e)f.add(i.fromDescriptor(a.extension[e],c,!0));if(a.nestedType)for(e=0;e<a.nestedType.length;++e)f.add(h.fromDescriptor(a.nestedType[e],c,!0)),a.nestedType[e].options&&a.nestedType[e].options.mapEntry&&f.setOption("map_entry",!0);if(a.enumType)for(e=0;e<a.enumType.length;++e)f.add(g.fromDescriptor(a.enumType[e],c,!0));if(a.extensionRange&&a.extensionRange.length)for(e=0,f.extensions=[];e<a.extensionRange.length;++e)f.extensions.push([a.extensionRange[e].start,a.extensionRange[e].end]);if(a.reservedRange&&a.reservedRange.length||a.reservedName&&a.reservedName.length){if(f.reserved=[],a.reservedRange)for(e=0;e<a.reservedRange.length;++e)f.reserved.push([a.reservedRange[e].start,a.reservedRange[e].end]);if(a.reservedName)for(e=0;e<a.reservedName.length;++e)f.reserved.push(a.reservedName[e])}return f},h.prototype.toDescriptor=function(a){var c,d,e=b.DescriptorProto.create({name:this.name});for(d=0;d<this.fieldsArray.length;++d)if(e.field.push(c=this._fieldsArray[d].toDescriptor(a)),this._fieldsArray[d]instanceof j){var f=w(this._fieldsArray[d].keyType,this._fieldsArray[d].resolvedKeyType,!1),k=w(this._fieldsArray[d].type,this._fieldsArray[d].resolvedType,!1),l=11===k||14===k?this._fieldsArray[d].resolvedType&&B(this.parent,this._fieldsArray[d].resolvedType)||this._fieldsArray[d].type:void 0;e.nestedType.push(b.DescriptorProto.create({name:c.typeName,field:[b.FieldDescriptorProto.create({name:"key",number:1,label:1,type:f}),b.FieldDescriptorProto.create({name:"value",number:2,label:1,type:k,typeName:l})],options:b.MessageOptions.create({mapEntry:!0})}))}for(d=0;d<this.oneofsArray.length;++d)e.oneofDecl.push(this._oneofsArray[d].toDescriptor());for(d=0;d<this.nestedArray.length;++d)this._nestedArray[d]instanceof i?e.field.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof h?e.nestedType.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof g&&e.enumType.push(this._nestedArray[d].toDescriptor());if(this.extensions)for(d=0;d<this.extensions.length;++d)e.extensionRange.push(b.DescriptorProto.ExtensionRange.create({start:this.extensions[d][0],end:this.extensions[d][1]}));if(this.reserved)for(d=0;d<this.reserved.length;++d)"string"==typeof this.reserved[d]?e.reservedName.push(this.reserved[d]):e.reservedRange.push(b.DescriptorProto.ReservedRange.create({start:this.reserved[d][0],end:this.reserved[d][1]}));return e.options=A(this.options,b.MessageOptions),e};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;i.fromDescriptor=function(a,c,d){if("number"==typeof a.length&&(a=b.DescriptorProto.decode(a)),"number"!=typeof a.number)throw Error("missing field id");switch(e=a.typeName&&a.typeName.length?a.typeName:u(a.type),a.label){case 1:f=void 0;break;case 2:f="required";break;case 3:f="repeated";break;default:throw Error("illegal label: "+a.label)}var e,f,g=a.extendee;void 0!==a.extendee&&(g=g.length?g:void 0);var h=new i(a.name.length?a.name:"field"+a.number,a.number,e,f,g);if(d||(h._edition=c),h.options=y(a.options,b.FieldOptions),a.proto3_optional&&(h.options.proto3_optional=!0),a.defaultValue&&a.defaultValue.length){var j=a.defaultValue;switch(j){case"true":case"TRUE":j=!0;break;case"false":case"FALSE":j=!1;break;default:p.exec(j)&&(j=parseInt(j))}h.setOption("default",j)}return v(a.type)&&("proto3"===c?a.options&&!a.options.packed&&h.setOption("packed",!1):(!c||"proto2"===c)&&a.options&&a.options.packed&&h.setOption("packed",!0)),h},i.prototype.toDescriptor=function(a){var c=b.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)c.type=11,c.typeName=d.util.ucFirst(this.name),c.label=3;else{switch(c.type=w(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:c.typeName=this.resolvedType?B(this.parent,this.resolvedType):this.type}"repeated"===this.rule?c.label=3:this.required&&"proto2"===a?c.label=2:c.label=1}if(c.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(c.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(c.options=A(this.options,b.FieldOptions),null!=this.options.default&&(c.defaultValue=String(this.options.default)),this.options.proto3_optional&&(c.proto3_optional=!0)),"proto3"===a?this.packed||((c.options||(c.options=b.FieldOptions.create())).packed=!1):(!a||"proto2"===a)&&this.packed&&((c.options||(c.options=b.FieldOptions.create())).packed=!0),c};var q=0;g.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.EnumDescriptorProto.decode(a));var e={};if(a.value)for(var f=0;f<a.value.length;++f){var h=a.value[f].name,i=a.value[f].number||0;e[h&&h.length?h:"NAME"+i]=i}var j=new g(a.name&&a.name.length?a.name:"Enum"+q++,e,y(a.options,b.EnumOptions));return d||(j._edition=c),j},g.prototype.toDescriptor=function(){for(var a=[],c=0,d=Object.keys(this.values);c<d.length;++c)a.push(b.EnumValueDescriptorProto.create({name:d[c],number:this.values[d[c]]}));return b.EnumDescriptorProto.create({name:this.name,value:a,options:A(this.options,b.EnumOptions)})};var r=0;k.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.OneofDescriptorProto.decode(a)),new k(a.name&&a.name.length?a.name:"oneof"+r++)},k.prototype.toDescriptor=function(){return b.OneofDescriptorProto.create({name:this.name})};var s=0;l.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.ServiceDescriptorProto.decode(a));var e=new l(a.name&&a.name.length?a.name:"Service"+s++,y(a.options,b.ServiceOptions));if(d||(e._edition=c),a.method)for(var f=0;f<a.method.length;++f)e.add(m.fromDescriptor(a.method[f]));return e},l.prototype.toDescriptor=function(){for(var a=[],c=0;c<this.methodsArray.length;++c)a.push(this._methodsArray[c].toDescriptor());return b.ServiceDescriptorProto.create({name:this.name,method:a,options:A(this.options,b.ServiceOptions)})};var t=0;function u(a){switch(a){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+a)}function v(a){switch(a){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function w(a,b,c){switch(a){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(b instanceof g)return 14;if(b instanceof h)return c?10:11;throw Error("illegal type: "+a)}function x(a,b){for(var c,d,e={},f=0;f<b.fieldsArray.length;++f)if("uninterpretedOption"!==(d=(c=b._fieldsArray[f]).name)&&Object.prototype.hasOwnProperty.call(a,d)){var i=C(d);c.resolvedType instanceof h?e[i]=x(a[d],c.resolvedType):c.resolvedType instanceof g?e[i]=c.resolvedType.valuesById[a[d]]:e[i]=a[d]}return e}function y(a,b){if(a)return x(b.toObject(a),b)}function z(a,b){for(var c={},e=Object.keys(a),f=0;f<e.length;++f){var g=e[f],i=d.util.camelCase(g);if(Object.prototype.hasOwnProperty.call(b.fields,i)){var j=b.fields[i];j.resolvedType instanceof h?c[i]=z(a[g],j.resolvedType):c[i]=a[g],j.repeated&&!Array.isArray(c[i])&&(c[i]=[c[i]])}}return c}function A(a,b){if(a)return b.fromObject(z(a,b))}function B(a,b){var c=a.fullName.split("."),d=b.fullName.split("."),g=0,h=0,i=d.length-1;if(!(a instanceof f)&&b instanceof e)for(;g<c.length&&h<i&&c[g]===d[h];){var j=b.lookup(c[g++],!0);if(null!==j&&j!==b)break;++h}else for(;g<c.length&&h<i&&c[g]===d[h];++g,++h);return d.slice(h).join(".")}function C(a){return a.substring(0,1)+a.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(a,b){return"_"+b.toLowerCase()})}function D(a){if("editions"===a.syntax)if(a.edition===b.Edition.EDITION_2023)return"2023";else throw Error("Unsupported edition "+a.edition);return"proto3"===a.syntax?"proto3":"proto2"}function E(a,c){if(a)if("proto2"===a||"proto3"===a)c.syntax=a;else if(c.syntax="editions","2023"===a)c.edition=b.Edition.EDITION_2023;else throw Error("Unsupported edition "+a)}m.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.MethodDescriptorProto.decode(a)),new m(a.name&&a.name.length?a.name:"Method"+t++,"rpc",a.inputType,a.outputType,!!a.clientStreaming,!!a.serverStreaming,y(a.options,b.MethodOptions))},m.prototype.toDescriptor=function(){return b.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:A(this.options,b.MethodOptions)})}},37842:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseFilter=void 0;class c{async sendMetadata(a){return a}receiveMetadata(a){return a}async sendMessage(a){return a}async receiveMessage(a){return a}receiveTrailers(a){return a}}b.BaseFilter=c},38939:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getDefaultRootsData=b.CIPHER_SUITES=void 0;let d=c(29021);b.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let e=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,f=null;b.getDefaultRootsData=function(){return e?(null===f&&(f=d.readFileSync(e)),f):null}},39127:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InternalChannel=void 0;let d=c(55382),e=c(81213),f=c(73212),g=c(82142),h=c(50615),i=c(82915),j=c(99967),k=c(9114),l=c(18031),m=c(57311),n=c(25554),o=c(96699),p=c(10811),q=c(80167),r=c(62556),s=c(9122),t=c(8380),u=c(29383),v=c(12715),w=c(10975),x=0x7fffffff,y=1e3,z=18e5,A=new Map,B=0x1000000,C=1048576;class D extends w.BaseSubchannelWrapper{constructor(a,b){super(a),this.channel=b,this.refCount=0,this.subchannelStateListener=(a,c,d,e)=>{b.throttleKeepalive(e)},a.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class E{constructor(a,b,c){var q,r,s,t,w,E,F,G;if(this.credentials=b,this.options=c,this.connectivityState=o.ConnectivityState.IDLE,this.currentPicker=new g.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new p.ChannelzCallTracker,this.childrenTracker=new p.ChannelzChildrenTracker,"string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.originalTarget=a;let H=(0,n.parseUri)(a);if(null===H)throw Error(`Could not parse target name "${a}"`);let I=(0,k.mapUriDefaultScheme)(H);if(null===I)throw Error(`Could not find a default scheme for target name "${a}"`);this.callRefTimer=setInterval(()=>{},x),null==(r=(q=this.callRefTimer).unref)||r.call(q),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new p.ChannelzTrace,this.channelzRef=(0,p.registerChannelzChannel)(a,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,k.getDefaultAuthority)(I);let J=(0,m.mapProxyName)(I,c);this.target=J.target,this.options=Object.assign({},this.options,J.extraOptions),this.subchannelPool=(0,f.getSubchannelPool)((null!=(s=c["grpc.use_local_subchannel_pool"])?s:0)===0),this.retryBufferTracker=new v.MessageBufferTracker(null!=(t=c["grpc.retry_buffer_size"])?t:B,null!=(w=c["grpc.per_rpc_retry_buffer_size"])?w:C),this.keepaliveTime=null!=(E=c["grpc.keepalive_time_ms"])?E:-1,this.idleTimeoutMs=Math.max(null!=(F=c["grpc.client_idle_timeout_ms"])?F:z,y);let K={createSubchannel:(a,b)=>{let c=this.subchannelPool.getOrCreateSubchannel(this.target,a,Object.assign({},this.options,b),this.credentials);c.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",c.getChannelzRef());let d=new D(c,this);return this.wrappedSubchannels.add(d),d},updateState:(a,b)=>{this.currentPicker=b;let c=this.pickQueue.slice();for(let a of(this.pickQueue=[],c.length>0&&this.callRefTimerUnref(),c))a.doPick();this.updateState(a)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.refChild(a)},removeChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.unrefChild(a)}};this.resolvingLoadBalancer=new e.ResolvingLoadBalancer(this.target,K,c,(a,b)=>{a.retryThrottling?A.set(this.getTarget(),new v.RetryThrottler(a.retryThrottling.maxTokens,a.retryThrottling.tokenRatio,A.get(this.getTarget()))):A.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=b,this.currentResolutionError=null,process.nextTick(()=>{let a=this.configSelectionQueue;for(let b of(this.configSelectionQueue=[],a.length>0&&this.callRefTimerUnref(),a))b.getConfig()})},a=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+a.code+' and details "'+a.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,u.restrictControlPlaneStatusCode)(a.code,a.details)),{metadata:a.metadata}));let b=this.configSelectionQueue;for(let c of(this.configSelectionQueue=[],b.length>0&&this.callRefTimerUnref(),b))c.reportResolverError(a)}),this.filterStackFactory=new i.FilterStackFactory([new j.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(c,void 0,2));let L=Error();(0,l.trace)(h.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null==(G=L.stack)?void 0:G.substring(L.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(a,b){(0,l.trace)(null!=b?b:h.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+a)}callRefTimerRef(){var a,b,c,d;(null==(b=(a=this.callRefTimer).hasRef)?void 0:b.call(a))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(d=(c=this.callRefTimer).ref)||d.call(c))}callRefTimerUnref(){var a,b;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(b=(a=this.callRefTimer).unref)||b.call(a))}removeConnectivityStateWatcher(a){let b=this.connectivityStateWatchers.findIndex(b=>b===a);b>=0&&this.connectivityStateWatchers.splice(b,1)}updateState(a){for(let b of((0,l.trace)(h.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+o.ConnectivityState[this.connectivityState]+" -> "+o.ConnectivityState[a]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+o.ConnectivityState[a]),this.connectivityState=a,this.connectivityStateWatchers.slice()))a!==b.currentState&&(b.timer&&clearTimeout(b.timer),this.removeConnectivityStateWatcher(b),b.callback());a!==o.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(a){if(a>this.keepaliveTime)for(let b of(this.keepaliveTime=a,this.wrappedSubchannels))b.throttleKeepalive(a)}removeWrappedSubchannel(a){this.wrappedSubchannels.delete(a)}doPick(a,b){return this.currentPicker.pick({metadata:a,extraPickInfo:b})}queueCallForPick(a){this.pickQueue.push(a),this.callRefTimerRef()}getConfig(a,b){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(a,b)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(a){this.configSelectionQueue.push(a),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.IDLE),this.currentPicker=new g.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(a){var b,c;this.idleTimer=setTimeout(()=>{if(this.callCount>0)return void this.startIdleTimeout(this.idleTimeoutMs);let a=new Date().valueOf()-this.lastActivityTimestamp.valueOf();a>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-a)},a),null==(c=(b=this.idleTimer).unref)||c.call(b)}maybeStartIdleTimer(){this.connectivityState===o.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(a){this.channelzEnabled&&(a.code===h.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+f+'] method="'+b+'"'),new q.LoadBalancingCall(this,a,b,c,d,e,f)}createRetryingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createRetryingCall ["+f+'] method="'+b+'"'),new v.RetryingCall(this,a,b,c,d,e,f,this.retryBufferTracker,A.get(this.getTarget()))}createInnerCall(a,b,c,d,e){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(a,b,c,d,e):this.createRetryingCall(a,b,c,d,e)}createResolvingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();this.trace("createResolvingCall ["+f+'] method="'+a+'", deadline='+(0,r.deadlineToString)(b));let g={deadline:b,flags:null!=e?e:h.Propagate.DEFAULTS,host:null!=c?c:this.defaultAuthority,parentCall:d},i=new s.ResolvingCall(this,a,g,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),f);return this.onCallStart(),i.addStatusWatcher(a=>{this.onCallEnd(a)}),i}close(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,p.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,n.uriToString)(this.target)}getConnectivityState(a){let b=this.connectivityState;return a&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),b}watchConnectivityState(a,b,c){if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let d=null;if(b!==1/0){let a=b instanceof Date?b:new Date(b),f=new Date;if(b===-1/0||a<=f)return void process.nextTick(c,Error("Deadline passed without connectivity state change"));d=setTimeout(()=>{this.removeConnectivityStateWatcher(e),c(Error("Deadline passed without connectivity state change"))},a.getTime()-f.getTime())}let e={currentState:a,callback:c,timer:d};this.connectivityStateWatchers.push(e)}getChannelzRef(){return this.channelzRef}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(a,b,c,d,e)}}b.InternalChannel=E},39929:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(9114);class e{constructor(a,b,c){let d;this.listener=b,this.addresses=[],this.hasReturnedResult=!1,d=""===a.authority?"/"+a.path:a.path,this.addresses=[{path:d}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(a){return"localhost"}}b.setup=function(){(0,d.registerResolver)("unix",e)}},40106:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"Image",{enumerable:!0,get:function(){return u}});let d=c(35288),e=c(55823),f=c(21124),g=e._(c(38301)),h=d._(c(23312)),i=d._(c(63725)),j=c(63974),k=c(3001),l=c(456);c(21507);let m=c(18355),n=d._(c(49656)),o=c(49427),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function q(a,b,c,d,e,f,g){let h=null==a?void 0:a.src;a&&a["data-loaded-src"]!==h&&(a["data-loaded-src"]=h,("decode"in a?a.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(a.parentElement&&a.isConnected){if("empty"!==b&&e(!0),null==c?void 0:c.current){let b=new Event("load");Object.defineProperty(b,"target",{writable:!1,value:a});let d=!1,e=!1;c.current({...b,nativeEvent:b,currentTarget:a,target:a,isDefaultPrevented:()=>d,isPropagationStopped:()=>e,persist:()=>{},preventDefault:()=>{d=!0,b.preventDefault()},stopPropagation:()=>{e=!0,b.stopPropagation()}})}(null==d?void 0:d.current)&&d.current(a)}}))}function r(a){return g.use?{fetchPriority:a}:{fetchpriority:a}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let s=(0,g.forwardRef)((a,b)=>{let{src:c,srcSet:d,sizes:e,height:h,width:i,decoding:j,className:k,style:l,fetchPriority:m,placeholder:n,loading:p,unoptimized:s,fill:t,onLoadRef:u,onLoadingCompleteRef:v,setBlurComplete:w,setShowAltText:x,sizesInput:y,onLoad:z,onError:A,...B}=a,C=(0,g.useCallback)(a=>{a&&(A&&(a.src=a.src),a.complete&&q(a,n,u,v,w,s,y))},[c,n,u,v,w,A,s,y]),D=(0,o.useMergedRef)(b,C);return(0,f.jsx)("img",{...B,...r(m),loading:p,width:i,height:h,decoding:j,"data-nimg":t?"fill":"1",className:k,style:l,sizes:e,srcSet:d,src:c,ref:D,onLoad:a=>{q(a.currentTarget,n,u,v,w,s,y)},onError:a=>{x(!0),"empty"!==n&&w(!0),A&&A(a)}})});function t(a){let{isAppRouter:b,imgAttributes:c}=a,d={as:"image",imageSrcSet:c.srcSet,imageSizes:c.sizes,crossOrigin:c.crossOrigin,referrerPolicy:c.referrerPolicy,...r(c.fetchPriority)};return b&&h.default.preload?(h.default.preload(c.src,d),null):(0,f.jsx)(i.default,{children:(0,f.jsx)("link",{rel:"preload",href:c.srcSet?void 0:c.src,...d},"__nimg-"+c.src+c.srcSet+c.sizes)})}let u=(0,g.forwardRef)((a,b)=>{let c=!(0,g.useContext)(m.RouterContext),d=(0,g.useContext)(l.ImageConfigContext),e=(0,g.useMemo)(()=>{var a;let b=p||d||k.imageConfigDefault,c=[...b.deviceSizes,...b.imageSizes].sort((a,b)=>a-b),e=b.deviceSizes.sort((a,b)=>a-b),f=null==(a=b.qualities)?void 0:a.sort((a,b)=>a-b);return{...b,allSizes:c,deviceSizes:e,qualities:f}},[d]),{onLoad:h,onLoadingComplete:i}=a,o=(0,g.useRef)(h);(0,g.useEffect)(()=>{o.current=h},[h]);let q=(0,g.useRef)(i);(0,g.useEffect)(()=>{q.current=i},[i]);let[r,u]=(0,g.useState)(!1),[v,w]=(0,g.useState)(!1),{props:x,meta:y}=(0,j.getImgProps)(a,{defaultLoader:n.default,imgConf:e,blurComplete:r,showAltText:v});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s,{...x,unoptimized:y.unoptimized,placeholder:y.placeholder,fill:y.fill,onLoadRef:o,onLoadingCompleteRef:q,setBlurComplete:u,setShowAltText:w,sizesInput:a.sizes,ref:b}),y.priority?(0,f.jsx)(t,{isAppRouter:c,imgAttributes:x}):null]})});("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},40543:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");d.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=!!b,this.responseDelimited=!!c}(e.prototype=Object.create(d.EventEmitter.prototype)).constructor=e,e.prototype.rpcCall=function a(b,c,e,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return d.asPromise(a,h,b,c,e,f);if(!h.rpcImpl)return void setTimeout(function(){g(Error("already ended"))},0);try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c)return void h.end(!0);if(!(c instanceof e))try{c=e[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(a){return h.emit("error",a,b),g(a)}return h.emit("data",c,b),g(null,c)})}catch(a){h.emit("error",a,b),setTimeout(function(){g(a)},0);return}},e.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},44333:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.StreamDecoder=void 0,function(a){a[a.NO_DATA=0]="NO_DATA",a[a.READING_SIZE=1]="READING_SIZE",a[a.READING_MESSAGE=2]="READING_MESSAGE"}(c||(c={}));class d{constructor(a){this.maxReadMessageLength=a,this.readState=c.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(a){let b,d=0,e=[];for(;d<a.length;)switch(this.readState){case c.NO_DATA:this.readCompressFlag=a.slice(d,d+1),d+=1,this.readState=c.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case c.READING_SIZE:if(b=Math.min(a.length-d,this.readSizeRemaining),a.copy(this.readPartialSize,4-this.readSizeRemaining,d,d+b),this.readSizeRemaining-=b,d+=b,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=c.READING_MESSAGE;else{let a=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=c.NO_DATA,e.push(a)}}break;case c.READING_MESSAGE:if(b=Math.min(a.length-d,this.readMessageRemaining),this.readPartialMessage.push(a.slice(d,d+b)),this.readMessageRemaining-=b,d+=b,0===this.readMessageRemaining){let a=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),b=Buffer.concat(a,this.readMessageSize+5);this.readState=c.NO_DATA,e.push(b)}break;default:throw Error("Unexpected read state")}return e}}b.StreamDecoder=d},44719:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Client=void 0;let d=c(14456),e=c(95749),f=c(96699),g=c(50615),h=c(64105),i=c(77232),j=Symbol(),k=Symbol(),l=Symbol(),m=Symbol();function n(a){return"function"==typeof a}function o(a){return a.stack.split("\n").slice(1).join("\n")}class p{constructor(a,b,c={}){var d,f;if(c=Object.assign({},c),this[k]=null!=(d=c.interceptors)?d:[],delete c.interceptors,this[l]=null!=(f=c.interceptor_providers)?f:[],delete c.interceptor_providers,this[k].length>0&&this[l].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[m]=c.callInvocationTransformer,delete c.callInvocationTransformer,c.channelOverride)this[j]=c.channelOverride;else if(c.channelFactoryOverride){let d=c.channelFactoryOverride;delete c.channelFactoryOverride,this[j]=d(a,b,c)}else this[j]=new e.ChannelImplementation(a,b,c)}close(){this[j].close()}getChannel(){return this[j]}waitForReady(a,b){let c=d=>{let e;if(d)return void b(Error("Failed to connect before the deadline"));try{e=this[j].getConnectivityState(!0)}catch(a){b(Error("The channel has been closed"));return}if(e===f.ConnectivityState.READY)b();else try{this[j].watchConnectivityState(e,a,c)}catch(a){b(Error("The channel has been closed"))}};setImmediate(c)}checkOptionalUnaryResponseArguments(a,b,c){if(n(a))return{metadata:new h.Metadata,options:{},callback:a};if(n(b))if(a instanceof h.Metadata)return{metadata:a,options:{},callback:b};else return{metadata:new h.Metadata,options:a,callback:b};if(!(a instanceof h.Metadata&&b instanceof Object&&n(c)))throw Error("Incorrect arguments passed");return{metadata:a,options:b,callback:c}}makeUnaryRequest(a,b,c,e,f,h,n){var p,q;let r=this.checkOptionalUnaryResponseArguments(f,h,n),s={path:a,requestStream:!1,responseStream:!1,requestSerialize:b,responseDeserialize:c},t={argument:e,metadata:r.metadata,call:new d.ClientUnaryCallImpl,channel:this[j],methodDefinition:s,callOptions:r.options,callback:r.callback};this[m]&&(t=this[m](t));let u=t.call,v={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(p=t.callOptions.interceptors)?p:[],callInterceptorProviders:null!=(q=t.callOptions.interceptor_providers)?q:[]},w=(0,i.getInterceptingCall)(v,t.methodDefinition,t.callOptions,t.channel);u.call=w;let x=null,y=!1,z=Error();return w.start(t.metadata,{onReceiveMetadata:a=>{u.emit("metadata",a)},onReceiveMessage(a){null!==x&&w.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),x=a},onReceiveStatus(a){if(!y){if(y=!0,a.code===g.Status.OK)if(null===x){let b=o(z);t.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else t.callback(null,x);else{let b=o(z);t.callback((0,d.callErrorFromStatus)(a,b))}z=null,u.emit("status",a)}}}),w.sendMessage(e),w.halfClose(),u}makeClientStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkOptionalUnaryResponseArguments(e,f,h),r={path:a,requestStream:!0,responseStream:!1,requestSerialize:b,responseDeserialize:c},s={metadata:q.metadata,call:new d.ClientWritableStreamImpl(b),channel:this[j],methodDefinition:r,callOptions:q.options,callback:q.callback};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=null,x=!1,y=Error();return v.start(s.metadata,{onReceiveMetadata:a=>{t.emit("metadata",a)},onReceiveMessage(a){null!==w&&v.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),w=a},onReceiveStatus(a){if(!x){if(x=!0,a.code===g.Status.OK)if(null===w){let b=o(y);s.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else s.callback(null,w);else{let b=o(y);s.callback((0,d.callErrorFromStatus)(a,b))}y=null,t.emit("status",a)}}}),t}checkMetadataAndOptions(a,b){let c,d;return a instanceof h.Metadata?(c=a,d=b||{}):(d=a||{},c=new h.Metadata),{metadata:c,options:d}}makeServerStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkMetadataAndOptions(f,h),r={path:a,requestStream:!1,responseStream:!0,requestSerialize:b,responseDeserialize:c},s={argument:e,metadata:q.metadata,call:new d.ClientReadableStreamImpl(c),channel:this[j],methodDefinition:r,callOptions:q.options};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=!1,x=Error();return v.start(s.metadata,{onReceiveMetadata(a){t.emit("metadata",a)},onReceiveMessage(a){t.push(a)},onReceiveStatus(a){if(!w){if(w=!0,t.push(null),a.code!==g.Status.OK){let b=o(x);t.emit("error",(0,d.callErrorFromStatus)(a,b))}x=null,t.emit("status",a)}}}),v.sendMessage(e),v.halfClose(),t}makeBidiStreamRequest(a,b,c,e,f){var h,n;let p=this.checkMetadataAndOptions(e,f),q={path:a,requestStream:!0,responseStream:!0,requestSerialize:b,responseDeserialize:c},r={metadata:p.metadata,call:new d.ClientDuplexStreamImpl(b,c),channel:this[j],methodDefinition:q,callOptions:p.options};this[m]&&(r=this[m](r));let s=r.call,t={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(h=r.callOptions.interceptors)?h:[],callInterceptorProviders:null!=(n=r.callOptions.interceptor_providers)?n:[]},u=(0,i.getInterceptingCall)(t,r.methodDefinition,r.callOptions,r.channel);s.call=u;let v=!1,w=Error();return u.start(r.metadata,{onReceiveMetadata(a){s.emit("metadata",a)},onReceiveMessage(a){s.push(a)},onReceiveStatus(a){if(!v){if(v=!0,s.push(null),a.code!==g.Status.OK){let b=o(w);s.emit("error",(0,d.callErrorFromStatus)(a,b))}w=null,s.emit("status",a)}}}),s}}b.Client=p},46265:(a,b,c)=>{Promise.resolve().then(c.bind(c,76780))},47372:(a,b,c)=>{"use strict";var d,e;d={value:!0},d=d=b.rS=b.Yi=d=b.Ib=d=d=void 0;let f=c(16452),g=c(64869),h=c(36827),i=c(55274);d=c(66666),d=function(a){return"@type"in a&&"string"==typeof a["@type"]},function(a){a.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",a.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",a.IDEMPOTENT="IDEMPOTENT"}(e=b.Ib||(b.Ib={}));let j={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function k(a,b){return""===a?b:a+"."+b}function l(a){return a instanceof g.Service||a instanceof g.Type||a instanceof g.Enum}function m(a){return a instanceof g.Namespace||a instanceof g.Root}function n(a,b){let c=k(b,a.name);return l(a)?[[c,a]]:m(a)&&void 0!==a.nested?Object.keys(a.nested).map(b=>n(a.nested[b],c)).reduce((a,b)=>a.concat(b),[]):[]}function o(a,b){return function(c){return a.toObject(a.decode(c),b)}}function p(a){return function(b){if(Array.isArray(b))throw Error(`Failed to serialize message: expected object with ${a.name} structure, got array instead`);let c=a.fromObject(b);return a.encode(c).finish()}}function q(a){return(a||[]).reduce((a,b)=>{for(let[c,d]of Object.entries(b))"uninterpreted_option"===c?a.uninterpreted_option.push(b.uninterpreted_option):a[c]=d;return a},{deprecated:!1,idempotency_level:e.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function r(a,b,c,d){let e=a.resolvedRequestType,g=a.resolvedResponseType;return{path:"/"+b+"/"+a.name,requestStream:!!a.requestStream,responseStream:!!a.responseStream,requestSerialize:p(e),requestDeserialize:o(e,c),responseSerialize:p(g),responseDeserialize:o(g,c),originalName:f(a.name),requestType:t(e,d),responseType:t(g,d),options:q(a.parsedOptions)}}function s(a,b,c,d){let e={};for(let f of a.methodsArray)e[f.name]=r(f,b,c,d);return e}function t(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function u(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function v(a,b,c,d){if(a instanceof g.Service)return s(a,b,c,d);if(a instanceof g.Type)return t(a,d);if(a instanceof g.Enum)return u(a,d);throw Error("Type mismatch in reflection object handling")}function w(a,b){let c={};a.resolveAll();let d=a.toDescriptor("proto3").file.map(a=>Buffer.from(h.FileDescriptorProto.encode(a).finish()));for(let[e,f]of n(a,""))c[e]=v(f,e,b,d);return c}function x(a,b){b=b||{};let c=g.Root.fromDescriptor(a);return c.resolveAll(),w(c,b)}d=function(a,b){return(0,i.loadProtosWithOptions)(a,b).then(a=>w(a,b))},b.Yi=function(a,b){return w((0,i.loadProtosWithOptionsSync)(a,b),b)},b.rS=function(a,b){b=b||{};let c=g.Root.fromJSON(a);return c.resolveAll(),w(c,b)},d=function(a,b){return x(h.FileDescriptorSet.decode(a),b)},d=function(a,b){return x(h.FileDescriptorSet.fromObject(a),b)},(0,i.addCommonProtos)()},49316:(a,b,c)=>{"use strict";a.exports=g;var d=c(99408);((g.prototype=Object.create(d.prototype)).constructor=g).className="MapField";var e=c(18657),f=c(90290);function g(a,b,c,e,g,h){if(d.call(this,a,b,e,void 0,void 0,g,h),!f.isString(c))throw TypeError("keyType must be a string");this.keyType=c,this.resolvedKeyType=null,this.map=!0}g.fromJSON=function(a,b){return new g(a,b.id,b.keyType,b.type,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},g.prototype.resolve=function(){if(this.resolved)return this;if(void 0===e.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return d.prototype.resolve.call(this)},g.d=function(a,b,c){return"function"==typeof c?c=f.decorateType(c).name:c&&"object"==typeof c&&(c=f.decorateEnum(c).name),function(d,e){f.decorateType(d.constructor).add(new g(e,a,b,c))}}},49427:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=c(38301);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},49656:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return e}});let c=75;function d(a){var b;let{config:d,src:e,width:f,quality:g}=a,h=g||(null==(b=d.qualities)?void 0:b.reduce((a,b)=>Math.abs(b-c)<Math.abs(a-c)?b:a))||c;return d.path+"?url="+encodeURIComponent(e)+"&w="+f+"&q="+h+(e.startsWith("/_next/static/media/"),"")}d.__next_img_default=!0;let e=d},50364:(a,b,c)=>{Promise.resolve().then(c.bind(c,97643))},50615:(a,b)=>{"use strict";var c,d,e;Object.defineProperty(b,"__esModule",{value:!0}),b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=b.Propagate=b.LogVerbosity=b.Status=void 0,function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(c||(b.Status=c={})),function(a){a[a.DEBUG=0]="DEBUG",a[a.INFO=1]="INFO",a[a.ERROR=2]="ERROR",a[a.NONE=3]="NONE"}(d||(b.LogVerbosity=d={})),function(a){a[a.DEADLINE=1]="DEADLINE",a[a.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",a[a.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",a[a.CANCELLATION=8]="CANCELLATION",a[a.DEFAULTS=65535]="DEFAULTS"}(e||(b.Propagate=e={})),b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g,metadata:()=>f});var d=c(75338);c(61135);var e=c(76780);let f={title:"Naughty Den",description:"A global community for creators and photo seekers.",icons:{icon:"/favicon.png"},manifest:"/manifest.webmanifest",themeColor:"#0a0a0a"};function g({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsxs)("body",{suppressHydrationWarning:!0,children:[(0,d.jsx)(e.default,{}),(0,d.jsx)("script",{dangerouslySetInnerHTML:{__html:`
          (function(){
            if (typeof window !== 'undefined' && 'serviceWorker' in navigator) {
              window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').catch(function(){});
              });
            }
          })();
        `}}),a]})})}},54900:(a,b,c)=>{"use strict";var d=a.exports=c(75005);d.build="full",d.tokenize=c(76043),d.parse=c(9259),d.common=c(72451),d.Root._configure(d.Type,d.parse,d.common)},55274:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addCommonProtos=b.loadProtosWithOptionsSync=b.loadProtosWithOptions=void 0;let d=c(29021),e=c(33873),f=c(64869);function g(a,b){let c=a.resolvePath;a.resolvePath=(a,f)=>{if(e.isAbsolute(f))return f;for(let a of b){let b=e.join(a,f);try{return d.accessSync(b,d.constants.R_OK),b}catch(a){continue}}return process.emitWarning(`${f} not found in any of the include paths ${b}`),c(a,f)}}b.loadProtosWithOptions=async function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));g(c,b.includeDirs)}let d=await c.load(a,b);return d.resolveAll(),d},b.loadProtosWithOptionsSync=function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))throw Error("The includeDirs option must be an array");g(c,b.includeDirs)}let d=c.loadSync(a,b);return d.resolveAll(),d},b.addCommonProtos=function(){let a=c(82566),b=c(97659),d=c(56271),e=c(96138);f.common("api",a.nested.google.nested.protobuf.nested),f.common("descriptor",b.nested.google.nested.protobuf.nested),f.common("source_context",d.nested.google.nested.protobuf.nested),f.common("type",e.nested.google.nested.protobuf.nested)}},55382:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelCredentials=void 0;let d=c(34631),e=c(98079),f=c(38939);function g(a,b){if(a&&!(a instanceof Buffer))throw TypeError(`${b}, if provided, must be a Buffer.`)}class h{constructor(a){this.callCredentials=a||e.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(a,b,c,e){var h;if(g(a,"Root certificate"),g(b,"Private key"),g(c,"Certificate chain"),b&&!c)throw Error("Private key must be given with accompanying certificate chain");if(!b&&c)throw Error("Certificate chain must be given with accompanying private key");return new j((0,d.createSecureContext)({ca:null!=(h=null!=a?a:(0,f.getDefaultRootsData)())?h:void 0,key:null!=b?b:void 0,cert:null!=c?c:void 0,ciphers:f.CIPHER_SUITES}),null!=e?e:{})}static createFromSecureContext(a,b){return new j(a,null!=b?b:{})}static createInsecure(){return new i}}b.ChannelCredentials=h;class i extends h{constructor(a){super(a)}compose(a){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(a){return a instanceof i}}class j extends h{constructor(a,b){super(),this.secureContext=a,this.verifyOptions=b,this.connectionOptions={secureContext:a},(null==b?void 0:b.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=b.checkServerIdentity)}compose(a){return new k(this,this.callCredentials.compose(a))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(a){return this===a||a instanceof j&&this.secureContext===a.secureContext&&this.verifyOptions.checkServerIdentity===a.verifyOptions.checkServerIdentity}}class k extends h{constructor(a,b){super(b),this.channelCredentials=a}compose(a){let b=this.callCredentials.compose(a);return new k(this.channelCredentials,b)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(a){return this===a||a instanceof k&&this.channelCredentials._equals(a.channelCredentials)&&this.callCredentials._equals(a.callCredentials)}}},55588:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.DEFAULT_PORT=void 0;let d=c(9114),e=c(14985),f=c(28354),g=c(10584),h=c(50615),i=c(64105),j=c(18031),k=c(50615),l=c(25554),m=c(91645),n=c(12812),o="dns_resolver";function p(a){j.trace(k.LogVerbosity.DEBUG,o,a)}b.DEFAULT_PORT=443;let q=3e4,r=f.promisify(e.resolveTxt),s=f.promisify(e.lookup);function t(...a){let b=[];for(let c=0;c<Math.max.apply(null,a.map(a=>a.length));c++)for(let d of a)c<d.length&&b.push(d[c]);return b}class u{constructor(a,c,d){var e,f,g;this.target=a,this.listener=c,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,p("Resolver constructed for target "+(0,l.uriToString)(a));let j=(0,l.splitHostPort)(a.path);null===j?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,m.isIPv4)(j.host)||(0,m.isIPv6)(j.host)?(this.ipResult=[{host:j.host,port:null!=(e=j.port)?e:b.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=j.host,this.port=null!=(f=j.port)?f:b.DEFAULT_PORT),this.percentage=100*Math.random(),1===d["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:h.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata};let k={initialDelay:d["grpc.initial_reconnect_backoff_ms"],maxDelay:d["grpc.max_reconnect_backoff_ms"]};this.backoff=new n.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},k),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!=(g=d["grpc.dns_min_time_between_resolutions_ms"])?g:q,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(p("Returning IP address for target "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)p("Failed to parse DNS address "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:h.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;p("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let a=this.dnsHostname;this.pendingLookupPromise=s(a,{all:!0}),this.pendingLookupPromise.then(a=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let b=a.filter(a=>4===a.family),c=a.filter(a=>6===a.family);this.latestLookupResult=t(c,b).map(a=>({host:a.address,port:+this.port}));let d="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(p("Resolved addresses for target "+(0,l.uriToString)(this.target)+": "+d),0===this.latestLookupResult.length)return void this.listener.onError(this.defaultResolutionError);this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},a=>{null!==this.pendingLookupPromise&&(p("Resolution error for target "+(0,l.uriToString)(this.target)+": "+a.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=r(a),this.pendingTxtPromise.then(a=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,g.extractAndSelectServiceConfig)(a,this.percentage)}catch(a){this.latestServiceConfigError={code:h.Status.UNAVAILABLE,details:`Parsing service config failed with error ${a.message}`,metadata:new i.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},a=>{}))}}startNextResolutionTimer(){var a,b;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null==(b=(a=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)?void 0:b.call(a),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?p('resolution update delayed by "min time between resolutions" rate limit'):p("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(a){return a.path}}b.setup=function(){(0,d.registerResolver)("dns",u),(0,d.registerDefaultScheme)("dns")}},56271:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},57311:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getProxiedConnection=b.mapProxyName=void 0;let d=c(18031),e=c(50615),f=c(9114),g=c(81630),h=c(34631),i=c(18031),j=c(24204),k=c(25554),l=c(79551),m=c(55588),n="proxy";function o(a){i.trace(e.LogVerbosity.DEBUG,n,a)}function p(){let a,b="",c="";if(process.env.grpc_proxy)c="grpc_proxy",b=process.env.grpc_proxy;else if(process.env.https_proxy)c="https_proxy",b=process.env.https_proxy;else{if(!process.env.http_proxy)return{};c="http_proxy",b=process.env.http_proxy}try{a=new l.URL(b)}catch(a){return(0,d.log)(e.LogVerbosity.ERROR,`cannot parse value of "${c}" env var`),{}}if("http:"!==a.protocol)return(0,d.log)(e.LogVerbosity.ERROR,`"${a.protocol}" scheme not supported in proxy URI`),{};let f=null;a.username&&(a.password?((0,d.log)(e.LogVerbosity.INFO,"userinfo found in proxy URI"),f=`${a.username}:${a.password}`):f=a.username);let g=a.hostname,h=a.port;""===h&&(h="80");let i={address:`${g}:${h}`};return f&&(i.creds=f),o("Proxy server "+i.address+" set by environment variable "+c),i}function q(){let a=process.env.no_grpc_proxy,b="no_grpc_proxy";return(a||(a=process.env.no_proxy,b="no_proxy"),a)?(o("No proxy server list set by environment variable "+b),a.split(",")):[]}b.mapProxyName=function(a,b){var c;let d={target:a,extraOptions:{}};if((null!=(c=b["grpc.enable_http_proxy"])?c:1)===0||"unix"===a.scheme)return d;let e=p();if(!e.address)return d;let f=(0,k.splitHostPort)(a.path);if(!f)return d;let g=f.host;for(let b of q())if(b===g)return o("Not using proxy for target in no_proxy list: "+(0,k.uriToString)(a)),d;let h={"grpc.http_connect_target":(0,k.uriToString)(a)};return e.creds&&(h["grpc.http_connect_creds"]=e.creds),{target:{scheme:"dns",path:e.address},extraOptions:h}},b.getProxiedConnection=function(a,b,c){var i;if(!("grpc.http_connect_target"in b))return Promise.resolve({});let l=b["grpc.http_connect_target"],n=(0,k.parseUri)(l);if(null===n)return Promise.resolve({});let p=(0,k.splitHostPort)(n.path);if(null===p)return Promise.resolve({});let q=`${p.host}:${null!=(i=p.port)?i:m.DEFAULT_PORT}`,r={method:"CONNECT",path:q},s={Host:q};(0,j.isTcpSubchannelAddress)(a)?(r.host=a.host,r.port=a.port):r.socketPath=a.path,"grpc.http_connect_creds"in b&&(s["Proxy-Authorization"]="Basic "+Buffer.from(b["grpc.http_connect_creds"]).toString("base64")),r.headers=s;let t=(0,j.subchannelAddressToString)(a);return o("Using proxy "+t+" to connect to "+r.path),new Promise((a,b)=>{let i=g.request(r);i.once("connect",(g,j,l)=>{var m;if(i.removeAllListeners(),j.removeAllListeners(),200===g.statusCode)if(o("Successfully connected to "+r.path+" through proxy "+t),"secureContext"in c){let d=(0,f.getDefaultAuthority)(n),e=(0,k.splitHostPort)(d),g=null!=(m=null==e?void 0:e.host)?m:d,i=h.connect(Object.assign({host:g,servername:g,socket:j},c),()=>{o("Successfully established a TLS connection to "+r.path+" through proxy "+t),a({socket:i,realTarget:n})});i.on("error",a=>{o("Failed to establish a TLS connection to "+r.path+" through proxy "+t+" with error "+a.message),b()})}else o("Successfully established a plaintext connection to "+r.path+" through proxy "+t),a({socket:j,realTarget:n});else(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to "+r.path+" through proxy "+t+" with status "+g.statusCode),b()}),i.once("error",a=>{i.removeAllListeners(),(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to proxy "+t+" with error "+a.message),b()}),i.end()})}},57684:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return h}});let d=c(38301),e=!0,f=()=>{},g=()=>{};function h(a){let{headManager:b,reduceComponentsToState:c}=a;function h(){if(b&&b.mountedInstances){let e=d.Children.toArray(Array.from(b.mountedInstances).filter(Boolean));b.updateHead(c(e,a))}}if(e){var i;null==b||null==(i=b.mountedInstances)||i.add(a.children),h()}return f(()=>{var c;return null==b||null==(c=b.mountedInstances)||c.add(a.children),()=>{var c;null==b||null==(c=b.mountedInstances)||c.delete(a.children)}}),f(()=>(b&&(b._pendingUpdate=h),()=>{b&&(b._pendingUpdate=h)})),g(()=>(b&&b._pendingUpdate&&(b._pendingUpdate(),b._pendingUpdate=null),()=>{b&&b._pendingUpdate&&(b._pendingUpdate(),b._pendingUpdate=null)})),null}},59665:(a,b,c)=>{"use strict";a.exports=l;var d,e=c(60054),f=e.LongBits,g=e.base64,h=e.utf8;function i(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function j(){}function k(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function l(){this.len=0,this.head=new i(j,0,0),this.tail=this.head,this.states=null}var m=function(){return e.Buffer?function(){return(l.create=function(){return new d})()}:function(){return new l}};function n(a,b,c){b[c]=255&a}function o(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function p(a,b){this.len=a,this.next=void 0,this.val=b}function q(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function r(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}l.create=m(),l.alloc=function(a){return new e.Array(a)},e.Array!==Array&&(l.alloc=e.pool(l.alloc,e.Array.prototype.subarray)),l.prototype._push=function(a,b,c){return this.tail=this.tail.next=new i(a,b,c),this.len+=b,this},p.prototype=Object.create(i.prototype),p.prototype.fn=o,l.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new p((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:5,a)).len,this},l.prototype.int32=function(a){return a<0?this._push(q,10,f.fromNumber(a)):this.uint32(a)},l.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},l.prototype.uint64=function(a){var b=f.from(a);return this._push(q,b.length(),b)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(a){var b=f.from(a).zzEncode();return this._push(q,b.length(),b)},l.prototype.bool=function(a){return this._push(n,1,+!!a)},l.prototype.fixed32=function(a){return this._push(r,4,a>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(a){var b=f.from(a);return this._push(r,4,b.lo)._push(r,4,b.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(a){return this._push(e.float.writeFloatLE,4,a)},l.prototype.double=function(a){return this._push(e.float.writeDoubleLE,8,a)};var s=e.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};l.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(n,1,0);if(e.isString(a)){var c=l.alloc(b=g.length(a));g.decode(a,c,0),a=c}return this.uint32(b)._push(s,b,a)},l.prototype.string=function(a){var b=h.length(a);return b?this.uint32(b)._push(h.write,b,a):this._push(n,1,0)},l.prototype.fork=function(){return this.states=new k(this),this.head=this.tail=new i(j,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(j,0,0),this.len=0),this},l.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},l.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},l._configure=function(a){d=a,l.create=m(),d._configure()}},60054:function(a,b,c){"use strict";var d=b;function e(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function f(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:Error().stack||""}),c&&e(this,c)}return b.prototype=Object.create(Error.prototype,{constructor:{value:b,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return a},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),b}d.asPromise=c(81165),d.base64=c(27203),d.EventEmitter=c(29178),d.float=c(24286),d.inquire=c(32497),d.utf8=c(63363),d.pool=c(90146),d.LongBits=c(65531),d.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),d.global=d.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},d.isString=function(a){return"string"==typeof a||a instanceof String},d.isObject=function(a){return a&&"object"==typeof a},d.isset=d.isSet=function(a,b){var c=a[b];return!!(null!=c&&a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},d.Buffer=function(){try{var a=d.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(a){return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(a){return"number"==typeof a?d.Buffer?d._Buffer_allocUnsafe(a):new d.Array(a):d.Buffer?d._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},d.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(a){return a?d.LongBits.from(a).toHash():d.LongBits.zeroHash},d.longFromHash=function(a,b){var c=d.LongBits.fromHash(a);return d.Long?d.Long.fromBits(c.lo,c.hi,b):c.toNumber(!!b)},d.merge=e,d.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},d.newError=f,d.ProtocolError=f("ProtocolError"),d.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(1===b[a[c]]&&void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},d.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var a=d.Buffer;if(!a){d._Buffer_from=d._Buffer_allocUnsafe=null;return}d._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},d._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}},60967:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(75338),e=c(99442);function f(){return(0,d.jsx)(e.default,{})}},61134:(a,b,c)=>{"use strict";a.exports=f;var d=c(59665);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(60054);function f(){d.call(this)}function g(a,b,c){a.length<40?e.utf8.write(a,b,c):b.utf8Write?b.utf8Write(a,c):b.write(a,c)}f._configure=function(){f.alloc=e._Buffer_allocUnsafe,f.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]}},f.prototype.bytes=function(a){e.isString(a)&&(a=e._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(f.writeBytesBuffer,b,a),this},f.prototype.string=function(a){var b=e.Buffer.byteLength(a);return this.uint32(b),b&&this._push(g,b,a),this},f._configure()},61135:()=>{},62556:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.deadlineToString=b.getRelativeTimeout=b.getDeadlineTimeoutString=b.minDeadline=void 0,b.minDeadline=function(...a){let b=1/0;for(let c of a){let a=c instanceof Date?c.getTime():c;a<b&&(b=a)}return b};let c=[["m",1],["S",1e3],["M",6e4],["H",36e5]];b.getDeadlineTimeoutString=function(a){let b=new Date().getTime();a instanceof Date&&(a=a.getTime());let d=Math.max(a-b,0);for(let[a,b]of c){let c=d/b;if(c<1e8)return String(Math.ceil(c))+a}throw Error("Deadline is too far in the future")};let d=0x7fffffff;b.getRelativeTimeout=function(a){let b=(a instanceof Date?a.getTime():a)-new Date().getTime();return b<0?0:b>d?1/0:b},b.deadlineToString=function(a){if(a instanceof Date)return a.toISOString();{let b=new Date(a);return Number.isNaN(b.getTime())?""+a:b.toISOString()}}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63363:(a,b)=>{"use strict";var c=b;c.length=function(a){for(var b=0,c=0,d=0;d<a.length;++d)(c=a.charCodeAt(d))<128?b+=1:c<2048?b+=2:(64512&c)==55296&&(64512&a.charCodeAt(d+1))==56320?(++d,b+=4):b+=3;return b},c.read=function(a,b,c){if(c-b<1)return"";for(var d,e=null,f=[],g=0;b<c;)(d=a[b++])<128?f[g++]=d:d>191&&d<224?f[g++]=(31&d)<<6|63&a[b++]:d>239&&d<365?(d=((7&d)<<18|(63&a[b++])<<12|(63&a[b++])<<6|63&a[b++])-65536,f[g++]=55296+(d>>10),f[g++]=56320+(1023&d)):f[g++]=(15&d)<<12|(63&a[b++])<<6|63&a[b++],g>8191&&((e||(e=[])).push(String.fromCharCode.apply(String,f)),g=0);return e?(g&&e.push(String.fromCharCode.apply(String,f.slice(0,g))),e.join("")):String.fromCharCode.apply(String,f.slice(0,g))},c.write=function(a,b,c){for(var d,e,f=c,g=0;g<a.length;++g)(d=a.charCodeAt(g))<128?b[c++]=d:(d<2048?b[c++]=d>>6|192:((64512&d)==55296&&(64512&(e=a.charCodeAt(g+1)))==56320?(d=65536+((1023&d)<<10)+(1023&e),++g,b[c++]=d>>18|240,b[c++]=d>>12&63|128):b[c++]=d>>12|224,b[c++]=d>>6&63|128),b[c++]=63&d|128);return c-f}},63725:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{default:function(){return q},defaultHead:function(){return l}});let d=c(35288),e=c(55823),f=c(21124),g=e._(c(38301)),h=d._(c(57684)),i=c(81578),j=c(19746),k=c(15217);function l(a){void 0===a&&(a=!1);let b=[(0,f.jsx)("meta",{charSet:"utf-8"},"charset")];return a||b.push((0,f.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),b}function m(a,b){return"string"==typeof b||"number"==typeof b?a:b.type===g.default.Fragment?a.concat(g.default.Children.toArray(b.props.children).reduce((a,b)=>"string"==typeof b||"number"==typeof b?a:a.concat(b),[])):a.concat(b)}c(21507);let n=["name","httpEquiv","charSet","itemProp"];function o(){let a=new Set,b=new Set,c=new Set,d={};return e=>{let f=!0,g=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){g=!0;let b=e.key.slice(e.key.indexOf("$")+1);a.has(b)?f=!1:a.add(b)}switch(e.type){case"title":case"base":b.has(e.type)?f=!1:b.add(e.type);break;case"meta":for(let a=0,b=n.length;a<b;a++){let b=n[a];if(e.props.hasOwnProperty(b))if("charSet"===b)c.has(b)?f=!1:c.add(b);else{let a=e.props[b],c=d[b]||new Set;("name"!==b||!g)&&c.has(a)?f=!1:(c.add(a),d[b]=c)}}}return f}}function p(a,b){let{inAmpMode:c}=b;return a.reduce(m,[]).reverse().concat(l(c).reverse()).filter(o()).reverse().map((a,b)=>{let c=a.key||b;return g.default.cloneElement(a,{key:c})})}let q=function(a){let{children:b}=a,c=(0,g.useContext)(i.AmpStateContext),d=(0,g.useContext)(j.HeadManagerContext);return(0,f.jsx)(h.default,{reduceComponentsToState:p,headManager:d,inAmpMode:(0,k.isInAmpMode)(c),children:b})};("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},63932:(a,b,c)=>{Promise.resolve().then(c.bind(c,99442))},63974:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"getImgProps",{enumerable:!0,get:function(){return m}}),c(21507);let d=c(78757),e=c(3001),f=["-moz-initial","fill","none","scale-down",void 0];function g(a){return void 0!==a.default}function h(a){return void 0!==a.src}function i(a){return!!a&&"object"==typeof a&&(g(a)||h(a))}function j(a){return void 0===a?a:"number"==typeof a?Number.isFinite(a)?a:NaN:"string"==typeof a&&/^[0-9]+$/.test(a)?parseInt(a,10):NaN}function k(a,b,c){let{deviceSizes:d,allSizes:e}=a;if(c){let a=/(^|\s)(1?\d?\d)vw/g,b=[];for(let d;d=a.exec(c);)b.push(parseInt(d[2]));if(b.length){let a=.01*Math.min(...b);return{widths:e.filter(b=>b>=d[0]*a),kind:"w"}}return{widths:e,kind:"w"}}return"number"!=typeof b?{widths:d,kind:"w"}:{widths:[...new Set([b,2*b].map(a=>e.find(b=>b>=a)||e[e.length-1]))],kind:"x"}}function l(a){let{config:b,src:c,unoptimized:d,width:e,quality:f,sizes:g,loader:h}=a;if(d)return{src:c,srcSet:void 0,sizes:void 0};let{widths:i,kind:j}=k(b,e,g),l=i.length-1;return{sizes:g||"w"!==j?g:"100vw",srcSet:i.map((a,d)=>h({config:b,src:c,quality:f,width:a})+" "+("w"===j?a:d+1)+j).join(", "),src:h({config:b,src:c,quality:f,width:i[l]})}}function m(a,b){var c;let h,k,m,{src:n,sizes:o,unoptimized:p=!1,priority:q=!1,loading:r,className:s,quality:t,width:u,height:v,fill:w=!1,style:x,overrideSrc:y,onLoad:z,onLoadingComplete:A,placeholder:B="empty",blurDataURL:C,fetchPriority:D,decoding:E="async",layout:F,objectFit:G,objectPosition:H,lazyBoundary:I,lazyRoot:J,...K}=a,{imgConf:L,showAltText:M,blurComplete:N,defaultLoader:O}=b,P=L||e.imageConfigDefault;if("allSizes"in P)h=P;else{let a=[...P.deviceSizes,...P.imageSizes].sort((a,b)=>a-b),b=P.deviceSizes.sort((a,b)=>a-b),d=null==(c=P.qualities)?void 0:c.sort((a,b)=>a-b);h={...P,allSizes:a,deviceSizes:b,qualities:d}}if(void 0===O)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let Q=K.loader||O;delete K.loader,delete K.srcSet;let R="__next_img_default"in Q;if(R){if("custom"===h.loader)throw Object.defineProperty(Error('Image with src "'+n+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader'),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let a=Q;Q=b=>{let{config:c,...d}=b;return a(d)}}if(F){"fill"===F&&(w=!0);let a={responsive:"100vw",fill:"100vw"},b={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[F];b&&(x={...x,...b});let c=a[F];c&&!o&&(o=c)}let S="",T=j(u),U=j(v);if(i(n)){let a=g(n)?n.default:n;if(!a.src)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(a)),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!a.height||!a.width)throw Object.defineProperty(Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(a)),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(k=a.blurWidth,m=a.blurHeight,C=C||a.blurDataURL,S=a.src,!w)if(T||U){if(T&&!U){let b=T/a.width;U=Math.round(a.height*b)}else if(!T&&U){let b=U/a.height;T=Math.round(a.width*b)}}else T=a.width,U=a.height}let V=!q&&("lazy"===r||void 0===r);(!(n="string"==typeof n?n:S)||n.startsWith("data:")||n.startsWith("blob:"))&&(p=!0,V=!1),h.unoptimized&&(p=!0),R&&!h.dangerouslyAllowSVG&&n.split("?",1)[0].endsWith(".svg")&&(p=!0);let W=j(t),X=Object.assign(w?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:G,objectPosition:H}:{},M?{}:{color:"transparent"},x),Y=N||"empty"===B?null:"blur"===B?'url("data:image/svg+xml;charset=utf-8,'+(0,d.getImageBlurSvg)({widthInt:T,heightInt:U,blurWidth:k,blurHeight:m,blurDataURL:C||"",objectFit:X.objectFit})+'")':'url("'+B+'")',Z=f.includes(X.objectFit)?"fill"===X.objectFit?"100% 100%":"cover":X.objectFit,$=Y?{backgroundSize:Z,backgroundPosition:X.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:Y}:{},_=l({config:h,src:n,unoptimized:p,width:T,quality:W,sizes:o,loader:Q});return{props:{...K,loading:V?"lazy":r,fetchPriority:D,width:T,height:U,decoding:E,className:s,style:{...X,...$},sizes:_.sizes,srcSet:_.srcSet,src:y||_.src},meta:{unoptimized:p,priority:q,placeholder:B,fill:w}}}},64022:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InterceptingListenerImpl=b.isInterceptingListener=void 0,b.isInterceptingListener=function(a){return void 0!==a.onReceiveMetadata&&1===a.onReceiveMetadata.length};class c{constructor(a,b){this.listener=a,this.nextListener=b,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(a){this.processingMetadata=!0,this.listener.onReceiveMetadata(a,a=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(a),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(a){this.processingMessage=!0,this.listener.onReceiveMessage(a,a=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=a,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(a),this.processPendingStatus())})}onReceiveStatus(a){this.listener.onReceiveStatus(a,a=>{this.processingMetadata||this.processingMessage?this.pendingStatus=a:this.nextListener.onReceiveStatus(a)})}}b.InterceptingListenerImpl=c},64105:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Metadata=void 0;let d=c(18031),e=c(50615),f=c(1400),g=/^[0-9a-z_.-]+$/,h=/^[ -~]*$/;function i(a){return g.test(a)}function j(a){return h.test(a)}function k(a){return a.endsWith("-bin")}function l(a){return!a.startsWith("grpc-")}function m(a){return a.toLowerCase()}function n(a,b){if(!i(a))throw Error('Metadata key "'+a+'" contains illegal characters');if(null!=b)if(k(a)){if(!Buffer.isBuffer(b))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(b))throw Error("keys that don't end with '-bin' must have String values");if(!j(b))throw Error('Metadata string value "'+b+'" contains illegal characters')}}class o{constructor(a={}){this.internalRepr=new Map,this.options=a}set(a,b){n(a=m(a),b),this.internalRepr.set(a,[b])}add(a,b){n(a=m(a),b);let c=this.internalRepr.get(a);void 0===c?this.internalRepr.set(a,[b]):c.push(b)}remove(a){a=m(a),this.internalRepr.delete(a)}get(a){return a=m(a),this.internalRepr.get(a)||[]}getMap(){let a={};for(let[b,c]of this.internalRepr)if(c.length>0){let d=c[0];a[b]=Buffer.isBuffer(d)?Buffer.from(d):d}return a}clone(){let a=new o(this.options),b=a.internalRepr;for(let[a,c]of this.internalRepr){let d=c.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);b.set(a,d)}return a}merge(a){for(let[b,c]of a.internalRepr){let a=(this.internalRepr.get(b)||[]).concat(c);this.internalRepr.set(b,a)}}setOptions(a){this.options=a}getOptions(){return this.options}toHttp2Headers(){let a={};for(let[b,c]of this.internalRepr)a[b]=c.map(p);return a}toJSON(){let a={};for(let[b,c]of this.internalRepr)a[b]=c;return a}static fromHttp2Headers(a){let b=new o;for(let c of Object.keys(a)){if(":"===c.charAt(0))continue;let g=a[c];try{k(c)?Array.isArray(g)?g.forEach(a=>{b.add(c,Buffer.from(a,"base64"))}):void 0!==g&&(l(c)?g.split(",").forEach(a=>{b.add(c,Buffer.from(a.trim(),"base64"))}):b.add(c,Buffer.from(g,"base64"))):Array.isArray(g)?g.forEach(a=>{b.add(c,a)}):void 0!==g&&b.add(c,g)}catch(b){let a=`Failed to add metadata entry ${c}: ${g}. ${(0,f.getErrorMessage)(b)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,d.log)(e.LogVerbosity.ERROR,a)}}return b}}b.Metadata=o;let p=a=>Buffer.isBuffer(a)?a.toString("base64"):a},64149:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addAdminServicesToServer=b.registerAdminService=void 0;let c=[];b.registerAdminService=function(a,b){c.push({getServiceDefinition:a,getHandlers:b})},b.addAdminServicesToServer=function(a){for(let{getServiceDefinition:b,getHandlers:d}of c)a.addService(b(),d())}},64869:(a,b,c)=>{"use strict";a.exports=c(54900)},65049:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},65487:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.RoundRobinLoadBalancer=void 0;let d=c(68367),e=c(96699),f=c(82142),g=c(24204),h=c(18031),i=c(50615),j="round_robin";function k(a){h.trace(i.LogVerbosity.DEBUG,j,a)}let l="round_robin";class m{getLoadBalancerName(){return l}constructor(){}toJsonObject(){return{[l]:{}}}static createFromJson(a){return new m}}class n{constructor(a,b=0){this.subchannelList=a,this.nextIndex=b}pick(a){let b=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:f.PickResultType.COMPLETE,subchannel:b,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class o{constructor(a){this.channelControlHelper=a,this.subchannels=[],this.currentState=e.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(a,b,c,d,f)=>{this.calculateAndUpdateState(),(c===e.ConnectivityState.TRANSIENT_FAILURE||c===e.ConnectivityState.IDLE)&&(f&&(this.lastError=f),this.channelControlHelper.requestReresolution(),a.startConnecting())}}countSubchannelsWithState(a){return this.subchannels.filter(b=>b.getConnectivityState()===a).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(e.ConnectivityState.READY)>0){let a=this.subchannels.filter(a=>a.getConnectivityState()===e.ConnectivityState.READY),b=0;null!==this.currentReadyPicker&&(b=a.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(b=0),this.updateState(e.ConnectivityState.READY,new n(a,b))}else this.countSubchannelsWithState(e.ConnectivityState.CONNECTING)>0?this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this)):this.countSubchannelsWithState(e.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this))}updateState(a,b){k(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),a===e.ConnectivityState.READY?this.currentReadyPicker=b:this.currentReadyPicker=null,this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.subchannels)a.removeConnectivityStateListener(this.subchannelStateListener),a.unref(),this.channelControlHelper.removeChannelzChild(a.getChannelzRef());this.subchannels=[]}updateAddressList(a,b){for(let b of(this.resetSubchannelList(),k("Connect to address list "+a.map(a=>(0,g.subchannelAddressToString)(a))),this.subchannels=a.map(a=>this.channelControlHelper.createSubchannel(a,{})),this.subchannels)){b.ref(),b.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(b.getChannelzRef());let a=b.getConnectivityState();(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.TRANSIENT_FAILURE)&&b.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let a of this.subchannels)a.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return l}}b.RoundRobinLoadBalancer=o,b.setup=function(){(0,d.registerLoadBalancerType)(l,o,m)}},65531:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a,b){this.lo=a>>>0,this.hi=b>>>0}var f=e.zero=new e(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,d=(a-c)/0x100000000>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>0xffffffff&&(c=0,++d>0xffffffff&&(d=0))),new e(c,d)},e.from=function(a){if("number"==typeof a)return e.fromNumber(a);if(d.isString(a))if(!d.Long)return e.fromNumber(parseInt(a,10));else a=d.Long.fromString(a);return a.low||a.high?new e(a.low>>>0,a.high>>>0):f},e.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=~this.lo+1>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+0x100000000*c)}return this.lo+0x100000000*this.hi},e.prototype.toLong=function(a){return d.Long?new d.Long(0|this.lo,0|this.hi,!!a):{low:0|this.lo,high:0|this.hi,unsigned:!!a}};var h=String.prototype.charCodeAt;e.fromHash=function(a){return a===g?f:new e((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},e.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},e.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},66666:function(a,b){var c;!function(d,e){function f(a){return a.default||a}void 0===(c=(function(){var a={};return e(a),f(a)}).apply(b,[]))||(a.exports=c)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var b=null;try{b=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function c(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c}function d(a){return!0===(a&&a.__isLong__)}function e(a){var b=Math.clz32(a&-a);return a?31-b:b}c.prototype.__isLong__,Object.defineProperty(c.prototype,"__isLong__",{value:!0}),c.isLong=d;var f={},g={};function h(a,b){var c,d,e;if(b)return(a>>>=0,(e=0<=a&&a<256)&&(d=g[a]))?d:(c=j(a,0,!0),e&&(g[a]=c),c);return(a|=0,(e=-128<=a&&a<128)&&(d=f[a]))?d:(c=j(a,a<0?-1:0,!1),e&&(f[a]=c),c)}function i(a,b){if(isNaN(a))return b?s:r;if(b){if(a<0)return s;if(a>=o)return x}else{if(a<=-p)return y;if(a+1>=p)return w}return a<0?i(-a,b).neg():j(a%n|0,a/n|0,b)}function j(a,b,d){return new c(a,b,d)}c.fromInt=h,c.fromNumber=i,c.fromBits=j;var k=Math.pow;function l(a,b,c){if(0===a.length)throw Error("empty string");if("number"==typeof b?(c=b,b=!1):b=!!b,"NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return b?s:r;if((c=c||10)<2||36<c)throw RangeError("radix");if((d=a.indexOf("-"))>0)throw Error("interior hyphen");if(0===d)return l(a.substring(1),b,c).neg();for(var d,e=i(k(c,8)),f=r,g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g),j=parseInt(a.substring(g,g+h),c);if(h<8){var m=i(k(c,h));f=f.mul(m).add(i(j))}else f=(f=f.mul(e)).add(i(j))}return f.unsigned=b,f}function m(a,b){return"number"==typeof a?i(a,b):"string"==typeof a?l(a,b):j(a.low,a.high,"boolean"==typeof b?b:a.unsigned)}c.fromString=l,c.fromValue=m;var n=0x100000000,o=0xffffffffffffffff,p=0x8000000000000000,q=h(0x1000000),r=h(0);c.ZERO=r;var s=h(0,!0);c.UZERO=s;var t=h(1);c.ONE=t;var u=h(1,!0);c.UONE=u;var v=h(-1);c.NEG_ONE=v;var w=j(-1,0x7fffffff,!1);c.MAX_VALUE=w;var x=j(-1,-1,!0);c.MAX_UNSIGNED_VALUE=x;var y=j(0,-0x80000000,!1);c.MIN_VALUE=y;var z=c.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},z.toString=function(a){if((a=a||10)<2||36<a)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(y))return"-"+this.neg().toString(a);else{var b=i(a),c=this.div(b),d=c.mul(b).sub(this);return c.toString(a)+d.toInt().toString(a)}for(var e=i(k(a,6),this.unsigned),f=this,g="";;){var h=f.div(e),j=(f.sub(h.mul(e)).toInt()>>>0).toString(a);if((f=h).isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(y)?64:this.neg().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&(a&1<<b)==0;b--);return 0!=this.high?b+33:b+1},z.isSafeInteger=function(){var a=this.high>>21;return!a||!this.unsigned&&-1===a&&(0!==this.low||-2097152!==this.high)},z.isZero=function(){return 0===this.high&&0===this.low},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&this.high<0},z.isPositive=function(){return this.unsigned||this.high>=0},z.isOdd=function(){return(1&this.low)==1},z.isEven=function(){return(1&this.low)==0},z.equals=function(a){return d(a)||(a=m(a)),(this.unsigned===a.unsigned||this.high>>>31!=1||a.high>>>31!=1)&&this.high===a.high&&this.low===a.low},z.eq=z.equals,z.notEquals=function(a){return!this.eq(a)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(a){return 0>this.comp(a)},z.lt=z.lessThan,z.lessThanOrEqual=function(a){return 0>=this.comp(a)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(a){return this.comp(a)>0},z.gt=z.greaterThan,z.greaterThanOrEqual=function(a){return this.comp(a)>=0},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(a){if(d(a)||(a=m(a)),this.eq(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.sub(a).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(y)?y:this.not().add(t)},z.neg=z.negate,z.add=function(a){d(a)||(a=m(a));var b,c,e=this.high>>>16,f=65535&this.high,g=this.low>>>16,h=65535&this.low,i=a.high>>>16,k=65535&a.high,l=a.low>>>16,n=65535&a.low,o=0,p=0;return b=0+((c=0+(h+n))>>>16),c&=65535,b+=g+l,p+=b>>>16,b&=65535,p+=f+k,o+=p>>>16,p&=65535,o+=e+i,j(b<<16|c,(o&=65535)<<16|p,this.unsigned)},z.subtract=function(a){return d(a)||(a=m(a)),this.add(a.neg())},z.sub=z.subtract,z.multiply=function(a){if(this.isZero())return this;if(d(a)||(a=m(a)),b)return j(b.mul(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned);if(a.isZero())return this.unsigned?s:r;if(this.eq(y))return a.isOdd()?y:r;if(a.eq(y))return this.isOdd()?y:r;if(this.isNegative())if(a.isNegative())return this.neg().mul(a.neg());else return this.neg().mul(a).neg();if(a.isNegative())return this.mul(a.neg()).neg();if(this.lt(q)&&a.lt(q))return i(this.toNumber()*a.toNumber(),this.unsigned);var c,e,f=this.high>>>16,g=65535&this.high,h=this.low>>>16,k=65535&this.low,l=a.high>>>16,n=65535&a.high,o=a.low>>>16,p=65535&a.low,t=0,u=0;return c=0+((e=0+k*p)>>>16),e&=65535,c+=h*p,u+=c>>>16,c&=65535,c+=k*o,u+=c>>>16,c&=65535,u+=g*p,t+=u>>>16,u&=65535,u+=h*o,t+=u>>>16,u&=65535,u+=k*n,t+=u>>>16,u&=65535,t+=f*p+g*o+h*n+k*l,j(c<<16|e,(t&=65535)<<16|u,this.unsigned)},z.mul=z.multiply,z.divide=function(a){if(d(a)||(a=m(a)),a.isZero())throw Error("division by zero");if(b){var c,e,f;return this.unsigned||-0x80000000!==this.high||-1!==a.low||-1!==a.high?j((this.unsigned?b.div_u:b.div_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?s:r;if(this.unsigned){if(a.unsigned||(a=a.toUnsigned()),a.gt(this))return s;if(a.gt(this.shru(1)))return u;f=s}else{if(this.eq(y))if(a.eq(t)||a.eq(v))return y;else return a.eq(y)?t:(c=this.shr(1).div(a).shl(1)).eq(r)?a.isNegative()?t:v:(e=this.sub(a.mul(c)),f=c.add(e.div(a)));if(a.eq(y))return this.unsigned?s:r;if(this.isNegative())return a.isNegative()?this.neg().div(a.neg()):this.neg().div(a).neg();if(a.isNegative())return this.div(a.neg()).neg();f=r}for(e=this;e.gte(a);){for(var g=Math.ceil(Math.log(c=Math.max(1,Math.floor(e.toNumber()/a.toNumber())))/Math.LN2),h=g<=48?1:k(2,g-48),l=i(c),n=l.mul(a);n.isNegative()||n.gt(e);)c-=h,n=(l=i(c,this.unsigned)).mul(a);l.isZero()&&(l=t),f=f.add(l),e=e.sub(n)}return f},z.div=z.divide,z.modulo=function(a){return(d(a)||(a=m(a)),b)?j((this.unsigned?b.rem_u:b.rem_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this.sub(this.div(a).mul(a))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return j(~this.low,~this.high,this.unsigned)},z.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},z.clz=z.countLeadingZeros,z.countTrailingZeros=function(){return this.low?e(this.low):e(this.high)+32},z.ctz=z.countTrailingZeros,z.and=function(a){return d(a)||(a=m(a)),j(this.low&a.low,this.high&a.high,this.unsigned)},z.or=function(a){return d(a)||(a=m(a)),j(this.low|a.low,this.high|a.high,this.unsigned)},z.xor=function(a){return d(a)||(a=m(a)),j(this.low^a.low,this.high^a.high,this.unsigned)},z.shiftLeft=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):j(0,this.low<<a-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):j(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>>a,this.unsigned):32===a?j(this.high,0,this.unsigned):j(this.high>>>a-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.rotateLeft=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.low<<a|this.high>>>b,this.high<<a|this.low>>>b,this.unsigned)):(a-=32,b=32-a,j(this.high<<a|this.low>>>b,this.low<<a|this.high>>>b,this.unsigned))},z.rotl=z.rotateLeft,z.rotateRight=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.high<<b|this.low>>>a,this.low<<b|this.high>>>a,this.unsigned)):(a-=32,b=32-a,j(this.low<<b|this.high>>>a,this.high<<b|this.low>>>a,this.unsigned))},z.rotr=z.rotateRight,z.toSigned=function(){return this.unsigned?j(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:j(this.low,this.high,!0)},z.toBytes=function(a){return a?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var a=this.high,b=this.low;return[255&b,b>>>8&255,b>>>16&255,b>>>24,255&a,a>>>8&255,a>>>16&255,a>>>24]},z.toBytesBE=function(){var a=this.high,b=this.low;return[a>>>24,a>>>16&255,a>>>8&255,255&a,b>>>24,b>>>16&255,b>>>8&255,255&b]},c.fromBytes=function(a,b,d){return d?c.fromBytesLE(a,b):c.fromBytesBE(a,b)},c.fromBytesLE=function(a,b){return new c(a[0]|a[1]<<8|a[2]<<16|a[3]<<24,a[4]|a[5]<<8|a[6]<<16|a[7]<<24,b)},c.fromBytesBE=function(a,b){return new c(a[4]<<24|a[5]<<16|a[6]<<8|a[7],a[0]<<24|a[1]<<16|a[2]<<8|a[3],b)},"function"==typeof BigInt&&(c.fromBigInt=function(a,b){return j(Number(BigInt.asIntN(32,a)),Number(BigInt.asIntN(32,a>>BigInt(32))),b)},c.fromValue=function(a,b){return"bigint"==typeof a?c.fromBigInt(a,b):m(a,b)},z.toBigInt=function(){var a=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|a}),a.default=c})},67369:(a,b,c)=>{"use strict";a.exports=g;var d=c(72481);((g.prototype=Object.create(d.prototype)).constructor=g).className="OneOf";var e=c(99408),f=c(90290);function g(a,b,c,e){if(Array.isArray(b)||(c=b,b=void 0),d.call(this,a,c),!(void 0===b||Array.isArray(b)))throw TypeError("fieldNames must be an Array");this.oneof=b||[],this.fieldsArray=[],this.comment=e}function h(a){if(a.parent)for(var b=0;b<a.fieldsArray.length;++b)a.fieldsArray[b].parent||a.parent.add(a.fieldsArray[b])}g.fromJSON=function(a,b){return new g(a,b.oneof,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["options",this.options,"oneof",this.oneof,"comment",b?this.comment:void 0])},g.prototype.add=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");return a.parent&&a.parent!==this.parent&&a.parent.remove(a),this.oneof.push(a.name),this.fieldsArray.push(a),a.partOf=this,h(this),this},g.prototype.remove=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");var b=this.fieldsArray.indexOf(a);if(b<0)throw Error(a+" is not a member of "+this);return this.fieldsArray.splice(b,1),(b=this.oneof.indexOf(a.name))>-1&&this.oneof.splice(b,1),a.partOf=null,this},g.prototype.onAdd=function(a){d.prototype.onAdd.call(this,a);for(var b=this,c=0;c<this.oneof.length;++c){var e=a.get(this.oneof[c]);e&&!e.partOf&&(e.partOf=b,b.fieldsArray.push(e))}h(this)},g.prototype.onRemove=function(a){for(var b,c=0;c<this.fieldsArray.length;++c)(b=this.fieldsArray[c]).parent&&b.parent.remove(b);d.prototype.onRemove.call(this,a)},Object.defineProperty(g.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var a=this.fieldsArray[0];return null!=a.options&&!0===a.options.proto3_optional}}),g.d=function(){for(var a=Array(arguments.length),b=0;b<arguments.length;)a[b]=arguments[b++];return function(b,c){f.decorateType(b.constructor).add(new g(c,a)),Object.defineProperty(b,c,{get:f.oneOfGetter(a),set:f.oneOfSetter(a)})}}},68134:(a,b,c)=>{"use strict";a.exports=s;var d=c(26991);((s.prototype=Object.create(d.prototype)).constructor=s).className="Type";var e=c(27791),f=c(67369),g=c(99408),h=c(49316),i=c(25811),j=c(4755),k=c(75645),l=c(59665),m=c(90290),n=c(23464),o=c(71600),p=c(6620),q=c(6792),r=c(19006);function s(a,b){d.call(this,a,b),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function t(a){return a._fieldsById=a._fieldsArray=a._oneofsArray=null,delete a.encode,delete a.decode,delete a.verify,a}Object.defineProperties(s.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var a=Object.keys(this.fields),b=0;b<a.length;++b){var c=this.fields[a[b]],d=c.id;if(this._fieldsById[d])throw Error("duplicate id "+d+" in "+this);this._fieldsById[d]=c}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=m.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=m.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=s.generateConstructor(this)())},set:function(a){var b=a.prototype;b instanceof j||((a.prototype=new j).constructor=a,m.merge(a.prototype,b)),a.$type=a.prototype.$type=this,m.merge(a,j,!0),this._ctor=a;for(var c=0;c<this.fieldsArray.length;++c)this._fieldsArray[c].resolve();var d={};for(c=0;c<this.oneofsArray.length;++c)d[this._oneofsArray[c].resolve().name]={get:m.oneOfGetter(this._oneofsArray[c].oneof),set:m.oneOfSetter(this._oneofsArray[c].oneof)};c&&Object.defineProperties(a.prototype,d)}}}),s.generateConstructor=function(a){for(var b,c=m.codegen(["p"],a.name),d=0;d<a.fieldsArray.length;++d)(b=a._fieldsArray[d]).map?c("this%s={}",m.safeProp(b.name)):b.repeated&&c("this%s=[]",m.safeProp(b.name));return c("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},s.fromJSON=function(a,b){var c=new s(a,b.options);c.extensions=b.extensions,c.reserved=b.reserved;for(var j=Object.keys(b.fields),k=0;k<j.length;++k)c.add((void 0!==b.fields[j[k]].keyType?h.fromJSON:g.fromJSON)(j[k],b.fields[j[k]]));if(b.oneofs)for(j=Object.keys(b.oneofs),k=0;k<j.length;++k)c.add(f.fromJSON(j[k],b.oneofs[j[k]]));if(b.nested)for(j=Object.keys(b.nested),k=0;k<j.length;++k){var l=b.nested[j[k]];c.add((void 0!==l.id?g.fromJSON:void 0!==l.fields?s.fromJSON:void 0!==l.values?e.fromJSON:void 0!==l.methods?i.fromJSON:d.fromJSON)(j[k],l))}return b.extensions&&b.extensions.length&&(c.extensions=b.extensions),b.reserved&&b.reserved.length&&(c.reserved=b.reserved),b.group&&(c.group=!0),b.comment&&(c.comment=b.comment),b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},s.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return m.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"oneofs",d.arrayToJSON(this.oneofsArray,a),"fields",d.arrayToJSON(this.fieldsArray.filter(function(a){return!a.declaringField}),a)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},s.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolveAll.call(this);var a=this.oneofsArray;for(c=0;c<a.length;)a[c++].resolve();for(var b=this.fieldsArray,c=0;c<b.length;)b[c++].resolve();return this},s.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.oneofsArray.forEach(b=>{b._resolveFeatures(a)}),this.fieldsArray.forEach(b=>{b._resolveFeatures(a)})),this},s.prototype.get=function(a){return this.fields[a]||this.oneofs&&this.oneofs[a]||this.nested&&this.nested[a]||null},s.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);if(a instanceof g&&void 0===a.extend){if(this._fieldsById?this._fieldsById[a.id]:this.fieldsById[a.id])throw Error("duplicate id "+a.id+" in "+this);if(this.isReservedId(a.id))throw Error("id "+a.id+" is reserved in "+this);if(this.isReservedName(a.name))throw Error("name '"+a.name+"' is reserved in "+this);return a.parent&&a.parent.remove(a),this.fields[a.name]=a,a.message=this,a.onAdd(this),t(this)}return a instanceof f?(this.oneofs||(this.oneofs={}),this.oneofs[a.name]=a,a.onAdd(this),t(this)):d.prototype.add.call(this,a)},s.prototype.remove=function(a){if(a instanceof g&&void 0===a.extend){if(!this.fields||this.fields[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.fields[a.name],a.parent=null,a.onRemove(this),t(this)}if(a instanceof f){if(!this.oneofs||this.oneofs[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.oneofs[a.name],a.parent=null,a.onRemove(this),t(this)}return d.prototype.remove.call(this,a)},s.prototype.isReservedId=function(a){return d.isReservedId(this.reserved,a)},s.prototype.isReservedName=function(a){return d.isReservedName(this.reserved,a)},s.prototype.create=function(a){return new this.ctor(a)},s.prototype.setup=function(){for(var a=this.fullName,b=[],c=0;c<this.fieldsArray.length;++c)b.push(this._fieldsArray[c].resolve().resolvedType);this.encode=n(this)({Writer:l,types:b,util:m}),this.decode=o(this)({Reader:k,types:b,util:m}),this.verify=p(this)({types:b,util:m}),this.fromObject=q.fromObject(this)({types:b,util:m}),this.toObject=q.toObject(this)({types:b,util:m});var d=r[a];if(d){var e=Object.create(this);e.fromObject=this.fromObject,this.fromObject=d.fromObject.bind(e),e.toObject=this.toObject,this.toObject=d.toObject.bind(e)}return this},s.prototype.encode=function(a,b){return this.setup().encode(a,b)},s.prototype.encodeDelimited=function(a,b){return this.encode(a,b&&b.len?b.fork():b).ldelim()},s.prototype.decode=function(a,b){return this.setup().decode(a,b)},s.prototype.decodeDelimited=function(a){return a instanceof k||(a=k.create(a)),this.decode(a,a.uint32())},s.prototype.verify=function(a){return this.setup().verify(a)},s.prototype.fromObject=function(a){return this.setup().fromObject(a)},s.prototype.toObject=function(a,b){return this.setup().toObject(a,b)},s.d=function(a){return function(b){m.decorateType(b,a)}}},68306:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelCall=void 0;let d=c(73496),e=c(21820),f=c(50615),g=c(64105),h=c(44333),i=c(18031),j=c(50615),k="subchannel_call";function l(a){for(let[b,c]of Object.entries(e.constants.errno))if(c===a)return b;return"Unknown system error "+a}class m{constructor(a,b,c,e,i){var j;this.http2Stream=a,this.callEventTracker=b,this.listener=c,this.transport=e,this.callId=i,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=f.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let k=null!=(j=e.getOptions()["grpc.max_receive_message_length"])?j:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new h.StreamDecoder(k),a.on("response",(a,b)=>{let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";switch(this.trace("Received server headers:\n"+c),a[":status"]){case 400:this.mappedStatusCode=f.Status.INTERNAL;break;case 401:this.mappedStatusCode=f.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=f.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=f.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=f.Status.UNAVAILABLE;break;default:this.mappedStatusCode=f.Status.UNKNOWN}if(b&d.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(a);else{let b;try{b=g.Metadata.fromHttp2Headers(a)}catch(a){this.endCall({code:f.Status.UNKNOWN,details:a.message,metadata:new g.Metadata});return}this.listener.onReceiveMetadata(b)}}),a.on("trailers",a=>{this.handleTrailers(a)}),a.on("data",a=>{let b;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+a.length);try{b=this.decoder.write(a)}catch(a){this.cancelWithStatus(f.Status.RESOURCE_EXHAUSTED,a.message);return}for(let a of b)this.trace("parsed message of length "+a.length),this.callEventTracker.addMessageReceived(),this.tryPush(a)}}),a.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),a.on("close",()=>{process.nextTick(()=>{var b;let c;if(this.trace("HTTP/2 stream closed with code "+a.rstCode),(null==(b=this.finalStatus)?void 0:b.code)===f.Status.OK)return;let e="";switch(a.rstCode){case d.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`;break;case d.constants.NGHTTP2_REFUSED_STREAM:c=f.Status.UNAVAILABLE,e="Stream refused by server";break;case d.constants.NGHTTP2_CANCEL:c=f.Status.CANCELLED,e="Call cancelled";break;case d.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=f.Status.RESOURCE_EXHAUSTED,e="Bandwidth exhausted or memory limit exceeded";break;case d.constants.NGHTTP2_INADEQUATE_SECURITY:c=f.Status.PERMISSION_DENIED,e="Protocol not secure enough";break;case d.constants.NGHTTP2_INTERNAL_ERROR:c=f.Status.INTERNAL,null===this.internalError?e=`Received RST_STREAM with code ${a.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(c=f.Status.UNAVAILABLE,e=this.internalError.message):e=`Received RST_STREAM with code ${a.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`}this.endCall({code:c,details:e,metadata:new g.Metadata,rstCode:a.rstCode})})}),a.on("error",a=>{"ERR_HTTP2_STREAM_ERROR"!==a.code&&(this.trace("Node error event: message="+a.message+" code="+a.code+" errno="+l(a.errno)+" syscall="+a.syscall),this.internalError=a),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:f.Status.UNAVAILABLE,details:"Connection dropped",metadata:new g.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(a){i.trace(j.LogVerbosity.DEBUG,k,"["+this.callId+"] "+a)}endCall(a){(null===this.finalStatus||this.finalStatus.code===f.Status.OK)&&(this.finalStatus=a,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===f.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(a){this.trace("pushing to reader message of length "+(a instanceof Buffer?a.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(a),this.maybeOutputStatus())})}tryPush(a){this.canPush?(this.http2Stream.pause(),this.push(a)):(this.trace("unpushedReadMessages.push message of length "+a.length),this.unpushedReadMessages.push(a))}handleTrailers(a){let b;this.callEventTracker.onStreamEnd(!0);let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";this.trace("Received server trailers:\n"+c);try{b=g.Metadata.fromHttp2Headers(a)}catch(a){b=new g.Metadata}let d=b.getMap(),e=this.mappedStatusCode;if(e===f.Status.UNKNOWN&&"string"==typeof d["grpc-status"]){let a=Number(d["grpc-status"]);a in f.Status&&(e=a,this.trace("received status code "+a+" from server")),b.remove("grpc-status")}let h="";if("string"==typeof d["grpc-message"]){try{h=decodeURI(d["grpc-message"])}catch(a){h=d["grpc-message"]}b.remove("grpc-message"),this.trace('received status details string "'+h+'" from server')}let i={code:e,details:h,metadata:b};this.endCall(i)}destroyHttp2Stream(){var a;if(!this.http2Stream.destroyed){let b;b=(null==(a=this.finalStatus)?void 0:a.code)===f.Status.OK?d.constants.NGHTTP2_NO_ERROR:d.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+b),this.http2Stream.close(b)}}cancelWithStatus(a,b){this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.endCall({code:a,details:b,metadata:new g.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==f.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let a=this.unpushedReadMessages.shift();this.push(a);return}this.http2Stream.resume()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length);let c=b=>{process.nextTick(()=>{var c;let d=f.Status.UNAVAILABLE;(null==b?void 0:b.code)==="ERR_STREAM_WRITE_AFTER_END"&&(d=f.Status.INTERNAL),b&&this.cancelWithStatus(d,`Write error: ${b.message}`),null==(c=a.callback)||c.call(a)})};this.trace("sending data chunk of length "+b.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(b,c)}catch(a){this.endCall({code:f.Status.UNAVAILABLE,details:`Write failed with error ${a.message}`,metadata:new g.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}b.Http2SubchannelCall=m},68367:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.isLoadBalancerNameRegistered=b.createLoadBalancer=b.registerDefaultLoadBalancerType=b.registerLoadBalancerType=b.createChildChannelControlHelper=void 0,b.createChildChannelControlHelper=function(a,b){var c,d,e,f,g,h,i,j,k,l;return{createSubchannel:null!=(d=null==(c=b.createSubchannel)?void 0:c.bind(b))?d:a.createSubchannel.bind(a),updateState:null!=(f=null==(e=b.updateState)?void 0:e.bind(b))?f:a.updateState.bind(a),requestReresolution:null!=(h=null==(g=b.requestReresolution)?void 0:g.bind(b))?h:a.requestReresolution.bind(a),addChannelzChild:null!=(j=null==(i=b.addChannelzChild)?void 0:i.bind(b))?j:a.addChannelzChild.bind(a),removeChannelzChild:null!=(l=null==(k=b.removeChannelzChild)?void 0:k.bind(b))?l:a.removeChannelzChild.bind(a)}};let c={},d=null;b.registerLoadBalancerType=function(a,b,d){c[a]={LoadBalancer:b,LoadBalancingConfig:d}},b.registerDefaultLoadBalancerType=function(a){d=a},b.createLoadBalancer=function(a,b){let d=a.getLoadBalancerName();return d in c?new c[d].LoadBalancer(b):null},b.isLoadBalancerNameRegistered=function(a){return a in c},b.getFirstUsableConfig=function(a,b=!1){for(let b of a)if(b.getLoadBalancerName()in c)return b;return b&&d?new c[d].LoadBalancingConfig:null},b.validateLoadBalancingConfig=function(a){if(null===a||"object"!=typeof a)throw Error("Load balancing config must be an object");let b=Object.keys(a);if(1!==b.length)throw Error("Provided load balancing config has multiple conflicting entries");let d=b[0];if(d in c)return c[d].LoadBalancingConfig.createFromJson(a[d]);throw Error(`Unrecognized load balancing config name ${d}`)}},69285:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChildLoadBalancerHandler=void 0;let d=c(68367),e=c(96699),f="child_load_balancer_helper";class g{constructor(a){this.channelControlHelper=a,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(a){this.parent=a,this.child=null}createSubchannel(a,b){return this.parent.channelControlHelper.createSubchannel(a,b)}updateState(a,b){var c;if(this.calledByPendingChild()){if(a===e.ConnectivityState.CONNECTING)return;null==(c=this.parent.currentChild)||c.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(a,b)}requestReresolution(){var a;let b=null!=(a=this.parent.pendingChild)?a:this.parent.currentChild;this.child===b&&this.parent.channelControlHelper.requestReresolution()}setChild(a){this.child=a}addChannelzChild(a){this.parent.channelControlHelper.addChannelzChild(a)}removeChannelzChild(a){this.parent.channelControlHelper.removeChannelzChild(a)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(a,b){return a.getLoadBalancerName()!==b.getLoadBalancerName()}updateAddressList(a,b,c){let e;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,b)){let a=new this.ChildPolicyHelper(this),c=(0,d.createLoadBalancer)(b,a);a.setChild(c),null===this.currentChild?(this.currentChild=c,e=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=c,e=this.pendingChild)}else e=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=b,e.updateAddressList(a,b,c)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return f}}b.ChildLoadBalancerHandler=g},70051:(a,b)=>{"use strict";var c=b,d=c.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},e=c.normalize=function(a){var b=(a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),c=d(a),e="";c&&(e=b.shift()+"/");for(var f=0;f<b.length;)".."===b[f]?f>0&&".."!==b[f-1]?b.splice(--f,2):c?b.splice(f,1):++f:"."===b[f]?b.splice(f,1):++f;return e+b.join("/")};c.resolve=function(a,b,c){return(c||(b=e(b)),d(b))?b:(c||(a=e(a)),(a=a.replace(/(?:\/|^)[^/]+$/,"")).length?e(a+"/"+b):b)}},70440:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(97523);let e=async a=>{let b={type:"image/x-icon",sizes:"16x16"},c=(0,d.fillMetadataSegment)(".",await a.params,"favicon.ico");return[{...b,url:c+""}]}},71600:(a,b,c)=>{"use strict";a.exports=h;var d=c(27791),e=c(18657),f=c(90290);function g(a){return"missing required '"+a.name+"'"}function h(a){for(var b=f.codegen(["r","l","e"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),c=0;c<a.fieldsArray.length;++c){var h=a._fieldsArray[c].resolve(),i=h.resolvedType instanceof d?"int32":h.type,j="m"+f.safeProp(h.name);b("case %i: {",h.id),h.map?(b("if(%s===util.emptyObject)",j)("%s={}",j)("var c2 = r.uint32()+r.pos"),void 0!==e.defaults[h.keyType]?b("k=%j",e.defaults[h.keyType]):b("k=null"),void 0!==e.defaults[i]?b("value=%j",e.defaults[i]):b("value=null"),b("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",h.keyType)("case 2:"),void 0===e.basic[i]?b("value=types[%i].decode(r,r.uint32())",c):b("value=r.%s()",i),b("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==e.long[h.keyType]?b('%s[typeof k==="object"?util.longToHash(k):k]=value',j):b("%s[k]=value",j)):h.repeated?(b("if(!(%s&&%s.length))",j,j)("%s=[]",j),void 0!==e.packed[i]&&b("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",j,i)("}else"),void 0===e.basic[i]?b(h.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",j,c):b("%s.push(r.%s())",j,i)):void 0===e.basic[i]?b(h.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",j,c):b("%s=r.%s()",j,i),b("break")("}")}for(b("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var k=a._fieldsArray[c];k.required&&b("if(!m.hasOwnProperty(%j))",k.name)("throw util.ProtocolError(%j,{instance:m})",g(k))}return b("return m")}},72222:(a,b,c)=>{"use strict";q={value:!0},q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=b.ex=q=q=q=q=q=q=b.OS=b.z3=void 0;let d=c(98079);q={enumerable:!0,get:function(){return d.CallCredentials}};let e=c(95749);q={enumerable:!0,get:function(){return e.ChannelImplementation}};let f=c(1887);q={enumerable:!0,get:function(){return f.CompressionAlgorithms}};let g=c(96699);q={enumerable:!0,get:function(){return g.ConnectivityState}};let h=c(55382);q={enumerable:!0,get:function(){return h.ChannelCredentials}};let i=c(44719);q={enumerable:!0,get:function(){return i.Client}};let j=c(50615);q={enumerable:!0,get:function(){return j.LogVerbosity}},q={enumerable:!0,get:function(){return j.Status}},q={enumerable:!0,get:function(){return j.Propagate}};let k=c(18031),l=c(32888);Object.defineProperty(b,"ex",{enumerable:!0,get:function(){return l.loadPackageDefinition}}),q={enumerable:!0,get:function(){return l.makeClientConstructor}},q={enumerable:!0,get:function(){return l.makeClientConstructor}};let m=c(64105);Object.defineProperty(b,"OS",{enumerable:!0,get:function(){return m.Metadata}});let n=c(78643);q={enumerable:!0,get:function(){return n.Server}};let o=c(17900);q={enumerable:!0,get:function(){return o.ServerCredentials}};let p=c(92788);q={enumerable:!0,get:function(){return p.StatusBuilder}},b.z3={combineChannelCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),combineCallCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),createInsecure:h.ChannelCredentials.createInsecure,createSsl:h.ChannelCredentials.createSsl,createFromSecureContext:h.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:d.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:d.CallCredentials.createFromGoogleCredential,createEmpty:d.CallCredentials.createEmpty},q=a=>a.close(),q=(a,b,c)=>a.waitForReady(b,c),q=(a,b)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=(a,b,c)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=a=>{k.setLogger(a)},q=a=>{k.setLoggerVerbosity(a)};var q=a=>i.Client.prototype.getChannel.call(a),r=c(77232);q={enumerable:!0,get:function(){return r.ListenerBuilder}},q={enumerable:!0,get:function(){return r.RequesterBuilder}},q={enumerable:!0,get:function(){return r.InterceptingCall}},q={enumerable:!0,get:function(){return r.InterceptorConfigurationError}};var s=c(10811);q={enumerable:!0,get:function(){return s.getChannelzServiceDefinition}},q={enumerable:!0,get:function(){return s.getChannelzHandlers}};var t=c(64149);q={enumerable:!0,get:function(){return t.addAdminServicesToServer}},q=c(35370);let u=c(55588),v=c(39929),w=c(72814),x=c(31834),y=c(65487),z=c(92812),A=c(10811);(()=>{u.setup(),v.setup(),w.setup(),x.setup(),y.setup(),z.setup(),A.setup()})()},72451:a=>{"use strict";a.exports=d;var b,c=/\/|\./;function d(a,b){c.test(a)||(a="google/protobuf/"+a+".proto",b={nested:{google:{nested:{protobuf:{nested:b}}}}}),d[a]=b}d("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),d("duration",{Duration:b={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),d("timestamp",{Timestamp:b}),d("empty",{Empty:{fields:{}}}),d("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),d("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),d("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),d.get=function(a){return d[a]||null}},72481:(a,b,c)=>{"use strict";a.exports=j,j.className="ReflectionObject";let d=c(67369);var e,f=c(90290),g={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},h={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},i={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function j(a,b){if(!f.isString(a))throw TypeError("name must be a string");if(b&&!f.isObject(b))throw TypeError("options must be an object");this.options=b,this.parsedOptions=null,this.name=a,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(j.prototype,{root:{get:function(){for(var a=this;null!==a.parent;)a=a.parent;return a}},fullName:{get:function(){for(var a=[this.name],b=this.parent;b;)a.unshift(b.name),b=b.parent;return a.join(".")}}}),j.prototype.toJSON=function(){throw Error()},j.prototype.onAdd=function(a){this.parent&&this.parent!==a&&this.parent.remove(this),this.parent=a,this.resolved=!1;var b=a.root;b instanceof e&&b._handleAdd(this)},j.prototype.onRemove=function(a){var b=a.root;b instanceof e&&b._handleRemove(this),this.parent=null,this.resolved=!1},j.prototype.resolve=function(){return this.resolved||this.root instanceof e&&(this.resolved=!0),this},j.prototype._resolveFeaturesRecursive=function(a){return this._resolveFeatures(this._edition||a)},j.prototype._resolveFeatures=function(a){if(!this._featuresResolved){var b={};if(!a)throw Error("Unknown edition for "+this.fullName);var c=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(a));if(this._edition){if("proto2"===a)b=Object.assign({},h);else if("proto3"===a)b=Object.assign({},i);else if("2023"===a)b=Object.assign({},g);else throw Error("Unknown edition: "+a);this._features=Object.assign(b,c||{}),this._featuresResolved=!0;return}if(this.partOf instanceof d){var e=Object.assign({},this.partOf._features);this._features=Object.assign(e,c||{})}else if(this.declaringField);else if(this.parent){var f=Object.assign({},this.parent._features);this._features=Object.assign(f,c||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},j.prototype._inferLegacyProtoFeatures=function(){return{}},j.prototype.getOption=function(a){if(this.options)return this.options[a]},j.prototype.setOption=function(a,b,c){return this.options||(this.options={}),/^features\./.test(a)?f.setProperty(this.options,a,b,c):c&&void 0!==this.options[a]||(this.getOption(a)!==b&&(this.resolved=!1),this.options[a]=b),this},j.prototype.setParsedOption=function(a,b,c){this.parsedOptions||(this.parsedOptions=[]);var d=this.parsedOptions;if(c){var e=d.find(function(b){return Object.prototype.hasOwnProperty.call(b,a)});if(e){var g=e[a];f.setProperty(g,c,b)}else(e={})[a]=f.setProperty({},c,b),d.push(e)}else{var h={};h[a]=b,d.push(h)}return this},j.prototype.setOptions=function(a,b){if(a)for(var c=Object.keys(a),d=0;d<c.length;++d)this.setOption(c[d],a[c[d]],b);return this},j.prototype.toString=function(){var a=this.constructor.className,b=this.fullName;return b.length?a+" "+b:a},j.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},j._configure=function(a){e=a}},72814:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(91645),e=c(50615),f=c(64105),g=c(9114),h=c(25554),i=c(18031),j="ip_resolver";function k(a){i.trace(e.LogVerbosity.DEBUG,j,a)}let l="ipv4",m="ipv6",n=443;class o{constructor(a,b,c){var g;this.listener=b,this.addresses=[],this.error=null,this.hasReturnedResult=!1,k("Resolver constructed for target "+(0,h.uriToString)(a));let i=[];if(a.scheme!==l&&a.scheme!==m){this.error={code:e.Status.UNAVAILABLE,details:`Unrecognized scheme ${a.scheme} in IP resolver`,metadata:new f.Metadata};return}for(let b of a.path.split(",")){let c=(0,h.splitHostPort)(b);if(null===c||a.scheme===l&&!(0,d.isIPv4)(c.host)||a.scheme===m&&!(0,d.isIPv6)(c.host)){this.error={code:e.Status.UNAVAILABLE,details:`Failed to parse ${a.scheme} address ${b}`,metadata:new f.Metadata};return}i.push({host:c.host,port:null!=(g=c.port)?g:n})}this.addresses=i,k("Parsed "+a.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(a){return a.path.split(",")[0]}}b.setup=function(){(0,g.registerResolver)(l,o),(0,g.registerResolver)(m,o)}},73212:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getSubchannelPool=b.SubchannelPool=void 0;let d=c(99130),e=c(84177),f=c(24204),g=c(25554),h=c(14299),i=1e4;class j{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let a=!0;for(let b in this.pool){let c=this.pool[b].filter(a=>!a.subchannel.unrefIfOneRef());c.length>0&&(a=!1),this.pool[b]=c}a&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var a,b;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},i),null==(b=(a=this.cleanupTimer).unref)||b.call(a))}getOrCreateSubchannel(a,b,c,i){this.ensureCleanupTask();let j=(0,g.uriToString)(a);if(j in this.pool){for(let a of this.pool[j])if((0,f.subchannelAddressEqual)(b,a.subchannelAddress)&&(0,d.channelOptionsEqual)(c,a.channelArguments)&&i._equals(a.channelCredentials))return a.subchannel}let k=new e.Subchannel(a,b,c,i,new h.Http2SubchannelConnector(a));return j in this.pool||(this.pool[j]=[]),this.pool[j].push({subchannelAddress:b,channelArguments:c,channelCredentials:i,subchannel:k}),k.ref(),k}}b.SubchannelPool=j;let k=new j;b.getSubchannelPool=function(a){return a?k:new j}},73496:a=>{"use strict";a.exports=require("http2")},74075:a=>{"use strict";a.exports=require("zlib")},74915:(a,b,c)=>{"use strict";b.Service=c(40543)},75005:(a,b,c)=>{"use strict";var d=a.exports=c(93686);function e(a,b,c){return"function"==typeof b?(c=b,b=new d.Root):b||(b=new d.Root),b.load(a,c)}function f(a,b){return b||(b=new d.Root),b.loadSync(a)}d.build="light",d.load=e,d.loadSync=f,d.encoder=c(23464),d.decoder=c(71600),d.verifier=c(6620),d.converter=c(6792),d.ReflectionObject=c(72481),d.Namespace=c(26991),d.Root=c(31502),d.Enum=c(27791),d.Type=c(68134),d.Field=c(99408),d.OneOf=c(67369),d.MapField=c(49316),d.Service=c(25811),d.Method=c(23455),d.Message=c(4755),d.wrappers=c(19006),d.types=c(18657),d.util=c(90290),d.ReflectionObject._configure(d.Root),d.Namespace._configure(d.Type,d.Service,d.Enum),d.Root._configure(d.Type),d.Field._configure(d.Type)},75645:(a,b,c)=>{"use strict";a.exports=i;var d,e=c(60054),f=e.LongBits,g=e.utf8;function h(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function i(a){this.buf=a,this.pos=0,this.len=a.length}var j="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new i(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new i(a);throw Error("illegal buffer")},k=function(){return e.Buffer?function(a){return(i.create=function(a){return e.Buffer.isBuffer(a)?new d(a):j(a)})(a)}:j};function l(){var a=new f(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw h(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}if(this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw h(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function m(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function n(){if(this.pos+8>this.len)throw h(this,8);return new f(m(this.buf,this.pos+=4),m(this.buf,this.pos+=4))}i.create=k(),i.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,i.prototype.uint32=function(){var a=0xffffffff;return function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return a;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return a}}(),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var a=this.uint32();return a>>>1^-(1&a)},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return m(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|m(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var a=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},i.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var a=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},i.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw h(this,a);if(this.pos+=a,Array.isArray(this.buf))return this.buf.slice(b,c);if(b===c){var d=e.Buffer;return d?d.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,b,c)},i.prototype.string=function(){var a=this.bytes();return g.read(a,0,a.length)},i.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw h(this,a);this.pos+=a}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},i._configure=function(a){d=a,i.create=k(),d._configure();var b=e.Long?"toLong":"toNumber";e.merge(i.prototype,{int64:function(){return l.call(this)[b](!1)},uint64:function(){return l.call(this)[b](!0)},sint64:function(){return l.call(this).zzDecode()[b](!1)},fixed64:function(){return n.call(this)[b](!0)},sfixed64:function(){return n.call(this)[b](!1)}})}},75956:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.isDuration=b.durationToMs=b.msToDuration=void 0,b.msToDuration=function(a){return{seconds:a/1e3|0,nanos:a%1e3*1e6|0}},b.durationToMs=function(a){return 1e3*a.seconds+a.nanos/1e6|0},b.isDuration=function(a){return"number"==typeof a.seconds&&"number"==typeof a.nanos}},76043:a=>{"use strict";a.exports=l;var b=/[\s{}=;:[\],'"()<>]/g,c=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,d=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,e=/^ *[*/]+ */,f=/^\s*\*?\/*/,g=/\n/g,h=/\s/,i=/\\(.?)/g,j={0:"\0",r:"\r",n:"\n",t:"	"};function k(a){return a.replace(i,function(a,b){switch(b){case"\\":case"":return b;default:return j[b]||""}})}function l(a,i){a=a.toString();var j=0,l=a.length,m=1,n=0,o={},p=[],q=null;function r(a){return Error("illegal "+a+" (line "+m+")")}function s(){var b="'"===q?d:c;b.lastIndex=j-1;var e=b.exec(a);if(!e)throw r("string");return j=b.lastIndex,y(q),q=null,k(e[1])}function t(b){return a.charAt(b)}function u(b,c,d){var h,j={type:a.charAt(b++),lineEmpty:!1,leading:d},k=b-(i?2:3);do if(--k<0||"\n"===(h=a.charAt(k))){j.lineEmpty=!0;break}while(" "===h||"	"===h);for(var l=a.substring(b,c).split(g),p=0;p<l.length;++p)l[p]=l[p].replace(i?f:e,"").trim();j.text=l.join("\n").trim(),o[m]=j,n=m}function v(b){var c=w(b),d=a.substring(b,c);return/^\s*\/\//.test(d)}function w(a){for(var b=a;b<l&&"\n"!==t(b);)b++;return b}function x(){if(p.length>0)return p.shift();if(q)return s();var c,d,e,f,g,k=0===j;do{if(j===l)return null;for(c=!1;h.test(e=t(j));)if("\n"===e&&(k=!0,++m),++j===l)return null;if("/"===t(j)){if(++j===l)throw r("comment");if("/"===t(j))if(i){if(f=j,g=!1,v(j-1)){g=!0;do if((j=w(j))===l||(j++,!k))break;while(v(j))}else j=Math.min(l,w(j)+1);g&&(u(f,j,k),k=!0),m++,c=!0}else{for(g="/"===t(f=j+1);"\n"!==t(++j);)if(j===l)return null;++j,g&&(u(f,j-1,k),k=!0),++m,c=!0}else{if("*"!==(e=t(j)))return"/";f=j+1,g=i||"*"===t(f);do{if("\n"===e&&++m,++j===l)throw r("comment");d=e,e=t(j)}while("*"!==d||"/"!==e);++j,g&&(u(f,j-2,k),k=!0),c=!0}}}while(c);var n=j;if(b.lastIndex=0,!b.test(t(n++)))for(;n<l&&!b.test(t(n));)++n;var o=a.substring(j,j=n);return('"'===o||"'"===o)&&(q=o),o}function y(a){p.push(a)}function z(){if(!p.length){var a=x();if(null===a)return null;y(a)}return p[0]}function A(a,b){var c=z();if(c===a)return x(),!0;if(!b)throw r("token '"+c+"', '"+a+"' expected");return!1}function B(a){var b,c=null;return void 0===a?(b=o[m-1],delete o[m-1],b&&(i||"*"===b.type||b.lineEmpty)&&(c=b.leading?b.text:null)):(n<a&&z(),b=o[a],delete o[a],b&&!b.lineEmpty&&(i||"/"===b.type)&&(c=b.leading?null:b.text)),c}return Object.defineProperty({next:x,peek:z,push:y,skip:A,cmnt:B},"line",{get:function(){return m}})}l.unescape=k},76780:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\mmmed\\\\Desktop\\\\Github\\\\naughty-den\\\\src\\\\app\\\\components\\\\PWAInstallPrompt.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\mmmed\\Desktop\\Github\\naughty-den\\src\\app\\components\\PWAInstallPrompt.tsx","default")},76932:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2ServerCallStream=b.ServerDuplexStreamImpl=b.ServerWritableStreamImpl=b.ServerReadableStreamImpl=b.ServerUnaryCallImpl=void 0;let d=c(94735),e=c(73496),f=c(27910),g=c(74075),h=c(50615),i=c(64105),j=c(44333),k=c(18031),l=c(1400),m="server_call";function n(a){k.trace(h.LogVerbosity.DEBUG,m,a)}let o="grpc-message",p="grpc-status",q="grpc-timeout",r=/(\d{1,8})\s*([HMSmun])/,s={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},t={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},u={[e.constants.HTTP2_HEADER_STATUS]:e.constants.HTTP_STATUS_OK,[e.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},v={waitForTrailers:!0};class w extends d.EventEmitter{constructor(a,b,c){super(),this.call=a,this.metadata=b,this.request=c,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerUnaryCallImpl=w;class x extends f.Readable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.deserialize=c,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,d)}_read(a){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerReadableStreamImpl=x;class y extends f.Writable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.request=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(a,b,c){try{let b=this.call.serializeMessage(a);if(!this.call.write(b))return void this.call.once("drain",c)}catch(a){this.emit("error",{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}c()}_final(a){this.call.sendStatus({code:h.Status.OK,details:"OK",metadata:this.trailingMetadata}),a(null)}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerWritableStreamImpl=y;class z extends f.Duplex{constructor(a,b,c,d,e){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.deserialize=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,e),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerDuplexStreamImpl=z,z.prototype._read=x.prototype._read,z.prototype._write=y.prototype._write,z.prototype._final=y.prototype._final;class A extends d.EventEmitter{constructor(a,b,c){super(),this.stream=a,this.handler=b,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=h.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=h.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",a=>{}),this.stream.once("close",()=>{var a;n("Request to method "+(null==(a=this.handler)?void 0:a.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:h.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in c&&(this.maxSendMessageSize=c["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in c&&(this.maxReceiveMessageSize=c["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(a,b){let c=a.subarray(5);if("identity"===b)return c;if("deflate"!==b&&"gzip"!==b)return Promise.reject({code:h.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${b}"`});{let a;return a="deflate"===b?g.createInflate():g.createGunzip(),new Promise((b,d)=>{let e=0,f=[];a.on("data",b=>{f.push(b),e+=b.byteLength,-1!==this.maxReceiveMessageSize&&e>this.maxReceiveMessageSize&&(a.destroy(),d({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),a.on("end",()=>{b(Buffer.concat(f))}),a.write(c),a.end()})}}sendMetadata(a){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let b=a?a.toHttp2Headers():null,c=Object.assign(Object.assign(Object.assign({},u),t),b);this.stream.respond(c,v)}receiveMetadata(a){let b=i.Metadata.fromHttp2Headers(a);k.isTracerEnabled(m)&&n("Request to "+this.handler.path+" received headers "+JSON.stringify(b.toJSON()));let c=b.get(q);if(c.length>0){let a=c[0].toString().match(r);if(null===a){let a=Error("Invalid deadline");return a.code=h.Status.OUT_OF_RANGE,this.sendError(a),b}let d=a[1]*s[a[2]]|0,e=new Date;this.deadline=e.setMilliseconds(e.getMilliseconds()+d),this.deadlineTimer=setTimeout(B,d,this),b.remove(q)}return b.remove(e.constants.HTTP2_HEADER_ACCEPT_ENCODING),b.remove(e.constants.HTTP2_HEADER_TE),b.remove(e.constants.HTTP2_HEADER_CONTENT_TYPE),b.remove("grpc-accept-encoding"),b}receiveUnaryMessage(a){return new Promise((b,c)=>{let{stream:d}=this,e=0,f=this,g=[],i=this.maxReceiveMessageSize;function j(a){if(e+=a.byteLength,-1!==i&&e>i){d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),c({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${e} vs. ${i})`});return}g.push(a)}function k(i){if(d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),void 0!==i)return void c({code:h.Status.INTERNAL,details:i.message});if(0===e)return void c({code:h.Status.INTERNAL,details:"received empty unary message"});f.emit("receiveMessage");let l=Buffer.concat(g,e),m=1===l.readUInt8(0)?a:"identity",n=f.getDecompressedMessage(l,m);if(Buffer.isBuffer(n))return void b(f.deserializeMessageWithInternalError(n));n.then(a=>b(f.deserializeMessageWithInternalError(a)),b=>c(b.code?b:{code:h.Status.INTERNAL,details:`Received "grpc-encoding" header "${a}" but ${a} decompression failed`}))}this.stream.on("data",j),this.stream.on("end",k),this.stream.on("error",k)})}async deserializeMessageWithInternalError(a){try{return this.deserializeMessage(a)}catch(a){throw{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL}}}serializeMessage(a){let b=this.handler.serialize(a),c=b.byteLength,d=Buffer.allocUnsafe(c+5);return d.writeUInt8(0,0),d.writeUInt32BE(c,1),b.copy(d,5),d}deserializeMessage(a){return this.handler.deserialize(a)}async sendUnaryMessage(a,b,c,d){if(!this.checkCancelled()){if(void 0===c&&(c=null),a){!Object.prototype.hasOwnProperty.call(a,"metadata")&&c&&(a.metadata=c),this.sendError(a);return}try{let a=this.serializeMessage(b);this.write(a),this.sendStatus({code:h.Status.OK,details:"OK",metadata:c})}catch(a){this.sendError({details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}}}sendStatus(a){var b,c;if(this.emit("callEnd",a.code),this.emit("streamEnd",a.code===h.Status.OK),!this.checkCancelled())if(n("Request to method "+(null==(b=this.handler)?void 0:b.path)+" ended with status code: "+h.Status[a.code]+" details: "+a.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var b;let c=Object.assign({[p]:a.code,[o]:encodeURI(a.details)},null==(b=a.metadata)?void 0:b.toHttp2Headers());this.stream.sendTrailers(c),this.statusSent=!0}),this.stream.end());else{let b=Object.assign(Object.assign({[p]:a.code,[o]:encodeURI(a.details)},u),null==(c=a.metadata)?void 0:c.toHttp2Headers());this.stream.respond(b,{endStream:!0}),this.statusSent=!0}}sendError(a){let b={code:h.Status.UNKNOWN,details:"message"in a?a.message:"Unknown Error",metadata:"metadata"in a&&void 0!==a.metadata?a.metadata:null};"code"in a&&"number"==typeof a.code&&Number.isInteger(a.code)&&(b.code=a.code,"details"in a&&"string"==typeof a.details&&(b.details=a.details)),this.sendStatus(b)}write(a){if(!this.checkCancelled())return -1!==this.maxSendMessageSize&&a.length>this.maxSendMessageSize?void this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${a.length} vs. ${this.maxSendMessageSize})`}):(this.sendMetadata(),this.emit("sendMessage"),this.stream.write(a))}resume(){this.stream.resume()}setupSurfaceCall(a){this.once("cancelled",b=>{a.cancelled=!0,a.emit("cancelled",b)}),this.once("callEnd",b=>a.emit("callEnd",b))}setupReadable(a,b){let c=new j.StreamDecoder(this.maxReceiveMessageSize),d=!1,e=!1,f=!1,g=async()=>{f||!d||e||(f=!0,await this.pushOrBufferMessage(a,null))};this.stream.on("data",async d=>{let f;try{f=c.write(d)}catch(a){this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:a.message});return}for(let c of(e=!0,this.stream.pause(),f)){let d;this.emit("receiveMessage");let e=1===c.readUInt8(0)?b:"identity";try{d=await this.getDecompressedMessage(c,e)}catch(a){this.sendError(a);return}if(!d)return;await this.pushOrBufferMessage(a,d)}e=!1,this.stream.resume(),await g()}),this.stream.once("end",async()=>{d=!0,await g()})}consumeUnpushedMessages(a){for(this.canPush=!0;this.messagesToPush.length>0;){let b=this.messagesToPush.shift(),c=a.push(b);if(null===b||!1===c){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(a,b){this.isPushPending?this.bufferedMessages.push(b):await this.pushMessage(a,b)}async pushMessage(a,b){if(null===b){n("Received end of stream"),this.canPush?a.push(null):this.messagesToPush.push(null);return}n("Received message of length "+b.length),this.isPushPending=!0;try{let c=await this.deserializeMessage(b);this.canPush?a.push(c)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(c)}catch(c){this.bufferedMessages.length=0;let b=(0,l.getErrorCode)(c);(null===b||b<h.Status.OK||b>h.Status.UNAUTHENTICATED)&&(b=h.Status.INTERNAL),a.emit("error",{details:(0,l.getErrorMessage)(c),code:b})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(a,this.bufferedMessages.shift())}getPeer(){var a;let b=null==(a=this.stream.session)?void 0:a.socket;return null!=b&&b.remoteAddress?b.remotePort?`${b.remoteAddress}:${b.remotePort}`:b.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function B(a){let b=Error("Deadline exceeded");b.code=h.Status.DEADLINE_EXCEEDED,a.sendError(b),a.cancelled=!0,a.emit("cancelled","deadline")}b.Http2ServerCallStream=A},77232:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getInterceptingCall=b.InterceptingCall=b.RequesterBuilder=b.ListenerBuilder=b.InterceptorConfigurationError=void 0;let d=c(64105),e=c(64022),f=c(50615),g=c(1400);class h extends Error{constructor(a){super(a),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,h)}}b.InterceptorConfigurationError=h;class i{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(a){return this.metadata=a,this}withOnReceiveMessage(a){return this.message=a,this}withOnReceiveStatus(a){return this.status=a,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}b.ListenerBuilder=i;class j{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(a){return this.start=a,this}withSendMessage(a){return this.message=a,this}withHalfClose(a){return this.halfClose=a,this}withCancel(a){return this.cancel=a,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}b.RequesterBuilder=j;let k={onReceiveMetadata:(a,b)=>{b(a)},onReceiveMessage:(a,b)=>{b(a)},onReceiveStatus:(a,b)=>{b(a)}},l={start:(a,b,c)=>{c(a,b)},sendMessage:(a,b)=>{b(a)},halfClose:a=>{a()},cancel:a=>{a()}};class m{constructor(a,b){var c,d,e,f;this.nextCall=a,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,b?this.requester={start:null!=(c=b.start)?c:l.start,sendMessage:null!=(d=b.sendMessage)?d:l.sendMessage,halfClose:null!=(e=b.halfClose)?e:l.halfClose,cancel:null!=(f=b.cancel)?f:l.cancel}:this.requester=l}cancelWithStatus(a,b){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(a,b)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(a,b){var c,d,f,g,h,i;let j={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:null!=(g=null==(f=null==b?void 0:b.onReceiveMessage)?void 0:f.bind(b))?g:a=>{},onReceiveStatus:null!=(i=null==(h=null==b?void 0:b.onReceiveStatus)?void 0:h.bind(b))?i:a=>{}};this.processingMetadata=!0,this.requester.start(a,j,(a,b)=>{var c,d,f;let g;if(this.processingMetadata=!1,(0,e.isInterceptingListener)(b))g=b;else{let a={onReceiveMetadata:null!=(c=b.onReceiveMetadata)?c:k.onReceiveMetadata,onReceiveMessage:null!=(d=b.onReceiveMessage)?d:k.onReceiveMessage,onReceiveStatus:null!=(f=b.onReceiveStatus)?f:k.onReceiveStatus};g=new e.InterceptingListenerImpl(a,j)}this.nextCall.start(a,g),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(a,b){this.processingMessage=!0,this.requester.sendMessage(b,c=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=a,this.pendingMessage=b):(this.nextCall.sendMessageWithContext(a,c),this.processPendingHalfClose())})}sendMessage(a){this.sendMessageWithContext({},a)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function n(a,b,c){var d,e;let f=null!=(d=c.deadline)?d:1/0,g=c.host,h=null!=(e=c.parent)?e:null,i=c.propagate_flags,j=c.credentials,k=a.createCall(b,f,g,h,i);return j&&k.setCredentials(j),k}b.InterceptingCall=m;class o{constructor(a,b){this.call=a,this.methodDefinition=b}cancelWithStatus(a,b){this.call.cancelWithStatus(a,b)}getPeer(){return this.call.getPeer()}sendMessageWithContext(a,b){let c;try{c=this.methodDefinition.requestSerialize(b)}catch(a){this.call.cancelWithStatus(f.Status.INTERNAL,`Request message serialization failure: ${(0,g.getErrorMessage)(a)}`);return}this.call.sendMessageWithContext(a,c)}sendMessage(a){this.sendMessageWithContext({},a)}start(a,b){let c=null;this.call.start(a,{onReceiveMetadata:a=>{var c;null==(c=null==b?void 0:b.onReceiveMetadata)||c.call(b,a)},onReceiveMessage:a=>{var e;let h;try{h=this.methodDefinition.responseDeserialize(a)}catch(a){c={code:f.Status.INTERNAL,details:`Response message parsing error: ${(0,g.getErrorMessage)(a)}`,metadata:new d.Metadata},this.call.cancelWithStatus(c.code,c.details);return}null==(e=null==b?void 0:b.onReceiveMessage)||e.call(b,h)},onReceiveStatus:a=>{var d,e;c?null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,c):null==(e=null==b?void 0:b.onReceiveStatus)||e.call(b,a)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class p extends o{constructor(a,b){super(a,b)}start(a,b){var c,d;let e=!1,f={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:a=>{var c;e=!0,null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,a)},onReceiveStatus:a=>{var c,d;e||null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,null),null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,a)}};super.start(a,f),this.call.startRead()}}class q extends o{}function r(a,b,c){let d=n(a,c.path,b);return c.responseStream?new q(d,c):new p(d,c)}b.getInterceptingCall=function(a,b,c,d){if(a.clientInterceptors.length>0&&a.clientInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(a.callInterceptors.length>0&&a.callInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let e=[];e=a.callInterceptors.length>0||a.callInterceptorProviders.length>0?[].concat(a.callInterceptors,a.callInterceptorProviders.map(a=>a(b))).filter(a=>a):[].concat(a.clientInterceptors,a.clientInterceptorProviders.map(a=>a(b))).filter(a=>a);let f=Object.assign({},c,{method_definition:b});return e.reduceRight((a,b)=>c=>b(c,a),a=>r(d,a,b))(f)}},78643:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Server=void 0;let d=c(73496),e=c(50615),f=c(76932),g=c(17900),h=c(9114),i=c(18031),j=c(24204),k=c(25554),l=c(10811),m=0x7fffffff,n=0x7fffffff,o=2e4,{HTTP2_HEADER_PATH:p}=d.constants,q="server";function r(){}function s(a){return{code:e.Status.UNIMPLEMENTED,details:`The server does not implement the method ${a}`}}function t(a,b){let c=s(b);switch(a){case"unary":return(a,b)=>{b(c,null)};case"clientStream":return(a,b)=>{b(c,null)};case"serverStream":return a=>{a.emit("error",c)};case"bidi":return a=>{a.emit("error",c)};default:throw Error(`Invalid handlerType ${a}`)}}class u{constructor(a){var b,c,d,e;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new l.ChannelzTrace,this.callTracker=new l.ChannelzCallTracker,this.listenerChildrenTracker=new l.ChannelzChildrenTracker,this.sessionChildrenTracker=new l.ChannelzChildrenTracker,this.options=null!=a?a:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,l.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!=(b=this.options["grpc.max_connection_age_ms"])?b:m,this.maxConnectionAgeGraceMs=null!=(c=this.options["grpc.max_connection_age_grace_ms"])?c:m,this.keepaliveTimeMs=null!=(d=this.options["grpc.keepalive_time_ms"])?d:n,this.keepaliveTimeoutMs=null!=(e=this.options["grpc.keepalive_timeout_ms"])?e:o,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(a){return()=>{var b,c,d;let e,f=this.sessions.get(a),g=a.socket,h=g.remoteAddress?(0,j.stringToSubchannelAddress)(g.remoteAddress,g.remotePort):null,i=g.localAddress?(0,j.stringToSubchannelAddress)(g.localAddress,g.localPort):null;if(a.encrypted){let a=g,c=a.getCipher(),d=a.getCertificate(),f=a.getPeerCertificate();e={cipherSuiteStandardName:null!=(b=c.standardName)?b:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else e=null;return{remoteAddress:h,localAddress:i,security:e,remoteName:null,streamsStarted:f.streamTracker.callsStarted,streamsSucceeded:f.streamTracker.callsSucceeded,streamsFailed:f.streamTracker.callsFailed,messagesSent:f.messagesSent,messagesReceived:f.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:f.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:f.lastMessageSentTimestamp,lastMessageReceivedTimestamp:f.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(c=a.state.localWindowSize)?c:null,remoteFlowControlWindow:null!=(d=a.state.remoteWindowSize)?d:null}}}trace(a){i.trace(e.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+a)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(a,b){if(null===a||"object"!=typeof a||null===b||"object"!=typeof b)throw Error("addService() requires two objects as arguments");let c=Object.keys(a);if(0===c.length)throw Error("Cannot add an empty service to a server");c.forEach(c=>{let d,e,f=a[c];d=f.requestStream?f.responseStream?"bidi":"clientStream":f.responseStream?"serverStream":"unary";let g=b[c];if(void 0===g&&"string"==typeof f.originalName&&(g=b[f.originalName]),e=void 0!==g?g.bind(b):t(d,c),!1===this.register(f.path,e,f.responseSerialize,f.requestDeserialize,d))throw Error(`Method handler for ${f.path} already provided.`)})}removeService(a){if(null===a||"object"!=typeof a)throw Error("removeService() requires object as argument");Object.keys(a).forEach(b=>{let c=a[b];this.unregister(c.path)})}bind(a,b){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(a,b,c){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof a)throw TypeError("port must be a string");if(null===b||!(b instanceof g.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof c)throw TypeError("callback must be a function");let f=(0,k.parseUri)(a);if(null===f)throw Error(`Could not parse port "${a}"`);let m=(0,h.mapUriDefaultScheme)(f);if(null===m)throw Error(`Could not get a default scheme for port "${a}"`);let n={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?n.maxSessionMemory=this.options["grpc-node.max_session_memory"]:n.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(n.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(a,b)=>{process.nextTick(()=>c(a,b))},p=()=>{let a;if(b._isSecure()){let c=Object.assign(n,b._getSettings());c.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(a=d.createSecureServer(c)).on("secureConnection",a=>{a.on("error",a=>{this.trace("An incoming TLS connection closed with error: "+a.message)})})}else a=d.createServer(n);return a.setTimeout(0,r),this._setupHandlers(a),a},q=(a,b,c)=>0===a.length?Promise.resolve({port:b,count:c}):Promise.all(a.map(a=>{let c;this.trace("Attempting to bind "+(0,j.subchannelAddressToString)(a)),c=(0,j.isTcpSubchannelAddress)(a)?{host:a.host,port:b}:a;let d=p();return new Promise((e,f)=>{let g=b=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(a)+" with error "+b.message),e(b)};d.once("error",g),d.listen(c,()=>{let a;if(this.shutdown){d.close(),e(Error("bindAsync failed because server is shutdown"));return}let c=d.address();a="string"==typeof c?{path:c}:{host:c.address,port:c.port};let f=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(a),()=>({localAddress:a,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(f),this.http2ServerList.push({server:d,channelzRef:f}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(a)),e("port"in a?a.port:b),d.removeListener("error",g)})})})).then(a=>{let d=0;for(let c of a)if("number"==typeof c&&(d+=1,c!==b))throw Error("Invalid state: multiple port numbers added from single address");return{port:b,count:d+c}}),s=a=>{if(0===a.length)return Promise.resolve({port:0,count:0});let b=a[0],c=p();return new Promise((d,e)=>{let f=c=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(b)+" with error "+c.message),d(s(a.slice(1)))};c.once("error",f),c.listen(b,()=>{if(this.shutdown){c.close(),d({port:0,count:0});return}let b=c.address(),e={host:b.address,port:b.port},g=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(g),this.http2ServerList.push({server:c,channelzRef:g}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(e)),d(q(a.slice(1),b.port,1)),c.removeListener("error",f)})})},t={onSuccessfulResolution:(b,c,d)=>{let f;if(t.onSuccessfulResolution=()=>{},this.shutdown&&o(Error("bindAsync failed because server is shutdown"),0),0===b.length)return void o(Error(`No addresses resolved for port ${a}`),0);(f=(0,j.isTcpSubchannelAddress)(b[0])?0===b[0].port?s(b):q(b,b[0].port,0):q(b,1,0)).then(a=>{if(0===a.count){let a=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,a),o(Error(a),0)}else a.count<b.length&&i.log(e.LogVerbosity.INFO,`WARNING Only ${a.count} addresses added out of total ${b.length} resolved`),o(null,a.port)},a=>{let c=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,c),o(Error(c),0)})},onError:a=>{o(Error(a.details),0)}};(0,h.createResolver)(m,t,this.options).updateResolution()}forceShutdown(){for(let{server:a,channelzRef:b}of this.http2ServerList)a.listening&&a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b))});this.started=!1,this.shutdown=!0,this.sessions.forEach((a,b)=>{b.destroy(d.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef)}register(a,b,c,d,e){return!this.handlers.has(a)&&(this.handlers.set(a,{func:b,serialize:c,deserialize:d,type:e,path:a}),!0)}unregister(a){return this.handlers.delete(a)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:a})=>!0!==a.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(a){let b=b=>{this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef),a(b)},c=0;function d(){0==--c&&b()}for(let{server:a,channelzRef:b}of(this.started=!1,this.shutdown=!0,this.http2ServerList))a.listening&&(c++,a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b)),d()}));this.sessions.forEach((a,b)=>{b.closed||(c+=1,b.close(d))}),0===c&&b()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(a,b){let c=b[d.constants.HTTP2_HEADER_CONTENT_TYPE];return"string"==typeof c&&!!c.startsWith("application/grpc")||(a.respond({[d.constants.HTTP2_HEADER_STATUS]:d.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(a){this.trace("Received call to method "+a+" at address "+this.serverAddressString);let b=this.handlers.get(a);return void 0===b?(this.trace("No handler registered for method "+a+". Sending UNIMPLEMENTED status."),null):b}_respondWithError(a,b,c=null){let d=new f.Http2ServerCallStream(b,null,this.options);void 0===a.code&&(a.code=e.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed()),d.sendError(a)}_channelzHandler(a,b){let c=this.sessions.get(a.session);if(this.callTracker.addCallStarted(),null==c||c.streamTracker.addCallStarted(),!this._verifyContentType(a,b)){this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed();return}let d=b[p],g=this._retrieveHandler(d);if(!g)return void this._respondWithError(s(d),a,c);let h=new f.Http2ServerCallStream(a,g,this.options);h.once("callEnd",a=>{a===e.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),c&&(h.once("streamEnd",a=>{a?c.streamTracker.addCallSucceeded():c.streamTracker.addCallFailed()}),h.on("sendMessage",()=>{c.messagesSent+=1,c.lastMessageSentTimestamp=new Date}),h.on("receiveMessage",()=>{c.messagesReceived+=1,c.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(h,g,b)||(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed(),h.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${g.type}`}))}_streamHandler(a,b){if(!0!==this._verifyContentType(a,b))return;let c=b[p],d=this._retrieveHandler(c);if(!d)return void this._respondWithError(s(c),a,null);let g=new f.Http2ServerCallStream(a,d,this.options);this._runHandlerForCall(g,d,b)||g.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${d.type}`})}_runHandlerForCall(a,b,c){var d;let e=a.receiveMetadata(c),f=null!=(d=e.get("grpc-encoding")[0])?d:"identity";e.remove("grpc-encoding");let{type:g}=b;if("unary"===g)v(a,b,e,f);else if("clientStream"===g)w(a,b,e,f);else if("serverStream"===g)x(a,b,e,f);else{if("bidi"!==g)return!1;y(a,b,e,f)}return!0}_setupHandlers(a){if(null===a)return;let b=a.address(),c="null";b&&(c="string"==typeof b?b:b.address+":"+b.port),this.serverAddressString=c;let e=this.channelzEnabled?this._channelzHandler:this._streamHandler;a.on("stream",e.bind(this)),a.on("session",a=>{var b,c,e,f,g;if(!this.started)return void a.destroy();let h=(0,l.registerChannelzSocket)(null!=(b=a.socket.remoteAddress)?b:"unknown",this.getChannelzSessionInfoGetter(a),this.channelzEnabled),i={ref:h,streamTracker:new l.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(a,i);let j=a.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+j),this.sessionChildrenTracker.refChild(h));let k=null,n=null,o=!1;if(this.maxConnectionAgeMs!==m){let b=this.maxConnectionAgeMs/10,f=Math.random()*b*2-b;k=null==(e=(c=setTimeout(()=>{var b,c;o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+j);try{a.goaway(d.constants.NGHTTP2_NO_ERROR,0x7fffffff,Buffer.from("max_age"))}catch(b){a.destroy();return}a.close(),this.maxConnectionAgeGraceMs!==m&&(n=null==(c=(b=setTimeout(()=>{a.destroy()},this.maxConnectionAgeGraceMs)).unref)?void 0:c.call(b))},this.maxConnectionAgeMs+f)).unref)?void 0:e.call(c)}let p=null==(g=(f=setInterval(()=>{var b,c;let d=null==(c=(b=setTimeout(()=>{o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+j),a.close()},this.keepaliveTimeoutMs)).unref)?void 0:c.call(b);try{a.ping((a,b,c)=>{clearTimeout(d)})}catch(b){a.destroy()}},this.keepaliveTimeMs)).unref)?void 0:g.call(f);a.on("close",()=>{this.channelzEnabled&&(o||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+j),this.sessionChildrenTracker.unrefChild(h),(0,l.unregisterChannelzRef)(h)),k&&clearTimeout(k),n&&clearTimeout(n),p&&clearTimeout(p),this.sessions.delete(a)})})}}async function v(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerUnaryCallImpl(a,c,e);b.func(g,(b,c,d,e)=>{a.sendUnaryMessage(b,c,d,e)})}catch(b){a.sendError(b)}}function w(a,b,c,d){let e=new f.ServerReadableStreamImpl(a,c,b.deserialize,d);function g(b,c,d,f){e.destroy(),a.sendUnaryMessage(b,c,d,f)}a.cancelled||(e.on("error",g),b.func(e,g))}async function x(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerWritableStreamImpl(a,c,b.serialize,e);b.func(g)}catch(b){a.sendError(b)}}function y(a,b,c,d){let e=new f.ServerDuplexStreamImpl(a,c,b.serialize,b.deserialize,d);a.cancelled||b.func(e)}b.Server=u},78757:(a,b)=>{"use strict";function c(a){let{widthInt:b,heightInt:c,blurWidth:d,blurHeight:e,blurDataURL:f,objectFit:g}=a,h=d?40*d:b,i=e?40*e:c,j=h&&i?"viewBox='0 0 "+h+" "+i+"'":"",k=j?"none":"contain"===g?"xMidYMid":"cover"===g?"xMidYMid slice":"none";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+j+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+k+"' style='filter: url(%23b);' href='"+f+"'/%3E%3C/svg%3E"}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"getImageBlurSvg",{enumerable:!0,get:function(){return c}})},79546:(a,b,c)=>{"use strict";a.exports=f;var d=c(75645);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(60054);function f(a){d.call(this,a)}f._configure=function(){e.Buffer&&(f.prototype._slice=e.Buffer.prototype.slice)},f.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},f._configure()},79551:a=>{"use strict";a.exports=require("url")},79622:(a,b,c)=>{"use strict";c.d(b,{default:()=>f});var d=c(21124),e=c(38301);let f=()=>{let[a,b]=(0,e.useState)(!1);return((0,e.useEffect)(()=>{let a=a=>{a.preventDefault(),window.deferredPrompt=a,b(!0)};return window.addEventListener("beforeinstallprompt",a),()=>window.removeEventListener("beforeinstallprompt",a)},[]),a)?(0,d.jsx)("div",{className:"fixed bottom-4 inset-x-0 flex justify-center z-[200] px-4",children:(0,d.jsxs)("div",{className:"bg-gray-900 text-white border border-pink-600 rounded-xl shadow-lg p-4 max-w-md w-full flex items-center justify-between gap-3",children:[(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("div",{className:"font-bold",children:"Install Naughty Den"}),(0,d.jsx)("div",{className:"text-gray-400",children:"Add the app to your home screen for a faster experience."})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("button",{className:"px-3 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800",onClick:()=>b(!1),children:"Not now"}),(0,d.jsx)("button",{className:"px-3 py-2 rounded-lg bg-pink-600 hover:bg-pink-700 font-bold",onClick:async()=>{let a=window.deferredPrompt;a&&(a.prompt(),await a.userChoice,window.deferredPrompt=null,b(!1))},children:"Install"})]})]})}):null}},80167:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LoadBalancingCall=void 0;let d=c(96699),e=c(50615),f=c(62556),g=c(64105),h=c(82142),i=c(25554),j=c(18031),k=c(29383),l=c(73496),m="load_balancing_call";class n{constructor(a,b,c,d,e,f,g){var h,j;this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let k=this.methodName.split("/"),l="";k.length>=2&&(l=k[1]);let m=null!=(j=null==(h=(0,i.splitHostPort)(this.host))?void 0:h.host)?j:"localhost";this.serviceUrl=`https://${m}/${l}`}trace(a){j.trace(e.LogVerbosity.DEBUG,m,"["+this.callNumber+"] "+a)}outputStatus(a,b){var c,d;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+a.code+' details="'+a.details+'"');let e=Object.assign(Object.assign({},a),{progress:b});null==(c=this.listener)||c.onReceiveStatus(e),null==(d=this.onCallEnded)||d.call(this,e.code)}}doPick(){var a,b;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let c=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=c.subchannel?"("+c.subchannel.getChannelzRef().id+") "+c.subchannel.getAddress():""+c.subchannel;switch(this.trace("Pick result: "+h.PickResultType[c.pickResultType]+" subchannel: "+i+" status: "+(null==(a=c.status)?void 0:a.code)+" "+(null==(b=c.status)?void 0:b.details)),c.pickResultType){case h.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var b,h,j;if(this.ended)return void this.trace("Credentials metadata generation finished after call ended");let k=this.metadata.clone();if(k.merge(a),k.get("authorization").length>1&&this.outputStatus({code:e.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new g.Metadata},"PROCESSED"),c.subchannel.getConnectivityState()!==d.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+d.ConnectivityState[c.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&k.set("grpc-timeout",(0,f.getDeadlineTimeoutString)(this.deadline));try{this.child=c.subchannel.getRealSubchannel().createCall(k,this.host,this.methodName,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(a)},onReceiveMessage:a=>{this.trace("Received message"),this.listener.onReceiveMessage(a)},onReceiveStatus:a=>{this.trace("Received status"),a.rstCode===l.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(a,"REFUSED"):this.outputStatus(a,"PROCESSED")}})}catch(a){this.trace("Failed to start call on picked subchannel "+i+" with error "+a.message),this.outputStatus({code:e.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+a.message,metadata:new g.Metadata},"NOT_STARTED");return}null==(h=(b=this.callConfig).onCommitted)||h.call(b),null==(j=c.onCallStarted)||j.call(c),this.onCallEnded=c.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:b,details:c}=(0,k.restrictControlPlaneStatusCode)("number"==typeof a.code?a.code:e.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:b,details:c,metadata:new g.Metadata},"PROCESSED")});break;case h.PickResultType.DROP:let{code:j,details:m}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:j,details:m,metadata:c.status.metadata},"DROP")});break;case h.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:b}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:a,details:b,metadata:c.status.metadata},"PROCESSED")})}break;case h.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new g.Metadata},"PROCESSED")}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.listener=b,this.metadata=a,this.doPick()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.child.sendMessageWithContext(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}b.LoadBalancingCall=n},81165:a=>{"use strict";a.exports=function a(a,b){for(var c=Array(arguments.length-1),d=0,e=2,f=!0;e<arguments.length;)c[d++]=arguments[e++];return new Promise(function(e,g){c[d]=function(a){if(f)if(f=!1,a)g(a);else{for(var b=Array(arguments.length-1),c=0;c<b.length;)b[c++]=arguments[c];e.apply(null,b)}};try{a.apply(b||null,c)}catch(a){f&&(f=!1,g(a))}})}},81213:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingLoadBalancer=void 0;let d=c(68367),e=c(10584),f=c(96699),g=c(9114),h=c(82142),i=c(12812),j=c(50615),k=c(64105),l=c(18031),m=c(50615),n=c(25554),o=c(69285),p="resolving_load_balancer";function q(a){l.trace(m.LogVerbosity.DEBUG,p,a)}let r=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function s(a,b,c,d){for(let e of c.name)switch(d){case"EMPTY":if(!e.service&&!e.method)return!0;break;case"SERVICE":if(e.service===a&&!e.method)return!0;break;case"SERVICE_AND_METHOD":if(e.service===a&&e.method===b)return!0}return!1}function t(a,b,c,d){for(let e of c)if(s(a,b,e,d))return e;return null}function u(a){return function(b,c){var d,e;let f=b.split("/").filter(a=>a.length>0),g=null!=(d=f[0])?d:"",h=null!=(e=f[1])?e:"";if(a&&a.methodConfig)for(let b of r){let c=t(g,h,a.methodConfig,b);if(c)return{methodConfig:c,pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}}class v{constructor(a,b,c,l,m){this.target=a,this.channelControlHelper=b,this.onSuccessfulResolution=l,this.onFailedResolution=m,this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,c["grpc.service_config"]?this.defaultServiceConfig=(0,e.validateServiceConfig)(JSON.parse(c["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(f.ConnectivityState.IDLE,new h.QueuePicker(this)),this.childLoadBalancer=new o.ChildLoadBalancerHandler({createSubchannel:b.createSubchannel.bind(b),requestReresolution:()=>{this.backoffTimeout.isRunning()?(q("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,b)=>{this.latestChildState=a,this.latestChildPicker=b,this.updateState(a,b)},addChannelzChild:b.addChannelzChild.bind(b),removeChannelzChild:b.removeChannelzChild.bind(b)}),this.innerResolver=(0,g.createResolver)(a,{onSuccessfulResolution:(a,b,c,e,f)=>{var g;this.backoffTimeout.stop(),this.backoffTimeout.reset();let h=null;null===b?null===c?(this.previousServiceConfig=null,h=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(c):h=this.previousServiceConfig:(h=b,this.previousServiceConfig=b);let i=null!=(g=null==h?void 0:h.loadBalancingConfig)?g:[],l=(0,d.getFirstUsableConfig)(i,!0);if(null===l)return void this.handleResolutionFailure({code:j.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new k.Metadata});this.childLoadBalancer.updateAddressList(a,l,f);let m=null!=h?h:this.defaultServiceConfig;this.onSuccessfulResolution(m,null!=e?e:u(m))},onError:a=>{this.handleResolutionFailure(a)}},c);let n={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},n),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===f.ConnectivityState.IDLE&&this.updateState(f.ConnectivityState.CONNECTING,new h.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(a,b){q((0,n.uriToString)(this.target)+" "+f.ConnectivityState[this.currentState]+" -> "+f.ConnectivityState[a]),a===f.ConnectivityState.IDLE&&(b=new h.QueuePicker(this)),this.currentState=a,this.channelControlHelper.updateState(a,b)}handleResolutionFailure(a){this.latestChildState===f.ConnectivityState.IDLE&&(this.updateState(f.ConnectivityState.TRANSIENT_FAILURE,new h.UnavailablePicker(a)),this.onFailedResolution(a))}exitIdle(){(this.currentState===f.ConnectivityState.IDLE||this.currentState===f.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(a,b){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}b.ResolvingLoadBalancer=v},81578:(a,b,c)=>{"use strict";a.exports=c(56796).vendored.contexts.AmpContext},81630:a=>{"use strict";a.exports=require("http")},82142:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.QueuePicker=b.UnavailablePicker=b.PickResultType=void 0;let e=c(64105),f=c(50615);!function(a){a[a.COMPLETE=0]="COMPLETE",a[a.QUEUE=1]="QUEUE",a[a.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",a[a.DROP=3]="DROP"}(d||(b.PickResultType=d={}));class g{constructor(a){this.status=Object.assign({code:f.Status.UNAVAILABLE,details:"No connection established",metadata:new e.Metadata},a)}pick(a){return{pickResultType:d.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}b.UnavailablePicker=g;class h{constructor(a){this.loadBalancer=a,this.calledExitIdle=!1}pick(a){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:d.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}b.QueuePicker=h},82566:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},82915:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.FilterStackFactory=b.FilterStack=void 0;class c{constructor(a){this.filters=a}sendMetadata(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMetadata(b);return b}receiveMetadata(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMetadata(b);return b}sendMessage(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMessage(b);return b}receiveMessage(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMessage(b);return b}receiveTrailers(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveTrailers(b);return b}push(a){this.filters.unshift(...a)}getFilters(){return this.filters}}b.FilterStack=c;class d{constructor(a){this.factories=a}push(a){this.factories.unshift(...a)}clone(){return new d([...this.factories])}createFilter(){return new c(this.factories.map(a=>a.createFilter()))}}b.FilterStackFactory=d},84177:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Subchannel=void 0;let d=c(96699),e=c(12812),f=c(18031),g=c(50615),h=c(25554),i=c(24204),j=c(10811),k="subchannel",l=0x7fffffff;class m{constructor(a,b,c,f,g){var h;this.channelTarget=a,this.subchannelAddress=b,this.options=c,this.credentials=f,this.connector=g,this.connectivityState=d.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new j.ChannelzCallTracker,this.childrenTracker=new j.ChannelzChildrenTracker,this.streamTracker=new j.ChannelzCallTracker;let k={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new e.BackoffTimeout(()=>{this.handleBackoffTimer()},k),this.backoffTimeout.unref(),this.subchannelAddressString=(0,i.subchannelAddressToString)(b),this.keepaliveTime=null!=(h=c["grpc.keepalive_time_ms"])?h:-1,0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new j.ChannelzTrace,this.channelzRef=(0,j.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(c,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(a){f.trace(g.LogVerbosity.DEBUG,k,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}refTrace(a){f.trace(g.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING):this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let a=this.options;if(a["grpc.keepalive_time_ms"]){let b=Math.min(this.keepaliveTime,l);a=Object.assign(Object.assign({},a),{"grpc.keepalive_time_ms":b})}this.connector.connect(this.subchannelAddress,this.credentials,a).then(a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.READY)?(this.transport=a,this.channelzEnabled&&this.childrenTracker.refChild(a.getChannelzRef()),a.addDisconnectListener(a=>{this.transitionToState([d.ConnectivityState.READY],d.ConnectivityState.IDLE),a&&this.keepaliveTime>0&&(this.keepaliveTime*=2,f.log(g.LogVerbosity.ERROR,`Connection to ${(0,h.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):a.shutdown()},a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.TRANSIENT_FAILURE,`${a}`)})}transitionToState(a,b,c){var e,f;if(-1===a.indexOf(this.connectivityState))return!1;this.trace(d.ConnectivityState[this.connectivityState]+" -> "+d.ConnectivityState[b]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+d.ConnectivityState[b]);let g=this.connectivityState;switch(this.connectivityState=b,b){case d.ConnectivityState.READY:this.stopBackoff();break;case d.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case d.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(e=this.transport)||e.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case d.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(f=this.transport)||f.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${b}`)}for(let a of this.stateListeners)a(this,g,b,this.keepaliveTime,c);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,j.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([d.ConnectivityState.CONNECTING,d.ConnectivityState.READY],d.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(a,b,c,d){let e;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),e={onCallEnd:a=>{a.code===g.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):e={},this.transport.createCall(a,b,c,d,e)}startConnecting(){process.nextTick(()=>{this.transitionToState([d.ConnectivityState.IDLE],d.ConnectivityState.CONNECTING)||this.connectivityState!==d.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(a){this.stateListeners.add(a)}removeConnectivityStateListener(a){this.stateListeners.delete(a)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(a){return a.getRealSubchannel()===this}throttleKeepalive(a){a>this.keepaliveTime&&(this.keepaliveTime=a)}}b.Subchannel=m},86243:a=>{"use strict";a.exports={rE:"1.9.15"}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87516:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{default:function(){return i},getImageProps:function(){return h}});let d=c(35288),e=c(63974),f=c(40106),g=d._(c(49656));function h(a){let{props:b}=(0,e.getImgProps)(a,{defaultLoader:g.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[a,c]of Object.entries(b))void 0===c&&delete b[a];return{props:b}}let i=f.Image},90146:a=>{"use strict";a.exports=function a(a,b,c){var d=c||8192,e=d>>>1,f=null,g=d;return function(c){if(c<1||c>e)return a(c);g+c>d&&(f=a(d),g=0);var h=b.call(f,g,g+=c);return 7&g&&(g=(7|g)+1),h}}},90290:(a,b,c)=>{"use strict";var d,e,f=a.exports=c(60054),g=c(27481);f.codegen=c(96953),f.fetch=c(26740),f.path=c(70051),f.fs=f.inquire("fs"),f.toArray=function(a){if(a){for(var b=Object.keys(a),c=Array(b.length),d=0;d<b.length;)c[d]=a[b[d++]];return c}return[]},f.toObject=function(a){for(var b={},c=0;c<a.length;){var d=a[c++],e=a[c++];void 0!==e&&(b[d]=e)}return b};var h=/\\/g,i=/"/g;f.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},f.safeProp=function(a){return!/^[$\w_]+$/.test(a)||f.isReserved(a)?'["'+a.replace(h,"\\\\").replace(i,'\\"')+'"]':"."+a},f.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var j=/_([a-z])/g;f.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(j,function(a,b){return b.toUpperCase()})},f.compareFieldsById=function(a,b){return a.id-b.id},f.decorateType=function(a,b){if(a.$type)return b&&a.$type.name!==b&&(f.decorateRoot.remove(a.$type),a.$type.name=b,f.decorateRoot.add(a.$type)),a.$type;d||(d=c(68134));var e=new d(b||a.name);return f.decorateRoot.add(e),e.ctor=a,Object.defineProperty(a,"$type",{value:e,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:e,enumerable:!1}),e};var k=0;f.decorateEnum=function(a){if(a.$type)return a.$type;e||(e=c(27791));var b=new e("Enum"+k++,a);return f.decorateRoot.add(b),Object.defineProperty(a,"$type",{value:b,enumerable:!1}),b},f.setProperty=function(a,b,c,d){function e(a,b,c){var f=b.shift();if("__proto__"===f||"prototype"===f)return a;if(b.length>0)a[f]=e(a[f]||{},b,c);else{var g=a[f];if(g&&d)return a;g&&(c=[].concat(g).concat(c)),a[f]=c}return a}if("object"!=typeof a)throw TypeError("dst must be an object");if(!b)throw TypeError("path must be specified");return e(a,b=b.split("."),c)},Object.defineProperty(f,"decorateRoot",{get:function(){return g.decorated||(g.decorated=new(c(31502)))}})},91645:a=>{"use strict";a.exports=require("net")},92788:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StatusBuilder=void 0;class c{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(a){return this.code=a,this}withDetails(a){return this.details=a,this}withMetadata(a){return this.metadata=a,this}build(){let a={};return null!==this.code&&(a.code=this.code),null!==this.details&&(a.details=this.details),null!==this.metadata&&(a.metadata=this.metadata),a}}b.StatusBuilder=c},92812:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.OutlierDetectionLoadBalancer=b.OutlierDetectionLoadBalancingConfig=void 0;let e=c(96699),f=c(50615),g=c(75956),h=c(35370),i=c(68367),j=c(69285),k=c(82142),l=c(24204),m=c(10975),n=c(18031),o="outlier_detection";function p(a){n.trace(f.LogVerbosity.DEBUG,o,a)}let q="outlier_detection",r=(null!=(d=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)?d:"true")==="true",s={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},t={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function u(a,b,c,d){if(b in a&&typeof a[b]!==c){let e=d?`${d}.${b}`:b;throw Error(`outlier detection config ${e} parse error: expected ${c}, got ${typeof a[b]}`)}}function v(a,b,c){let d=c?`${c}.${b}`:b;if(b in a){if(!(0,g.isDuration)(a[b]))throw Error(`outlier detection config ${d} parse error: expected Duration, got ${typeof a[b]}`);if(!(a[b].seconds>=0&&a[b].seconds<=315576e6&&a[b].nanos>=0&&a[b].nanos<=0x3b9ac9ff))throw Error(`outlier detection config ${d} parse error: values out of range for non-negative Duaration`)}}function w(a,b,c){let d=c?`${c}.${b}`:b;if(u(a,b,"number",c),b in a&&!(a[b]>=0&&a[b]<=100))throw Error(`outlier detection config ${d} parse error: value out of range for percentage (0-100)`)}class x{constructor(a,b,c,d,e,f,g){if(this.childPolicy=g,g.length>0&&"pick_first"===g[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=a?a:1e4,this.baseEjectionTimeMs=null!=b?b:3e4,this.maxEjectionTimeMs=null!=c?c:3e5,this.maxEjectionPercent=null!=d?d:10,this.successRateEjection=e?Object.assign(Object.assign({},s),e):null,this.failurePercentageEjection=f?Object.assign(Object.assign({},t),f):null}getLoadBalancerName(){return q}toJsonObject(){return{interval:(0,g.msToDuration)(this.intervalMs),base_ejection_time:(0,g.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,g.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(a=>a.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(a){return new x(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,a)}static createFromJson(a){var b;if(v(a,"interval"),v(a,"base_ejection_time"),v(a,"max_ejection_time"),w(a,"max_ejection_percent"),"success_rate_ejection"in a){if("object"!=typeof a.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");u(a.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),w(a.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),u(a.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),u(a.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in a){if("object"!=typeof a.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");w(a.failure_percentage_ejection,"threshold","failure_percentage_ejection"),w(a.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),u(a.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),u(a.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new x(a.interval?(0,g.durationToMs)(a.interval):null,a.base_ejection_time?(0,g.durationToMs)(a.base_ejection_time):null,a.max_ejection_time?(0,g.durationToMs)(a.max_ejection_time):null,null!=(b=a.max_ejection_percent)?b:null,a.success_rate_ejection,a.failure_percentage_ejection,a.child_policy.map(i.validateLoadBalancingConfig))}}b.OutlierDetectionLoadBalancingConfig=x;class y extends m.BaseSubchannelWrapper{constructor(a,b){super(a),this.mapEntry=b,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=a.getConnectivityState(),a.addConnectivityStateListener((a,b,c,d)=>{if(this.childSubchannelState=c,!this.ejected)for(let a of this.stateListeners)a(this,b,c,d)})}getConnectivityState(){return this.ejected?e.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(a){this.stateListeners.push(a)}removeConnectivityStateListener(a){let b=this.stateListeners.indexOf(a);b>-1&&this.stateListeners.splice(b,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let a=this.mapEntry.subchannelWrappers.indexOf(this);a>=0&&this.mapEntry.subchannelWrappers.splice(a,1)}}eject(){for(let a of(this.ejected=!0,this.stateListeners))a(this,this.childSubchannelState,e.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let a of(this.ejected=!1,this.stateListeners))a(this,e.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function z(){return{success:0,failure:0}}class A{constructor(){this.activeBucket=z(),this.inactiveBucket=z()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=z()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class B{constructor(a,b){this.wrappedPicker=a,this.countCalls=b}pick(a){let b=this.wrappedPicker.pick(a);if(b.pickResultType!==k.PickResultType.COMPLETE)return b;{let a=b.subchannel,c=a.getMapEntry();if(!c)return Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel()});{let d=b.onCallEnded;return this.countCalls&&(d=a=>{var d;a===f.Status.OK?c.counter.addSuccess():c.counter.addFailure(),null==(d=b.onCallEnded)||d.call(b,a)}),Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel(),onCallEnded:d})}}}}class C{constructor(a){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new j.ChildLoadBalancerHandler((0,h.createChildChannelControlHelper)(a,{createSubchannel:(b,c)=>{let d=a.createSubchannel(b,c),e=this.addressMap.get((0,l.subchannelAddressToString)(b)),f=new y(d,e);return(null==e?void 0:e.currentEjectionTimestamp)!==null&&f.eject(),null==e||e.subchannelWrappers.push(f),f},updateState:(b,c)=>{b===e.ConnectivityState.READY?a.updateState(b,new B(c,this.isCountingEnabled())):a.updateState(b,c)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let a=0;for(let b of this.addressMap.values())null!==b.currentEjectionTimestamp&&(a+=1);return 100*a/this.addressMap.size}runSuccessRateCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getSuccessRateEjectionConfig();if(!b)return;p("Running success rate check");let c=b.request_volume,d=0,e=[];for(let[a,b]of this.addressMap){let f=b.counter.getLastSuccesses(),g=b.counter.getLastFailures();p("Stats for "+a+": successes="+f+" failures="+g+" targetRequestVolume="+c),f+g>=c&&(d+=1,e.push(f/(f+g)))}if(p("Found "+d+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+e+"]"),d<b.minimum_hosts)return;let f=e.reduce((a,b)=>a+b)/e.length,g=0;for(let a of e){let b=a-f;g+=b*b}let h=Math.sqrt(g/e.length),i=f-h*(b.stdev_factor/1e3);for(let[d,e]of(p("stdev="+h+" ejectionThreshold="+i),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let f=e.counter.getLastSuccesses(),g=e.counter.getLastFailures();if(f+g<c)continue;let h=f/(f+g);if(p("Checking candidate "+d+" successRate="+h),h<i){let c=100*Math.random();p("Candidate "+d+" randomNumber="+c+" enforcement_percentage="+b.enforcement_percentage),c<b.enforcement_percentage&&(p("Ejecting candidate "+d),this.eject(e,a))}}}runFailurePercentageCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getFailurePercentageEjectionConfig();if(!b)return;p("Running failure percentage check. threshold="+b.threshold+" request volume threshold="+b.request_volume);let c=0;for(let a of this.addressMap.values())a.counter.getLastSuccesses()+a.counter.getLastFailures()>=b.request_volume&&(c+=1);if(!(c<b.minimum_hosts))for(let[c,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let e=d.counter.getLastSuccesses(),f=d.counter.getLastFailures();if((p("Candidate successes="+e+" failures="+f),!(e+f<b.request_volume))&&100*f/(f+e)>b.threshold){let e=100*Math.random();p("Candidate "+c+" randomNumber="+e+" enforcement_percentage="+b.enforcement_percentage),e<b.enforcement_percentage&&(p("Ejecting candidate "+c),this.eject(d,a))}}}eject(a,b){for(let b of(a.currentEjectionTimestamp=new Date,a.ejectionTimeMultiplier+=1,a.subchannelWrappers))b.eject()}uneject(a){for(let b of(a.currentEjectionTimestamp=null,a.subchannelWrappers))b.uneject()}switchAllBuckets(){for(let a of this.addressMap.values())a.counter.switchBuckets()}startTimer(a){var b,c;this.ejectionTimer=setTimeout(()=>this.runChecks(),a),null==(c=(b=this.ejectionTimer).unref)||c.call(b)}runChecks(){let a=new Date;if(p("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[b,c]of(this.timerStartTime=a,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(a),this.runFailurePercentageCheck(a),this.addressMap.entries()))if(null===c.currentEjectionTimestamp)c.ejectionTimeMultiplier>0&&(c.ejectionTimeMultiplier-=1);else{let a=this.latestConfig.getBaseEjectionTimeMs(),d=this.latestConfig.getMaxEjectionTimeMs(),e=new Date(c.currentEjectionTimestamp.getTime());e.setMilliseconds(e.getMilliseconds()+Math.min(a*c.ejectionTimeMultiplier,Math.max(a,d))),e<new Date&&(p("Unejecting "+b),this.uneject(c))}}updateAddressList(a,b,c){if(!(b instanceof x))return;let d=new Set;for(let b of a)d.add((0,l.subchannelAddressToString)(b));for(let a of d)this.addressMap.has(a)||(p("Adding map entry for "+a),this.addressMap.set(a,{counter:new A,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())d.has(a)||(p("Removing map entry for "+a),this.addressMap.delete(a));let e=(0,i.getFirstUsableConfig)(b.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(a,e,c),b.getSuccessRateEjectionConfig()||b.getFailurePercentageEjectionConfig())if(this.timerStartTime){p("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=b.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else p("Starting new timer"),this.timerStartTime=new Date,this.startTimer(b.getIntervalMs()),this.switchAllBuckets();else for(let a of(p("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(a),a.ejectionTimeMultiplier=0;this.latestConfig=b}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return q}}b.OutlierDetectionLoadBalancer=C,b.setup=function(){r&&(0,h.registerLoadBalancerType)(q,C,x)}},93686:(a,b,c)=>{"use strict";var d=b;function e(){d.util._configure(),d.Writer._configure(d.BufferWriter),d.Reader._configure(d.BufferReader)}d.build="minimal",d.Writer=c(59665),d.BufferWriter=c(61134),d.Reader=c(75645),d.BufferReader=c(79546),d.util=c(60054),d.rpc=c(74915),d.roots=c(27481),d.configure=e,e()},94735:a=>{"use strict";a.exports=require("events")},95749:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelImplementation=void 0;let d=c(55382),e=c(39127);class f{constructor(a,b,c){if("string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.internalChannel=new e.InternalChannel(a,b,c)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(a){return this.internalChannel.getConnectivityState(a)}watchConnectivityState(a,b,c){this.internalChannel.watchConnectivityState(a,b,c)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(a,b,c,d,e)}}b.ChannelImplementation=f},96138:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},96699:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.ConnectivityState=void 0,function(a){a[a.IDLE=0]="IDLE",a[a.CONNECTING=1]="CONNECTING",a[a.READY=2]="READY",a[a.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",a[a.SHUTDOWN=4]="SHUTDOWN"}(c||(b.ConnectivityState=c={}))},96953:a=>{"use strict";function b(a,c){"string"==typeof a&&(c=a,a=void 0);var d=[];function e(a){if("string"!=typeof a){var c=f();if(b.verbose&&console.log("codegen: "+c),c="return "+c,a){for(var g=Object.keys(a),h=Array(g.length+1),i=Array(g.length),j=0;j<g.length;)h[j]=g[j],i[j]=a[g[j++]];return h[j]=c,Function.apply(null,h).apply(null,i)}return Function(c)()}for(var k=Array(arguments.length-1),l=0;l<k.length;)k[l]=arguments[++l];if(l=0,a=a.replace(/%([%dfijs])/g,function(a,b){var c=k[l++];switch(b){case"d":case"f":return String(Number(c));case"i":return String(Math.floor(c));case"j":return JSON.stringify(c);case"s":return String(c)}return"%"}),l!==k.length)throw Error("parameter count mismatch");return d.push(a),e}function f(b){return"function "+(b||c||"")+"("+(a&&a.join(",")||"")+"){\n  "+d.join("\n  ")+"\n}"}return e.toString=f,e}a.exports=b,b.verbose=!1},97643:(a,b,c)=>{"use strict";let d,e,f,g,h,i;c.d(b,{default:()=>xF});var j,k,l,m,n,o,p,q=c(21124),r=c(38301);let s=()=>void 0,t={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},u=function(a){return Error("Firebase Database ("+t.SDK_VERSION+") INTERNAL ASSERT FAILED: "+a)},v=function(a){let b=[],c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:(e<2048?b[c++]=e>>6|192:((64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b},w=function(a){let b=[],c=0,d=0;for(;c<a.length;){let e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){let f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){let f=a[c++],g=((7&e)<<18|(63&f)<<12|(63&a[c++])<<6|63&a[c++])-65536;b[d++]=String.fromCharCode(55296+(g>>10)),b[d++]=String.fromCharCode(56320+(1023&g))}else{let f=a[c++],g=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)}}return b.join("")},x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();let c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let b=0;b<a.length;b+=3){let e=a[b],f=b+1<a.length,g=f?a[b+1]:0,h=b+2<a.length,i=h?a[b+2]:0,j=e>>2,k=(3&e)<<4|g>>4,l=(15&g)<<2|i>>6,m=63&i;!h&&(m=64,f||(l=64)),d.push(c[j],c[k],c[l],c[m])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(v(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):w(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();let c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let b=0;b<a.length;){let e=c[a.charAt(b++)],f=b<a.length?c[a.charAt(b)]:0,g=++b<a.length?c[a.charAt(b)]:64,h=++b<a.length?c[a.charAt(b)]:64;if(++b,null==e||null==f||null==g||null==h)throw new y;let i=e<<2|f>>4;if(d.push(i),64!==g){let a=f<<4&240|g>>2;if(d.push(a),64!==h){let a=g<<6&192|h;d.push(a)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class y extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let z=function(a){let b=v(a);return x.encodeByteArray(b,!0)},A=function(a){return z(a).replace(/\./g,"")},B=function(a){try{return x.decodeString(a,!0)}catch(a){console.error("base64Decode failed: ",a)}return null};function C(a){return"__proto__"!==a}function D(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}let E=()=>D().__FIREBASE_DEFAULTS__,F=()=>{if("undefined"==typeof process||void 0===process.env)return;let a=process.env.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},G=()=>{let a;if("undefined"==typeof document)return;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(a){return}let b=a&&B(a[1]);return b&&JSON.parse(b)},H=()=>{try{return s()||E()||F()||G()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},I=a=>H()?.emulatorHosts?.[a],J=a=>{let b=I(a);if(!b)return;let c=b.lastIndexOf(":");if(c<=0||c+1===b.length)throw Error(`Invalid host ${b} with no separate hostname and port!`);let d=parseInt(b.substring(c+1),10);return"["===b[0]?[b.substring(1,c-1),d]:[b.substring(0,c),d]},K=()=>H()?.config;class L{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(a){return(b,c)=>{b?this.reject(b):this.resolve(c),"function"==typeof a&&(this.promise.catch(()=>{}),1===a.length?a(b):a(b,c))}}}function M(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function N(a){return(await fetch(a,{credentials:"include"})).ok}function O(a,b){if(a.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let c={alg:"none",type:"JWT"},d=b||"demo-project",e=a.iat||0,f=a.sub||a.user_id;if(!f)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let g={iss:`https://securetoken.google.com/${d}`,aud:d,iat:e,exp:e+3600,auth_time:e,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}},...a},h="";return[A(JSON.stringify(c)),A(JSON.stringify(g)),h].join(".")}let P={};function Q(){let a={prod:[],emulator:[]};for(let b of Object.keys(P))P[b]?a.emulator.push(b):a.prod.push(b);return a}function R(a){let b=document.getElementById(a),c=!1;return b||((b=document.createElement("div")).setAttribute("id",a),c=!0),{created:c,element:b}}let S=!1;function T(a,b){if("undefined"==typeof window||"undefined"==typeof document||!M(window.location.host)||P[a]===b||P[a]||S)return;function c(a){return`__firebase__banner__${a}`}P[a]=b;let d="__firebase__banner",e=Q().prod.length>0;function f(){let a=document.getElementById(d);a&&a.remove()}function g(a){a.style.display="flex",a.style.background="#7faaf0",a.style.position="fixed",a.style.bottom="5px",a.style.left="5px",a.style.padding=".5em",a.style.borderRadius="5px",a.style.alignItems="center"}function h(a,b){a.setAttribute("width","24"),a.setAttribute("id",b),a.setAttribute("height","24"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("fill","none"),a.style.marginLeft="-6px"}function i(){let a=document.createElement("span");return a.style.cursor="pointer",a.style.marginLeft="16px",a.style.fontSize="24px",a.innerHTML=" &times;",a.onclick=()=>{S=!0,f()},a}function j(a,b){a.setAttribute("id",b),a.innerText="Learn more",a.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",a.setAttribute("target","__blank"),a.style.paddingLeft="5px",a.style.textDecoration="underline"}function k(){let a=R(d),b=c("text"),f=document.getElementById(b)||document.createElement("span"),k=c("learnmore"),l=document.getElementById(k)||document.createElement("a"),m=c("preprendIcon"),n=document.getElementById(m)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(a.created){let b=a.element;g(b),j(l,k);let c=i();h(n,m),b.append(n,f,l,c),document.body.appendChild(b)}e?(f.innerText="Preview backend disconnected.",n.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(n.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,f.innerText="Preview backend running in this workspace."),f.setAttribute("id",b)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",k):k()}function U(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function V(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(U())}function W(){let a=H()?.forceEnvironment;if("node"===a)return!0;if("browser"===a)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(a){return!1}}function X(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function Y(){let a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof a&&void 0!==a.id}function Z(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function $(){return!W()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return!W()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function aa(){try{return"object"==typeof indexedDB}catch(a){return!1}}function ab(){return new Promise((a,b)=>{try{let c=!0,d="validate-browser-context-for-indexeddb-analytics-module",e=self.indexedDB.open(d);e.onsuccess=()=>{e.result.close(),c||self.indexedDB.deleteDatabase(d),a(!0)},e.onupgradeneeded=()=>{c=!1},e.onerror=()=>{b(e.error?.message||"")}}catch(a){b(a)}})}let ac="FirebaseError";class ad extends Error{constructor(a,b,c){super(b),this.code=a,this.customData=c,this.name=ac,Object.setPrototypeOf(this,ad.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ae.prototype.create)}}class ae{constructor(a,b,c){this.service=a,this.serviceName=b,this.errors=c}create(a,...b){let c=b[0]||{},d=`${this.service}/${a}`,e=this.errors[a],f=e?af(e,c):"Error",g=`${this.serviceName}: ${f} (${d}).`;return new ad(d,g,c)}}function af(a,b){return a.replace(ag,(a,c)=>{let d=b[c];return null!=d?String(d):`<${c}?>`})}let ag=/\{\$([^}]+)}/g;function ah(a){return JSON.parse(a)}function ai(a,b){if(a===b)return!0;let c=Object.keys(a),d=Object.keys(b);for(let e of c){if(!d.includes(e))return!1;let c=a[e],f=b[e];if(aj(c)&&aj(f)){if(!ai(c,f))return!1}else if(c!==f)return!1}for(let a of d)if(!c.includes(a))return!1;return!0}function aj(a){return null!==a&&"object"==typeof a}function ak(a){let b=[];for(let[c,d]of Object.entries(a))Array.isArray(d)?d.forEach(a=>{b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}):b.push(encodeURIComponent(c)+"="+encodeURIComponent(d));return b.length?"&"+b.join("&"):""}function al(a){let b={};return a.replace(/^\?/,"").split("&").forEach(a=>{if(a){let[c,d]=a.split("=");b[decodeURIComponent(c)]=decodeURIComponent(d)}}),b}function am(a){let b=a.indexOf("?");if(!b)return"";let c=a.indexOf("#",b);return a.substring(b,c>0?c:void 0)}function an(a,b){let c=new ao(a,b);return c.subscribe.bind(c)}class ao{constructor(a,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{a(this)}).catch(a=>{this.error(a)})}next(a){this.forEachObserver(b=>{b.next(a)})}error(a){this.forEachObserver(b=>{b.error(a)}),this.close(a)}complete(){this.forEachObserver(a=>{a.complete()}),this.close()}subscribe(a,b,c){let d;if(void 0===a&&void 0===b&&void 0===c)throw Error("Missing Observer.");void 0===(d=ap(a,["next","error","complete"])?a:{next:a,error:b,complete:c}).next&&(d.next=aq),void 0===d.error&&(d.error=aq),void 0===d.complete&&(d.complete=aq);let e=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch(a){}}),this.observers.push(d),e}unsubscribeOne(a){void 0!==this.observers&&void 0!==this.observers[a]&&(delete this.observers[a],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(a){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,a)}sendOne(a,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[a])try{b(this.observers[a])}catch(a){"undefined"!=typeof console&&console.error&&console.error(a)}})}close(a){this.finalized||(this.finalized=!0,void 0!==a&&(this.finalError=a),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ap(a,b){if("object"!=typeof a||null===a)return!1;for(let c of b)if(c in a&&"function"==typeof a[c])return!0;return!1}function aq(){}function ar(a){return a&&a._delegate?a._delegate:a}t.NODE_CLIENT=!0;class as{constructor(a,b,c){this.name=a,this.instanceFactory=b,this.type=c,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(a){return this.instantiationMode=a,this}setMultipleInstances(a){return this.multipleInstances=a,this}setServiceProps(a){return this.serviceProps=a,this}setInstanceCreatedCallback(a){return this.onInstanceCreated=a,this}}let at="[DEFAULT]";class au{constructor(a,b){this.name=a,this.container=b,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(a){let b=this.normalizeInstanceIdentifier(a);if(!this.instancesDeferred.has(b)){let a=new L;if(this.instancesDeferred.set(b,a),this.isInitialized(b)||this.shouldAutoInitialize())try{let c=this.getOrInitializeService({instanceIdentifier:b});c&&a.resolve(c)}catch(a){}}return this.instancesDeferred.get(b).promise}getImmediate(a){let b=this.normalizeInstanceIdentifier(a?.identifier),c=a?.optional??!1;if(this.isInitialized(b)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:b})}catch(a){if(c)return null;throw a}if(c)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(a){if(a.name!==this.name)throw Error(`Mismatching Component ${a.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=a,this.shouldAutoInitialize()){if(aw(a))try{this.getOrInitializeService({instanceIdentifier:at})}catch(a){}for(let[a,b]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(a);try{let a=this.getOrInitializeService({instanceIdentifier:c});b.resolve(a)}catch(a){}}}}clearInstance(a=at){this.instancesDeferred.delete(a),this.instancesOptions.delete(a),this.instances.delete(a)}async delete(){let a=Array.from(this.instances.values());await Promise.all([...a.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...a.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(a=at){return this.instances.has(a)}getOptions(a=at){return this.instancesOptions.get(a)||{}}initialize(a={}){let{options:b={}}=a,c=this.normalizeInstanceIdentifier(a.instanceIdentifier);if(this.isInitialized(c))throw Error(`${this.name}(${c}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let d=this.getOrInitializeService({instanceIdentifier:c,options:b});for(let[a,b]of this.instancesDeferred.entries())c===this.normalizeInstanceIdentifier(a)&&b.resolve(d);return d}onInit(a,b){let c=this.normalizeInstanceIdentifier(b),d=this.onInitCallbacks.get(c)??new Set;d.add(a),this.onInitCallbacks.set(c,d);let e=this.instances.get(c);return e&&a(e,c),()=>{d.delete(a)}}invokeOnInitCallbacks(a,b){let c=this.onInitCallbacks.get(b);if(c)for(let d of c)try{d(a,b)}catch{}}getOrInitializeService({instanceIdentifier:a,options:b={}}){let c=this.instances.get(a);if(!c&&this.component&&(c=this.component.instanceFactory(this.container,{instanceIdentifier:av(a),options:b}),this.instances.set(a,c),this.instancesOptions.set(a,b),this.invokeOnInitCallbacks(c,a),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,a,c)}catch{}return c||null}normalizeInstanceIdentifier(a=at){return this.component?this.component.multipleInstances?a:at:a}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function av(a){return a===at?void 0:a}function aw(a){return"EAGER"===a.instantiationMode}class ax{constructor(a){this.name=a,this.providers=new Map}addComponent(a){let b=this.getProvider(a.name);if(b.isComponentSet())throw Error(`Component ${a.name} has already been registered with ${this.name}`);b.setComponent(a)}addOrOverwriteComponent(a){this.getProvider(a.name).isComponentSet()&&this.providers.delete(a.name),this.addComponent(a)}getProvider(a){if(this.providers.has(a))return this.providers.get(a);let b=new au(a,this);return this.providers.set(a,b),b}getProviders(){return Array.from(this.providers.values())}}let ay=[];!function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"}(j||(j={}));let az={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},aA=j.INFO,aB={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},aC=(a,b,...c)=>{if(b<a.logLevel)return;let d=new Date().toISOString(),e=aB[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw Error(`Attempted to log a message with an invalid logType (value: ${b})`)};class aD{constructor(a){this.name=a,this._logLevel=aA,this._logHandler=aC,this._userLogHandler=null,ay.push(this)}get logLevel(){return this._logLevel}set logLevel(a){if(!(a in j))throw TypeError(`Invalid value "${a}" assigned to \`logLevel\``);this._logLevel=a}setLogLevel(a){this._logLevel="string"==typeof a?az[a]:a}get logHandler(){return this._logHandler}set logHandler(a){if("function"!=typeof a)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=a}get userLogHandler(){return this._userLogHandler}set userLogHandler(a){this._userLogHandler=a}debug(...a){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...a),this._logHandler(this,j.DEBUG,...a)}log(...a){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...a),this._logHandler(this,j.VERBOSE,...a)}info(...a){this._userLogHandler&&this._userLogHandler(this,j.INFO,...a),this._logHandler(this,j.INFO,...a)}warn(...a){this._userLogHandler&&this._userLogHandler(this,j.WARN,...a),this._logHandler(this,j.WARN,...a)}error(...a){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...a),this._logHandler(this,j.ERROR,...a)}}let aE=(a,b)=>b.some(b=>a instanceof b);function aF(){return d||(d=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aG(){return e||(e=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let aH=new WeakMap,aI=new WeakMap,aJ=new WeakMap,aK=new WeakMap,aL=new WeakMap;function aM(a){let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("success",e),a.removeEventListener("error",f)},e=()=>{b(aS(a.result)),d()},f=()=>{c(a.error),d()};a.addEventListener("success",e),a.addEventListener("error",f)});return b.then(b=>{b instanceof IDBCursor&&aH.set(b,a)}).catch(()=>{}),aL.set(b,a),b}function aN(a){if(aI.has(a))return;let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("complete",e),a.removeEventListener("error",f),a.removeEventListener("abort",f)},e=()=>{b(),d()},f=()=>{c(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",e),a.addEventListener("error",f),a.addEventListener("abort",f)});aI.set(a,b)}let aO={get(a,b,c){if(a instanceof IDBTransaction){if("done"===b)return aI.get(a);if("objectStoreNames"===b)return a.objectStoreNames||aJ.get(a);if("store"===b)return c.objectStoreNames[1]?void 0:c.objectStore(c.objectStoreNames[0])}return aS(a[b])},set:(a,b,c)=>(a[b]=c,!0),has:(a,b)=>a instanceof IDBTransaction&&("done"===b||"store"===b)||b in a};function aP(a){aO=a(aO)}function aQ(a){return a!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?aG().includes(a)?function(...b){return a.apply(aT(this),b),aS(aH.get(this))}:function(...b){return aS(a.apply(aT(this),b))}:function(b,...c){let d=a.call(aT(this),b,...c);return aJ.set(d,b.sort?b.sort():[b]),aS(d)}}function aR(a){return"function"==typeof a?aQ(a):(a instanceof IDBTransaction&&aN(a),aE(a,aF()))?new Proxy(a,aO):a}function aS(a){if(a instanceof IDBRequest)return aM(a);if(aK.has(a))return aK.get(a);let b=aR(a);return b!==a&&(aK.set(a,b),aL.set(b,a)),b}let aT=a=>aL.get(a);function aU(a,b,{blocked:c,upgrade:d,blocking:e,terminated:f}={}){let g=indexedDB.open(a,b),h=aS(g);return d&&g.addEventListener("upgradeneeded",a=>{d(aS(g.result),a.oldVersion,a.newVersion,aS(g.transaction),a)}),c&&g.addEventListener("blocked",a=>c(a.oldVersion,a.newVersion,a)),h.then(a=>{f&&a.addEventListener("close",()=>f()),e&&a.addEventListener("versionchange",a=>e(a.oldVersion,a.newVersion,a))}).catch(()=>{}),h}let aV=["get","getKey","getAll","getAllKeys","count"],aW=["put","add","delete","clear"],aX=new Map;function aY(a,b){if(!(a instanceof IDBDatabase&&!(b in a)&&"string"==typeof b))return;if(aX.get(b))return aX.get(b);let c=b.replace(/FromIndex$/,""),d=b!==c,e=aW.includes(c);if(!(c in(d?IDBIndex:IDBObjectStore).prototype)||!(e||aV.includes(c)))return;let f=async function(a,...b){let f=this.transaction(a,e?"readwrite":"readonly"),g=f.store;return d&&(g=g.index(b.shift())),(await Promise.all([g[c](...b),e&&f.done]))[0]};return aX.set(b,f),f}aP(a=>({...a,get:(b,c,d)=>aY(b,c)||a.get(b,c,d),has:(b,c)=>!!aY(b,c)||a.has(b,c)}));class aZ{constructor(a){this.container=a}getPlatformInfoString(){return this.container.getProviders().map(a=>{if(!a$(a))return null;{let b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}function a$(a){let b=a.getComponent();return b?.type==="VERSION"}let a_="@firebase/app",a0="0.14.2",a1=new aD("@firebase/app"),a2="12.2.0",a3="[DEFAULT]",a4={[a_]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},a5=new Map,a6=new Map,a7=new Map;function a8(a,b){try{a.container.addComponent(b)}catch(c){a1.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function a9(a){let b=a.name;if(a7.has(b))return a1.debug(`There were multiple attempts to register component ${b}.`),!1;for(let c of(a7.set(b,a),a5.values()))a8(c,a);for(let b of a6.values())a8(b,a);return!0}function ba(a,b){let c=a.container.getProvider("heartbeat").getImmediate({optional:!0});return c&&c.triggerHeartbeat(),a.container.getProvider(b)}function bb(a){return void 0!==a.options}function bc(a){return null!=a&&void 0!==a.settings}let bd=new ae("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class be{constructor(a,b,c){this._isDeleted=!1,this._options={...a},this._config={...b},this._name=b.name,this._automaticDataCollectionEnabled=b.automaticDataCollectionEnabled,this._container=c,this.container.addComponent(new as("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(a){this.checkDestroyed(),this._automaticDataCollectionEnabled=a}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(a){this._isDeleted=a}checkDestroyed(){if(this.isDeleted)throw bd.create("app-deleted",{appName:this._name})}}function bf(a,b){let c=B(a.split(".")[1]);return null===c?void console.error(`FirebaseServerApp ${b} is invalid: second part could not be parsed.`):void 0===JSON.parse(c).exp?void console.error(`FirebaseServerApp ${b} is invalid: expiration claim could not be parsed`):void(1e3*JSON.parse(c).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${b} is invalid: the token has expired.`))}let bg=a2;function bh(a,b={}){let c=a;"object"!=typeof b&&(b={name:b});let d={name:a3,automaticDataCollectionEnabled:!0,...b},e=d.name;if("string"!=typeof e||!e)throw bd.create("bad-app-name",{appName:String(e)});if(c||(c=K()),!c)throw bd.create("no-options");let f=a5.get(e);if(f)if(ai(c,f.options)&&ai(d,f.config))return f;else throw bd.create("duplicate-app",{appName:e});let g=new ax(e);for(let a of a7.values())g.addComponent(a);let h=new be(c,d,g);return a5.set(e,h),h}function bi(a=a3){let b=a5.get(a);if(!b&&a===a3&&K())return bh();if(!b)throw bd.create("no-app",{appName:a});return b}function bj(){return Array.from(a5.values())}async function bk(a){let b=!1,c=a.name;a5.has(c)?(b=!0,a5.delete(c)):a6.has(c)&&0>=a.decRefCount()&&(a6.delete(c),b=!0),b&&(await Promise.all(a.container.getProviders().map(a=>a.delete())),a.isDeleted=!0)}function bl(a,b,c){let d=a4[a]??a;c&&(d+=`-${c}`);let e=d.match(/\s|\//),f=b.match(/\s|\//);if(e||f){let a=[`Unable to register library "${d}" with version "${b}":`];e&&a.push(`library name "${d}" contains illegal characters (whitespace or "/")`),e&&f&&a.push("and"),f&&a.push(`version name "${b}" contains illegal characters (whitespace or "/")`),a1.warn(a.join(" "));return}a9(new as(`${d}-version`,()=>({library:d,version:b}),"VERSION"))}let bm="firebase-heartbeat-database",bn=1,bo="firebase-heartbeat-store",bp=null;function bq(){return bp||(bp=aU(bm,bn,{upgrade:(a,b)=>{if(0===b)try{a.createObjectStore(bo)}catch(a){console.warn(a)}}}).catch(a=>{throw bd.create("idb-open",{originalErrorMessage:a.message})})),bp}async function br(a){try{let b=(await bq()).transaction(bo),c=await b.objectStore(bo).get(bt(a));return await b.done,c}catch(a){if(a instanceof ad)a1.warn(a.message);else{let b=bd.create("idb-get",{originalErrorMessage:a?.message});a1.warn(b.message)}}}async function bs(a,b){try{let c=(await bq()).transaction(bo,"readwrite"),d=c.objectStore(bo);await d.put(b,bt(a)),await c.done}catch(a){if(a instanceof ad)a1.warn(a.message);else{let b=bd.create("idb-set",{originalErrorMessage:a?.message});a1.warn(b.message)}}}function bt(a){return`${a.name}!${a.options.appId}`}let bu=1024,bv=30;class bw{constructor(a){this.container=a,this._heartbeatsCache=null;let b=this.container.getProvider("app").getImmediate();this._storage=new bz(b),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){try{let a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),b=bx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===b||this._heartbeatsCache.heartbeats.some(a=>a.date===b))return;if(this._heartbeatsCache.heartbeats.push({date:b,agent:a}),this._heartbeatsCache.heartbeats.length>bv){let a=bB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){a1.warn(a)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let a=bx(),{heartbeatsToSend:b,unsentEntries:c}=by(this._heartbeatsCache.heartbeats),d=A(JSON.stringify({version:2,heartbeats:b}));return this._heartbeatsCache.lastSentHeartbeatDate=a,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(a){return a1.warn(a),""}}}function bx(){return new Date().toISOString().substring(0,10)}function by(a,b=bu){let c=[],d=a.slice();for(let e of a){let a=c.find(a=>a.agent===e.agent);if(a){if(a.dates.push(e.date),bA(c)>b){a.dates.pop();break}}else if(c.push({agent:e.agent,dates:[e.date]}),bA(c)>b){c.pop();break}d=d.slice(1)}return{heartbeatsToSend:c,unsentEntries:d}}class bz{constructor(a){this.app=a,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!aa()&&ab().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let a=await br(this.app);return a?.heartbeats?a:{heartbeats:[]}}}async overwrite(a){if(await this._canUseIndexedDBPromise){let b=await this.read();return bs(this.app,{lastSentHeartbeatDate:a.lastSentHeartbeatDate??b.lastSentHeartbeatDate,heartbeats:a.heartbeats})}}async add(a){if(await this._canUseIndexedDBPromise){let b=await this.read();return bs(this.app,{lastSentHeartbeatDate:a.lastSentHeartbeatDate??b.lastSentHeartbeatDate,heartbeats:[...b.heartbeats,...a.heartbeats]})}}}function bA(a){return A(JSON.stringify({version:2,heartbeats:a})).length}function bB(a){if(0===a.length)return -1;let b=0,c=a[0].date;for(let d=1;d<a.length;d++)a[d].date<c&&(c=a[d].date,b=d);return b}function bC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}(function(a){a9(new as("platform-logger",a=>new aZ(a),"PRIVATE")),a9(new as("heartbeat",a=>new bw(a),"PRIVATE")),bl(a_,a0,""),bl(a_,a0,"esm2020"),bl("fire-js","")})(""),bl("firebase","12.2.1","app");let bD=bC,bE=new ae("auth","Firebase",bC()),bF=new aD("@firebase/auth");function bG(a,...b){bF.logLevel<=j.WARN&&bF.warn(`Auth (${bg}): ${a}`,...b)}function bH(a,...b){bF.logLevel<=j.ERROR&&bF.error(`Auth (${bg}): ${a}`,...b)}function bI(a,...b){throw bM(a,...b)}function bJ(a,...b){return bM(a,...b)}function bK(a,b,c){return new ae("auth","Firebase",{...bD(),[b]:c}).create(b,{appName:a.name})}function bL(a){return bK(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bM(a,...b){if("string"!=typeof a){let c=b[0],d=[...b.slice(1)];return d[0]&&(d[0].appName=a.name),a._errorFactory.create(c,...d)}return bE.create(a,...b)}function bN(a,b,...c){if(!a)throw bM(b,...c)}function bO(a){let b="INTERNAL ASSERTION FAILED: "+a;throw bH(b),Error(b)}function bP(a,b){a||bO(b)}function bQ(){return"http:"===bR()||"https:"===bR()}function bR(){return"undefined"!=typeof self&&self.location?.protocol||null}function bS(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(bQ()||Y()||"connection"in navigator))||navigator.onLine}function bT(){if("undefined"==typeof navigator)return null;let a=navigator;return a.languages&&a.languages[0]||a.language||null}class bU{constructor(a,b){this.shortDelay=a,this.longDelay=b,bP(b>a,"Short delay should be less than long delay!"),this.isMobile=V()||Z()}get(){return bS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function bV(a,b){bP(a.emulator,"Emulator should always be set here");let{url:c}=a.emulator;return b?`${c}${b.startsWith("/")?b.slice(1):b}`:c}class bW{static initialize(a,b,c){this.fetchImpl=a,b&&(this.headersImpl=b),c&&(this.responseImpl=c)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void bO("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void bO("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void bO("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let bX={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},bY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bZ=new bU(3e4,6e4);function b$(a,b){return a.tenantId&&!b.tenantId?{...b,tenantId:a.tenantId}:b}async function b_(a,b,c,d,e={}){return b0(a,e,async()=>{let e={},f={};d&&("GET"===b?f=d:e={body:JSON.stringify(d)});let g=ak({key:a.config.apiKey,...f}).slice(1),h=await a._getAdditionalHeaders();h["Content-Type"]="application/json",a.languageCode&&(h["X-Firebase-Locale"]=a.languageCode);let i={method:b,headers:h,...e};return X()||(i.referrerPolicy="no-referrer"),a.emulatorConfig&&M(a.emulatorConfig.host)&&(i.credentials="include"),bW.fetch()(await b2(a,a.config.apiHost,c,g),i)})}async function b0(a,b,c){a._canInitEmulator=!1;let d={...bX,...b};try{let b=new b4(a),e=await Promise.race([c(),b.promise]);b.clearNetworkTimeout();let f=await e.json();if("needConfirmation"in f)throw b5(a,"account-exists-with-different-credential",f);if(e.ok&&!("errorMessage"in f))return f;{let[b,c]=(e.ok?f.errorMessage:f.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===b)throw b5(a,"credential-already-in-use",f);if("EMAIL_EXISTS"===b)throw b5(a,"email-already-in-use",f);if("USER_DISABLED"===b)throw b5(a,"user-disabled",f);let g=d[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw bK(a,g,c);bI(a,g)}}catch(b){if(b instanceof ad)throw b;bI(a,"network-request-failed",{message:String(b)})}}async function b1(a,b,c,d,e={}){let f=await b_(a,b,c,d,e);return"mfaPendingCredential"in f&&bI(a,"multi-factor-auth-required",{_serverResponse:f}),f}async function b2(a,b,c,d){let e=`${b}${c}?${d}`,f=a,g=f.config.emulator?bV(a.config,e):`${a.config.apiScheme}://${e}`;return bY.includes(c)&&(await f._persistenceManagerAvailable,"COOKIE"===f._getPersistenceType())?f._getPersistence()._getFinalTarget(g).toString():g}function b3(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class b4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(a){this.auth=a,this.timer=null,this.promise=new Promise((a,b)=>{this.timer=setTimeout(()=>b(bJ(this.auth,"network-request-failed")),bZ.get())})}}function b5(a,b,c){let d={appName:a.name};c.email&&(d.email=c.email),c.phoneNumber&&(d.phoneNumber=c.phoneNumber);let e=bJ(a,b,d);return e.customData._tokenResponse=c,e}function b6(a){return void 0!==a&&void 0!==a.enterprise}class b7{constructor(a){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===a.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=a.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=a.recaptchaEnforcementState}getProviderEnforcementState(a){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let b of this.recaptchaEnforcementState)if(b.provider&&b.provider===a)return b3(b.enforcementState);return null}isProviderEnabled(a){return"ENFORCE"===this.getProviderEnforcementState(a)||"AUDIT"===this.getProviderEnforcementState(a)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function b8(a,b){return b_(a,"GET","/v2/recaptchaConfig",b$(a,b))}async function b9(a,b){return b_(a,"POST","/v1/accounts:delete",b)}async function ca(a,b){return b_(a,"POST","/v1/accounts:lookup",b)}function cb(a){if(a)try{let b=new Date(Number(a));if(!isNaN(b.getTime()))return b.toUTCString()}catch(a){}}async function cc(a,b=!1){let c=ar(a),d=await c.getIdToken(b),e=ce(d);bN(e&&e.exp&&e.auth_time&&e.iat,c.auth,"internal-error");let f="object"==typeof e.firebase?e.firebase:void 0,g=f?.sign_in_provider;return{claims:e,token:d,authTime:cb(cd(e.auth_time)),issuedAtTime:cb(cd(e.iat)),expirationTime:cb(cd(e.exp)),signInProvider:g||null,signInSecondFactor:f?.sign_in_second_factor||null}}function cd(a){return 1e3*Number(a)}function ce(a){let[b,c,d]=a.split(".");if(void 0===b||void 0===c||void 0===d)return bH("JWT malformed, contained fewer than 3 sections"),null;try{let a=B(c);if(!a)return bH("Failed to decode base64 JWT payload"),null;return JSON.parse(a)}catch(a){return bH("Caught error parsing JWT payload as JSON",a?.toString()),null}}function cf(a){let b=ce(a);return bN(b,"internal-error"),bN(void 0!==b.exp,"internal-error"),bN(void 0!==b.iat,"internal-error"),Number(b.exp)-Number(b.iat)}async function cg(a,b,c=!1){if(c)return b;try{return await b}catch(b){throw b instanceof ad&&ch(b)&&a.auth.currentUser===a&&await a.auth.signOut(),b}}function ch({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}class ci{constructor(a){this.user=a,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(a){if(!a)return this.errorBackoff=3e4,Math.max(0,(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5);{let a=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),a}}schedule(a=!1){if(!this.isRunning)return;let b=this.getInterval(a);this.timerId=setTimeout(async()=>{await this.iteration()},b)}async iteration(){try{await this.user.getIdToken(!0)}catch(a){a?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class cj{constructor(a,b){this.createdAt=a,this.lastLoginAt=b,this._initializeTime()}_initializeTime(){this.lastSignInTime=cb(this.lastLoginAt),this.creationTime=cb(this.createdAt)}_copy(a){this.createdAt=a.createdAt,this.lastLoginAt=a.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ck(a){let b=a.auth,c=await a.getIdToken(),d=await cg(a,ca(b,{idToken:c}));bN(d?.users.length,b,"internal-error");let e=d.users[0];a._notifyReloadListener(e);let f=e.providerUserInfo?.length?cn(e.providerUserInfo):[],g=cm(a.providerData,f),h=a.isAnonymous,i=!(a.email&&e.passwordHash)&&!g?.length,j=!!h&&i;Object.assign(a,{uid:e.localId,displayName:e.displayName||null,photoURL:e.photoUrl||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,tenantId:e.tenantId||null,providerData:g,metadata:new cj(e.createdAt,e.lastLoginAt),isAnonymous:j})}async function cl(a){let b=ar(a);await ck(b),await b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)}function cm(a,b){return[...a.filter(a=>!b.some(b=>b.providerId===a.providerId)),...b]}function cn(a){return a.map(({providerId:a,...b})=>({providerId:a,uid:b.rawId||"",displayName:b.displayName||null,email:b.email||null,phoneNumber:b.phoneNumber||null,photoURL:b.photoUrl||null}))}async function co(a,b){let c=await b0(a,{},async()=>{let c=ak({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:d,apiKey:e}=a.config,f=await b2(a,d,"/v1/token",`key=${e}`),g=await a._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";let h={method:"POST",headers:g,body:c};return a.emulatorConfig&&M(a.emulatorConfig.host)&&(h.credentials="include"),bW.fetch()(f,h)});return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}}async function cp(a,b){return b_(a,"POST","/v2/accounts:revokeToken",b$(a,b))}class cq{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(a){bN(a.idToken,"internal-error"),bN(void 0!==a.idToken,"internal-error"),bN(void 0!==a.refreshToken,"internal-error");let b="expiresIn"in a&&void 0!==a.expiresIn?Number(a.expiresIn):cf(a.idToken);this.updateTokensAndExpiration(a.idToken,a.refreshToken,b)}updateFromIdToken(a){bN(0!==a.length,"internal-error");let b=cf(a);this.updateTokensAndExpiration(a,null,b)}async getToken(a,b=!1){return b||!this.accessToken||this.isExpired?(bN(this.refreshToken,a,"user-token-expired"),this.refreshToken)?(await this.refresh(a,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(a,b){let{accessToken:c,refreshToken:d,expiresIn:e}=await co(a,b);this.updateTokensAndExpiration(c,d,Number(e))}updateTokensAndExpiration(a,b,c){this.refreshToken=b||null,this.accessToken=a||null,this.expirationTime=Date.now()+1e3*c}static fromJSON(a,b){let{refreshToken:c,accessToken:d,expirationTime:e}=b,f=new cq;return c&&(bN("string"==typeof c,"internal-error",{appName:a}),f.refreshToken=c),d&&(bN("string"==typeof d,"internal-error",{appName:a}),f.accessToken=d),e&&(bN("number"==typeof e,"internal-error",{appName:a}),f.expirationTime=e),f}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(a){this.accessToken=a.accessToken,this.refreshToken=a.refreshToken,this.expirationTime=a.expirationTime}_clone(){return Object.assign(new cq,this.toJSON())}_performRefresh(){return bO("not implemented")}}function cr(a,b){bN("string"==typeof a||void 0===a,"internal-error",{appName:b})}class cs{constructor({uid:a,auth:b,stsTokenManager:c,...d}){this.providerId="firebase",this.proactiveRefresh=new ci(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=b,this.stsTokenManager=c,this.accessToken=c.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new cj(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(a){let b=await cg(this,this.stsTokenManager.getToken(this.auth,a));return bN(b,this.auth,"internal-error"),this.accessToken!==b&&(this.accessToken=b,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),b}getIdTokenResult(a){return cc(this,a)}reload(){return cl(this)}_assign(a){this!==a&&(bN(this.uid===a.uid,this.auth,"internal-error"),this.displayName=a.displayName,this.photoURL=a.photoURL,this.email=a.email,this.emailVerified=a.emailVerified,this.phoneNumber=a.phoneNumber,this.isAnonymous=a.isAnonymous,this.tenantId=a.tenantId,this.providerData=a.providerData.map(a=>({...a})),this.metadata._copy(a.metadata),this.stsTokenManager._assign(a.stsTokenManager))}_clone(a){let b=new cs({...this,auth:a,stsTokenManager:this.stsTokenManager._clone()});return b.metadata._copy(this.metadata),b}_onReload(a){bN(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=a,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(a){this.reloadListener?this.reloadListener(a):this.reloadUserInfo=a}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(a,b=!1){let c=!1;a.idToken&&a.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(a),c=!0),b&&await ck(this),await this.auth._persistUserIfCurrent(this),c&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bc(this.auth.app))return Promise.reject(bL(this.auth));let a=await this.getIdToken();return await cg(this,b9(this.auth,{idToken:a})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(a=>({...a})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(a,b){let c=b.displayName??void 0,d=b.email??void 0,e=b.phoneNumber??void 0,f=b.photoURL??void 0,g=b.tenantId??void 0,h=b._redirectEventId??void 0,i=b.createdAt??void 0,j=b.lastLoginAt??void 0,{uid:k,emailVerified:l,isAnonymous:m,providerData:n,stsTokenManager:o}=b;bN(k&&o,a,"internal-error");let p=cq.fromJSON(this.name,o);bN("string"==typeof k,a,"internal-error"),cr(c,a.name),cr(d,a.name),bN("boolean"==typeof l,a,"internal-error"),bN("boolean"==typeof m,a,"internal-error"),cr(e,a.name),cr(f,a.name),cr(g,a.name),cr(h,a.name),cr(i,a.name),cr(j,a.name);let q=new cs({uid:k,auth:a,email:d,emailVerified:l,displayName:c,isAnonymous:m,photoURL:f,phoneNumber:e,tenantId:g,stsTokenManager:p,createdAt:i,lastLoginAt:j});return n&&Array.isArray(n)&&(q.providerData=n.map(a=>({...a}))),h&&(q._redirectEventId=h),q}static async _fromIdTokenResponse(a,b,c=!1){let d=new cq;d.updateFromServerResponse(b);let e=new cs({uid:b.localId,auth:a,stsTokenManager:d,isAnonymous:c});return await ck(e),e}static async _fromGetAccountInfoResponse(a,b,c){let d=b.users[0];bN(void 0!==d.localId,"internal-error");let e=void 0!==d.providerUserInfo?cn(d.providerUserInfo):[],f=!(d.email&&d.passwordHash)&&!e?.length,g=new cq;g.updateFromIdToken(c);let h=new cs({uid:d.localId,auth:a,stsTokenManager:g,isAnonymous:f});return Object.assign(h,{uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:e,metadata:new cj(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!e?.length}),h}}let ct=new Map;function cu(a){bP(a instanceof Function,"Expected a class definition");let b=ct.get(a);return b?bP(b instanceof a,"Instance stored in cache mismatched with class"):(b=new a,ct.set(a,b)),b}class cv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(a,b){this.storage[a]=b}async _get(a){let b=this.storage[a];return void 0===b?null:b}async _remove(a){delete this.storage[a]}_addListener(a,b){}_removeListener(a,b){}}cv.type="NONE";let cw=cv;function cx(a,b,c){return`firebase:${a}:${b}:${c}`}class cy{constructor(a,b,c){this.persistence=a,this.auth=b,this.userKey=c;let{config:d,name:e}=this.auth;this.fullUserKey=cx(this.userKey,d.apiKey,e),this.fullPersistenceKey=cx("persistence",d.apiKey,e),this.boundEventHandler=b._onStorageEvent.bind(b),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(a){return this.persistence._set(this.fullUserKey,a.toJSON())}async getCurrentUser(){let a=await this.persistence._get(this.fullUserKey);if(!a)return null;if("string"==typeof a){let b=await ca(this.auth,{idToken:a}).catch(()=>void 0);return b?cs._fromGetAccountInfoResponse(this.auth,b,a):null}return cs._fromJSON(this.auth,a)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(a){if(this.persistence===a)return;let b=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=a,b)return this.setCurrentUser(b)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(a,b,c="authUser"){if(!b.length)return new cy(cu(cw),a,c);let d=(await Promise.all(b.map(async a=>{if(await a._isAvailable())return a}))).filter(a=>a),e=d[0]||cu(cw),f=cx(c,a.config.apiKey,a.name),g=null;for(let c of b)try{let b=await c._get(f);if(b){let d;if("string"==typeof b){let c=await ca(a,{idToken:b}).catch(()=>void 0);if(!c)break;d=await cs._fromGetAccountInfoResponse(a,c,b)}else d=cs._fromJSON(a,b);c!==e&&(g=d),e=c;break}}catch{}let h=d.filter(a=>a._shouldAllowMigration);return e._shouldAllowMigration&&h.length&&(e=h[0],g&&await e._set(f,g.toJSON()),await Promise.all(b.map(async a=>{if(a!==e)try{await a._remove(f)}catch{}}))),new cy(e,a,c)}}function cz(a){let b=a.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";{if(cD(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(cA(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(cF(b))return"Blackberry";if(cG(b))return"Webos";if(cB(b))return"Safari";if((b.includes("chrome/")||cC(b))&&!b.includes("edge/"))return"Chrome";if(cE(b))return"Android";let c=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,d=a.match(c);if(d?.length===2)return d[1]}return"Other"}function cA(a=U()){return/firefox\//i.test(a)}function cB(a=U()){let b=a.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function cC(a=U()){return/crios\//i.test(a)}function cD(a=U()){return/iemobile/i.test(a)}function cE(a=U()){return/android/i.test(a)}function cF(a=U()){return/blackberry/i.test(a)}function cG(a=U()){return/webos/i.test(a)}function cH(a,b=[]){let c;switch(a){case"Browser":c=cz(U());break;case"Worker":c=`${cz(U())}-${a}`;break;default:c=a}let d=b.length?b.join(","):"FirebaseCore-web";return`${c}/JsCore/${bg}/${d}`}class cI{constructor(a){this.auth=a,this.queue=[]}pushCallback(a,b){let c=b=>new Promise((c,d)=>{try{let d=a(b);c(d)}catch(a){d(a)}});c.onAbort=b,this.queue.push(c);let d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(a){if(this.auth.currentUser===a)return;let b=[];try{for(let c of this.queue)await c(a),c.onAbort&&b.push(c.onAbort)}catch(a){for(let a of(b.reverse(),b))try{a()}catch(a){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}async function cJ(a,b={}){return b_(a,"GET","/v2/passwordPolicy",b$(a,b))}let cK=6;class cL{constructor(a){let b=a.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=b.minPasswordLength??cK,b.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=b.maxPasswordLength),void 0!==b.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=b.containsLowercaseCharacter),void 0!==b.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=b.containsUppercaseCharacter),void 0!==b.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=b.containsNumericCharacter),void 0!==b.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=b.containsNonAlphanumericCharacter),this.enforcementState=a.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=a.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=a.forceUpgradeOnSignin??!1,this.schemaVersion=a.schemaVersion}validatePassword(a){let b={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(a,b),this.validatePasswordCharacterOptions(a,b),b.isValid&&(b.isValid=b.meetsMinPasswordLength??!0),b.isValid&&(b.isValid=b.meetsMaxPasswordLength??!0),b.isValid&&(b.isValid=b.containsLowercaseLetter??!0),b.isValid&&(b.isValid=b.containsUppercaseLetter??!0),b.isValid&&(b.isValid=b.containsNumericCharacter??!0),b.isValid&&(b.isValid=b.containsNonAlphanumericCharacter??!0),b}validatePasswordLengthOptions(a,b){let c=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;c&&(b.meetsMinPasswordLength=a.length>=c),d&&(b.meetsMaxPasswordLength=a.length<=d)}validatePasswordCharacterOptions(a,b){let c;this.updatePasswordCharacterOptionsStatuses(b,!1,!1,!1,!1);for(let d=0;d<a.length;d++)c=a.charAt(d),this.updatePasswordCharacterOptionsStatuses(b,c>="a"&&c<="z",c>="A"&&c<="Z",c>="0"&&c<="9",this.allowedNonAlphanumericCharacters.includes(c))}updatePasswordCharacterOptionsStatuses(a,b,c,d,e){this.customStrengthOptions.containsLowercaseLetter&&(a.containsLowercaseLetter||(a.containsLowercaseLetter=b)),this.customStrengthOptions.containsUppercaseLetter&&(a.containsUppercaseLetter||(a.containsUppercaseLetter=c)),this.customStrengthOptions.containsNumericCharacter&&(a.containsNumericCharacter||(a.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(a.containsNonAlphanumericCharacter||(a.containsNonAlphanumericCharacter=e))}}class cM{constructor(a,b,c,d){this.app=a,this.heartbeatServiceProvider=b,this.appCheckServiceProvider=c,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cO(this),this.idTokenSubscription=new cO(this),this.beforeStateQueue=new cI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=a.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(a,b){return b&&(this._popupRedirectResolver=cu(b)),this._initializationPromise=this.queue(async()=>{if(!this._deleted){if(this.persistenceManager=await cy.create(this,a),this._resolvePersistenceManagerAvailable?.(),!this._deleted){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(a){}await this.initializeCurrentUser(b),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let a=await this.assertedPersistence.getCurrentUser();if(this.currentUser||a){if(this.currentUser&&a&&this.currentUser.uid===a.uid){this._currentUser._assign(a),await this.currentUser.getIdToken();return}await this._updateCurrentUser(a,!0)}}async initializeCurrentUserFromIdToken(a){try{let b=await ca(this,{idToken:a}),c=await cs._fromGetAccountInfoResponse(this,b,a);await this.directlySetCurrentUser(c)}catch(a){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",a),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(a){if(bc(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(b=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(b,b))}):this.directlySetCurrentUser(null)}let b=await this.assertedPersistence.getCurrentUser(),c=b,d=!1;if(a&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let b=this.redirectUser?._redirectEventId,e=c?._redirectEventId,f=await this.tryRedirectSignIn(a);(!b||b===e)&&f?.user&&(c=f.user,d=!0)}if(!c)return this.directlySetCurrentUser(null);if(!c._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(c)}catch(a){c=b,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return c?this.reloadAndSetCurrentUserOrClear(c):this.directlySetCurrentUser(null)}return(bN(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===c._redirectEventId)?this.directlySetCurrentUser(c):this.reloadAndSetCurrentUserOrClear(c)}async tryRedirectSignIn(a){let b=null;try{b=await this._popupRedirectResolver._completeRedirectFn(this,a,!0)}catch(a){await this._setRedirectUser(null)}return b}async reloadAndSetCurrentUserOrClear(a){try{await ck(a)}catch(a){if(a?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(a)}useDeviceLanguage(){this.languageCode=bT()}async _delete(){this._deleted=!0}async updateCurrentUser(a){if(bc(this.app))return Promise.reject(bL(this));let b=a?ar(a):null;return b&&bN(b.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(b&&b._clone(this))}async _updateCurrentUser(a,b=!1){if(!this._deleted)return a&&bN(this.tenantId===a.tenantId,this,"tenant-id-mismatch"),b||await this.beforeStateQueue.runMiddleware(a),this.queue(async()=>{await this.directlySetCurrentUser(a),this.notifyAuthListeners()})}async signOut(){return bc(this.app)?Promise.reject(bL(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(a){return bc(this.app)?Promise.reject(bL(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cu(a))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(a){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let b=this._getPasswordPolicyInternal();return b.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):b.validatePassword(a)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let a=new cL(await cJ(this));null===this.tenantId?this._projectPasswordPolicy=a:this._tenantPasswordPolicies[this.tenantId]=a}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(a){this._errorFactory=new ae("auth","Firebase",a())}onAuthStateChanged(a,b,c){return this.registerStateListener(this.authStateSubscription,a,b,c)}beforeAuthStateChanged(a,b){return this.beforeStateQueue.pushCallback(a,b)}onIdTokenChanged(a,b,c){return this.registerStateListener(this.idTokenSubscription,a,b,c)}authStateReady(){return new Promise((a,b)=>{if(this.currentUser)a();else{let c=this.onAuthStateChanged(()=>{c(),a()},b)}})}async revokeAccessToken(a){if(this.currentUser){let b={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:a,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(b.tenantId=this.tenantId),await cp(this,b)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(a,b){let c=await this.getOrInitRedirectPersistenceManager(b);return null===a?c.removeCurrentUser():c.setCurrentUser(a)}async getOrInitRedirectPersistenceManager(a){if(!this.redirectPersistenceManager){let b=a&&cu(a)||this._popupRedirectResolver;bN(b,this,"argument-error"),this.redirectPersistenceManager=await cy.create(this,[cu(b._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(a){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===a)?this._currentUser:this.redirectUser?._redirectEventId===a?this.redirectUser:null}async _persistUserIfCurrent(a){if(a===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(a))}_notifyListenersIfCurrent(a){a===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let a=this.currentUser?.uid??null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(a,b,c,d){if(this._deleted)return()=>{};let e="function"==typeof b?b:b.next.bind(b),f=!1,g=this._isInitialized?Promise.resolve():this._initializationPromise;if(bN(g,this,"internal-error"),g.then(()=>{f||e(this.currentUser)}),"function"==typeof b){let e=a.addObserver(b,c,d);return()=>{f=!0,e()}}{let c=a.addObserver(b);return()=>{f=!0,c()}}}async directlySetCurrentUser(a){this.currentUser&&this.currentUser!==a&&this._currentUser._stopProactiveRefresh(),a&&this.isProactiveRefreshEnabled&&a._startProactiveRefresh(),this.currentUser=a,a?await this.assertedPersistence.setCurrentUser(a):await this.assertedPersistence.removeCurrentUser()}queue(a){return this.operations=this.operations.then(a,a),this.operations}get assertedPersistence(){return bN(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(a){!a||this.frameworks.includes(a)||(this.frameworks.push(a),this.frameworks.sort(),this.clientVersion=cH(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let a={"X-Client-Version":this.clientVersion};this.app.options.appId&&(a["X-Firebase-gmpid"]=this.app.options.appId);let b=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();b&&(a["X-Firebase-Client"]=b);let c=await this._getAppCheckToken();return c&&(a["X-Firebase-AppCheck"]=c),a}async _getAppCheckToken(){if(bc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let a=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return a?.error&&bG(`Error while retrieving App Check token: ${a.error}`),a?.token}}function cN(a){return ar(a)}class cO{constructor(a){this.auth=a,this.observer=null,this.addObserver=an(a=>this.observer=a)}get next(){return bN(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let cP={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cQ(a){return cP.loadJS(a)}function cR(){return cP.recaptchaEnterpriseScript}class cS{constructor(){this.enterprise=new cT}ready(a){a()}execute(a,b){return Promise.resolve("token")}render(a,b){return""}}class cT{ready(a){a()}execute(a,b){return Promise.resolve("token")}render(a,b){return""}}let cU="recaptcha-enterprise",cV="NO_RECAPTCHA";class cW{constructor(a){this.type=cU,this.auth=cN(a)}async verify(a="verify",b=!1){async function c(a){if(!b){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(b,c)=>{b8(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0===d.recaptchaKey)c(Error("recaptcha Enterprise site key undefined"));else{let c=new b7(d);return null==a.tenantId?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,b(c.siteKey)}}).catch(a=>{c(a)})})}function d(b,c,d){let e=window.grecaptcha;b6(e)?e.enterprise.ready(()=>{e.enterprise.execute(b,{action:a}).then(a=>{c(a)}).catch(()=>{c(cV)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new cS().execute("siteKey",{action:"verify"}):new Promise((a,e)=>{c(this.auth).then(c=>{if(!b&&b6(window.grecaptcha))d(c,a,e);else{if("undefined"==typeof window)return void e(Error("RecaptchaVerifier is only supported in browser"));let b=cR();0!==b.length&&(b+=c),cQ(b).then(()=>{d(c,a,e)}).catch(a=>{e(a)})}}).catch(a=>{e(a)})})}}async function cX(a,b,c,d=!1,e=!1){let f,g=new cW(a);if(e)f=cV;else try{f=await g.verify(c)}catch(a){f=await g.verify(c,!0)}let h={...b};if("mfaSmsEnrollment"===c||"mfaSmsSignIn"===c){if("phoneEnrollmentInfo"in h){let a=h.phoneEnrollmentInfo.phoneNumber,b=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:b,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){let a=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:a,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return d?Object.assign(h,{captchaResp:f}):Object.assign(h,{captchaResponse:f}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function cY(a,b,c,d,e){if("EMAIL_PASSWORD_PROVIDER"===e)if(!a._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return d(a,b).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log(`${c} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let e=await cX(a,b,c,"getOobCode"===c);return d(a,e)}});else{let e=await cX(a,b,c,"getOobCode"===c);return d(a,e)}if("PHONE_PROVIDER"!==e)return Promise.reject(e+" provider is not supported.");if(a._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let e=await cX(a,b,c);return d(a,e).catch(async e=>{if(a._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===e.code||"auth/invalid-app-credential"===e.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${c} flow.`);let e=await cX(a,b,c,!1,!0);return d(a,e)}return Promise.reject(e)})}{let e=await cX(a,b,c,!1,!0);return d(a,e)}}function cZ(a,b){let c=ba(a,"auth");if(c.isInitialized()){let a=c.getImmediate();if(ai(c.getOptions(),b??{}))return a;bI(a,"already-initialized")}return c.initialize({options:b})}function c$(a,b){let c=b?.persistence||[],d=(Array.isArray(c)?c:[c]).map(cu);b?.errorMap&&a._updateErrorMap(b.errorMap),a._initializeWithPersistence(d,b?.popupRedirectResolver)}function c_(a,b,c){let d=cN(a);bN(/^https?:\/\//.test(b),d,"invalid-emulator-scheme");let e=!!c?.disableWarnings,f=c0(b),{host:g,port:h}=c1(b),i=null===h?"":`:${h}`,j={url:`${f}//${g}${i}/`},k=Object.freeze({host:g,port:h,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:e})});if(!d._canInitEmulator){bN(d.config.emulator&&d.emulatorConfig,d,"emulator-config-failed"),bN(ai(j,d.config.emulator)&&ai(k,d.emulatorConfig),d,"emulator-config-failed");return}d.config.emulator=j,d.emulatorConfig=k,d.settings.appVerificationDisabledForTesting=!0,M(g)?(N(`${f}//${g}${i}`),T("Auth",!0)):e||c3()}function c0(a){let b=a.indexOf(":");return b<0?"":a.substr(0,b+1)}function c1(a){let b=c0(a),c=/(\/\/)?([^?#/]+)/.exec(a.substr(b.length));if(!c)return{host:"",port:null};let d=c[2].split("@").pop()||"",e=/^(\[[^\]]+\])(:|$)/.exec(d);if(e){let a=e[1];return{host:a,port:c2(d.substr(a.length+1))}}{let[a,b]=d.split(":");return{host:a,port:c2(b)}}}function c2(a){if(!a)return null;let b=Number(a);return isNaN(b)?null:b}function c3(){function a(){let a=document.createElement("p"),b=a.style;a.innerText="Running in emulator mode. Do not use with production credentials.",b.position="fixed",b.width="100%",b.backgroundColor="#ffffff",b.border=".1em solid #000000",b.color="#b50000",b.bottom="0px",b.left="0px",b.margin="0px",b.zIndex="10000",b.textAlign="center",a.classList.add("firebase-emulator-warning"),document.body.appendChild(a)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a())}class c4{constructor(a,b){this.providerId=a,this.signInMethod=b}toJSON(){return bO("not implemented")}_getIdTokenResponse(a){return bO("not implemented")}_linkToIdToken(a,b){return bO("not implemented")}_getReauthenticationResolver(a){return bO("not implemented")}}async function c5(a,b){return b_(a,"POST","/v1/accounts:resetPassword",b$(a,b))}async function c6(a,b){return b_(a,"POST","/v1/accounts:update",b)}async function c7(a,b){return b_(a,"POST","/v1/accounts:signUp",b)}async function c8(a,b){return b1(a,"POST","/v1/accounts:signInWithPassword",b$(a,b))}async function c9(a,b){return b_(a,"POST","/v1/accounts:sendOobCode",b$(a,b))}async function da(a,b){return b1(a,"POST","/v1/accounts:signInWithEmailLink",b$(a,b))}async function db(a,b){return b1(a,"POST","/v1/accounts:signInWithEmailLink",b$(a,b))}class dc extends c4{constructor(a,b,c,d=null){super("password",c),this._email=a,this._password=b,this._tenantId=d}static _fromEmailAndPassword(a,b){return new dc(a,b,"password")}static _fromEmailAndCode(a,b,c=null){return new dc(a,b,"emailLink",c)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(a){let b="string"==typeof a?JSON.parse(a):a;if(b?.email&&b?.password){if("password"===b.signInMethod)return this._fromEmailAndPassword(b.email,b.password);else if("emailLink"===b.signInMethod)return this._fromEmailAndCode(b.email,b.password,b.tenantId)}return null}async _getIdTokenResponse(a){switch(this.signInMethod){case"password":return cY(a,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",c8,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return da(a,{email:this._email,oobCode:this._password});default:bI(a,"internal-error")}}async _linkToIdToken(a,b){switch(this.signInMethod){case"password":return cY(a,{idToken:b,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",c7,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return db(a,{idToken:b,email:this._email,oobCode:this._password});default:bI(a,"internal-error")}}_getReauthenticationResolver(a){return this._getIdTokenResponse(a)}}async function dd(a,b){return b1(a,"POST","/v1/accounts:signInWithIdp",b$(a,b))}let de="http://localhost";class df extends c4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(a){let b=new df(a.providerId,a.signInMethod);return a.idToken||a.accessToken?(a.idToken&&(b.idToken=a.idToken),a.accessToken&&(b.accessToken=a.accessToken),a.nonce&&!a.pendingToken&&(b.nonce=a.nonce),a.pendingToken&&(b.pendingToken=a.pendingToken)):a.oauthToken&&a.oauthTokenSecret?(b.accessToken=a.oauthToken,b.secret=a.oauthTokenSecret):bI("argument-error"),b}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(a){let{providerId:b,signInMethod:c,...d}="string"==typeof a?JSON.parse(a):a;if(!b||!c)return null;let e=new df(b,c);return e.idToken=d.idToken||void 0,e.accessToken=d.accessToken||void 0,e.secret=d.secret,e.nonce=d.nonce,e.pendingToken=d.pendingToken||null,e}_getIdTokenResponse(a){return dd(a,this.buildRequest())}_linkToIdToken(a,b){let c=this.buildRequest();return c.idToken=b,dd(a,c)}_getReauthenticationResolver(a){let b=this.buildRequest();return b.autoCreate=!1,dd(a,b)}buildRequest(){let a={requestUri:de,returnSecureToken:!0};if(this.pendingToken)a.pendingToken=this.pendingToken;else{let b={};this.idToken&&(b.id_token=this.idToken),this.accessToken&&(b.access_token=this.accessToken),this.secret&&(b.oauth_token_secret=this.secret),b.providerId=this.providerId,this.nonce&&!this.pendingToken&&(b.nonce=this.nonce),a.postBody=ak(b)}return a}}async function dg(a,b){return b1(a,"POST","/v1/accounts:signInWithPhoneNumber",b$(a,b))}async function dh(a,b){let c=await b1(a,"POST","/v1/accounts:signInWithPhoneNumber",b$(a,b));if(c.temporaryProof)throw b5(a,"account-exists-with-different-credential",c);return c}let di={USER_NOT_FOUND:"user-not-found"};async function dj(a,b){return b1(a,"POST","/v1/accounts:signInWithPhoneNumber",b$(a,{...b,operation:"REAUTH"}),di)}class dk extends c4{constructor(a){super("phone","phone"),this.params=a}static _fromVerification(a,b){return new dk({verificationId:a,verificationCode:b})}static _fromTokenResponse(a,b){return new dk({phoneNumber:a,temporaryProof:b})}_getIdTokenResponse(a){return dg(a,this._makeVerificationRequest())}_linkToIdToken(a,b){return dh(a,{idToken:b,...this._makeVerificationRequest()})}_getReauthenticationResolver(a){return dj(a,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:a,phoneNumber:b,verificationId:c,verificationCode:d}=this.params;return a&&b?{temporaryProof:a,phoneNumber:b}:{sessionInfo:c,code:d}}toJSON(){let a={providerId:this.providerId};return this.params.phoneNumber&&(a.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(a.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(a.verificationCode=this.params.verificationCode),this.params.verificationId&&(a.verificationId=this.params.verificationId),a}static fromJSON(a){"string"==typeof a&&(a=JSON.parse(a));let{verificationId:b,verificationCode:c,phoneNumber:d,temporaryProof:e}=a;return c||b||d||e?new dk({verificationId:b,verificationCode:c,phoneNumber:d,temporaryProof:e}):null}}function dl(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dm(a){let b=al(am(a)).link,c=b?al(am(b)).deep_link_id:null,d=al(am(a)).deep_link_id;return(d?al(am(d)).link:null)||d||c||b||a}class dn{constructor(a){let b=al(am(a)),c=b.apiKey??null,d=b.oobCode??null,e=dl(b.mode??null);bN(c&&d&&e,"argument-error"),this.apiKey=c,this.operation=e,this.code=d,this.continueUrl=b.continueUrl??null,this.languageCode=b.lang??null,this.tenantId=b.tenantId??null}static parseLink(a){let b=dm(a);try{return new dn(b)}catch{return null}}}class dp{constructor(){this.providerId=dp.PROVIDER_ID}static credential(a,b){return dc._fromEmailAndPassword(a,b)}static credentialWithLink(a,b){let c=dn.parseLink(b);return bN(c,"argument-error"),dc._fromEmailAndCode(a,c.code,c.tenantId)}}dp.PROVIDER_ID="password",dp.EMAIL_PASSWORD_SIGN_IN_METHOD="password",dp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class dq{constructor(a){this.providerId=a,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(a){this.defaultLanguageCode=a}setCustomParameters(a){return this.customParameters=a,this}getCustomParameters(){return this.customParameters}}class dr extends dq{constructor(){super(...arguments),this.scopes=[]}addScope(a){return this.scopes.includes(a)||this.scopes.push(a),this}getScopes(){return[...this.scopes]}}class ds extends null{static credentialFromJSON(a){let b="string"==typeof a?JSON.parse(a):a;return bN("providerId"in b&&"signInMethod"in b,"argument-error"),df._fromParams(b)}credential(a){return this._credential({...a,nonce:a.rawNonce})}_credential(a){return bN(a.idToken||a.accessToken,"argument-error"),df._fromParams({...a,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(a){return ds.oauthCredentialFromTaggedObject(a)}static credentialFromError(a){return ds.oauthCredentialFromTaggedObject(a.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthIdToken:b,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:e,nonce:f,providerId:g}=a;if(!c&&!d&&!b&&!e||!g)return null;try{return new ds(g)._credential({idToken:b,accessToken:c,nonce:f,pendingToken:e})}catch(a){return null}}}class dt extends dr{constructor(){super("facebook.com")}static credential(a){return df._fromParams({providerId:dt.PROVIDER_ID,signInMethod:dt.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return dt.credentialFromTaggedObject(a)}static credentialFromError(a){return dt.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return dt.credential(a.oauthAccessToken)}catch{return null}}}dt.FACEBOOK_SIGN_IN_METHOD="facebook.com",dt.PROVIDER_ID="facebook.com";class du extends dr{constructor(){super("google.com"),this.addScope("profile")}static credential(a,b){return df._fromParams({providerId:du.PROVIDER_ID,signInMethod:du.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:b})}static credentialFromResult(a){return du.credentialFromTaggedObject(a)}static credentialFromError(a){return du.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthIdToken:b,oauthAccessToken:c}=a;if(!b&&!c)return null;try{return du.credential(b,c)}catch{return null}}}du.GOOGLE_SIGN_IN_METHOD="google.com",du.PROVIDER_ID="google.com";class dv extends dr{constructor(){super("github.com")}static credential(a){return df._fromParams({providerId:dv.PROVIDER_ID,signInMethod:dv.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return dv.credentialFromTaggedObject(a)}static credentialFromError(a){return dv.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return dv.credential(a.oauthAccessToken)}catch{return null}}}dv.GITHUB_SIGN_IN_METHOD="github.com",dv.PROVIDER_ID="github.com";let dw="http://localhost";class dx extends c4{constructor(a,b){super(a,a),this.pendingToken=b}_getIdTokenResponse(a){return dd(a,this.buildRequest())}_linkToIdToken(a,b){let c=this.buildRequest();return c.idToken=b,dd(a,c)}_getReauthenticationResolver(a){let b=this.buildRequest();return b.autoCreate=!1,dd(a,b)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(a){let{providerId:b,signInMethod:c,pendingToken:d}="string"==typeof a?JSON.parse(a):a;return b&&c&&d&&b===c?new dx(b,d):null}static _create(a,b){return new dx(a,b)}buildRequest(){return{requestUri:dw,returnSecureToken:!0,pendingToken:this.pendingToken}}}let dy="saml.";class dz extends dq{constructor(a){bN(a.startsWith(dy),"argument-error"),super(a)}static credentialFromResult(a){return dz.samlCredentialFromTaggedObject(a)}static credentialFromError(a){return dz.samlCredentialFromTaggedObject(a.customData||{})}static credentialFromJSON(a){let b=dx.fromJSON(a);return bN(b,"argument-error"),b}static samlCredentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{pendingToken:b,providerId:c}=a;if(!b||!c)return null;try{return dx._create(c,b)}catch(a){return null}}}class dA extends dr{constructor(){super("twitter.com")}static credential(a,b){return df._fromParams({providerId:dA.PROVIDER_ID,signInMethod:dA.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:b})}static credentialFromResult(a){return dA.credentialFromTaggedObject(a)}static credentialFromError(a){return dA.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthAccessToken:b,oauthTokenSecret:c}=a;if(!b||!c)return null;try{return dA.credential(b,c)}catch{return null}}}dA.TWITTER_SIGN_IN_METHOD="twitter.com",dA.PROVIDER_ID="twitter.com";class dB{constructor(a){this.user=a.user,this.providerId=a.providerId,this._tokenResponse=a._tokenResponse,this.operationType=a.operationType}static async _fromIdTokenResponse(a,b,c,d=!1){return new dB({user:await cs._fromIdTokenResponse(a,c,d),providerId:dC(c),_tokenResponse:c,operationType:b})}static async _forOperation(a,b,c){return await a._updateTokensIfNecessary(c,!0),new dB({user:a,providerId:dC(c),_tokenResponse:c,operationType:b})}}function dC(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class dD extends ad{constructor(a,b,c,d){super(b.code,b.message),this.operationType=c,this.user=d,Object.setPrototypeOf(this,dD.prototype),this.customData={appName:a.name,tenantId:a.tenantId??void 0,_serverResponse:b.customData._serverResponse,operationType:c}}static _fromErrorAndOperation(a,b,c,d){return new dD(a,b,c,d)}}function dE(a,b,c,d){return("reauthenticate"===b?c._getReauthenticationResolver(a):c._getIdTokenResponse(a)).catch(c=>{if("auth/multi-factor-auth-required"===c.code)throw dD._fromErrorAndOperation(a,c,b,d);throw c})}function dF(a){return new Set(a.map(({providerId:a})=>a).filter(a=>!!a))}async function dG(a,b,c=!1){if(_isFirebaseServerApp(a.app))return Promise.reject(bL(a));let d="signIn",e=await dE(a,d,b),f=await dB._fromIdTokenResponse(a,d,e);return c||await a._updateCurrentUser(f.user),f}class dH{constructor(a,b){this.factorId=a,this.uid=b.mfaEnrollmentId,this.enrollmentTime=new Date(b.enrolledAt).toUTCString(),this.displayName=b.displayName}static _fromServerResponse(a,b){return"phoneInfo"in b?dI._fromServerResponse(a,b):"totpInfo"in b?dJ._fromServerResponse(a,b):bI(a,"internal-error")}}class dI extends dH{constructor(a){super("phone",a),this.phoneNumber=a.phoneInfo}static _fromServerResponse(a,b){return new dI(b)}}class dJ extends dH{constructor(a){super("totp",a)}static _fromServerResponse(a,b){return new dJ(b)}}class dK{constructor(a,b,c={}){this.isNewUser=a,this.providerId=b,this.profile=c}}class dL extends dK{constructor(a,b,c,d){super(a,b,c),this.username=d}}class dM extends dK{constructor(a,b){super(a,"facebook.com",b)}}class dN extends dL{constructor(a,b){super(a,"github.com",b,"string"==typeof b?.login?b?.login:null)}}class dO extends dK{constructor(a,b){super(a,"google.com",b)}}class dP extends dL{constructor(a,b,c){super(a,"twitter.com",b,c)}}function dQ(a,b,c,d){return ar(a).onAuthStateChanged(b,c,d)}function dR(a){return ar(a).signOut()}class dS{constructor(a,b,c){this.type=a,this.credential=b,this.user=c}static _fromIdtoken(a,b){return new dS("enroll",a,b)}static _fromMfaPendingCredential(a){return new dS("signin",a)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(a){if(a?.multiFactorSession){if(a.multiFactorSession?.pendingCredential)return dS._fromMfaPendingCredential(a.multiFactorSession.pendingCredential);else if(a.multiFactorSession?.idToken)return dS._fromIdtoken(a.multiFactorSession.idToken)}return null}}class dT{constructor(a,b,c){this.session=a,this.hints=b,this.signInResolver=c}static _fromError(a,b){let c=cN(a),d=b.customData._serverResponse,e=(d.mfaInfo||[]).map(a=>dH._fromServerResponse(c,a));bN(d.mfaPendingCredential,c,"internal-error");let f=dS._fromMfaPendingCredential(d.mfaPendingCredential);return new dT(f,e,async a=>{let e=await a._process(c,f);delete d.mfaInfo,delete d.mfaPendingCredential;let g={...d,idToken:e.idToken,refreshToken:e.refreshToken};switch(b.operationType){case"signIn":let h=await dB._fromIdTokenResponse(c,b.operationType,g);return await c._updateCurrentUser(h.user),h;case"reauthenticate":return bN(b.user,c,"internal-error"),dB._forOperation(b.user,b.operationType,g);default:bI(c,"internal-error")}})}async resolveSignIn(a){let b=a;return this.signInResolver(b)}}function dU(a,b){return b_(a,"POST","/v2/accounts/mfaEnrollment:start",b$(a,b))}function dV(a,b){return b_(a,"POST","/v2/accounts/mfaEnrollment:finalize",b$(a,b))}function dW(a,b){return b_(a,"POST","/v2/accounts/mfaEnrollment:withdraw",b$(a,b))}class dX{constructor(a){this.user=a,this.enrolledFactors=[],a._onReload(b=>{b.mfaInfo&&(this.enrolledFactors=b.mfaInfo.map(b=>dH._fromServerResponse(a.auth,b)))})}static _fromUser(a){return new dX(a)}async getSession(){return dS._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(a,b){let c=a,d=await this.getSession(),e=await cg(this.user,c._process(this.user.auth,d,b));return await this.user._updateTokensIfNecessary(e),this.user.reload()}async unenroll(a){let b="string"==typeof a?a:a.uid,c=await this.user.getIdToken();try{let a=await cg(this.user,dW(this.user.auth,{idToken:c,mfaEnrollmentId:b}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==b),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}new WeakMap;var dY="@firebase/auth",dZ="1.11.0";class d${constructor(a){this.auth=a,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(a){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(a)}:null}addAuthTokenListener(a){if(this.assertAuthConfigured(),this.internalListeners.has(a))return;let b=this.auth.onIdTokenChanged(b=>{a(b?.stsTokenManager.accessToken||null)});this.internalListeners.set(a,b),this.updateProactiveRefresh()}removeAuthTokenListener(a){this.assertAuthConfigured();let b=this.internalListeners.get(a);b&&(this.internalListeners.delete(a),b(),this.updateProactiveRefresh())}assertAuthConfigured(){bN(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function d_(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function d0(a){a9(new as("auth",(b,{options:c})=>{let d=b.getProvider("app").getImmediate(),e=b.getProvider("heartbeat"),f=b.getProvider("app-check-internal"),{apiKey:g,authDomain:h}=d.options;bN(g&&!g.includes(":"),"invalid-api-key",{appName:d.name});let i=new cM(d,e,f,{apiKey:g,authDomain:h,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cH(a)});return c$(i,c),i},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((a,b,c)=>{a.getProvider("auth-internal").initialize()})),a9(new as("auth-internal",a=>new d$(cN(a.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),bl(dY,dZ,d_(a)),bl(dY,dZ,"esm2020")}function d1(a=bi()){let b=ba(a,"auth");if(b.isInitialized())return b.getImmediate();let c=cZ(a),d=I("auth");return d&&c_(c,`http://${d}`),c}function d2(a,b){return b_(a,"POST","/v2/accounts/mfaSignIn:finalize",b$(a,b))}bW.initialize(fetch,Headers,Response),d0("Node"),bJ("operation-not-supported-in-this-environment"),cM.prototype.setPersistence=async()=>{};class d3{constructor(a){this.factorId=a}_process(a,b,c){switch(b.type){case"enroll":return this._finalizeEnroll(a,b.credential,c);case"signin":return this._finalizeSignIn(a,b.credential);default:return bO("unexpected MultiFactorSessionType")}}}class d4{static assertionForEnrollment(a,b){return d5._fromSecret(a,b)}static assertionForSignIn(a,b){return d5._fromEnrollmentId(a,b)}static async generateSecret(a){let b=a;bN(void 0!==b.user?.auth,"internal-error");let c=await dU(b.user.auth,{idToken:b.credential,totpEnrollmentInfo:{}});return d6._fromStartTotpMfaEnrollmentResponse(c,b.user.auth)}}d4.FACTOR_ID="totp";class d5 extends d3{constructor(a,b,c){super("totp"),this.otp=a,this.enrollmentId=b,this.secret=c}static _fromSecret(a,b){return new d5(b,void 0,a)}static _fromEnrollmentId(a,b){return new d5(b,a)}async _finalizeEnroll(a,b,c){return bN(void 0!==this.secret,a,"argument-error"),dV(a,{idToken:b,displayName:c,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(a,b){bN(void 0!==this.enrollmentId&&void 0!==this.otp,a,"argument-error");let c={verificationCode:this.otp};return d2(a,{mfaPendingCredential:b,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:c})}}class d6{constructor(a,b,c,d,e,f,g){this.sessionInfo=f,this.auth=g,this.secretKey=a,this.hashingAlgorithm=b,this.codeLength=c,this.codeIntervalSeconds=d,this.enrollmentCompletionDeadline=e}static _fromStartTotpMfaEnrollmentResponse(a,b){return new d6(a.totpSessionInfo.sharedSecretKey,a.totpSessionInfo.hashingAlgorithm,a.totpSessionInfo.verificationCodeLength,a.totpSessionInfo.periodSec,new Date(a.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),a.totpSessionInfo.sessionInfo,b)}_makeTotpVerificationInfo(a){return{sessionInfo:this.sessionInfo,verificationCode:a}}generateQrCodeUrl(a,b){let c=!1;return(d7(a)||d7(b))&&(c=!0),c&&(d7(a)&&(a=this.auth.currentUser?.email||"unknownuser"),d7(b)&&(b=this.auth.name)),`otpauth://totp/${b}:${a}?secret=${this.secretKey}&issuer=${b}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function d7(a){return void 0===a||a?.length===0}var d8=c(28354),d9="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ea={};(function(){function a(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function b(a,b,c){c||(c=0);var d=Array(16);if("string"==typeof b)for(var e=0;16>e;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;16>e;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.g[0],c=a.g[1],e=a.g[2];var f=a.g[3],g=b+(f^c&(e^f))+d[0]+0xd76aa478|0;g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[1]+0xe8c7b756|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[2]+0x242070db|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[3]+0xc1bdceee|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[4]+0xf57c0faf|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[5]+0x4787c62a|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[6]+0xa8304613|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[7]+0xfd469501|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[8]+0x698098d8|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[9]+0x8b44f7af|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[10]+0xffff5bb1|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[11]+0x895cd7be|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[12]+0x6b901122|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[13]+0xfd987193|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[14]+0xa679438e|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[15]+0x49b40821|0,c=e+(g<<22|g>>>10),g=b+(e^f&(c^e))+d[1]+0xf61e2562|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[6]+0xc040b340|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[11]+0x265e5a51|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[0]+0xe9b6c7aa|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[5]+0xd62f105d|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[10]+0x2441453|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[15]+0xd8a1e681|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[4]+0xe7d3fbc8|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[9]+0x21e1cde6|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[14]+0xc33707d6|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[3]+0xf4d50d87|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[8]+0x455a14ed|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[13]+0xa9e3e905|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[2]+0xfcefa3f8|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[7]+0x676f02d9|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[12]+0x8d2a4c8a|0,g=b+((c=e+(g<<20|g>>>12))^e^f)+d[5]+0xfffa3942|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[8]+0x8771f681|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[11]+0x6d9d6122|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[14]+0xfde5380c|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[1]+0xa4beea44|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[4]+0x4bdecfa9|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[7]+0xf6bb4b60|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[10]+0xbebfbc70|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[13]+0x289b7ec6|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[0]+0xeaa127fa|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[3]+0xd4ef3085|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[6]+0x4881d05|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[9]+0xd9d4d039|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[12]+0xe6db99e5|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[15]+0x1fa27cf8|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[2]+0xc4ac5665|0,c=e+(g<<23|g>>>9),g=b+(e^(c|~f))+d[0]+0xf4292244|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[7]+0x432aff97|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[14]+0xab9423a7|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[5]+0xfc93a039|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[12]+0x655b59c3|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[3]+0x8f0ccc92|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[10]+0xffeff47d|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[1]+0x85845dd1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[8]+0x6fa87e4f|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[15]+0xfe2ce6e0|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[6]+0xa3014314|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[13]+0x4e0811a1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[4]+0xf7537e82|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[11]+0xbd3af235|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[2]+0x2ad7d2bb|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[9]+0xeb86d391|0,a.g[0]=a.g[0]+b|0,a.g[1]=a.g[1]+(e+(g<<21|g>>>11))|0,a.g[2]=a.g[2]+e|0,a.g[3]=a.g[3]+f|0}function c(a,b){var c=f;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function d(a,b){this.h=b;for(var c=[],d=!0,e=a.length-1;0<=e;e--){var f=0|a[e];d&&f==b||(c[e]=f,d=!1)}this.g=c}(function(a,b){function c(){}c.prototype=b.prototype,a.D=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.C=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}})(a,function(){this.blockSize=-1}),a.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},a.prototype.u=function(a,c){void 0===c&&(c=a.length);for(var d=c-this.blockSize,e=this.B,f=this.h,g=0;g<c;){if(0==f)for(;g<=d;)b(this,a,g),g+=this.blockSize;if("string"==typeof a){for(;g<c;)if(e[f++]=a.charCodeAt(g++),f==this.blockSize){b(this,e),f=0;break}}else for(;g<c;)if(e[f++]=a[g++],f==this.blockSize){b(this,e),f=0;break}}this.h=f,this.o+=c},a.prototype.v=function(){var a=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;var c=8*this.o;for(b=a.length-8;b<a.length;++b)a[b]=255&c,c/=256;for(this.u(a),a=Array(16),b=c=0;4>b;++b)for(var d=0;32>d;d+=8)a[c++]=this.g[b]>>>d&255;return a};var e,f={};function g(a){return -128<=a&&128>a?c(a,function(a){return new d([0|a],0>a?-1:0)}):new d([0|a],0>a?-1:0)}function h(a){if(isNaN(a)||!isFinite(a))return j;if(0>a)return q(h(-a));for(var b=[],c=1,e=0;a>=c;e++)b[e]=a/c|0,c*=0x100000000;return new d(b,0)}function i(a,b){if(0==a.length)throw Error("number format error: empty string");if(2>(b=b||10)||36<b)throw Error("radix out of range: "+b);if("-"==a.charAt(0))return q(i(a.substring(1),b));if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character');for(var c=h(Math.pow(b,8)),d=j,e=0;e<a.length;e+=8){var f=Math.min(8,a.length-e),g=parseInt(a.substring(e,e+f),b);8>f?(f=h(Math.pow(b,f)),d=d.j(f).add(h(g))):d=(d=d.j(c)).add(h(g))}return d}var j=g(0),m=g(1),n=g(0x1000000);function o(a){if(0!=a.h)return!1;for(var b=0;b<a.g.length;b++)if(0!=a.g[b])return!1;return!0}function p(a){return -1==a.h}function q(a){for(var b=a.g.length,c=[],e=0;e<b;e++)c[e]=~a.g[e];return new d(c,~a.h).add(m)}function r(a,b){return a.add(q(b))}function s(a,b){for(;(65535&a[b])!=a[b];)a[b+1]+=a[b]>>>16,a[b]&=65535,b++}function t(a,b){this.g=a,this.h=b}function u(a,b){if(o(b))throw Error("division by zero");if(o(a))return new t(j,j);if(p(a))return b=u(q(a),b),new t(q(b.g),q(b.h));if(p(b))return b=u(a,q(b)),new t(q(b.g),b.h);if(30<a.g.length){if(p(a)||p(b))throw Error("slowDivide_ only works with positive integers.");for(var c=m,d=b;0>=d.l(a);)c=v(c),d=v(d);var e=w(c,1),f=w(d,1);for(d=w(d,2),c=w(c,2);!o(d);){var g=f.add(d);0>=g.l(a)&&(e=e.add(c),f=g),d=w(d,1),c=w(c,1)}return b=r(a,e.j(b)),new t(e,b)}for(e=j;0<=a.l(b);){for(d=48>=(d=Math.ceil(Math.log(c=Math.max(1,Math.floor(a.m()/b.m())))/Math.LN2))?1:Math.pow(2,d-48),g=(f=h(c)).j(b);p(g)||0<g.l(a);)c-=d,g=(f=h(c)).j(b);o(f)&&(f=m),e=e.add(f),a=r(a,g)}return new t(e,a)}function v(a){for(var b=a.g.length+1,c=[],e=0;e<b;e++)c[e]=a.i(e)<<1|a.i(e-1)>>>31;return new d(c,a.h)}function w(a,b){var c=b>>5;b%=32;for(var e=a.g.length-c,f=[],g=0;g<e;g++)f[g]=0<b?a.i(g+c)>>>b|a.i(g+c+1)<<32-b:a.i(g+c);return new d(f,a.h)}(e=d.prototype).m=function(){if(p(this))return-q(this).m();for(var a=0,b=1,c=0;c<this.g.length;c++){var d=this.i(c);a+=(0<=d?d:0x100000000+d)*b,b*=0x100000000}return a},e.toString=function(a){if(2>(a=a||10)||36<a)throw Error("radix out of range: "+a);if(o(this))return"0";if(p(this))return"-"+q(this).toString(a);for(var b=h(Math.pow(a,6)),c=this,d="";;){var e=u(c,b).g,f=((0<(c=r(c,e.j(b))).g.length?c.g[0]:c.h)>>>0).toString(a);if(o(c=e))return f+d;for(;6>f.length;)f="0"+f;d=f+d}},e.i=function(a){return 0>a?0:a<this.g.length?this.g[a]:this.h},e.l=function(a){return p(a=r(this,a))?-1:+!o(a)},e.abs=function(){return p(this)?q(this):this},e.add=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0,f=0;f<=b;f++){var g=e+(65535&this.i(f))+(65535&a.i(f)),h=(g>>>16)+(this.i(f)>>>16)+(a.i(f)>>>16);e=h>>>16,g&=65535,h&=65535,c[f]=h<<16|g}return new d(c,-0x80000000&c[c.length-1]?-1:0)},e.j=function(a){if(o(this)||o(a))return j;if(p(this))return p(a)?q(this).j(q(a)):q(q(this).j(a));if(p(a))return q(this.j(q(a)));if(0>this.l(n)&&0>a.l(n))return h(this.m()*a.m());for(var b=this.g.length+a.g.length,c=[],e=0;e<2*b;e++)c[e]=0;for(e=0;e<this.g.length;e++)for(var f=0;f<a.g.length;f++){var g=this.i(e)>>>16,i=65535&this.i(e),k=a.i(f)>>>16,l=65535&a.i(f);c[2*e+2*f]+=i*l,s(c,2*e+2*f),c[2*e+2*f+1]+=g*l,s(c,2*e+2*f+1),c[2*e+2*f+1]+=i*k,s(c,2*e+2*f+1),c[2*e+2*f+2]+=g*k,s(c,2*e+2*f+2)}for(e=0;e<b;e++)c[e]=c[2*e+1]<<16|c[2*e];for(e=b;e<2*b;e++)c[e]=0;return new d(c,0)},e.A=function(a){return u(this,a).h},e.and=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)&a.i(e);return new d(c,this.h&a.h)},e.or=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)|a.i(e);return new d(c,this.h|a.h)},e.xor=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)^a.i(e);return new d(c,this.h^a.h)},a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,l=ea.Md5=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=h,d.fromString=i,k=ea.Integer=d}).apply(void 0!==d9?d9:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});let eb=require("crypto");var ec=c(72222),ed=c(47372);let ee="@firebase/firestore",ef="4.9.1";class eg{constructor(a){this.uid=a}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(a){return a.uid===this.uid}}eg.UNAUTHENTICATED=new eg(null),eg.GOOGLE_CREDENTIALS=new eg("google-credentials-uid"),eg.FIRST_PARTY=new eg("first-party-uid"),eg.MOCK_USER=new eg("mock-user");let eh="12.2.0";function ei(a){eh=a}function ej(a){return(0,d8.inspect)(a,{depth:100})}let ek=new aD("@firebase/firestore");function el(){return ek.logLevel}function em(a,...b){if(ek.logLevel<=j.DEBUG){let c=b.map(ep);ek.debug(`Firestore (${eh}): ${a}`,...c)}}function en(a,...b){if(ek.logLevel<=j.ERROR){let c=b.map(ep);ek.error(`Firestore (${eh}): ${a}`,...c)}}function eo(a,...b){if(ek.logLevel<=j.WARN){let c=b.map(ep);ek.warn(`Firestore (${eh}): ${a}`,...c)}}function ep(a){if("string"==typeof a)return a;try{return ej(a)}catch(b){return a}}function eq(a,b,c){let d="Unexpected state";"string"==typeof b?d=b:c=b,er(a,d,c)}function er(a,b,c){let d=`FIRESTORE (${eh}) INTERNAL ASSERTION FAILED: ${b} (ID: ${a.toString(16)})`;if(void 0!==c)try{let a=JSON.stringify(c);d+=" CONTEXT: "+a}catch(a){d+=" CONTEXT: "+c}throw en(d),Error(d)}function es(a,b,c,d){let e="Unexpected state";"string"==typeof c?e=c:d=c,a||er(b,e,d)}function et(a,b){return a}let eu={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ev extends ad{constructor(a,b){super(a,b),this.code=a,this.message=b,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ew{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class ex{constructor(a,b){this.user=b,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${a}`)}}class ey{getToken(){return Promise.resolve(null)}invalidateToken(){}start(a,b){a.enqueueRetryable(()=>b(eg.UNAUTHENTICATED))}shutdown(){}}class ez{constructor(a){this.token=a,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(a,b){this.changeListener=b,a.enqueueRetryable(()=>b(this.token.user))}shutdown(){this.changeListener=null}}class eA{constructor(a){this.authProvider=a,this.currentUser=eg.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(a,b){es(void 0===this.tokenListener,42304);let c=this.tokenCounter,d=a=>this.tokenCounter!==c?(c=this.tokenCounter,b(a)):Promise.resolve(),e=new ew;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),e.resolve(),e=new ew,a.enqueueRetryable(()=>d(this.currentUser))};let f=()=>{let b=e;a.enqueueRetryable(async()=>{await b.promise,await d(this.currentUser)})},g=a=>{em("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),f())};this.authProvider.onInit(a=>g(a)),setTimeout(()=>{if(!this.auth){let a=this.authProvider.getImmediate({optional:!0});a?g(a):(em("FirebaseAuthCredentialsProvider","Auth not yet detected"),e.resolve(),e=new ew)}},0),f()}getToken(){let a=this.tokenCounter,b=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(b).then(b=>this.tokenCounter!==a?(em("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):b?(es("string"==typeof b.accessToken,31837,{tokenData:b}),new ex(b.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let a=this.auth&&this.auth.getUid();return es(null===a||"string"==typeof a,2055,{currentUid:a}),new eg(a)}}class eB{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c,this.type="FirstParty",this.user=eg.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let a=this.getAuthToken();return a&&this._headers.set("Authorization",a),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class eC{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c}getToken(){return Promise.resolve(new eB(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(a,b){a.enqueueRetryable(()=>b(eg.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eD{constructor(a){this.value=a,this.type="AppCheck",this.headers=new Map,a&&a.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eE{constructor(a,b){this.appCheckProvider=b,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,bc(a)&&a.settings.appCheckToken&&(this.serverAppAppCheckToken=a.settings.appCheckToken)}start(a,b){es(void 0===this.tokenListener,3512);let c=a=>{null!=a.error&&em("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);let c=a.token!==this.latestAppCheckToken;return this.latestAppCheckToken=a.token,em("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?b(a.token):Promise.resolve()};this.tokenListener=b=>{a.enqueueRetryable(()=>c(b))};let d=a=>{em("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(a=>d(a)),setTimeout(()=>{if(!this.appCheck){let a=this.appCheckProvider.getImmediate({optional:!0});a?d(a):em("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new eD(this.serverAppAppCheckToken));let a=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(a).then(a=>a?(es("string"==typeof a.token,44558,{tokenResult:a}),this.latestAppCheckToken=a.token,new eD(a.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function eF(a){if(!a)return new ey;switch(a.type){case"firstParty":return new eC(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new ev(eu.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function eG(a){return(0,eb.randomBytes)(a)}class eH{static newId(){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=Math.floor(256/a.length)*a.length,c="",d=20;for(;c.length<d;){let e=eG(40);for(let f=0;f<e.length;++f)c.length<d&&e[f]<b&&(c+=a.charAt(e[f]%a.length))}return c}}function eI(a,b){return a<b?-1:+(a>b)}function eJ(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=a.charAt(d),e=b.charAt(d);if(c!==e)return eM(c)===eM(e)?eI(c,e):eM(c)?1:-1}return eI(a.length,b.length)}let eK=55296,eL=57343;function eM(a){let b=a.charCodeAt(0);return b>=eK&&b<=eL}function eN(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}function eO(a){return a+"\0"}let eP="__name__";class eQ{constructor(a,b,c){void 0===b?b=0:b>a.length&&eq(637,{offset:b,range:a.length}),void 0===c?c=a.length-b:c>a.length-b&&eq(1746,{length:c,range:a.length-b}),this.segments=a,this.offset=b,this.len=c}get length(){return this.len}isEqual(a){return 0===eQ.comparator(this,a)}child(a){let b=this.segments.slice(this.offset,this.limit());return a instanceof eQ?a.forEach(a=>{b.push(a)}):b.push(a),this.construct(b)}limit(){return this.offset+this.length}popFirst(a){return a=void 0===a?1:a,this.construct(this.segments,this.offset+a,this.length-a)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(a){return this.segments[this.offset+a]}isEmpty(){return 0===this.length}isPrefixOf(a){if(a.length<this.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}isImmediateParentOf(a){if(this.length+1!==a.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}forEach(a){for(let b=this.offset,c=this.limit();b<c;b++)a(this.segments[b])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=eQ.compareSegments(a.get(d),b.get(d));if(0!==c)return c}return eI(a.length,b.length)}static compareSegments(a,b){let c=eQ.isNumericId(a),d=eQ.isNumericId(b);return c&&!d?-1:!c&&d?1:c&&d?eQ.extractNumericId(a).compare(eQ.extractNumericId(b)):eJ(a,b)}static isNumericId(a){return a.startsWith("__id")&&a.endsWith("__")}static extractNumericId(a){return k.fromString(a.substring(4,a.length-2))}}class eR extends eQ{construct(a,b,c){return new eR(a,b,c)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...a){let b=[];for(let c of a){if(c.indexOf("//")>=0)throw new ev(eu.INVALID_ARGUMENT,`Invalid segment (${c}). Paths must not contain // in them.`);b.push(...c.split("/").filter(a=>a.length>0))}return new eR(b)}static emptyPath(){return new eR([])}}let eS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class eT extends eQ{construct(a,b,c){return new eT(a,b,c)}static isValidIdentifier(a){return eS.test(a)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),eT.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===eP}static keyField(){return new eT([eP])}static fromServerFormat(a){let b=[],c="",d=0,e=()=>{if(0===c.length)throw new ev(eu.INVALID_ARGUMENT,`Invalid field path (${a}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);b.push(c),c=""},f=!1;for(;d<a.length;){let b=a[d];if("\\"===b){if(d+1===a.length)throw new ev(eu.INVALID_ARGUMENT,"Path has trailing escape character: "+a);let b=a[d+1];if("\\"!==b&&"."!==b&&"`"!==b)throw new ev(eu.INVALID_ARGUMENT,"Path has invalid escape sequence: "+a);c+=b,d+=2}else"`"===b?f=!f:"."!==b||f?c+=b:e(),d++}if(e(),f)throw new ev(eu.INVALID_ARGUMENT,"Unterminated ` in path: "+a);return new eT(b)}static emptyPath(){return new eT([])}}class eU{constructor(a){this.path=a}static fromPath(a){return new eU(eR.fromString(a))}static fromName(a){return new eU(eR.fromString(a).popFirst(5))}static empty(){return new eU(eR.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(a){return this.path.length>=2&&this.path.get(this.path.length-2)===a}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(a){return null!==a&&0===eR.comparator(this.path,a.path)}toString(){return this.path.toString()}static comparator(a,b){return eR.comparator(a.path,b.path)}static isDocumentKey(a){return a.length%2==0}static fromSegments(a){return new eU(new eR(a.slice()))}}function eV(a,b,c){if(!c)throw new ev(eu.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${b}.`)}function eW(a,b,c,d){if(!0===b&&!0===d)throw new ev(eu.INVALID_ARGUMENT,`${a} and ${c} cannot be used together.`)}function eX(a){if(!eU.isDocumentKey(a))throw new ev(eu.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function eY(a){return"object"==typeof a&&null!==a&&(Object.getPrototypeOf(a)===Object.prototype||null===Object.getPrototypeOf(a))}function eZ(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a)if(a instanceof Array)return"an array";else{let b=e$(a);return b?`a custom ${b} object`:"an object"}else if("function"==typeof a)return"a function";else return eq(12329,{type:typeof a})}function e$(a){return a.constructor?a.constructor.name:null}function e_(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b))if(b.name===a.constructor.name)throw new ev(eu.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let c=eZ(a);throw new ev(eu.INVALID_ARGUMENT,`Expected type '${b.name}', but it was: ${c}`)}return a}function e0(a,b){let c={typeString:a};return b&&(c.value=b),c}function e1(a,b){let c;if(!eY(a))throw new ev(eu.INVALID_ARGUMENT,"JSON must be an object");for(let d in b)if(b[d]){let e=b[d].typeString,f="value"in b[d]?{value:b[d].value}:void 0;if(!(d in a)){c=`JSON missing required field: '${d}'`;break}let g=a[d];if(e&&typeof g!==e){c=`JSON field '${d}' must be a ${e}.`;break}if(void 0!==f&&g!==f.value){c=`Expected '${d}' field to equal '${f.value}'`;break}}if(c)throw new ev(eu.INVALID_ARGUMENT,c);return!0}let e2=-0xe7791f700,e3=1e6;class e4{static now(){return e4.fromMillis(Date.now())}static fromDate(a){return e4.fromMillis(a.getTime())}static fromMillis(a){let b=Math.floor(a/1e3),c=Math.floor((a-1e3*b)*e3);return new e4(b,c)}constructor(a,b){if(this.seconds=a,this.nanoseconds=b,b<0||b>=1e9)throw new ev(eu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+b);if(a<e2||a>=0x3afff44180)throw new ev(eu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/e3}_compareTo(a){return this.seconds===a.seconds?eI(this.nanoseconds,a.nanoseconds):eI(this.seconds,a.seconds)}isEqual(a){return a.seconds===this.seconds&&a.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:e4._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(a){if(e1(a,e4._jsonSchema))return new e4(a.seconds,a.nanoseconds)}valueOf(){return String(this.seconds-e2).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}e4._jsonSchemaVersion="firestore/timestamp/1.0",e4._jsonSchema={type:e0("string",e4._jsonSchemaVersion),seconds:e0("number"),nanoseconds:e0("number")};class e5{static fromTimestamp(a){return new e5(a)}static min(){return new e5(new e4(0,0))}static max(){return new e5(new e4(0x3afff4417f,1e9-1))}constructor(a){this.timestamp=a}compareTo(a){return this.timestamp._compareTo(a.timestamp)}isEqual(a){return this.timestamp.isEqual(a.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let e6=-1,e7=0;class e8{constructor(a,b,c,d){this.indexId=a,this.collectionGroup=b,this.fields=c,this.indexState=d}}function e9(a){return a.fields.find(a=>2===a.kind)}function fa(a){return a.fields.filter(a=>2!==a.kind)}function fb(a){let b=fa(a);return 0===b.length?0:b[b.length-1].kind}function fc(a,b){let c=eI(a.collectionGroup,b.collectionGroup);if(0!==c)return c;for(let d=0;d<Math.min(a.fields.length,b.fields.length);++d)if(0!==(c=ff(a.fields[d],b.fields[d])))return c;return eI(a.fields.length,b.fields.length)}function fd(a){return`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map(a=>`${a.fieldPath}:${a.kind}`).join(",")}`}e8.UNKNOWN_ID=-1;class fe{constructor(a,b){this.fieldPath=a,this.kind=b}}function ff(a,b){let c=eT.comparator(a.fieldPath,b.fieldPath);return 0!==c?c:eI(a.kind,b.kind)}class fg{constructor(a,b){this.sequenceNumber=a,this.offset=b}static empty(){return new fg(e7,fj.min())}}function fh(a,b){let c=a.toTimestamp().seconds,d=a.toTimestamp().nanoseconds+1;return new fj(e5.fromTimestamp(1e9===d?new e4(c+1,0):new e4(c,d)),eU.empty(),b)}function fi(a){return new fj(a.readTime,a.key,e6)}class fj{constructor(a,b,c){this.readTime=a,this.documentKey=b,this.largestBatchId=c}static min(){return new fj(e5.min(),eU.empty(),e6)}static max(){return new fj(e5.max(),eU.empty(),e6)}}function fk(a,b){let c=a.readTime.compareTo(b.readTime);return 0!==c||0!==(c=eU.comparator(a.documentKey,b.documentKey))?c:eI(a.largestBatchId,b.largestBatchId)}let fl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(a){this.onCommittedListeners.push(a)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(a=>a())}}async function fn(a){if(a.code===eu.FAILED_PRECONDITION&&a.message===fl)em("LocalStore","Unexpectedly lost primary lease");else throw a}class fo{constructor(a){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,a(a=>{this.isDone=!0,this.result=a,this.nextCallback&&this.nextCallback(a)},a=>{this.isDone=!0,this.error=a,this.catchCallback&&this.catchCallback(a)})}catch(a){return this.next(void 0,a)}next(a,b){return(this.callbackAttached&&eq(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(b,this.error):this.wrapSuccess(a,this.result):new fo((c,d)=>{this.nextCallback=b=>{this.wrapSuccess(a,b).next(c,d)},this.catchCallback=a=>{this.wrapFailure(b,a).next(c,d)}})}toPromise(){return new Promise((a,b)=>{this.next(a,b)})}wrapUserFunction(a){try{let b=a();if(b instanceof fo)return b;return fo.resolve(b)}catch(a){return fo.reject(a)}}wrapSuccess(a,b){return a?this.wrapUserFunction(()=>a(b)):fo.resolve(b)}wrapFailure(a,b){return a?this.wrapUserFunction(()=>a(b)):fo.reject(b)}static resolve(a){return new fo((b,c)=>{b(a)})}static reject(a){return new fo((b,c)=>{c(a)})}static waitFor(a){return new fo((b,c)=>{let d=0,e=0,f=!1;a.forEach(a=>{++d,a.next(()=>{++e,f&&e===d&&b()},a=>c(a))}),f=!0,e===d&&b()})}static or(a){let b=fo.resolve(!1);for(let c of a)b=b.next(a=>a?fo.resolve(a):c());return b}static forEach(a,b){let c=[];return a.forEach((a,d)=>{c.push(b.call(this,a,d))}),this.waitFor(c)}static mapArray(a,b){return new fo((c,d)=>{let e=a.length,f=Array(e),g=0;for(let h=0;h<e;h++){let i=h;b(a[i]).next(a=>{f[i]=a,++g===e&&c(f)},a=>d(a))}})}static doWhile(a,b){return new fo((c,d)=>{let e=()=>{!0===a()?b().next(()=>{e()},d):c()};e()})}}let fp="SimpleDb",fq=3;class fr{static open(a,b,c,d){try{return new fr(b,a.transaction(d,c))}catch(a){throw new fv(b,a)}}constructor(a,b){this.action=a,this.transaction=b,this.aborted=!1,this.completionDeferred=new ew,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{b.error?this.completionDeferred.reject(new fv(a,b.error)):this.completionDeferred.resolve()},this.transaction.onerror=b=>{let c=fA(b.target.error);this.completionDeferred.reject(new fv(a,c))}}get completionPromise(){return this.completionDeferred.promise}abort(a){a&&this.completionDeferred.reject(a),this.aborted||(em(fp,"Aborting transaction:",a?a.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let a=this.transaction;this.aborted||"function"!=typeof a.commit||a.commit()}store(a){return new fx(this.transaction.objectStore(a))}}class fs{static delete(a){return em(fp,"Removing database:",a),fy(D().indexedDB.deleteDatabase(a)).toPromise()}static isAvailable(){if(!aa())return!1;if(fs.isMockPersistence())return!0;let a=U(),b=fs.getIOSVersion(a),c=0<b&&b<10,d=ft(a),e=0<d&&d<4.5;return!(a.indexOf("MSIE ")>0||a.indexOf("Trident/")>0||a.indexOf("Edge/")>0)&&!c&&!e}static isMockPersistence(){return"undefined"!=typeof process&&process.env?.USE_MOCK_PERSISTENCE==="YES"}static getStore(a,b){return a.store(b)}static getIOSVersion(a){let b=a.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(b?b[1].split("_").slice(0,2).join("."):"-1")}constructor(a,b,c){this.name=a,this.version=b,this.schemaConverter=c,this.lastClosedDbVersion=null,12.2===fs.getIOSVersion(U())&&en("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(a){return this.db||(em(fp,"Opening database:",this.name),this.db=await new Promise((b,c)=>{let d=indexedDB.open(this.name,this.version);d.onsuccess=a=>{b(a.target.result)},d.onblocked=()=>{c(new fv(a,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},d.onerror=b=>{let d=b.target.error;"VersionError"===d.name?c(new ev(eu.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===d.name?c(new ev(eu.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):c(new fv(a,d))},d.onupgradeneeded=a=>{em(fp,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);let b=a.target.result;this.schemaConverter.createOrUpgrade(b,d.transaction,a.oldVersion,this.version).next(()=>{em(fp,"Database upgrade to version "+this.version+" complete")})}})),this.versionchangelistener&&(this.db.onversionchange=a=>this.versionchangelistener(a)),this.db}setVersionChangeListener(a){this.versionchangelistener=a,this.db&&(this.db.onversionchange=b=>a(b))}async runTransaction(a,b,c,d){let e="readonly"===b,f=0;for(;;){++f;try{this.db=await this.ensureDb(a);let b=fr.open(this.db,a,e?"readonly":"readwrite",c),f=d(b).next(a=>(b.maybeCommit(),a)).catch(a=>(b.abort(a),fo.reject(a))).toPromise();return f.catch(()=>{}),await b.completionPromise,f}catch(c){let a=c,b="FirebaseError"!==a.name&&f<fq;if(em(fp,"Transaction failed with error:",a.message,"Retrying:",b),this.close(),!b)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ft(a){let b=a.match(/Android ([\d.]+)/i);return Number(b?b[1].split(".").slice(0,2).join("."):"-1")}class fu{constructor(a){this.dbCursor=a,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(a){this.dbCursor=a}done(){this.shouldStop=!0}skip(a){this.nextKey=a}delete(){return fy(this.dbCursor.delete())}}class fv extends ev{constructor(a,b){super(eu.UNAVAILABLE,`IndexedDB transaction '${a}' failed: ${b}`),this.name="IndexedDbTransactionError"}}function fw(a){return"IndexedDbTransactionError"===a.name}class fx{constructor(a){this.store=a}put(a,b){let c;return void 0!==b?(em(fp,"PUT",this.store.name,a,b),c=this.store.put(b,a)):(em(fp,"PUT",this.store.name,"<auto-key>",a),c=this.store.put(a)),fy(c)}add(a){return em(fp,"ADD",this.store.name,a,a),fy(this.store.add(a))}get(a){return fy(this.store.get(a)).next(b=>(void 0===b&&(b=null),em(fp,"GET",this.store.name,a,b),b))}delete(a){return em(fp,"DELETE",this.store.name,a),fy(this.store.delete(a))}count(){return em(fp,"COUNT",this.store.name),fy(this.store.count())}loadAll(a,b){let c=this.options(a,b),d=c.index?this.store.index(c.index):this.store;if("function"==typeof d.getAll){let a=d.getAll(c.range);return new fo((b,c)=>{a.onerror=a=>{c(a.target.error)},a.onsuccess=a=>{b(a.target.result)}})}{let a=this.cursor(c),b=[];return this.iterateCursor(a,(a,c)=>{b.push(c)}).next(()=>b)}}loadFirst(a,b){let c=this.store.getAll(a,null===b?void 0:b);return new fo((a,b)=>{c.onerror=a=>{b(a.target.error)},c.onsuccess=b=>{a(b.target.result)}})}deleteAll(a,b){em(fp,"DELETE ALL",this.store.name);let c=this.options(a,b);c.keysOnly=!1;let d=this.cursor(c);return this.iterateCursor(d,(a,b,c)=>c.delete())}iterate(a,b){let c;b?c=a:(c={},b=a);let d=this.cursor(c);return this.iterateCursor(d,b)}iterateSerial(a){let b=this.cursor({});return new fo((c,d)=>{b.onerror=a=>{d(fA(a.target.error))},b.onsuccess=b=>{let d=b.target.result;if(!d)return void c();a(d.primaryKey,d.value).next(a=>{a?d.continue():c()})}})}iterateCursor(a,b){let c=[];return new fo((d,e)=>{a.onerror=a=>{e(a.target.error)},a.onsuccess=a=>{let e=a.target.result;if(!e)return void d();let f=new fu(e),g=b(e.primaryKey,e.value,f);if(g instanceof fo){let a=g.catch(a=>(f.done(),fo.reject(a)));c.push(a)}f.isDone?d():null===f.skipToKey?e.continue():e.continue(f.skipToKey)}}).next(()=>fo.waitFor(c))}options(a,b){let c;return void 0!==a&&("string"==typeof a?c=a:b=a),{index:c,range:b}}cursor(a){let b="next";if(a.reverse&&(b="prev"),!a.index)return this.store.openCursor(a.range,b);{let c=this.store.index(a.index);return a.keysOnly?c.openKeyCursor(a.range,b):c.openCursor(a.range,b)}}}function fy(a){return new fo((b,c)=>{a.onsuccess=a=>{b(a.target.result)},a.onerror=a=>{c(fA(a.target.error))}})}let fz=!1;function fA(a){let b=fs.getIOSVersion(U());if(b>=12.2&&b<13){let b="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(b)>=0){let a=new ev("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${b}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fz||(fz=!0,setTimeout(()=>{throw a},0)),a}}return a}let fB="IndexBackfiller",fC=15e3,fD=6e4,fE=50;class fF{constructor(a,b){this.asyncQueue=a,this.backfiller=b,this.task=null}start(){this.schedule(fC)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(a){em(fB,`Scheduled in ${a}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",a,async()=>{this.task=null;try{let a=await this.backfiller.backfill();em(fB,`Documents written: ${a}`)}catch(a){fw(a)?em(fB,"Ignoring IndexedDB error during index backfill: ",a):await fn(a)}await this.schedule(fD)})}}class fG{constructor(a,b){this.localStore=a,this.persistence=b}async backfill(a=fE){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",b=>this.writeIndexEntries(b,a))}writeIndexEntries(a,b){let c=new Set,d=b,e=!0;return fo.doWhile(()=>!0===e&&d>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(a).next(b=>{if(!(null===b||c.has(b)))return em(fB,`Processing collection: ${b}`),this.writeEntriesForCollectionGroup(a,b,d).next(a=>{d-=a,c.add(b)});e=!1})).next(()=>b-d)}writeEntriesForCollectionGroup(a,b,c){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(a,b).next(d=>this.localStore.localDocuments.getNextDocuments(a,b,d,c).next(c=>{let e=c.changes;return this.localStore.indexManager.updateIndexEntries(a,e).next(()=>this.getNewOffset(d,c)).next(c=>(em(fB,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(a,b,c))).next(()=>e.size)}))}getNewOffset(a,b){let c=a;return b.changes.forEach((a,b)=>{let d=fi(b);fk(d,c)>0&&(c=d)}),new fj(c.readTime,c.documentKey,Math.max(b.batchId,a.largestBatchId))}}class fH{constructor(a,b){this.previousValue=a,b&&(b.sequenceNumberHandler=a=>this.setPreviousValue(a),this.writeNewSequenceNumber=a=>b.writeSequenceNumber(a))}setPreviousValue(a){return this.previousValue=Math.max(a,this.previousValue),this.previousValue}next(){let a=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(a),a}}fH.INVALID=-1;let fI="\x01",fJ="\x01",fK="\x10",fL="\x11";function fM(a){let b="";for(let c=0;c<a.length;c++)b.length>0&&(b=fO(b)),b=fN(a.get(c),b);return fO(b)}function fN(a,b){let c=b,d=a.length;for(let b=0;b<d;b++){let d=a.charAt(b);switch(d){case"\0":c+=fI+fK;break;case fI:c+=fI+fL;break;default:c+=d}}return c}function fO(a){return a+fI+fJ}function fP(a){let b=a.length;if(es(b>=2,64408,{path:a}),2===b)return es(a.charAt(0)===fI&&a.charAt(1)===fJ,56145,{path:a}),eR.emptyPath();let c=b-2,d=[],e="";for(let f=0;f<b;){let b=a.indexOf(fI,f);switch((b<0||b>c)&&eq(50515,{path:a}),a.charAt(b+1)){case fJ:let g,h=a.substring(f,b);0===e.length?g=h:(e+=h,g=e,e=""),d.push(g);break;case fK:e+=a.substring(f,b),e+="\0";break;case fL:e+=a.substring(f,b+1);break;default:eq(61167,{path:a})}f=b+2}return new eR(d)}let fQ="remoteDocuments",fR="owner",fS="owner",fT="mutationQueues",fU="userId",fV="mutations",fW="batchId",fX="userMutationsIndex",fY=["userId","batchId"];function fZ(a){return[a]}function f$(a,b){return[a,fM(b)]}function f_(a,b,c){return[a,fM(b),c]}let f0={},f1="documentMutations",f2="remoteDocumentsV14",f3=["prefixPath","collectionGroup","readTime","documentId"],f4="documentKeyIndex",f5=["prefixPath","collectionGroup","documentId"],f6="collectionGroupIndex",f7=["collectionGroup","readTime","prefixPath","documentId"],f8="remoteDocumentGlobal",f9="remoteDocumentGlobalKey",ga="targets",gb="targetId",gc="queryTargetsIndex",gd=["canonicalId","targetId"],ge="targetDocuments",gf=["targetId","path"],gg="documentTargetsIndex",gh=["path","targetId"],gi="targetGlobalKey",gj="targetGlobal",gk="collectionParents",gl=["collectionId","parent"],gm="clientMetadata",gn="clientId",go="bundles",gp="bundleId",gq="namedQueries",gr="name",gs="indexConfiguration",gt="indexId",gu="collectionGroupIndex",gv="collectionGroup",gw="indexState",gx=["indexId","uid"],gy="sequenceNumberIndex",gz=["uid","sequenceNumber"],gA="indexEntries",gB=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gC="documentKeyIndex",gD=["indexId","uid","orderedDocumentKey"],gE="documentOverlays",gF=["userId","collectionPath","documentId"],gG="collectionPathOverlayIndex",gH=["userId","collectionPath","largestBatchId"],gI="collectionGroupOverlayIndex",gJ=["userId","collectionGroup","largestBatchId"],gK="globals",gL="name",gM=[fT,fV,f1,fQ,ga,fR,gj,ge,gm,f8,gk,go,gq],gN=[...gM,gE],gO=[fT,fV,f1,f2,ga,fR,gj,ge,gm,f8,gk,go,gq,gE],gP=gO,gQ=[...gP,gs,gw,gA],gR=gQ,gS=[...gQ,gK],gT=gS;function gU(a){return 18===a?gT:17===a?gS:16===a?gR:15===a?gQ:14===a?gP:13===a?gO:12===a?gN:11===a?gM:void eq(60245)}class gV extends fm{constructor(a,b){super(),this.simpleDbTransaction=a,this.currentSequenceNumber=b}}function gW(a,b){let c=et(a);return fs.getStore(c.simpleDbTransaction,b)}function gX(a){let b=0;for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function gY(a,b){for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function gZ(a,b){let c=[];for(let d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(b(a[d],d,a));return c}function g$(a){for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}class g_{constructor(a,b){this.comparator=a,this.root=b||g1.EMPTY}insert(a,b){return new g_(this.comparator,this.root.insert(a,b,this.comparator).copy(null,null,g1.BLACK,null,null))}remove(a){return new g_(this.comparator,this.root.remove(a,this.comparator).copy(null,null,g1.BLACK,null,null))}get(a){let b=this.root;for(;!b.isEmpty();){let c=this.comparator(a,b.key);if(0===c)return b.value;c<0?b=b.left:c>0&&(b=b.right)}return null}indexOf(a){let b=0,c=this.root;for(;!c.isEmpty();){let d=this.comparator(a,c.key);if(0===d)return b+c.left.size;d<0?c=c.left:(b+=c.left.size+1,c=c.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(a){return this.root.inorderTraversal(a)}forEach(a){this.inorderTraversal((b,c)=>(a(b,c),!1))}toString(){let a=[];return this.inorderTraversal((b,c)=>(a.push(`${b}:${c}`),!1)),`{${a.join(", ")}}`}reverseTraversal(a){return this.root.reverseTraversal(a)}getIterator(){return new g0(this.root,null,this.comparator,!1)}getIteratorFrom(a){return new g0(this.root,a,this.comparator,!1)}getReverseIterator(){return new g0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(a){return new g0(this.root,a,this.comparator,!0)}}class g0{constructor(a,b,c,d){this.isReverse=d,this.nodeStack=[];let e=1;for(;!a.isEmpty();)if(e=b?c(a.key,b):1,b&&d&&(e*=-1),e<0)a=this.isReverse?a.left:a.right;else if(0===e){this.nodeStack.push(a);break}else this.nodeStack.push(a),a=this.isReverse?a.right:a.left}getNext(){let a=this.nodeStack.pop(),b={key:a.key,value:a.value};if(this.isReverse)for(a=a.left;!a.isEmpty();)this.nodeStack.push(a),a=a.right;else for(a=a.right;!a.isEmpty();)this.nodeStack.push(a),a=a.left;return b}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let a=this.nodeStack[this.nodeStack.length-1];return{key:a.key,value:a.value}}}class g1{constructor(a,b,c,d,e){this.key=a,this.value=b,this.color=null!=c?c:g1.RED,this.left=null!=d?d:g1.EMPTY,this.right=null!=e?e:g1.EMPTY,this.size=this.left.size+1+this.right.size}copy(a,b,c,d,e){return new g1(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)}isEmpty(){return!1}inorderTraversal(a){return this.left.inorderTraversal(a)||a(this.key,this.value)||this.right.inorderTraversal(a)}reverseTraversal(a){return this.right.reverseTraversal(a)||a(this.key,this.value)||this.left.reverseTraversal(a)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(a,b,c){let d=this,e=c(a,d.key);return(d=e<0?d.copy(null,null,null,d.left.insert(a,b,c),null):0===e?d.copy(null,b,null,null,null):d.copy(null,null,null,null,d.right.insert(a,b,c))).fixUp()}removeMin(){if(this.left.isEmpty())return g1.EMPTY;let a=this;return a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),(a=a.copy(null,null,null,a.left.removeMin(),null)).fixUp()}remove(a,b){let c,d=this;if(0>b(a,d.key))d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(a,b),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),0===b(a,d.key))if(d.right.isEmpty())return g1.EMPTY;else c=d.right.min(),d=d.copy(c.key,c.value,null,null,d.right.removeMin());d=d.copy(null,null,null,null,d.right.remove(a,b))}return d.fixUp()}isRed(){return this.color}fixUp(){let a=this;return a.right.isRed()&&!a.left.isRed()&&(a=a.rotateLeft()),a.left.isRed()&&a.left.left.isRed()&&(a=a.rotateRight()),a.left.isRed()&&a.right.isRed()&&(a=a.colorFlip()),a}moveRedLeft(){let a=this.colorFlip();return a.right.left.isRed()&&(a=(a=(a=a.copy(null,null,null,null,a.right.rotateRight())).rotateLeft()).colorFlip()),a}moveRedRight(){let a=this.colorFlip();return a.left.left.isRed()&&(a=(a=a.rotateRight()).colorFlip()),a}rotateLeft(){let a=this.copy(null,null,g1.RED,null,this.right.left);return this.right.copy(null,null,this.color,a,null)}rotateRight(){let a=this.copy(null,null,g1.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,a)}colorFlip(){let a=this.left.copy(null,null,!this.left.color,null,null),b=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,a,b)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw eq(43730,{key:this.key,value:this.value});if(this.right.isRed())throw eq(14113,{key:this.key,value:this.value});let a=this.left.check();if(a===this.right.check())return a+ +!this.isRed();throw eq(27949)}}g1.EMPTY=null,g1.RED=!0,g1.BLACK=!1;class g2{constructor(){this.size=0}get key(){throw eq(57766)}get value(){throw eq(16141)}get color(){throw eq(16727)}get left(){throw eq(29726)}get right(){throw eq(36894)}copy(a,b,c,d,e){return this}insert(a,b,c){return new g1(a,b)}remove(a,b){return this}isEmpty(){return!0}inorderTraversal(a){return!1}reverseTraversal(a){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}g1.EMPTY=new g2;class g3{constructor(a){this.comparator=a,this.data=new g_(this.comparator)}has(a){return null!==this.data.get(a)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(a){return this.data.indexOf(a)}forEach(a){this.data.inorderTraversal((b,c)=>(a(b),!1))}forEachInRange(a,b){let c=this.data.getIteratorFrom(a[0]);for(;c.hasNext();){let d=c.getNext();if(this.comparator(d.key,a[1])>=0)return;b(d.key)}}forEachWhile(a,b){let c;for(c=void 0!==b?this.data.getIteratorFrom(b):this.data.getIterator();c.hasNext();)if(!a(c.getNext().key))return}firstAfterOrEqual(a){let b=this.data.getIteratorFrom(a);return b.hasNext()?b.getNext().key:null}getIterator(){return new g4(this.data.getIterator())}getIteratorFrom(a){return new g4(this.data.getIteratorFrom(a))}add(a){return this.copy(this.data.remove(a).insert(a,!0))}delete(a){return this.has(a)?this.copy(this.data.remove(a)):this}isEmpty(){return this.data.isEmpty()}unionWith(a){let b=this;return b.size<a.size&&(b=a,a=this),a.forEach(a=>{b=b.add(a)}),b}isEqual(a){if(!(a instanceof g3)||this.size!==a.size)return!1;let b=this.data.getIterator(),c=a.data.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(0!==this.comparator(a,d))return!1}return!0}toArray(){let a=[];return this.forEach(b=>{a.push(b)}),a}toString(){let a=[];return this.forEach(b=>a.push(b)),"SortedSet("+a.toString()+")"}copy(a){let b=new g3(this.comparator);return b.data=a,b}}class g4{constructor(a){this.iter=a}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function g5(a,b,c,d,e){let f=a.getIterator(),g=b.getIterator(),h=g6(f),i=g6(g);for(;h||i;){let a=!1,b=!1;if(h&&i){let d=c(h,i);d<0?b=!0:d>0&&(a=!0)}else null!=h?b=!0:a=!0;a?(d(i),i=g6(g)):b?(e(h),h=g6(f)):(h=g6(f),i=g6(g))}}function g6(a){return a.hasNext()?a.getNext():void 0}class g7{constructor(a){this.fields=a,a.sort(eT.comparator)}static empty(){return new g7([])}unionWith(a){let b=new g3(eT.comparator);for(let a of this.fields)b=b.add(a);for(let c of a)b=b.add(c);return new g7(b.toArray())}covers(a){for(let b of this.fields)if(b.isPrefixOf(a))return!0;return!1}isEqual(a){return eN(this.fields,a.fields,(a,b)=>a.isEqual(b))}}function g8(a){return Buffer.from(a,"base64").toString("binary")}function g9(a){return Buffer.from(a,"binary").toString("base64")}class ha{constructor(a){this.binaryString=a}static fromBase64String(a){return new ha(g8(a))}static fromUint8Array(a){return new ha(hb(a))}[Symbol.iterator](){let a=0;return{next:()=>a<this.binaryString.length?{value:this.binaryString.charCodeAt(a++),done:!1}:{value:void 0,done:!0}}}toBase64(){return g9(this.binaryString)}toUint8Array(){return hc(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(a){return eI(this.binaryString,a.binaryString)}isEqual(a){return this.binaryString===a.binaryString}}function hb(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}function hc(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}ha.EMPTY_BYTE_STRING=new ha("");let hd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function he(a){if(es(!!a,39018),"string"==typeof a){let b=0,c=hd.exec(a);if(es(!!c,46558,{timestamp:a}),c[1]){let a=c[1];b=Number(a=(a+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(a).getTime()/1e3),nanos:b}}return{seconds:hf(a.seconds),nanos:hf(a.nanos)}}function hf(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function hg(a){return"string"==typeof a?ha.fromBase64String(a):ha.fromUint8Array(a)}let hh="server_timestamp",hi="__type__",hj="__previous_value__",hk="__local_write_time__";function hl(a){return(a?.mapValue?.fields||{})[hi]?.stringValue===hh}function hm(a,b){let c={fields:{[hi]:{stringValue:hh},[hk]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return b&&hl(b)&&(b=hn(b)),b&&(c.fields[hj]=b),{mapValue:c}}function hn(a){let b=a.mapValue.fields[hj];return hl(b)?hn(b):b}function ho(a){let b=he(a.mapValue.fields[hk].timestampValue);return new e4(b.seconds,b.nanos)}class hp{constructor(a,b,c,d,e,f,g,h,i,j){this.databaseId=a,this.appId=b,this.persistenceKey=c,this.host=d,this.ssl=e,this.forceLongPolling=f,this.autoDetectLongPolling=g,this.longPollingOptions=h,this.useFetchStreams=i,this.isUsingEmulator=j}}let hq="(default)";class hr{constructor(a,b){this.projectId=a,this.database=b||hq}static empty(){return new hr("","")}get isDefaultDatabase(){return this.database===hq}isEqual(a){return a instanceof hr&&a.projectId===this.projectId&&a.database===this.database}}function hs(a,b){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new ev(eu.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hr(a.options.projectId,b)}let ht=-1;function hu(a){return null==a}function hv(a){return 0===a&&1/a==-1/0}function hw(a){return"number"==typeof a&&Number.isInteger(a)&&!hv(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}let hx="__type__",hy="__max__",hz={mapValue:{fields:{__type__:{stringValue:hy}}}},hA="__vector__",hB="value",hC={nullValue:"NULL_VALUE"};function hD(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?hl(a)?4:id(a)?0x1fffffffffffff:ib(a)?10:11:eq(28295,{value:a})}function hE(a,b){if(a===b)return!0;let c=hD(a);if(c!==hD(b))return!1;switch(c){case 0:case 0x1fffffffffffff:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return ho(a).isEqual(ho(b));case 3:return hF(a,b);case 5:return a.stringValue===b.stringValue;case 6:return hH(a,b);case 7:return a.referenceValue===b.referenceValue;case 8:return hG(a,b);case 2:return hI(a,b);case 9:return eN(a.arrayValue.values||[],b.arrayValue.values||[],hE);case 10:case 11:return hJ(a,b);default:return eq(52216,{left:a})}}function hF(a,b){if("string"==typeof a.timestampValue&&"string"==typeof b.timestampValue&&a.timestampValue.length===b.timestampValue.length)return a.timestampValue===b.timestampValue;let c=he(a.timestampValue),d=he(b.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}function hG(a,b){return hf(a.geoPointValue.latitude)===hf(b.geoPointValue.latitude)&&hf(a.geoPointValue.longitude)===hf(b.geoPointValue.longitude)}function hH(a,b){return hg(a.bytesValue).isEqual(hg(b.bytesValue))}function hI(a,b){if("integerValue"in a&&"integerValue"in b)return hf(a.integerValue)===hf(b.integerValue);if("doubleValue"in a&&"doubleValue"in b){let c=hf(a.doubleValue),d=hf(b.doubleValue);return c===d?hv(c)===hv(d):isNaN(c)&&isNaN(d)}return!1}function hJ(a,b){let c=a.mapValue.fields||{},d=b.mapValue.fields||{};if(gX(c)!==gX(d))return!1;for(let a in c)if(c.hasOwnProperty(a)&&(void 0===d[a]||!hE(c[a],d[a])))return!1;return!0}function hK(a,b){return void 0!==(a.values||[]).find(a=>hE(a,b))}function hL(a,b){if(a===b)return 0;let c=hD(a),d=hD(b);if(c!==d)return eI(c,d);switch(c){case 0:case 0x1fffffffffffff:return 0;case 1:return eI(a.booleanValue,b.booleanValue);case 2:return hM(a,b);case 3:return hN(a.timestampValue,b.timestampValue);case 4:return hN(ho(a),ho(b));case 5:return eJ(a.stringValue,b.stringValue);case 6:return hQ(a.bytesValue,b.bytesValue);case 7:return hO(a.referenceValue,b.referenceValue);case 8:return hP(a.geoPointValue,b.geoPointValue);case 9:return hR(a.arrayValue,b.arrayValue);case 10:return hS(a.mapValue,b.mapValue);case 11:return hT(a.mapValue,b.mapValue);default:throw eq(23264,{leftType:c})}}function hM(a,b){let c=hf(a.integerValue||a.doubleValue),d=hf(b.integerValue||b.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}function hN(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return eI(a,b);let c=he(a),d=he(b),e=eI(c.seconds,d.seconds);return 0!==e?e:eI(c.nanos,d.nanos)}function hO(a,b){let c=a.split("/"),d=b.split("/");for(let a=0;a<c.length&&a<d.length;a++){let b=eI(c[a],d[a]);if(0!==b)return b}return eI(c.length,d.length)}function hP(a,b){let c=eI(hf(a.latitude),hf(b.latitude));return 0!==c?c:eI(hf(a.longitude),hf(b.longitude))}function hQ(a,b){let c=hg(a),d=hg(b);return c.compareTo(d)}function hR(a,b){let c=a.values||[],d=b.values||[];for(let a=0;a<c.length&&a<d.length;++a){let b=hL(c[a],d[a]);if(b)return b}return eI(c.length,d.length)}function hS(a,b){let c=a.fields||{},d=b.fields||{},e=c[hB]?.arrayValue,f=d[hB]?.arrayValue,g=eI(e?.values?.length||0,f?.values?.length||0);return 0!==g?g:hR(e,f)}function hT(a,b){if(a===hz.mapValue&&b===hz.mapValue)return 0;if(a===hz.mapValue)return 1;if(b===hz.mapValue)return -1;let c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let a=0;a<d.length&&a<f.length;++a){let b=eJ(d[a],f[a]);if(0!==b)return b;let g=hL(c[d[a]],e[f[a]]);if(0!==g)return g}return eI(d.length,f.length)}function hU(a){return hV(a)}function hV(a){if("nullValue"in a)return"null";if("booleanValue"in a)return""+a.booleanValue;if("integerValue"in a)return""+a.integerValue;if("doubleValue"in a)return""+a.doubleValue;if("timestampValue"in a)return hX(a.timestampValue);else if("stringValue"in a)return a.stringValue;else if("bytesValue"in a)return hW(a.bytesValue);else if("referenceValue"in a)return hZ(a.referenceValue);else if("geoPointValue"in a)return hY(a.geoPointValue);else if("arrayValue"in a)return h_(a.arrayValue);else if("mapValue"in a)return h$(a.mapValue);else return eq(61005,{value:a})}function hW(a){return hg(a).toBase64()}function hX(a){let b=he(a);return`time(${b.seconds},${b.nanos})`}function hY(a){return`geo(${a.latitude},${a.longitude})`}function hZ(a){return eU.fromName(a).toString()}function h$(a){let b=Object.keys(a.fields||{}).sort(),c="{",d=!0;for(let e of b)d?d=!1:c+=",",c+=`${e}:${hV(a.fields[e])}`;return c+"}"}function h_(a){let b="[",c=!0;for(let d of a.values||[])c?c=!1:b+=",",b+=hV(d);return b+"]"}function h0(a){switch(hD(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let b=hn(a);return b?16+h0(b):16;case 5:return 2*a.stringValue.length;case 6:return hg(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return h2(a.arrayValue);case 10:case 11:return h1(a.mapValue);default:throw eq(13486,{value:a})}}function h1(a){let b=0;return gY(a.fields,(a,c)=>{b+=a.length+h0(c)}),b}function h2(a){return(a.values||[]).reduce((a,b)=>a+h0(b),0)}function h3(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function h4(a){return!!a&&"integerValue"in a}function h5(a){return!!a&&"doubleValue"in a}function h6(a){return h4(a)||h5(a)}function h7(a){return!!a&&"arrayValue"in a}function h8(a){return!!a&&"nullValue"in a}function h9(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function ia(a){return!!a&&"mapValue"in a}function ib(a){return(a?.mapValue?.fields||{})[hx]?.stringValue===hA}function ic(a){if(a.geoPointValue)return{geoPointValue:{...a.geoPointValue}};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:{...a.timestampValue}};if(a.mapValue){let b={mapValue:{fields:{}}};return gY(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=ic(c)),b}{if(!a.arrayValue)return{...a};let b={arrayValue:{values:[]}};for(let c=0;c<(a.arrayValue.values||[]).length;++c)b.arrayValue.values[c]=ic(a.arrayValue.values[c]);return b}}function id(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue===hy}let ie={mapValue:{fields:{[hx]:{stringValue:hA},[hB]:{arrayValue:{}}}}};function ig(a){if("nullValue"in a)return hC;if("booleanValue"in a)return{booleanValue:!1};if("integerValue"in a||"doubleValue"in a)return{doubleValue:NaN};if("timestampValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in a)return{stringValue:""};else if("bytesValue"in a)return{bytesValue:""};else if("referenceValue"in a)return h3(hr.empty(),eU.empty());else if("geoPointValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in a)return{arrayValue:{}};else if(!("mapValue"in a))return eq(35942,{value:a});else return ib(a)?ie:{mapValue:{}}}function ih(a){if("nullValue"in a)return{booleanValue:!1};if("booleanValue"in a)return{doubleValue:NaN};if("integerValue"in a||"doubleValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in a)return{stringValue:""};if("stringValue"in a)return{bytesValue:""};else if("bytesValue"in a)return h3(hr.empty(),eU.empty());else if("referenceValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in a)return{arrayValue:{}};else if("arrayValue"in a)return ie;else if(!("mapValue"in a))return eq(61959,{value:a});else return ib(a)?{mapValue:{}}:hz}function ii(a,b){let c=hL(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?-1:!a.inclusive&&b.inclusive?1:0}function ij(a,b){let c=hL(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?1:!a.inclusive&&b.inclusive?-1:0}class ik{constructor(a){this.value=a}static empty(){return new ik({mapValue:{}})}field(a){if(a.isEmpty())return this.value;{let b=this.value;for(let c=0;c<a.length-1;++c)if(!ia(b=(b.mapValue.fields||{})[a.get(c)]))return null;return(b=(b.mapValue.fields||{})[a.lastSegment()])||null}}set(a,b){this.getFieldsMap(a.popLast())[a.lastSegment()]=ic(b)}setAll(a){let b=eT.emptyPath(),c={},d=[];a.forEach((a,e)=>{if(!b.isImmediateParentOf(e)){let a=this.getFieldsMap(b);this.applyChanges(a,c,d),c={},d=[],b=e.popLast()}a?c[e.lastSegment()]=ic(a):d.push(e.lastSegment())});let e=this.getFieldsMap(b);this.applyChanges(e,c,d)}delete(a){let b=this.field(a.popLast());ia(b)&&b.mapValue.fields&&delete b.mapValue.fields[a.lastSegment()]}isEqual(a){return hE(this.value,a.value)}getFieldsMap(a){let b=this.value;b.mapValue.fields||(b.mapValue={fields:{}});for(let c=0;c<a.length;++c){let d=b.mapValue.fields[a.get(c)];ia(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},b.mapValue.fields[a.get(c)]=d),b=d}return b.mapValue.fields}applyChanges(a,b,c){for(let d of(gY(b,(b,c)=>a[b]=c),c))delete a[d]}clone(){return new ik(ic(this.value))}}function il(a){let b=[];return gY(a.fields,(a,c)=>{let d=new eT([a]);if(ia(c)){let a=il(c.mapValue).fields;if(0===a.length)b.push(d);else for(let c of a)b.push(d.child(c))}else b.push(d)}),new g7(b)}class im{constructor(a,b,c,d,e,f,g){this.key=a,this.documentType=b,this.version=c,this.readTime=d,this.createTime=e,this.data=f,this.documentState=g}static newInvalidDocument(a){return new im(a,0,e5.min(),e5.min(),e5.min(),ik.empty(),0)}static newFoundDocument(a,b,c,d){return new im(a,1,b,e5.min(),c,d,0)}static newNoDocument(a,b){return new im(a,2,b,e5.min(),e5.min(),ik.empty(),0)}static newUnknownDocument(a,b){return new im(a,3,b,e5.min(),e5.min(),ik.empty(),2)}convertToFoundDocument(a,b){return this.createTime.isEqual(e5.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=a),this.version=a,this.documentType=1,this.data=b,this.documentState=0,this}convertToNoDocument(a){return this.version=a,this.documentType=2,this.data=ik.empty(),this.documentState=0,this}convertToUnknownDocument(a){return this.version=a,this.documentType=3,this.data=ik.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=e5.min(),this}setReadTime(a){return this.readTime=a,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(a){return a instanceof im&&this.key.isEqual(a.key)&&this.version.isEqual(a.version)&&this.documentType===a.documentType&&this.documentState===a.documentState&&this.data.isEqual(a.data)}mutableCopy(){return new im(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function io(a,b,c){let d=b.data.field(a),e=c.data.field(a);return null!==d&&null!==e?hL(d,e):eq(42886)}class ip{constructor(a,b){this.position=a,this.inclusive=b}}function iq(a,b,c){let d=0;for(let e=0;e<a.position.length;e++){let f=b[e],g=a.position[e];if(d=f.field.isKeyField()?eU.comparator(eU.fromName(g.referenceValue),c.key):hL(g,c.data.field(f.field)),"desc"===f.dir&&(d*=-1),0!==d)break}return d}function ir(a,b,c){let d=iq(a,b,c);return a.inclusive?d>=0:d>0}function is(a,b,c){let d=iq(a,b,c);return a.inclusive?d<=0:d<0}function it(a,b){if(null===a)return null===b;if(null===b||a.inclusive!==b.inclusive||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!hE(a.position[c],b.position[c]))return!1;return!0}class iu{constructor(a,b="asc"){this.field=a,this.dir=b}}function iv(a){return a.field.canonicalString()+a.dir}function iw(a){return`${a.field.canonicalString()} (${a.dir})`}function ix(a,b){return a.dir===b.dir&&a.field.isEqual(b.field)}class iy{}class iz extends iy{constructor(a,b,c){super(),this.field=a,this.op=b,this.value=c}static create(a,b,c){if(a.isKeyField())if("in"===b||"not-in"===b)return this.createKeyFieldInFilter(a,b,c);else return new iN(a,b,c);if("array-contains"===b)return new iR(a,c);if("in"===b)return new iS(a,c);if("not-in"===b)return new iT(a,c);if("array-contains-any"===b)return new iU(a,c);else return new iz(a,b,c)}static createKeyFieldInFilter(a,b,c){return"in"===b?new iO(a,c):new iP(a,c)}matches(a){let b=a.data.field(this.field);return"!="===this.op?null!==b&&void 0===b.nullValue&&this.matchesComparison(hL(b,this.value)):null!==b&&hD(this.value)===hD(b)&&this.matchesComparison(hL(b,this.value))}matchesComparison(a){switch(this.op){case"<":return a<0;case"<=":return a<=0;case"==":return 0===a;case"!=":return 0!==a;case">":return a>0;case">=":return a>=0;default:return eq(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class iA extends iy{constructor(a,b){super(),this.filters=a,this.op=b,this.memoizedFlattenedFilters=null}static create(a,b){return new iA(a,b)}matches(a){return iB(this)?void 0===this.filters.find(b=>!b.matches(a)):void 0!==this.filters.find(b=>b.matches(a))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((a,b)=>a.concat(b.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function iB(a){return"and"===a.op}function iC(a){return"or"===a.op}function iD(a){return iE(a)&&iB(a)}function iE(a){for(let b of a.filters)if(b instanceof iA)return!1;return!0}function iF(a){if(a instanceof iz)return a.field.canonicalString()+a.op.toString()+hU(a.value);{if(iD(a))return a.filters.map(a=>iF(a)).join(",");let b=a.filters.map(a=>iF(a)).join(",");return`${a.op}(${b})`}}function iG(a,b){return a instanceof iz?iH(a,b):a instanceof iA?iI(a,b):void eq(19439)}function iH(a,b){return b instanceof iz&&a.op===b.op&&a.field.isEqual(b.field)&&hE(a.value,b.value)}function iI(a,b){return b instanceof iA&&a.op===b.op&&a.filters.length===b.filters.length&&a.filters.reduce((a,c,d)=>a&&iG(c,b.filters[d]),!0)}function iJ(a,b){let c=a.filters.concat(b);return iA.create(c,a.op)}function iK(a){return a instanceof iz?iM(a):a instanceof iA?iL(a):"Filter"}function iL(a){return a.op.toString()+" {"+a.getFilters().map(iK).join(" ,")+"}"}function iM(a){return`${a.field.canonicalString()} ${a.op} ${hU(a.value)}`}class iN extends iz{constructor(a,b,c){super(a,b,c),this.key=eU.fromName(c.referenceValue)}matches(a){let b=eU.comparator(a.key,this.key);return this.matchesComparison(b)}}class iO extends iz{constructor(a,b){super(a,"in",b),this.keys=iQ("in",b)}matches(a){return this.keys.some(b=>b.isEqual(a.key))}}class iP extends iz{constructor(a,b){super(a,"not-in",b),this.keys=iQ("not-in",b)}matches(a){return!this.keys.some(b=>b.isEqual(a.key))}}function iQ(a,b){return(b.arrayValue?.values||[]).map(a=>eU.fromName(a.referenceValue))}class iR extends iz{constructor(a,b){super(a,"array-contains",b)}matches(a){let b=a.data.field(this.field);return h7(b)&&hK(b.arrayValue,this.value)}}class iS extends iz{constructor(a,b){super(a,"in",b)}matches(a){let b=a.data.field(this.field);return null!==b&&hK(this.value.arrayValue,b)}}class iT extends iz{constructor(a,b){super(a,"not-in",b)}matches(a){if(hK(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let b=a.data.field(this.field);return null!==b&&void 0===b.nullValue&&!hK(this.value.arrayValue,b)}}class iU extends iz{constructor(a,b){super(a,"array-contains-any",b)}matches(a){let b=a.data.field(this.field);return!!h7(b)&&!!b.arrayValue.values&&b.arrayValue.values.some(a=>hK(this.value.arrayValue,a))}}class iV{constructor(a,b=null,c=[],d=[],e=null,f=null,g=null){this.path=a,this.collectionGroup=b,this.orderBy=c,this.filters=d,this.limit=e,this.startAt=f,this.endAt=g,this.memoizedCanonicalId=null}}function iW(a,b=null,c=[],d=[],e=null,f=null,g=null){return new iV(a,b,c,d,e,f,g)}function iX(a){let b=et(a);if(null===b.memoizedCanonicalId){let a=b.path.canonicalString();null!==b.collectionGroup&&(a+="|cg:"+b.collectionGroup),a+="|f:",a+=b.filters.map(a=>iF(a)).join(","),a+="|ob:",a+=b.orderBy.map(a=>iv(a)).join(","),hu(b.limit)||(a+="|l:",a+=b.limit),b.startAt&&(a+="|lb:",a+=b.startAt.inclusive?"b:":"a:",a+=b.startAt.position.map(a=>hU(a)).join(",")),b.endAt&&(a+="|ub:",a+=b.endAt.inclusive?"a:":"b:",a+=b.endAt.position.map(a=>hU(a)).join(",")),b.memoizedCanonicalId=a}return b.memoizedCanonicalId}function iY(a){let b=a.path.canonicalString();return null!==a.collectionGroup&&(b+=" collectionGroup="+a.collectionGroup),a.filters.length>0&&(b+=`, filters: [${a.filters.map(a=>iK(a)).join(", ")}]`),hu(a.limit)||(b+=", limit: "+a.limit),a.orderBy.length>0&&(b+=`, orderBy: [${a.orderBy.map(a=>iw(a)).join(", ")}]`),a.startAt&&(b+=", startAt: ",b+=a.startAt.inclusive?"b:":"a:",b+=a.startAt.position.map(a=>hU(a)).join(",")),a.endAt&&(b+=", endAt: ",b+=a.endAt.inclusive?"a:":"b:",b+=a.endAt.position.map(a=>hU(a)).join(",")),`Target(${b})`}function iZ(a,b){if(a.limit!==b.limit||a.orderBy.length!==b.orderBy.length)return!1;for(let c=0;c<a.orderBy.length;c++)if(!ix(a.orderBy[c],b.orderBy[c]))return!1;if(a.filters.length!==b.filters.length)return!1;for(let c=0;c<a.filters.length;c++)if(!iG(a.filters[c],b.filters[c]))return!1;return a.collectionGroup===b.collectionGroup&&!!a.path.isEqual(b.path)&&!!it(a.startAt,b.startAt)&&it(a.endAt,b.endAt)}function i$(a){return eU.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function i_(a,b){return a.filters.filter(a=>a instanceof iz&&a.field.isEqual(b))}function i0(a,b){let c=e9(b);if(void 0===c)return null;for(let b of i_(a,c.fieldPath))switch(b.op){case"array-contains-any":return b.value.arrayValue.values||[];case"array-contains":return[b.value]}return null}function i1(a,b){let c=new Map;for(let d of fa(b))for(let b of i_(a,d.fieldPath))switch(b.op){case"==":case"in":c.set(d.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return c.set(d.fieldPath.canonicalString(),b.value),Array.from(c.values())}return null}function i2(a,b){let c=[],d=!0;for(let e of fa(b)){let b=0===e.kind?i4(a,e.fieldPath,a.startAt):i5(a,e.fieldPath,a.startAt);c.push(b.value),d&&(d=b.inclusive)}return new ip(c,d)}function i3(a,b){let c=[],d=!0;for(let e of fa(b)){let b=0===e.kind?i5(a,e.fieldPath,a.endAt):i4(a,e.fieldPath,a.endAt);c.push(b.value),d&&(d=b.inclusive)}return new ip(c,d)}function i4(a,b,c){let d=hC,e=!0;for(let c of i_(a,b)){let a=hC,b=!0;switch(c.op){case"<":case"<=":a=ig(c.value);break;case"==":case"in":case">=":a=c.value;break;case">":a=c.value,b=!1;break;case"!=":case"not-in":a=hC}0>ii({value:d,inclusive:e},{value:a,inclusive:b})&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];0>ii({value:d,inclusive:e},{value:a,inclusive:c.inclusive})&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function i5(a,b,c){let d=hz,e=!0;for(let c of i_(a,b)){let a=hz,b=!0;switch(c.op){case">=":case">":a=ih(c.value),b=!1;break;case"==":case"in":case"<=":a=c.value;break;case"<":a=c.value,b=!1;break;case"!=":case"not-in":a=hz}ij({value:d,inclusive:e},{value:a,inclusive:b})>0&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];ij({value:d,inclusive:e},{value:a,inclusive:c.inclusive})>0&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function i6(a){let b=new g3(eT.comparator),c=!1;for(let d of a.filters)for(let a of d.getFlattenedFilters())a.field.isKeyField()||("array-contains"===a.op||"array-contains-any"===a.op?c=!0:b=b.add(a.field));for(let c of a.orderBy)c.field.isKeyField()||(b=b.add(c.field));return b.size+ +!!c}function i7(a){return null!==a.limit}class i8{constructor(a,b=null,c=[],d=[],e=null,f="F",g=null,h=null){this.path=a,this.collectionGroup=b,this.explicitOrderBy=c,this.filters=d,this.limit=e,this.limitType=f,this.startAt=g,this.endAt=h,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function i9(a,b,c,d,e,f,g,h){return new i8(a,b,c,d,e,f,g,h)}function ja(a){return new i8(a)}function jb(a,b){return new i8(b,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function jc(a){return 0===a.filters.length&&null===a.limit&&null==a.startAt&&null==a.endAt&&(0===a.explicitOrderBy.length||1===a.explicitOrderBy.length&&a.explicitOrderBy[0].field.isKeyField())}function jd(a){let b=new g3(eT.comparator);return a.filters.forEach(a=>{a.getFlattenedFilters().forEach(a=>{a.isInequality()&&(b=b.add(a.field))})}),b}function je(a){return eU.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function jf(a){return null!==a.collectionGroup}function jg(a){let b=et(a);if(null===b.memoizedNormalizedOrderBy){b.memoizedNormalizedOrderBy=[];let a=new Set;for(let c of b.explicitOrderBy)b.memoizedNormalizedOrderBy.push(c),a.add(c.field.canonicalString());let c=b.explicitOrderBy.length>0?b.explicitOrderBy[b.explicitOrderBy.length-1].dir:"asc";jd(b).forEach(d=>{a.has(d.canonicalString())||d.isKeyField()||b.memoizedNormalizedOrderBy.push(new iu(d,c))}),a.has(eT.keyField().canonicalString())||b.memoizedNormalizedOrderBy.push(new iu(eT.keyField(),c))}return b.memoizedNormalizedOrderBy}function jh(a){let b=et(a);return b.memoizedTarget||(b.memoizedTarget=jj(b,jg(a))),b.memoizedTarget}function ji(a){let b=et(a);return b.memoizedAggregateTarget||(b.memoizedAggregateTarget=jj(b,a.explicitOrderBy)),b.memoizedAggregateTarget}function jj(a,b){if("F"===a.limitType)return iW(a.path,a.collectionGroup,b,a.filters,a.limit,a.startAt,a.endAt);{b=b.map(a=>{let b="desc"===a.dir?"asc":"desc";return new iu(a.field,b)});let c=a.endAt?new ip(a.endAt.position,a.endAt.inclusive):null,d=a.startAt?new ip(a.startAt.position,a.startAt.inclusive):null;return iW(a.path,a.collectionGroup,b,a.filters,a.limit,c,d)}}function jk(a,b){let c=a.filters.concat([b]);return new i8(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}function jl(a,b){let c=a.explicitOrderBy.concat([b]);return new i8(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function jm(a,b,c){return new i8(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),b,c,a.startAt,a.endAt)}function jn(a,b){return new i8(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,b,a.endAt)}function jo(a,b){return new i8(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,b)}function jp(a,b){return iZ(jh(a),jh(b))&&a.limitType===b.limitType}function jq(a){return`${iX(jh(a))}|lt:${a.limitType}`}function jr(a){return`Query(target=${iY(jh(a))}; limitType=${a.limitType})`}function js(a,b){return b.isFoundDocument()&&jt(a,b)&&ju(a,b)&&jv(a,b)&&jw(a,b)}function jt(a,b){let c=b.key.path;return null!==a.collectionGroup?b.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):eU.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}function ju(a,b){for(let c of jg(a))if(!c.field.isKeyField()&&null===b.data.field(c.field))return!1;return!0}function jv(a,b){for(let c of a.filters)if(!c.matches(b))return!1;return!0}function jw(a,b){return(!a.startAt||!!is(a.startAt,jg(a),b))&&(!a.endAt||!!ir(a.endAt,jg(a),b))}function jx(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function jy(a){return(b,c)=>{let d=!1;for(let e of jg(a)){let a=jz(e,b,c);if(0!==a)return a;d=d||e.field.isKeyField()}return 0}}function jz(a,b,c){let d=a.field.isKeyField()?eU.comparator(b.key,c.key):io(a.field,b,c);switch(a.dir){case"asc":return d;case"desc":return -1*d;default:return eq(19790,{direction:a.dir})}}class jA{constructor(a,b){this.mapKeyFn=a,this.equalsFn=b,this.inner={},this.innerSize=0}get(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0!==c){for(let[b,d]of c)if(this.equalsFn(b,a))return d}}has(a){return void 0!==this.get(a)}set(a,b){let c=this.mapKeyFn(a),d=this.inner[c];if(void 0===d){this.inner[c]=[[a,b]],this.innerSize++;return}for(let c=0;c<d.length;c++)if(this.equalsFn(d[c][0],a)){d[c]=[a,b];return}d.push([a,b]),this.innerSize++}delete(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0===c)return!1;for(let d=0;d<c.length;d++)if(this.equalsFn(c[d][0],a))return 1===c.length?delete this.inner[b]:c.splice(d,1),this.innerSize--,!0;return!1}forEach(a){gY(this.inner,(b,c)=>{for(let[b,d]of c)a(b,d)})}isEmpty(){return g$(this.inner)}size(){return this.innerSize}}let jB=new g_(eU.comparator);function jC(){return jB}let jD=new g_(eU.comparator);function jE(...a){let b=jD;for(let c of a)b=b.insert(c.key,c);return b}function jF(){return jJ()}function jG(a){let b=jD;return a.forEach((a,c)=>b=b.insert(a,c.overlayedDocument)),b}function jH(){return jJ()}function jI(){return jJ()}function jJ(){return new jA(a=>a.toString(),(a,b)=>a.isEqual(b))}let jK=new g_(eU.comparator);function jL(){return jK}let jM=new g3(eU.comparator);function jN(...a){let b=jM;for(let c of a)b=b.add(c);return b}let jO=new g3(eI);function jP(){return jO}function jQ(a,b){if(a.useProto3Json){if(isNaN(b))return{doubleValue:"NaN"};else if(b===1/0)return{doubleValue:"Infinity"};else if(b===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hv(b)?"-0":b}}function jR(a){return{integerValue:""+a}}function jS(a,b){return hw(b)?jR(b):jQ(a,b)}class jT{constructor(){this._=void 0}}function jU(a,b,c){return a instanceof jY?hm(c,b):a instanceof jZ?j$(a,b):a instanceof j_?j0(a,b):j2(a,b)}function jV(a,b,c){return a instanceof jZ?j$(a,b):a instanceof j_?j0(a,b):c}function jW(a,b){return a instanceof j1?h6(b)?b:{integerValue:0}:null}function jX(a,b){return a instanceof jZ&&b instanceof jZ||a instanceof j_&&b instanceof j_?eN(a.elements,b.elements,hE):a instanceof j1&&b instanceof j1?hE(a.operand,b.operand):a instanceof jY&&b instanceof jY}class jY extends jT{}class jZ extends jT{constructor(a){super(),this.elements=a}}function j$(a,b){let c=j4(b);for(let b of a.elements)c.some(a=>hE(a,b))||c.push(b);return{arrayValue:{values:c}}}class j_ extends jT{constructor(a){super(),this.elements=a}}function j0(a,b){let c=j4(b);for(let b of a.elements)c=c.filter(a=>!hE(a,b));return{arrayValue:{values:c}}}class j1 extends jT{constructor(a,b){super(),this.serializer=a,this.operand=b}}function j2(a,b){let c=jW(a,b),d=j3(c)+j3(a.operand);return h4(c)&&h4(a.operand)?jR(d):jQ(a.serializer,d)}function j3(a){return hf(a.integerValue||a.doubleValue)}function j4(a){return h7(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class j5{constructor(a,b){this.field=a,this.transform=b}}function j6(a,b){return a.field.isEqual(b.field)&&jX(a.transform,b.transform)}function j7(a,b){return void 0===a&&void 0===b||!!a&&!!b&&eN(a,b,(a,b)=>j6(a,b))}class j8{constructor(a,b){this.version=a,this.transformResults=b}}class j9{constructor(a,b){this.updateTime=a,this.exists=b}static none(){return new j9}static exists(a){return new j9(void 0,a)}static updateTime(a){return new j9(a)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(a){return this.exists===a.exists&&(this.updateTime?!!a.updateTime&&this.updateTime.isEqual(a.updateTime):!a.updateTime)}}function ka(a,b){return void 0!==a.updateTime?b.isFoundDocument()&&b.version.isEqual(a.updateTime):void 0===a.exists||a.exists===b.isFoundDocument()}class kb{}function kc(a,b){if(!a.hasLocalMutations||b&&0===b.fields.length)return null;if(null===b)if(a.isNoDocument())return new kq(a.key,j9.none());else return new kh(a.key,a.data,j9.none());{let c=a.data,d=ik.empty(),e=new g3(eT.comparator);for(let a of b.fields)if(!e.has(a)){let b=c.field(a);null===b&&a.length>1&&(a=a.popLast(),b=c.field(a)),null===b?d.delete(a):d.set(a,b),e=e.add(a)}return new kk(a.key,d,new g7(e.toArray()),j9.none())}}function kd(a,b,c){a instanceof kh?ki(a,b,c):a instanceof kk?kl(a,b,c):kr(a,b,c)}function ke(a,b,c,d){return a instanceof kh?kj(a,b,c,d):a instanceof kk?km(a,b,c,d):ks(a,b,c)}function kf(a,b){let c=null;for(let d of a.fieldTransforms){let a=b.data.field(d.field),e=jW(d.transform,a||null);null!=e&&(null===c&&(c=ik.empty()),c.set(d.field,e))}return c||null}function kg(a,b){return a.type===b.type&&!!a.key.isEqual(b.key)&&!!a.precondition.isEqual(b.precondition)&&!!j7(a.fieldTransforms,b.fieldTransforms)&&(0===a.type?a.value.isEqual(b.value):1!==a.type||a.data.isEqual(b.data)&&a.fieldMask.isEqual(b.fieldMask))}class kh extends kb{constructor(a,b,c,d=[]){super(),this.key=a,this.value=b,this.precondition=c,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}function ki(a,b,c){let d=a.value.clone(),e=ko(a.fieldTransforms,b,c.transformResults);d.setAll(e),b.convertToFoundDocument(c.version,d).setHasCommittedMutations()}function kj(a,b,c,d){if(!ka(a.precondition,b))return c;let e=a.value.clone(),f=kp(a.fieldTransforms,d,b);return e.setAll(f),b.convertToFoundDocument(b.version,e).setHasLocalMutations(),null}class kk extends kb{constructor(a,b,c,d,e=[]){super(),this.key=a,this.data=b,this.fieldMask=c,this.precondition=d,this.fieldTransforms=e,this.type=1}getFieldMask(){return this.fieldMask}}function kl(a,b,c){if(!ka(a.precondition,b))return void b.convertToUnknownDocument(c.version);let d=ko(a.fieldTransforms,b,c.transformResults),e=b.data;e.setAll(kn(a)),e.setAll(d),b.convertToFoundDocument(c.version,e).setHasCommittedMutations()}function km(a,b,c,d){if(!ka(a.precondition,b))return c;let e=kp(a.fieldTransforms,d,b),f=b.data;return(f.setAll(kn(a)),f.setAll(e),b.convertToFoundDocument(b.version,f).setHasLocalMutations(),null===c)?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(a=>a.field))}function kn(a){let b=new Map;return a.fieldMask.fields.forEach(c=>{if(!c.isEmpty()){let d=a.data.field(c);b.set(c,d)}}),b}function ko(a,b,c){let d=new Map;es(a.length===c.length,32656,{serverTransformResultCount:c.length,fieldTransformCount:a.length});for(let e=0;e<c.length;e++){let f=a[e],g=f.transform,h=b.data.field(f.field);d.set(f.field,jV(g,h,c[e]))}return d}function kp(a,b,c){let d=new Map;for(let e of a){let a=e.transform,f=c.data.field(e.field);d.set(e.field,jU(a,f,b))}return d}class kq extends kb{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function kr(a,b,c){b.convertToNoDocument(c.version).setHasCommittedMutations()}function ks(a,b,c){return ka(a.precondition,b)?(b.convertToNoDocument(b.version).setHasLocalMutations(),null):c}class kt extends kb{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ku{constructor(a,b,c,d){this.batchId=a,this.localWriteTime=b,this.baseMutations=c,this.mutations=d}applyToRemoteDocument(a,b){let c=b.mutationResults;for(let b=0;b<this.mutations.length;b++){let d=this.mutations[b];d.key.isEqual(a.key)&&kd(d,a,c[b])}}applyToLocalView(a,b){for(let c of this.baseMutations)c.key.isEqual(a.key)&&(b=ke(c,a,b,this.localWriteTime));for(let c of this.mutations)c.key.isEqual(a.key)&&(b=ke(c,a,b,this.localWriteTime));return b}applyToLocalDocumentSet(a,b){let c=jI();return this.mutations.forEach(d=>{let e=a.get(d.key),f=e.overlayedDocument,g=this.applyToLocalView(f,e.mutatedFields),h=kc(f,g=b.has(d.key)?null:g);null!==h&&c.set(d.key,h),f.isValidDocument()||f.convertToNoDocument(e5.min())}),c}keys(){return this.mutations.reduce((a,b)=>a.add(b.key),jN())}isEqual(a){return this.batchId===a.batchId&&eN(this.mutations,a.mutations,(a,b)=>kg(a,b))&&eN(this.baseMutations,a.baseMutations,(a,b)=>kg(a,b))}}class kv{constructor(a,b,c,d){this.batch=a,this.commitVersion=b,this.mutationResults=c,this.docVersions=d}static from(a,b,c){es(a.mutations.length===c.length,58842,{mutationsSent:a.mutations.length,resultsReceived:c.length});let d=jL(),e=a.mutations;for(let a=0;a<e.length;a++)d=d.insert(e[a].key,c[a].version);return new kv(a,b,c,d)}}class kw{constructor(a,b){this.largestBatchId=a,this.mutation=b}getKey(){return this.mutation.key}isEqual(a){return null!==a&&this.mutation===a.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class kx{constructor(a,b){this.count=a,this.unchangedNames=b}}function ky(a){switch(a){case eu.OK:return eq(64938);case eu.CANCELLED:case eu.UNKNOWN:case eu.DEADLINE_EXCEEDED:case eu.RESOURCE_EXHAUSTED:case eu.INTERNAL:case eu.UNAVAILABLE:case eu.UNAUTHENTICATED:return!1;case eu.INVALID_ARGUMENT:case eu.NOT_FOUND:case eu.ALREADY_EXISTS:case eu.PERMISSION_DENIED:case eu.FAILED_PRECONDITION:case eu.ABORTED:case eu.OUT_OF_RANGE:case eu.UNIMPLEMENTED:case eu.DATA_LOSS:return!0;default:return eq(15467,{code:a})}}function kz(a){return ky(a)&&a!==eu.ABORTED}function kA(a){if(void 0===a)return en("GRPC error has no .code"),eu.UNKNOWN;switch(a){case m.OK:return eu.OK;case m.CANCELLED:return eu.CANCELLED;case m.UNKNOWN:return eu.UNKNOWN;case m.DEADLINE_EXCEEDED:return eu.DEADLINE_EXCEEDED;case m.RESOURCE_EXHAUSTED:return eu.RESOURCE_EXHAUSTED;case m.INTERNAL:return eu.INTERNAL;case m.UNAVAILABLE:return eu.UNAVAILABLE;case m.UNAUTHENTICATED:return eu.UNAUTHENTICATED;case m.INVALID_ARGUMENT:return eu.INVALID_ARGUMENT;case m.NOT_FOUND:return eu.NOT_FOUND;case m.ALREADY_EXISTS:return eu.ALREADY_EXISTS;case m.PERMISSION_DENIED:return eu.PERMISSION_DENIED;case m.FAILED_PRECONDITION:return eu.FAILED_PRECONDITION;case m.ABORTED:return eu.ABORTED;case m.OUT_OF_RANGE:return eu.OUT_OF_RANGE;case m.UNIMPLEMENTED:return eu.UNIMPLEMENTED;case m.DATA_LOSS:return eu.DATA_LOSS;default:return eq(39323,{code:a})}}!function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS"}(m||(m={}));class kB extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}let kC=null;function kD(a){if(kC)throw Error("a TestingHooksSpi instance is already set");kC=a}function kE(){return new d8.TextEncoder}function kF(){return new TextDecoder("utf-8")}let kG=new k([0xffffffff,0xffffffff],0);function kH(a){let b=kE().encode(a),c=new l;return c.update(b),new Uint8Array(c.digest())}function kI(a){let b=new DataView(a.buffer),c=b.getUint32(0,!0),d=b.getUint32(4,!0),e=b.getUint32(8,!0),f=b.getUint32(12,!0);return[new k([c,d],0),new k([e,f],0)]}class kJ{constructor(a,b,c){if(this.bitmap=a,this.padding=b,this.hashCount=c,b<0||b>=8)throw new kK(`Invalid padding: ${b}`);if(c<0||a.length>0&&0===this.hashCount)throw new kK(`Invalid hash count: ${c}`);if(0===a.length&&0!==b)throw new kK(`Invalid padding when bitmap length is 0: ${b}`);this.bitCount=8*a.length-b,this.bitCountInInteger=k.fromNumber(this.bitCount)}getBitIndex(a,b,c){let d=a.add(b.multiply(k.fromNumber(c)));return 1===d.compare(kG)&&(d=new k([d.getBits(0),d.getBits(1)],0)),d.modulo(this.bitCountInInteger).toNumber()}isBitSet(a){return(this.bitmap[Math.floor(a/8)]&1<<a%8)!=0}mightContain(a){if(0===this.bitCount)return!1;let[b,c]=kI(kH(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);if(!this.isBitSet(d))return!1}return!0}static create(a,b,c){let d=a%8==0?0:8-a%8,e=new kJ(new Uint8Array(Math.ceil(a/8)),d,b);return c.forEach(a=>e.insert(a)),e}insert(a){if(0===this.bitCount)return;let[b,c]=kI(kH(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);this.setBit(d)}}setBit(a){let b=Math.floor(a/8),c=a%8;this.bitmap[b]|=1<<c}}class kK extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class kL{constructor(a,b,c,d,e){this.snapshotVersion=a,this.targetChanges=b,this.targetMismatches=c,this.documentUpdates=d,this.resolvedLimboDocuments=e}static createSynthesizedRemoteEventForCurrentChange(a,b,c){let d=new Map;return d.set(a,kM.createSynthesizedTargetChangeForCurrentChange(a,b,c)),new kL(e5.min(),d,new g_(eI),jC(),jN())}}class kM{constructor(a,b,c,d,e){this.resumeToken=a,this.current=b,this.addedDocuments=c,this.modifiedDocuments=d,this.removedDocuments=e}static createSynthesizedTargetChangeForCurrentChange(a,b,c){return new kM(c,b,jN(),jN(),jN())}}class kN{constructor(a,b,c,d){this.updatedTargetIds=a,this.removedTargetIds=b,this.key=c,this.newDoc=d}}class kO{constructor(a,b){this.targetId=a,this.existenceFilter=b}}class kP{constructor(a,b,c=ha.EMPTY_BYTE_STRING,d=null){this.state=a,this.targetIds=b,this.resumeToken=c,this.cause=d}}class kQ{constructor(){this.pendingResponses=0,this.documentChanges=kU(),this._resumeToken=ha.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(a){a.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=a)}toTargetChange(){let a=jN(),b=jN(),c=jN();return this.documentChanges.forEach((d,e)=>{switch(e){case 0:a=a.add(d);break;case 2:b=b.add(d);break;case 1:c=c.add(d);break;default:eq(38017,{changeType:e})}}),new kM(this._resumeToken,this._current,a,b,c)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=kU()}addDocumentChange(a,b){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(a,b)}removeDocumentChange(a){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(a)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,es(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let kR="WatchChangeAggregator";class kS{constructor(a){this.metadataProvider=a,this.targetStates=new Map,this.pendingDocumentUpdates=jC(),this.pendingDocumentUpdatesByTarget=kT(),this.pendingDocumentTargetMapping=kT(),this.pendingTargetResets=new g_(eI)}handleDocumentChange(a){for(let b of a.updatedTargetIds)a.newDoc&&a.newDoc.isFoundDocument()?this.addDocumentToTarget(b,a.newDoc):this.removeDocumentFromTarget(b,a.key,a.newDoc);for(let b of a.removedTargetIds)this.removeDocumentFromTarget(b,a.key,a.newDoc)}handleTargetChange(a){this.forEachTarget(a,b=>{let c=this.ensureTargetState(b);switch(a.state){case 0:this.isActiveTarget(b)&&c.updateResumeToken(a.resumeToken);break;case 1:c.recordTargetResponse(),c.isPending||c.clearPendingChanges(),c.updateResumeToken(a.resumeToken);break;case 2:c.recordTargetResponse(),c.isPending||this.removeTarget(b);break;case 3:this.isActiveTarget(b)&&(c.markCurrent(),c.updateResumeToken(a.resumeToken));break;case 4:this.isActiveTarget(b)&&(this.resetTarget(b),c.updateResumeToken(a.resumeToken));break;default:eq(56790,{state:a.state})}})}forEachTarget(a,b){a.targetIds.length>0?a.targetIds.forEach(b):this.targetStates.forEach((a,c)=>{this.isActiveTarget(c)&&b(c)})}handleExistenceFilter(a){let b=a.targetId,c=a.existenceFilter.count,d=this.targetDataForActiveTarget(b);if(d){let e=d.target;if(i$(e))if(0===c){let a=new eU(e.path);this.removeDocumentFromTarget(b,a,im.newNoDocument(a,e5.min()))}else es(1===c,20013,{expectedCount:c});else{let d=this.getCurrentDocumentCountForTarget(b);if(d!==c){let c=this.parseBloomFilter(a),e=c?this.applyBloomFilter(c,a,d):1;if(0!==e){this.resetTarget(b);let a=2===e?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(b,a)}kC?.notifyOnExistenceFilterMismatch(kV(d,a.existenceFilter,this.metadataProvider.getDatabaseId(),c,e))}}}}parseBloomFilter(a){let b,c,d=a.existenceFilter.unchangedNames;if(!d||!d.bits)return null;let{bits:{bitmap:e="",padding:f=0},hashCount:g=0}=d;try{b=hg(e).toUint8Array()}catch(a){if(a instanceof kB)return eo("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{c=new kJ(b,f,g)}catch(a){return a instanceof kK?eo("BloomFilter error: ",a):eo("Applying bloom filter failed: ",a),null}return 0===c.bitCount?null:c}applyBloomFilter(a,b,c){return 2*(b.existenceFilter.count!==c-this.filterRemovedDocuments(a,b.targetId))}filterRemovedDocuments(a,b){let c=this.metadataProvider.getRemoteKeysForTarget(b),d=0;return c.forEach(c=>{let e=this.metadataProvider.getDatabaseId(),f=`projects/${e.projectId}/databases/${e.database}/documents/${c.path.canonicalString()}`;!a.mightContain(f)&&(this.removeDocumentFromTarget(b,c,null),d++)}),d}createRemoteEvent(a){let b=new Map;this.targetStates.forEach((c,d)=>{let e=this.targetDataForActiveTarget(d);if(e){if(c.current&&i$(e.target)){let b=new eU(e.target.path);this.ensureDocumentUpdateByTarget(b).has(d)||this.targetContainsDocument(d,b)||this.removeDocumentFromTarget(d,b,im.newNoDocument(b,a))}c.hasPendingChanges&&(b.set(d,c.toTargetChange()),c.clearPendingChanges())}});let c=jN();this.pendingDocumentTargetMapping.forEach((a,b)=>{let d=!0;b.forEachWhile(a=>{let b=this.targetDataForActiveTarget(a);return!b||"TargetPurposeLimboResolution"===b.purpose||(d=!1,!1)}),d&&(c=c.add(a))}),this.pendingDocumentUpdates.forEach((b,c)=>c.setReadTime(a));let d=new kL(a,b,this.pendingTargetResets,this.pendingDocumentUpdates,c);return this.pendingDocumentUpdates=jC(),this.pendingDocumentUpdatesByTarget=kT(),this.pendingDocumentTargetMapping=kT(),this.pendingTargetResets=new g_(eI),d}addDocumentToTarget(a,b){if(!this.isActiveTarget(a))return;let c=2*!!this.targetContainsDocument(a,b.key);this.ensureTargetState(a).addDocumentChange(b.key,c),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b.key,b),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(b.key,this.ensureDocumentUpdateByTarget(b.key).add(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b.key,this.ensureDocumentTargetMapping(b.key).add(a))}removeDocumentFromTarget(a,b,c){if(!this.isActiveTarget(a))return;let d=this.ensureTargetState(a);this.targetContainsDocument(a,b)?d.addDocumentChange(b,1):d.removeDocumentChange(b),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).delete(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).add(a)),c&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b,c))}removeTarget(a){this.targetStates.delete(a)}getCurrentDocumentCountForTarget(a){let b=this.ensureTargetState(a).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(a).size+b.addedDocuments.size-b.removedDocuments.size}recordPendingTargetRequest(a){this.ensureTargetState(a).recordPendingTargetRequest()}ensureTargetState(a){let b=this.targetStates.get(a);return b||(b=new kQ,this.targetStates.set(a,b)),b}ensureDocumentTargetMapping(a){let b=this.pendingDocumentTargetMapping.get(a);return b||(b=new g3(eI),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(a,b)),b}ensureDocumentUpdateByTarget(a){let b=this.pendingDocumentUpdatesByTarget.get(a);return b||(b=new g3(eI),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(a,b)),b}isActiveTarget(a){let b=null!==this.targetDataForActiveTarget(a);return b||em(kR,"Detected inactive target",a),b}targetDataForActiveTarget(a){let b=this.targetStates.get(a);return b&&b.isPending?null:this.metadataProvider.getTargetDataForTarget(a)}resetTarget(a){this.targetStates.set(a,new kQ),this.metadataProvider.getRemoteKeysForTarget(a).forEach(b=>{this.removeDocumentFromTarget(a,b,null)})}targetContainsDocument(a,b){return this.metadataProvider.getRemoteKeysForTarget(a).has(b)}}function kT(){return new g_(eU.comparator)}function kU(){return new g_(eU.comparator)}function kV(a,b,c,d,e){let f={localCacheCount:a,existenceFilterCount:b.count,databaseId:c.database,projectId:c.projectId},g=b.unchangedNames;return g&&(f.bloomFilter={applied:0===e,hashCount:g?.hashCount??0,bitmapLength:g?.bits?.bitmap?.length??0,padding:g?.bits?.padding??0,mightContain:a=>d?.mightContain(a)??!1}),f}let kW=(()=>{let a={};return a.asc="ASCENDING",a.desc="DESCENDING",a})(),kX=(()=>{let a={};return a["<"]="LESS_THAN",a["<="]="LESS_THAN_OR_EQUAL",a[">"]="GREATER_THAN",a[">="]="GREATER_THAN_OR_EQUAL",a["=="]="EQUAL",a["!="]="NOT_EQUAL",a["array-contains"]="ARRAY_CONTAINS",a.in="IN",a["not-in"]="NOT_IN",a["array-contains-any"]="ARRAY_CONTAINS_ANY",a})(),kY=(()=>{let a={};return a.and="AND",a.or="OR",a})();class kZ{constructor(a,b){this.databaseId=a,this.useProto3Json=b}}function k$(a){return new ev(void 0===a.code?eu.UNKNOWN:kA(a.code),a.message||"")}function k_(a,b){return a.useProto3Json||hu(b)?b:{value:b}}function k0(a){let b;return hu(b="object"==typeof a?a.value:a)?null:b}function k1(a,b){if(!a.useProto3Json)return{seconds:""+b.seconds,nanos:b.nanoseconds};{let a=new Date(1e3*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),c=("000000000"+b.nanoseconds).slice(-9);return`${a}.${c}Z`}}function k2(a){let b=he(a);return new e4(b.seconds,b.nanos)}function k3(a,b){return a.useProto3Json?b.toBase64():b.toUint8Array()}function k4(a,b){return a.useProto3Json?(es(void 0===b||"string"==typeof b,58123),ha.fromBase64String(b||"")):(es(void 0===b||b instanceof Buffer||b instanceof Uint8Array,16193),ha.fromUint8Array(b||new Uint8Array))}function k5(a,b){return k1(a,b.toTimestamp())}function k6(a){return es(!!a,49232),e5.fromTimestamp(k2(a))}function k7(a,b){return k8(a,b).canonicalString()}function k8(a,b){let c=lf(a).child("documents");return void 0===b?c:c.child(b)}function k9(a){let b=eR.fromString(a);return es(l6(b),10190,{key:b.toString()}),b}function la(a,b){return k7(a.databaseId,b.path)}function lb(a,b){let c=k9(b);if(c.get(1)!==a.databaseId.projectId)throw new ev(eu.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+c.get(1)+" vs "+a.databaseId.projectId);if(c.get(3)!==a.databaseId.database)throw new ev(eu.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+c.get(3)+" vs "+a.databaseId.database);return new eU(lg(c))}function lc(a,b){return k7(a.databaseId,b)}function ld(a){let b=k9(a);return 4===b.length?eR.emptyPath():lg(b)}function le(a){return new eR(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function lf(a){return new eR(["projects",a.projectId,"databases",a.database])}function lg(a){return es(a.length>4&&"documents"===a.get(4),29091,{key:a.toString()}),a.popFirst(5)}function lh(a,b,c){return{name:la(a,b),fields:c.value.mapValue.fields}}function li(a,b){return{name:la(a,b.key),fields:b.data.value.mapValue.fields,updateTime:k1(a,b.version.toTimestamp()),createTime:k1(a,b.createTime.toTimestamp())}}function lj(a,b,c){let d=lb(a,b.name),e=k6(b.updateTime),f=b.createTime?k6(b.createTime):e5.min(),g=new ik({mapValue:{fields:b.fields}}),h=im.newFoundDocument(d,e,f,g);return c&&h.setHasCommittedMutations(),c?h.setHasCommittedMutations():h}function lk(a,b){es(!!b.found,43571),b.found.name,b.found.updateTime;let c=lb(a,b.found.name),d=k6(b.found.updateTime),e=b.found.createTime?k6(b.found.createTime):e5.min(),f=new ik({mapValue:{fields:b.found.fields}});return im.newFoundDocument(c,d,e,f)}function ll(a,b){es(!!b.missing,3894),es(!!b.readTime,22933);let c=lb(a,b.missing),d=k6(b.readTime);return im.newNoDocument(c,d)}function lm(a,b){return"found"in b?lk(a,b):"missing"in b?ll(a,b):eq(7234,{result:b})}function ln(a,b){let c;if("targetChange"in b){b.targetChange;let d=lo(b.targetChange.targetChangeType||"NO_CHANGE"),e=b.targetChange.targetIds||[],f=k4(a,b.targetChange.resumeToken),g=b.targetChange.cause;c=new kP(d,e,f,g&&k$(g)||null)}else if("documentChange"in b){b.documentChange;let d=b.documentChange;d.document,d.document.name,d.document.updateTime;let e=lb(a,d.document.name),f=k6(d.document.updateTime),g=d.document.createTime?k6(d.document.createTime):e5.min(),h=new ik({mapValue:{fields:d.document.fields}}),i=im.newFoundDocument(e,f,g,h);c=new kN(d.targetIds||[],d.removedTargetIds||[],i.key,i)}else if("documentDelete"in b){b.documentDelete;let d=b.documentDelete;d.document;let e=lb(a,d.document),f=d.readTime?k6(d.readTime):e5.min(),g=im.newNoDocument(e,f);c=new kN([],d.removedTargetIds||[],g.key,g)}else if("documentRemove"in b){b.documentRemove;let d=b.documentRemove;d.document;let e=lb(a,d.document);c=new kN([],d.removedTargetIds||[],e,null)}else{if(!("filter"in b))return eq(11601,{change:b});b.filter;let a=b.filter;a.targetId;let{count:d=0,unchangedNames:e}=a,f=new kx(d,e);c=new kO(a.targetId,f)}return c}function lo(a){if("NO_CHANGE"===a)return 0;if("ADD"===a)return 1;if("REMOVE"===a)return 2;if("CURRENT"===a)return 3;if("RESET"===a)return 4;else return eq(39313,{state:a})}function lp(a){if(!("targetChange"in a))return e5.min();let b=a.targetChange;return b.targetIds&&b.targetIds.length||!b.readTime?e5.min():k6(b.readTime)}function lq(a,b){let c;if(b instanceof kh)c={update:lh(a,b.key,b.value)};else if(b instanceof kq)c={delete:la(a,b.key)};else if(b instanceof kk)c={update:lh(a,b.key,b.data),updateMask:l4(b.fieldMask)};else{if(!(b instanceof kt))return eq(16599,{mutationType:b.type});c={verify:la(a,b.key)}}return b.fieldTransforms.length>0&&(c.updateTransforms=b.fieldTransforms.map(b=>lw(a,b))),b.precondition.isNone||(c.currentDocument=ls(a,b.precondition)),c}function lr(a,b){let c=b.currentDocument?lt(b.currentDocument):j9.none(),d=b.updateTransforms?b.updateTransforms.map(b=>lx(a,b)):[];if(b.update){b.update.name;let e=lb(a,b.update.name),f=new ik({mapValue:{fields:b.update.fields}});return b.updateMask?new kk(e,f,l5(b.updateMask),c,d):new kh(e,f,c,d)}return b.delete?new kq(lb(a,b.delete),c):b.verify?new kt(lb(a,b.verify),c):eq(1463,{proto:b})}function ls(a,b){return void 0!==b.updateTime?{updateTime:k5(a,b.updateTime)}:void 0!==b.exists?{exists:b.exists}:eq(27497)}function lt(a){return void 0!==a.updateTime?j9.updateTime(k6(a.updateTime)):void 0!==a.exists?j9.exists(a.exists):j9.none()}function lu(a,b){let c=a.updateTime?k6(a.updateTime):k6(b);return c.isEqual(e5.min())&&(c=k6(b)),new j8(c,a.transformResults||[])}function lv(a,b){return a&&a.length>0?(es(void 0!==b,14353),a.map(a=>lu(a,b))):[]}function lw(a,b){let c=b.transform;if(c instanceof jY)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof jZ)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof j_)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof j1)return{fieldPath:b.field.canonicalString(),increment:c.operand};throw eq(20930,{transform:b.transform})}function lx(a,b){let c=null;return"setToServerValue"in b?(es("REQUEST_TIME"===b.setToServerValue,16630,{proto:b}),c=new jY):"appendMissingElements"in b?c=new jZ(b.appendMissingElements.values||[]):"removeAllFromArray"in b?c=new j_(b.removeAllFromArray.values||[]):"increment"in b?c=new j1(a,b.increment):eq(16584,{proto:b}),new j5(eT.fromServerFormat(b.fieldPath),c)}function ly(a,b){return{documents:[lc(a,b.path)]}}function lz(a){let b=a.documents.length;return es(1===b,1966,{count:b}),jh(ja(ld(a.documents[0])))}function lA(a,b){let c,d={structuredQuery:{}},e=b.path;null!==b.collectionGroup?(c=e,d.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(c=e.popLast(),d.structuredQuery.from=[{collectionId:e.lastSegment()}]),d.parent=lc(a,c);let f=lH(b.filters);f&&(d.structuredQuery.where=f);let g=lK(b.orderBy);g&&(d.structuredQuery.orderBy=g);let h=k_(a,b.limit);return null!==h&&(d.structuredQuery.limit=h),b.startAt&&(d.structuredQuery.startAt=lM(b.startAt)),b.endAt&&(d.structuredQuery.endAt=lN(b.endAt)),{queryTarget:d,parent:c}}function lB(a,b,c,d){let{queryTarget:e,parent:f}=lA(a,b),g={},h=[],i=0;return c.forEach(a=>{let b=d?a.alias:`aggregate_${i++}`;g[b]=a.alias,"count"===a.aggregateType?h.push({alias:b,count:{}}):"avg"===a.aggregateType?h.push({alias:b,avg:{field:lW(a.fieldPath)}}):"sum"===a.aggregateType&&h.push({alias:b,sum:{field:lW(a.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:e.structuredQuery},parent:e.parent},aliasMap:g,parent:f}}function lC(a){let b=ld(a.parent),c=a.structuredQuery,d=c.from?c.from.length:0,e=null;if(d>0){es(1===d,65062);let a=c.from[0];a.allDescendants?e=a.collectionId:b=b.child(a.collectionId)}let f=[];c.where&&(f=lI(c.where));let g=[];c.orderBy&&(g=lL(c.orderBy));let h=null;c.limit&&(h=k0(c.limit));let i=null;c.startAt&&(i=lO(c.startAt));let j=null;return c.endAt&&(j=lP(c.endAt)),i9(b,e,g,f,h,"F",i,j)}function lD(a){return jh(lC(a))}function lE(a,b){let c=lF(b.purpose);return null==c?null:{"goog-listen-tags":c}}function lF(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return eq(28987,{purpose:a})}}function lG(a,b){let c,d=b.target;if((c=i$(d)?{documents:ly(a,d)}:{query:lA(a,d).queryTarget}).targetId=b.targetId,b.resumeToken.approximateByteSize()>0){c.resumeToken=k3(a,b.resumeToken);let d=k_(a,b.expectedCount);null!==d&&(c.expectedCount=d)}else if(b.snapshotVersion.compareTo(e5.min())>0){c.readTime=k1(a,b.snapshotVersion.toTimestamp());let d=k_(a,b.expectedCount);null!==d&&(c.expectedCount=d)}return c}function lH(a){if(0!==a.length)return l$(iA.create(a,"and"))}function lI(a){let b=lJ(a);return b instanceof iA&&iD(b)?b.getFilters():[b]}function lJ(a){return void 0!==a.unaryFilter?l1(a):void 0!==a.fieldFilter?l2(a):void 0!==a.compositeFilter?l3(a):eq(30097,{filter:a})}function lK(a){if(0!==a.length)return a.map(a=>lY(a))}function lL(a){return a.map(a=>lZ(a))}function lM(a){return{before:a.inclusive,values:a.position}}function lN(a){return{before:!a.inclusive,values:a.position}}function lO(a){let b=!!a.before;return new ip(a.values||[],b)}function lP(a){let b=!a.before;return new ip(a.values||[],b)}function lQ(a){return kW[a]}function lR(a){switch(a){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function lS(a){return kX[a]}function lT(a){return kY[a]}function lU(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return eq(58110);default:return eq(50506)}}function lV(a){switch(a){case"AND":return"and";case"OR":return"or";default:return eq(1026)}}function lW(a){return{fieldPath:a.canonicalString()}}function lX(a){return eT.fromServerFormat(a.fieldPath)}function lY(a){return{field:lW(a.field),direction:lQ(a.dir)}}function lZ(a){return new iu(lX(a.field),lR(a.direction))}function l$(a){return a instanceof iz?l0(a):a instanceof iA?l_(a):eq(54877,{filter:a})}function l_(a){let b=a.getFilters().map(a=>l$(a));return 1===b.length?b[0]:{compositeFilter:{op:lT(a.op),filters:b}}}function l0(a){if("=="===a.op){if(h9(a.value))return{unaryFilter:{field:lW(a.field),op:"IS_NAN"}};else if(h8(a.value))return{unaryFilter:{field:lW(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(h9(a.value))return{unaryFilter:{field:lW(a.field),op:"IS_NOT_NAN"}};else if(h8(a.value))return{unaryFilter:{field:lW(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lW(a.field),op:lS(a.op),value:a.value}}}function l1(a){switch(a.unaryFilter.op){case"IS_NAN":let b=lX(a.unaryFilter.field);return iz.create(b,"==",{doubleValue:NaN});case"IS_NULL":let c=lX(a.unaryFilter.field);return iz.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let d=lX(a.unaryFilter.field);return iz.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let e=lX(a.unaryFilter.field);return iz.create(e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return eq(61313);default:return eq(60726)}}function l2(a){return iz.create(lX(a.fieldFilter.field),lU(a.fieldFilter.op),a.fieldFilter.value)}function l3(a){return iA.create(a.compositeFilter.filters.map(a=>lJ(a)),lV(a.compositeFilter.op))}function l4(a){let b=[];return a.fields.forEach(a=>b.push(a.canonicalString())),{fieldPaths:b}}function l5(a){return new g7((a.fieldPaths||[]).map(a=>eT.fromServerFormat(a)))}function l6(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}class l7{constructor(a,b,c,d,e=e5.min(),f=e5.min(),g=ha.EMPTY_BYTE_STRING,h=null){this.target=a,this.targetId=b,this.purpose=c,this.sequenceNumber=d,this.snapshotVersion=e,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=g,this.expectedCount=h}withSequenceNumber(a){return new l7(this.target,this.targetId,this.purpose,a,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(a,b){return new l7(this.target,this.targetId,this.purpose,this.sequenceNumber,b,this.lastLimboFreeSnapshotVersion,a,null)}withExpectedCount(a){return new l7(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,a)}withLastLimboFreeSnapshotVersion(a){return new l7(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,a,this.resumeToken,this.expectedCount)}}class l8{constructor(a){this.remoteSerializer=a}}function l9(a,b){let c;if(b.document)c=lj(a.remoteSerializer,b.document,!!b.hasCommittedMutations);else if(b.noDocument){let a=eU.fromSegments(b.noDocument.path),d=me(b.noDocument.readTime);c=im.newNoDocument(a,d),b.hasCommittedMutations&&c.setHasCommittedMutations()}else{if(!b.unknownDocument)return eq(56709);let a=eU.fromSegments(b.unknownDocument.path),d=me(b.unknownDocument.version);c=im.newUnknownDocument(a,d)}return b.readTime&&c.setReadTime(mc(b.readTime)),c}function ma(a,b){let c=b.key,d={prefixPath:c.getCollectionPath().popLast().toArray(),collectionGroup:c.collectionGroup,documentId:c.path.lastSegment(),readTime:mb(b.readTime),hasCommittedMutations:b.hasCommittedMutations};if(b.isFoundDocument())d.document=li(a.remoteSerializer,b);else if(b.isNoDocument())d.noDocument={path:c.path.toArray(),readTime:md(b.version)};else{if(!b.isUnknownDocument())return eq(57904,{document:b});d.unknownDocument={path:c.path.toArray(),version:md(b.version)}}return d}function mb(a){let b=a.toTimestamp();return[b.seconds,b.nanoseconds]}function mc(a){let b=new e4(a[0],a[1]);return e5.fromTimestamp(b)}function md(a){let b=a.toTimestamp();return{seconds:b.seconds,nanoseconds:b.nanoseconds}}function me(a){let b=new e4(a.seconds,a.nanoseconds);return e5.fromTimestamp(b)}function mf(a,b,c){let d=c.baseMutations.map(b=>lq(a.remoteSerializer,b)),e=c.mutations.map(b=>lq(a.remoteSerializer,b));return{userId:b,batchId:c.batchId,localWriteTimeMs:c.localWriteTime.toMillis(),baseMutations:d,mutations:e}}function mg(a,b){let c=(b.baseMutations||[]).map(b=>lr(a.remoteSerializer,b));for(let a=0;a<b.mutations.length-1;++a){let c=b.mutations[a];a+1<b.mutations.length&&void 0!==b.mutations[a+1].transform&&(c.updateTransforms=b.mutations[a+1].transform.fieldTransforms,b.mutations.splice(a+1,1),++a)}let d=b.mutations.map(b=>lr(a.remoteSerializer,b)),e=e4.fromMillis(b.localWriteTimeMs);return new ku(b.batchId,e,c,d)}function mh(a){let b,c=me(a.readTime),d=void 0!==a.lastLimboFreeSnapshotVersion?me(a.lastLimboFreeSnapshotVersion):e5.min();return new l7(b=mj(a.query)?lz(a.query):lD(a.query),a.targetId,"TargetPurposeListen",a.lastListenSequenceNumber,c,d,ha.fromBase64String(a.resumeToken))}function mi(a,b){let c,d=md(b.snapshotVersion),e=md(b.lastLimboFreeSnapshotVersion);c=i$(b.target)?ly(a.remoteSerializer,b.target):lA(a.remoteSerializer,b.target).queryTarget;let f=b.resumeToken.toBase64();return{targetId:b.targetId,canonicalId:iX(b.target),readTime:d,resumeToken:f,lastListenSequenceNumber:b.sequenceNumber,lastLimboFreeSnapshotVersion:e,query:c}}function mj(a){return void 0!==a.documents}function mk(a){return{id:a.bundleId,createTime:me(a.createTime),version:a.version}}function ml(a){return{bundleId:a.id,createTime:md(k6(a.createTime)),version:a.version}}function mm(a){return{name:a.name,query:mo(a.bundledQuery),readTime:me(a.readTime)}}function mn(a){return{name:a.name,readTime:md(k6(a.readTime)),bundledQuery:a.bundledQuery}}function mo(a){let b=lC({parent:a.parent,structuredQuery:a.structuredQuery});return"LAST"===a.limitType?jm(b,b.limit,"L"):b}function mp(a){return{name:a.name,query:mo(a.bundledQuery),readTime:k6(a.readTime)}}function mq(a){return{id:a.id,version:a.version,createTime:k6(a.createTime)}}function mr(a,b){return new kw(b.largestBatchId,lr(a.remoteSerializer,b.overlayMutation))}function ms(a,b,c){let[d,e,f]=mt(b,c.mutation.key);return{userId:b,collectionPath:e,documentId:f,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:lq(a.remoteSerializer,c.mutation)}}function mt(a,b){let c=b.path.lastSegment();return[a,fM(b.path.popLast()),c]}function mu(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}function mv(a,b){let c=b?new fg(b.sequenceNumber,new fj(me(b.readTime),new eU(fP(b.documentKey)),b.largestBatchId)):fg.empty(),d=a.fields.map(([a,b])=>new fe(eT.fromServerFormat(a),b));return new e8(a.indexId,a.collectionGroup,d,c)}function mw(a,b,c,d){return{indexId:a,uid:b,sequenceNumber:c,readTime:md(d.readTime),documentKey:fM(d.documentKey.path),largestBatchId:d.largestBatchId}}class mx{getBundleMetadata(a,b){return my(a).get(b).next(a=>{if(a)return mk(a)})}saveBundleMetadata(a,b){return my(a).put(ml(b))}getNamedQuery(a,b){return mz(a).get(b).next(a=>{if(a)return mm(a)})}saveNamedQuery(a,b){return mz(a).put(mn(b))}}function my(a){return gW(a,go)}function mz(a){return gW(a,gq)}class mA{constructor(a,b){this.serializer=a,this.userId=b}static forUser(a,b){return new mA(a,b.uid||"")}getOverlay(a,b){return mB(a).get(mt(this.userId,b)).next(a=>a?mr(this.serializer,a):null)}getOverlays(a,b){let c=jH();return fo.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){let d=[];return c.forEach((c,e)=>{let f=new kw(b,e);d.push(this.saveOverlay(a,f))}),fo.waitFor(d)}removeOverlaysForBatchId(a,b,c){let d=new Set;b.forEach(a=>d.add(fM(a.getCollectionPath())));let e=[];return d.forEach(b=>{let d=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,c+1],!1,!0);e.push(mB(a).deleteAll(gG,d))}),fo.waitFor(e)}getOverlaysForCollection(a,b,c){let d=jH(),e=fM(b),f=IDBKeyRange.bound([this.userId,e,c],[this.userId,e,1/0],!0);return mB(a).loadAll(gG,f).next(a=>{for(let b of a){let a=mr(this.serializer,b);d.set(a.getKey(),a)}return d})}getOverlaysForCollectionGroup(a,b,c,d){let e,f=jH(),g=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,1/0],!0);return mB(a).iterate({index:gI,range:g},(a,b,c)=>{let g=mr(this.serializer,b);f.size()<d||g.largestBatchId===e?(f.set(g.getKey(),g),e=g.largestBatchId):c.done()}).next(()=>f)}saveOverlay(a,b){return mB(a).put(ms(this.serializer,this.userId,b))}}function mB(a){return gW(a,gE)}class mC{globalsStore(a){return gW(a,gK)}getSessionToken(a){return this.globalsStore(a).get("sessionToken").next(a=>{let b=a?.value;return b?ha.fromUint8Array(b):ha.EMPTY_BYTE_STRING})}setSessionToken(a,b){return this.globalsStore(a).put({name:"sessionToken",value:b.toUint8Array()})}}let mD=5,mE=10,mF=13,mG=15,mH=20,mI=25,mJ=30,mK=37,mL=45,mM=50,mN=53,mO=55,mP=60,mQ=2;class mR{constructor(){}writeIndexValue(a,b){this.writeIndexValueAux(a,b),b.writeInfinity()}writeIndexValueAux(a,b){if("nullValue"in a)this.writeValueTypeLabel(b,mD);else if("booleanValue"in a)this.writeValueTypeLabel(b,mE),b.writeNumber(+!!a.booleanValue);else if("integerValue"in a)this.writeValueTypeLabel(b,mG),b.writeNumber(hf(a.integerValue));else if("doubleValue"in a){let c=hf(a.doubleValue);isNaN(c)?this.writeValueTypeLabel(b,mF):(this.writeValueTypeLabel(b,mG),hv(c)?b.writeNumber(0):b.writeNumber(c))}else if("timestampValue"in a){let c=a.timestampValue;this.writeValueTypeLabel(b,mH),"string"==typeof c&&(c=he(c)),b.writeString(`${c.seconds||""}`),b.writeNumber(c.nanos||0)}else if("stringValue"in a)this.writeIndexString(a.stringValue,b),this.writeTruncationMarker(b);else if("bytesValue"in a)this.writeValueTypeLabel(b,mJ),b.writeBytes(hg(a.bytesValue)),this.writeTruncationMarker(b);else if("referenceValue"in a)this.writeIndexEntityRef(a.referenceValue,b);else if("geoPointValue"in a){let c=a.geoPointValue;this.writeValueTypeLabel(b,mL),b.writeNumber(c.latitude||0),b.writeNumber(c.longitude||0)}else"mapValue"in a?id(a)?this.writeValueTypeLabel(b,Number.MAX_SAFE_INTEGER):ib(a)?this.writeIndexVector(a.mapValue,b):(this.writeIndexMap(a.mapValue,b),this.writeTruncationMarker(b)):"arrayValue"in a?(this.writeIndexArray(a.arrayValue,b),this.writeTruncationMarker(b)):eq(19022,{indexValue:a})}writeIndexString(a,b){this.writeValueTypeLabel(b,mI),this.writeUnlabeledIndexString(a,b)}writeUnlabeledIndexString(a,b){b.writeString(a)}writeIndexMap(a,b){let c=a.fields||{};for(let a of(this.writeValueTypeLabel(b,mO),Object.keys(c)))this.writeIndexString(a,b),this.writeIndexValueAux(c[a],b)}writeIndexVector(a,b){let c=a.fields||{};this.writeValueTypeLabel(b,mN);let d=hB,e=c[d].arrayValue?.values?.length||0;this.writeValueTypeLabel(b,mG),b.writeNumber(hf(e)),this.writeIndexString(d,b),this.writeIndexValueAux(c[d],b)}writeIndexArray(a,b){let c=a.values||[];for(let a of(this.writeValueTypeLabel(b,mM),c))this.writeIndexValueAux(a,b)}writeIndexEntityRef(a,b){this.writeValueTypeLabel(b,mK),eU.fromName(a).path.forEach(a=>{this.writeValueTypeLabel(b,mP),this.writeUnlabeledIndexString(a,b)})}writeValueTypeLabel(a,b){a.writeNumber(b)}writeTruncationMarker(a){a.writeNumber(mQ)}}mR.INSTANCE=new mR;let mS="\uD800",mT="\uDBFF",mU=0,mV=255,mW=1,mX=255,mY=255,mZ=0,m$=64,m_=8,m0=1024;function m1(a){let b=new DataView(new ArrayBuffer(8));return b.setFloat64(0,a,!1),new Uint8Array(b.buffer)}function m2(a){if(0===a)return 8;let b=0;return a>>4==0&&(b+=4,a<<=4),a>>6==0&&(b+=2,a<<=2),a>>7==0&&(b+=1),b}function m3(a){let b=0;for(let c=0;c<8;++c){let d=m2(255&a[c]);if(b+=d,8!==d)break}return b}function m4(a){return Math.ceil((m$-m3(a))/m_)}class m5{constructor(){this.buffer=new Uint8Array(m0),this.position=0}writeBytesAscending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteAscending(c.value),c=b.next();this.writeSeparatorAscending()}writeBytesDescending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteDescending(c.value),c=b.next();this.writeSeparatorDescending()}writeUtf8Ascending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteAscending(a);else if(a<2048)this.writeByteAscending(960|a>>>6),this.writeByteAscending(128|63&a);else if(b<mS||mT<b)this.writeByteAscending(480|a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a);else{let a=b.codePointAt(0);this.writeByteAscending(240|a>>>18),this.writeByteAscending(128|63&a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a)}}this.writeSeparatorAscending()}writeUtf8Descending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteDescending(a);else if(a<2048)this.writeByteDescending(960|a>>>6),this.writeByteDescending(128|63&a);else if(b<mS||mT<b)this.writeByteDescending(480|a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a);else{let a=b.codePointAt(0);this.writeByteDescending(240|a>>>18),this.writeByteDescending(128|63&a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a)}}this.writeSeparatorDescending()}writeNumberAscending(a){let b=this.toOrderedBits(a),c=m4(b);this.ensureAvailable(1+c),this.buffer[this.position++]=255&c;for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=255&b[a]}writeNumberDescending(a){let b=this.toOrderedBits(a),c=m4(b);this.ensureAvailable(1+c),this.buffer[this.position++]=~(255&c);for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=~(255&b[a])}writeInfinityAscending(){this.writeEscapedByteAscending(mX),this.writeEscapedByteAscending(mY)}writeInfinityDescending(){this.writeEscapedByteDescending(mX),this.writeEscapedByteDescending(mY)}reset(){this.position=0}seed(a){this.ensureAvailable(a.length),this.buffer.set(a,this.position),this.position+=a.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(a){let b=m1(a),c=(128&b[0])!=0;b[0]^=c?255:128;for(let a=1;a<b.length;++a)b[a]^=255*!!c;return b}writeByteAscending(a){let b=255&a;b===mU?(this.writeEscapedByteAscending(mU),this.writeEscapedByteAscending(mV)):b===mX?(this.writeEscapedByteAscending(mX),this.writeEscapedByteAscending(mZ)):this.writeEscapedByteAscending(b)}writeByteDescending(a){let b=255&a;b===mU?(this.writeEscapedByteDescending(mU),this.writeEscapedByteDescending(mV)):b===mX?(this.writeEscapedByteDescending(mX),this.writeEscapedByteDescending(mZ)):this.writeEscapedByteDescending(a)}writeSeparatorAscending(){this.writeEscapedByteAscending(mU),this.writeEscapedByteAscending(mW)}writeSeparatorDescending(){this.writeEscapedByteDescending(mU),this.writeEscapedByteDescending(mW)}writeEscapedByteAscending(a){this.ensureAvailable(1),this.buffer[this.position++]=a}writeEscapedByteDescending(a){this.ensureAvailable(1),this.buffer[this.position++]=~a}ensureAvailable(a){let b=a+this.position;if(b<=this.buffer.length)return;let c=2*this.buffer.length;c<b&&(c=b);let d=new Uint8Array(c);d.set(this.buffer),this.buffer=d}}class m6{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesAscending(a)}writeString(a){this.orderedCode.writeUtf8Ascending(a)}writeNumber(a){this.orderedCode.writeNumberAscending(a)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class m7{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesDescending(a)}writeString(a){this.orderedCode.writeUtf8Descending(a)}writeNumber(a){this.orderedCode.writeNumberDescending(a)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class m8{constructor(){this.orderedCode=new m5,this.ascending=new m6(this.orderedCode),this.descending=new m7(this.orderedCode)}seed(a){this.orderedCode.seed(a)}forKind(a){return 0===a?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}class m9{constructor(a,b,c,d){this._indexId=a,this._documentKey=b,this._arrayValue=c,this._directionalValue=d}successor(){let a=this._directionalValue.length,b=0===a||255===this._directionalValue[a-1]?a+1:a,c=new Uint8Array(b);return c.set(this._directionalValue,0),b!==a?c.set([0],this._directionalValue.length):++c[c.length-1],new m9(this._indexId,this._documentKey,this._arrayValue,c)}dbIndexEntry(a,b,c){return{indexId:this._indexId,uid:a,arrayValue:nc(this._arrayValue),directionalValue:nc(this._directionalValue),orderedDocumentKey:nc(b),documentKey:c.path.toArray()}}dbIndexEntryKey(a,b,c){let d=this.dbIndexEntry(a,b,c);return[d.indexId,d.uid,d.arrayValue,d.directionalValue,d.orderedDocumentKey,d.documentKey]}}function na(a,b){let c=a._indexId-b._indexId;return 0!==c||0!==(c=nb(a._arrayValue,b._arrayValue))||0!==(c=nb(a._directionalValue,b._directionalValue))?c:eU.comparator(a._documentKey,b._documentKey)}function nb(a,b){for(let c=0;c<a.length&&c<b.length;++c){let d=a[c]-b[c];if(0!==d)return d}return a.length-b.length}function nc(a){return _()?ne(a):a}function nd(a){return"string"!=typeof a?a:nf(a)}function ne(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}function nf(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}class ng{constructor(a){for(let b of(this.inequalityFilters=new g3((a,b)=>eT.comparator(a.field,b.field)),this.collectionId=null!=a.collectionGroup?a.collectionGroup:a.path.lastSegment(),this.orderBys=a.orderBy,this.equalityFilters=[],a.filters)){let a=b;a.isInequality()?this.inequalityFilters=this.inequalityFilters.add(a):this.equalityFilters.push(a)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(a){if(es(a.collectionGroup===this.collectionId,49279),this.hasMultipleInequality)return!1;let b=e9(a);if(void 0!==b&&!this.hasMatchingEqualityFilter(b))return!1;let c=fa(a),d=new Set,e=0,f=0;for(;e<c.length;++e)if(this.hasMatchingEqualityFilter(c[e]))d=d.add(c[e].fieldPath.canonicalString());else break;if(e===c.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!d.has(a.field.canonicalString())){let b=c[e];if(!this.matchesFilter(a,b)||!this.matchesOrderBy(this.orderBys[f++],b))return!1}++e}for(;e<c.length;++e){let a=c[e];if(f>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[f++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let a=new g3(eT.comparator),b=[];for(let c of this.equalityFilters)if(!c.field.isKeyField())if("array-contains"===c.op||"array-contains-any"===c.op)b.push(new fe(c.field,2));else{if(a.has(c.field))continue;a=a.add(c.field),b.push(new fe(c.field,0))}for(let c of this.orderBys)!c.field.isKeyField()&&(a.has(c.field)||(a=a.add(c.field),b.push(new fe(c.field,+("asc"!==c.dir)))));return new e8(e8.UNKNOWN_ID,this.collectionId,b,fg.empty())}hasMatchingEqualityFilter(a){for(let b of this.equalityFilters)if(this.matchesFilter(b,a))return!0;return!1}matchesFilter(a,b){if(void 0===a||!a.field.isEqual(b.fieldPath))return!1;let c="array-contains"===a.op||"array-contains-any"===a.op;return 2===b.kind===c}matchesOrderBy(a,b){return!!a.field.isEqual(b.fieldPath)&&(0===b.kind&&"asc"===a.dir||1===b.kind&&"desc"===a.dir)}}function nh(a){if(es(a instanceof iz||a instanceof iA,20012),a instanceof iz)if(!(a instanceof iS))return a;else{let b=a.value.arrayValue?.values?.map(b=>iz.create(a.field,"==",b))||[];return iA.create(b,"or")}let b=a.filters.map(a=>nh(a));return iA.create(b,a.op)}function ni(a){if(0===a.getFilters().length)return[];let b=nn(nh(a));return(es(nl(b),7391),nj(b)||nk(b))?[b]:b.getFilters()}function nj(a){return a instanceof iz}function nk(a){return a instanceof iA&&iD(a)}function nl(a){return nj(a)||nk(a)||nm(a)}function nm(a){if(a instanceof iA&&iC(a)){for(let b of a.getFilters())if(!nj(b)&&!nk(b))return!1;return!0}return!1}function nn(a){if(es(a instanceof iz||a instanceof iA,34018),a instanceof iz)return a;if(1===a.filters.length)return nn(a.filters[0]);let b=a.filters.map(a=>nn(a)),c=iA.create(b,a.op);return nl(c=ns(c))?c:(es(c instanceof iA,64498),es(iB(c),40251),es(c.filters.length>1,57927),c.filters.reduce((a,b)=>no(a,b)))}function no(a,b){let c;return es(a instanceof iz||a instanceof iA,38388),es(b instanceof iz||b instanceof iA,25473),ns(c=a instanceof iz?b instanceof iz?np(a,b):nr(a,b):b instanceof iz?nr(b,a):nq(a,b))}function np(a,b){return iA.create([a,b],"and")}function nq(a,b){if(es(a.filters.length>0&&b.filters.length>0,48005),iB(a)&&iB(b))return iJ(a,b.getFilters());let c=iC(a)?a:b,d=iC(a)?b:a,e=c.filters.map(a=>no(a,d));return iA.create(e,"or")}function nr(a,b){if(iB(b))return iJ(b,a.getFilters());{let c=b.filters.map(b=>no(a,b));return iA.create(c,"or")}}function ns(a){if(es(a instanceof iz||a instanceof iA,11850),a instanceof iz)return a;let b=a.getFilters();if(1===b.length)return ns(b[0]);if(iE(a))return a;let c=b.map(a=>ns(a)),d=[];return(c.forEach(b=>{b instanceof iz?d.push(b):b instanceof iA&&(b.op===a.op?d.push(...b.filters):d.push(b))}),1===d.length)?d[0]:iA.create(d,a.op)}class nt{constructor(){this.collectionParentIndex=new nu}addToCollectionParentIndex(a,b){return this.collectionParentIndex.add(b),fo.resolve()}getCollectionParents(a,b){return fo.resolve(this.collectionParentIndex.getEntries(b))}addFieldIndex(a,b){return fo.resolve()}deleteFieldIndex(a,b){return fo.resolve()}deleteAllFieldIndexes(a){return fo.resolve()}createTargetIndexes(a,b){return fo.resolve()}getDocumentsMatchingTarget(a,b){return fo.resolve(null)}getIndexType(a,b){return fo.resolve(0)}getFieldIndexes(a,b){return fo.resolve([])}getNextCollectionGroupToUpdate(a){return fo.resolve(null)}getMinOffset(a,b){return fo.resolve(fj.min())}getMinOffsetFromCollectionGroup(a,b){return fo.resolve(fj.min())}updateCollectionGroup(a,b,c){return fo.resolve()}updateIndexEntries(a,b){return fo.resolve()}}class nu{constructor(){this.index={}}add(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b]||new g3(eR.comparator),e=!d.has(c);return this.index[b]=d.add(c),e}has(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b];return d&&d.has(c)}getEntries(a){return(this.index[a]||new g3(eR.comparator)).toArray()}}let nv="IndexedDbIndexManager",nw=new Uint8Array(0);class nx{constructor(a,b){this.databaseId=b,this.collectionParentsCache=new nu,this.targetToDnfSubTargets=new jA(a=>iX(a),(a,b)=>iZ(a,b)),this.uid=a.uid||""}addToCollectionParentIndex(a,b){if(!this.collectionParentsCache.has(b)){let c=b.lastSegment(),d=b.popLast();a.addOnCommittedListener(()=>{this.collectionParentsCache.add(b)});let e={collectionId:c,parent:fM(d)};return ny(a).put(e)}return fo.resolve()}getCollectionParents(a,b){let c=[],d=IDBKeyRange.bound([b,""],[eO(b),""],!1,!0);return ny(a).loadAll(d).next(a=>{for(let d of a){if(d.collectionId!==b)break;c.push(fP(d.parent))}return c})}addFieldIndex(a,b){let c=nA(a),d=mu(b);delete d.indexId;let e=c.add(d);if(!b.indexState)return e.next();{let c=nB(a);return e.next(a=>{c.put(mw(a,this.uid,b.indexState.sequenceNumber,b.indexState.offset))})}}deleteFieldIndex(a,b){let c=nA(a),d=nB(a),e=nz(a);return c.delete(b.indexId).next(()=>d.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0))).next(()=>e.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0)))}deleteAllFieldIndexes(a){let b=nA(a),c=nz(a),d=nB(a);return b.deleteAll().next(()=>c.deleteAll()).next(()=>d.deleteAll())}createTargetIndexes(a,b){return fo.forEach(this.getSubTargets(b),b=>this.getIndexType(a,b).next(c=>{if(0===c||1===c){let c=new ng(b).buildTargetIndex();if(null!=c)return this.addFieldIndex(a,c)}}))}getDocumentsMatchingTarget(a,b){let c=nz(a),d=!0,e=new Map;return fo.forEach(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>{d&&(d=!!a),e.set(b,a)})).next(()=>{if(!d)return fo.resolve(null);{let a=jN(),d=[];return fo.forEach(e,(e,f)=>{em(nv,`Using index ${fd(e)} to execute ${iX(b)}`);let g=i0(f,e),h=i1(f,e),i=i2(f,e),j=i3(f,e),k=this.encodeBound(e,f,i),l=this.encodeBound(e,f,j),m=this.encodeValues(e,f,h),n=this.generateIndexRanges(e.indexId,g,k,i.inclusive,l,j.inclusive,m);return fo.forEach(n,e=>c.loadFirst(e,b.limit).next(b=>{b.forEach(b=>{let c=eU.fromSegments(b.documentKey);a.has(c)||(a=a.add(c),d.push(c))})}))}).next(()=>d)}})}getSubTargets(a){let b=this.targetToDnfSubTargets.get(a);return b||(b=0===a.filters.length?[a]:ni(iA.create(a.filters,"and")).map(b=>iW(a.path,a.collectionGroup,a.orderBy,b.getFilters(),a.limit,a.startAt,a.endAt)),this.targetToDnfSubTargets.set(a,b)),b}generateIndexRanges(a,b,c,d,e,f,g){let h=(null!=b?b.length:1)*Math.max(c.length,e.length),i=h/(null!=b?b.length:1),j=[];for(let k=0;k<h;++k){let h=b?this.encodeSingleElement(b[k/i]):nw,l=this.generateLowerBound(a,h,c[k%i],d),m=this.generateUpperBound(a,h,e[k%i],f),n=g.map(b=>this.generateLowerBound(a,h,b,!0));j.push(...this.createRange(l,m,n))}return j}generateLowerBound(a,b,c,d){let e=new m9(a,eU.empty(),b,c);return d?e:e.successor()}generateUpperBound(a,b,c,d){let e=new m9(a,eU.empty(),b,c);return d?e.successor():e}getFieldIndex(a,b){let c=new ng(b),d=null!=b.collectionGroup?b.collectionGroup:b.path.lastSegment();return this.getFieldIndexes(a,d).next(a=>{let b=null;for(let d of a)c.servedByIndex(d)&&(!b||d.fields.length>b.fields.length)&&(b=d);return b})}getIndexType(a,b){let c=2,d=this.getSubTargets(b);return fo.forEach(d,b=>this.getFieldIndex(a,b).next(a=>{a?0!==c&&a.fields.length<i6(b)&&(c=1):c=0})).next(()=>i7(b)&&d.length>1&&2===c?1:c)}encodeDirectionalElements(a,b){let c=new m8;for(let d of fa(a)){let a=b.data.field(d.fieldPath);if(null==a)return null;let e=c.forKind(d.kind);mR.INSTANCE.writeIndexValue(a,e)}return c.encodedBytes()}encodeSingleElement(a){let b=new m8;return mR.INSTANCE.writeIndexValue(a,b.forKind(0)),b.encodedBytes()}encodeDirectionalKey(a,b){let c=new m8;return mR.INSTANCE.writeIndexValue(h3(this.databaseId,b),c.forKind(fb(a))),c.encodedBytes()}encodeValues(a,b,c){if(null===c)return[];let d=[];d.push(new m8);let e=0;for(let f of fa(a)){let a=c[e++];for(let c of d)if(this.isInFilter(b,f.fieldPath)&&h7(a))d=this.expandIndexValues(d,f,a);else{let b=c.forKind(f.kind);mR.INSTANCE.writeIndexValue(a,b)}}return this.getEncodedBytes(d)}encodeBound(a,b,c){return this.encodeValues(a,b,c.position)}getEncodedBytes(a){let b=[];for(let c=0;c<a.length;++c)b[c]=a[c].encodedBytes();return b}expandIndexValues(a,b,c){let d=[...a],e=[];for(let a of c.arrayValue.values||[])for(let c of d){let d=new m8;d.seed(c.encodedBytes()),mR.INSTANCE.writeIndexValue(a,d.forKind(b.kind)),e.push(d)}return e}isInFilter(a,b){return!!a.filters.find(a=>a instanceof iz&&a.field.isEqual(b)&&("in"===a.op||"not-in"===a.op))}getFieldIndexes(a,b){let c=nA(a),d=nB(a);return(b?c.loadAll(gu,IDBKeyRange.bound(b,b)):c.loadAll()).next(a=>{let b=[];return fo.forEach(a,a=>d.get([a.indexId,this.uid]).next(c=>{b.push(mv(a,c))})).next(()=>b)})}getNextCollectionGroupToUpdate(a){return this.getFieldIndexes(a).next(a=>0===a.length?null:(a.sort((a,b)=>{let c=a.indexState.sequenceNumber-b.indexState.sequenceNumber;return 0!==c?c:eI(a.collectionGroup,b.collectionGroup)}),a[0].collectionGroup))}updateCollectionGroup(a,b,c){let d=nA(a),e=nB(a);return this.getNextSequenceNumber(a).next(a=>d.loadAll(gu,IDBKeyRange.bound(b,b)).next(b=>fo.forEach(b,b=>e.put(mw(b.indexId,this.uid,a,c)))))}updateIndexEntries(a,b){let c=new Map;return fo.forEach(b,(b,d)=>{let e=c.get(b.collectionGroup);return(e?fo.resolve(e):this.getFieldIndexes(a,b.collectionGroup)).next(e=>(c.set(b.collectionGroup,e),fo.forEach(e,c=>this.getExistingIndexEntries(a,b,c).next(b=>{let e=this.computeIndexEntries(d,c);return b.isEqual(e)?fo.resolve():this.updateEntries(a,d,c,b,e)}))))})}addIndexEntry(a,b,c,d){return nz(a).put(d.dbIndexEntry(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}deleteIndexEntry(a,b,c,d){return nz(a).delete(d.dbIndexEntryKey(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}getExistingIndexEntries(a,b,c){let d=nz(a),e=new g3(na);return d.iterate({index:gC,range:IDBKeyRange.only([c.indexId,this.uid,nc(this.encodeDirectionalKey(c,b))])},(a,d)=>{e=e.add(new m9(c.indexId,b,nd(d.arrayValue),nd(d.directionalValue)))}).next(()=>e)}computeIndexEntries(a,b){let c=new g3(na),d=this.encodeDirectionalElements(b,a);if(null==d)return c;let e=e9(b);if(null!=e){let f=a.data.field(e.fieldPath);if(h7(f))for(let e of f.arrayValue.values||[])c=c.add(new m9(b.indexId,a.key,this.encodeSingleElement(e),d))}else c=c.add(new m9(b.indexId,a.key,nw,d));return c}updateEntries(a,b,c,d,e){em(nv,"Updating index entries for document '%s'",b.key);let f=[];return g5(d,e,na,d=>{f.push(this.addIndexEntry(a,b,c,d))},d=>{f.push(this.deleteIndexEntry(a,b,c,d))}),fo.waitFor(f)}getNextSequenceNumber(a){let b=1;return nB(a).iterate({index:gy,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(a,c,d)=>{d.done(),b=c.sequenceNumber+1}).next(()=>b)}createRange(a,b,c){c=c.sort((a,b)=>na(a,b)).filter((a,b,c)=>!b||0!==na(a,c[b-1]));let d=[];for(let e of(d.push(a),c)){let c=na(e,a),f=na(e,b);if(0===c)d[0]=a.successor();else if(c>0&&f<0)d.push(e),d.push(e.successor());else if(f>0)break}d.push(b);let e=[];for(let a=0;a<d.length;a+=2){if(this.isRangeMatchable(d[a],d[a+1]))return[];let b=d[a].dbIndexEntryKey(this.uid,nw,eU.empty()),c=d[a+1].dbIndexEntryKey(this.uid,nw,eU.empty());e.push(IDBKeyRange.bound(b,c))}return e}isRangeMatchable(a,b){return na(a,b)>0}getMinOffsetFromCollectionGroup(a,b){return this.getFieldIndexes(a,b).next(nC)}getMinOffset(a,b){return fo.mapArray(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>a||eq(44426))).next(nC)}}function ny(a){return gW(a,gk)}function nz(a){return gW(a,gA)}function nA(a){return gW(a,gs)}function nB(a){return gW(a,gw)}function nC(a){es(0!==a.length,28825);let b=a[0].indexState.offset,c=b.largestBatchId;for(let d=1;d<a.length;d++){let e=a[d].indexState.offset;0>fk(e,b)&&(b=e),c<e.largestBatchId&&(c=e.largestBatchId)}return new fj(b.readTime,b.documentKey,c)}function nD(a,b,c){let d=a.store(fV),e=a.store(f1),f=[],g=IDBKeyRange.only(c.batchId),h=0,i=d.iterate({range:g},(a,b,c)=>(h++,c.delete()));f.push(i.next(()=>{es(1===h,47070,{batchId:c.batchId})}));let j=[];for(let a of c.mutations){let d=f_(b,a.key.path,c.batchId);f.push(e.delete(d)),j.push(a.key)}return fo.waitFor(f).next(()=>j)}function nE(a){let b;if(!a)return 0;if(a.document)b=a.document;else if(a.unknownDocument)b=a.unknownDocument;else if(a.noDocument)b=a.noDocument;else throw eq(14731);return JSON.stringify(b).length}class nF{constructor(a,b,c,d){this.userId=a,this.serializer=b,this.indexManager=c,this.referenceDelegate=d,this.documentKeysByBatchId={}}static forUser(a,b,c,d){return es(""!==a.uid,64387),new nF(a.isAuthenticated()?a.uid:"",b,c,d)}checkEmpty(a){let b=!0,c=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return nI(a).iterate({index:fX,range:c},(a,c,d)=>{b=!1,d.done()}).next(()=>b)}addMutationBatch(a,b,c,d){let e=nJ(a),f=nI(a);return f.add({}).next(g=>{es("number"==typeof g,49019);let h=new ku(g,b,c,d),i=mf(this.serializer,this.userId,h),j=[],k=new g3((a,b)=>eI(a.canonicalString(),b.canonicalString()));for(let a of d){let b=f_(this.userId,a.key.path,g);k=k.add(a.key.path.popLast()),j.push(f.put(i)),j.push(e.put(b,f0))}return k.forEach(b=>{j.push(this.indexManager.addToCollectionParentIndex(a,b))}),a.addOnCommittedListener(()=>{this.documentKeysByBatchId[g]=h.keys()}),fo.waitFor(j).next(()=>h)})}lookupMutationBatch(a,b){return nI(a).get(b).next(a=>a?(es(a.userId===this.userId,48,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),mg(this.serializer,a)):null)}lookupMutationKeys(a,b){return this.documentKeysByBatchId[b]?fo.resolve(this.documentKeysByBatchId[b]):this.lookupMutationBatch(a,b).next(a=>{if(!a)return null;{let c=a.keys();return this.documentKeysByBatchId[b]=c,c}})}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=IDBKeyRange.lowerBound([this.userId,c]),e=null;return nI(a).iterate({index:fX,range:d},(a,b,d)=>{b.userId===this.userId&&(es(b.batchId>=c,47524,{nextBatchId:c}),e=mg(this.serializer,b)),d.done()}).next(()=>e)}getHighestUnacknowledgedBatchId(a){let b=IDBKeyRange.upperBound([this.userId,1/0]),c=ht;return nI(a).iterate({index:fX,range:b,reverse:!0},(a,b,d)=>{c=b.batchId,d.done()}).next(()=>c)}getAllMutationBatches(a){let b=IDBKeyRange.bound([this.userId,ht],[this.userId,1/0]);return nI(a).loadAll(fX,b).next(a=>a.map(a=>mg(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(a,b){let c=f$(this.userId,b.path),d=IDBKeyRange.lowerBound(c),e=[];return nJ(a).iterate({range:d},(c,d,f)=>{let[g,h,i]=c,j=fP(h);return g===this.userId&&b.path.isEqual(j)?nI(a).get(i).next(a=>{if(!a)throw eq(61480,{indexKey:c,batchId:i});es(a.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:a.userId,batchId:i}),e.push(mg(this.serializer,a))}):void f.done()}).next(()=>e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new g3(eI),d=[];return b.forEach(b=>{let e=f$(this.userId,b.path),f=IDBKeyRange.lowerBound(e),g=nJ(a).iterate({range:f},(a,d,e)=>{let[f,g,h]=a,i=fP(g);if(f!==this.userId||!b.path.isEqual(i))return void e.done();c=c.add(h)});d.push(g)}),fo.waitFor(d).next(()=>this.lookupMutationBatches(a,c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=f$(this.userId,c),f=IDBKeyRange.lowerBound(e),g=new g3(eI);return nJ(a).iterate({range:f},(a,b,e)=>{let[f,h,i]=a,j=fP(h);if(f!==this.userId||!c.isPrefixOf(j))return void e.done();j.length===d&&(g=g.add(i))}).next(()=>this.lookupMutationBatches(a,g))}lookupMutationBatches(a,b){let c=[],d=[];return b.forEach(b=>{d.push(nI(a).get(b).next(a=>{if(null===a)throw eq(35274,{batchId:b});es(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),c.push(mg(this.serializer,a))}))}),fo.waitFor(d).next(()=>c)}removeMutationBatch(a,b){return nD(a.simpleDbTransaction,this.userId,b).next(c=>(a.addOnCommittedListener(()=>{this.removeCachedMutationKeys(b.batchId)}),fo.forEach(c,b=>this.referenceDelegate.markPotentiallyOrphaned(a,b))))}removeCachedMutationKeys(a){delete this.documentKeysByBatchId[a]}performConsistencyCheck(a){return this.checkEmpty(a).next(b=>{if(!b)return fo.resolve();let c=IDBKeyRange.lowerBound(fZ(this.userId)),d=[];return nJ(a).iterate({range:c},(a,b,c)=>{if(a[0]!==this.userId)return void c.done();{let b=fP(a[1]);d.push(b)}}).next(()=>{es(0===d.length,56720,{danglingKeys:d.map(a=>a.canonicalString())})})})}containsKey(a,b){return nG(a,this.userId,b)}getMutationQueueMetadata(a){return nK(a).get(this.userId).next(a=>a||{userId:this.userId,lastAcknowledgedBatchId:ht,lastStreamToken:""})}}function nG(a,b,c){let d=f$(b,c.path),e=d[1],f=IDBKeyRange.lowerBound(d),g=!1;return nJ(a).iterate({range:f,keysOnly:!0},(a,c,d)=>{let[f,h,i]=a;f===b&&h===e&&(g=!0),d.done()}).next(()=>g)}function nH(a,b){let c=!1;return nK(a).iterateSerial(d=>nG(a,d,b).next(a=>(a&&(c=!0),fo.resolve(!a)))).next(()=>c)}function nI(a){return gW(a,fV)}function nJ(a){return gW(a,f1)}function nK(a){return gW(a,fT)}let nL=2;class nM{constructor(a){this.lastId=a}next(){return this.lastId+=nL,this.lastId}static forTargetCache(){return new nM(2-nL)}static forSyncEngine(){return new nM(1-nL)}}class nN{constructor(a,b){this.referenceDelegate=a,this.serializer=b}allocateTargetId(a){return this.retrieveMetadata(a).next(b=>{let c=new nM(b.highestTargetId);return b.highestTargetId=c.next(),this.saveMetadata(a,b).next(()=>b.highestTargetId)})}getLastRemoteSnapshotVersion(a){return this.retrieveMetadata(a).next(a=>e5.fromTimestamp(new e4(a.lastRemoteSnapshotVersion.seconds,a.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(a){return this.retrieveMetadata(a).next(a=>a.highestListenSequenceNumber)}setTargetsMetadata(a,b,c){return this.retrieveMetadata(a).next(d=>(d.highestListenSequenceNumber=b,c&&(d.lastRemoteSnapshotVersion=c.toTimestamp()),b>d.highestListenSequenceNumber&&(d.highestListenSequenceNumber=b),this.saveMetadata(a,d)))}addTargetData(a,b){return this.saveTargetData(a,b).next(()=>this.retrieveMetadata(a).next(c=>(c.targetCount+=1,this.updateMetadataFromTargetData(b,c),this.saveMetadata(a,c))))}updateTargetData(a,b){return this.saveTargetData(a,b)}removeTargetData(a,b){return this.removeMatchingKeysForTargetId(a,b.targetId).next(()=>nO(a).delete(b.targetId)).next(()=>this.retrieveMetadata(a)).next(b=>(es(b.targetCount>0,8065),b.targetCount-=1,this.saveMetadata(a,b)))}removeTargets(a,b,c){let d=0,e=[];return nO(a).iterate((f,g)=>{let h=mh(g);h.sequenceNumber<=b&&null===c.get(h.targetId)&&(d++,e.push(this.removeTargetData(a,h)))}).next(()=>fo.waitFor(e)).next(()=>d)}forEachTarget(a,b){return nO(a).iterate((a,c)=>{b(mh(c))})}retrieveMetadata(a){return nP(a).get(gi).next(a=>(es(null!==a,2888),a))}saveMetadata(a,b){return nP(a).put(gi,b)}saveTargetData(a,b){return nO(a).put(mi(this.serializer,b))}updateMetadataFromTargetData(a,b){let c=!1;return a.targetId>b.highestTargetId&&(b.highestTargetId=a.targetId,c=!0),a.sequenceNumber>b.highestListenSequenceNumber&&(b.highestListenSequenceNumber=a.sequenceNumber,c=!0),c}getTargetCount(a){return this.retrieveMetadata(a).next(a=>a.targetCount)}getTargetData(a,b){let c=iX(b),d=IDBKeyRange.bound([c,-1/0],[c,1/0]),e=null;return nO(a).iterate({range:d,index:gc},(a,c,d)=>{let f=mh(c);iZ(b,f.target)&&(e=f,d.done())}).next(()=>e)}addMatchingKeys(a,b,c){let d=[],e=nQ(a);return b.forEach(b=>{let f=fM(b.path);d.push(e.put({targetId:c,path:f})),d.push(this.referenceDelegate.addReference(a,c,b))}),fo.waitFor(d)}removeMatchingKeys(a,b,c){let d=nQ(a);return fo.forEach(b,b=>{let e=fM(b.path);return fo.waitFor([d.delete([c,e]),this.referenceDelegate.removeReference(a,c,b)])})}removeMatchingKeysForTargetId(a,b){let c=nQ(a),d=IDBKeyRange.bound([b],[b+1],!1,!0);return c.delete(d)}getMatchingKeysForTargetId(a,b){let c=IDBKeyRange.bound([b],[b+1],!1,!0),d=nQ(a),e=jN();return d.iterate({range:c,keysOnly:!0},(a,b,c)=>{let d=new eU(fP(a[1]));e=e.add(d)}).next(()=>e)}containsKey(a,b){let c=fM(b.path),d=IDBKeyRange.bound([c],[eO(c)],!1,!0),e=0;return nQ(a).iterate({index:gg,keysOnly:!0,range:d},([a,b],c,d)=>{0!==a&&(e++,d.done())}).next(()=>e>0)}getTargetDataForTarget(a,b){return nO(a).get(b).next(a=>a?mh(a):null)}}function nO(a){return gW(a,ga)}function nP(a){return gW(a,gj)}function nQ(a){return gW(a,ge)}let nR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nS=-1,nT=0x2800000;class nU{static withCacheSize(a){return new nU(a,nU.DEFAULT_COLLECTION_PERCENTILE,nU.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(a,b,c){this.cacheSizeCollectionThreshold=a,this.percentileToCollect=b,this.maximumSequenceNumbersToCollect=c}}nU.DEFAULT_COLLECTION_PERCENTILE=10,nU.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nU.DEFAULT=new nU(nT,nU.DEFAULT_COLLECTION_PERCENTILE,nU.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nU.DISABLED=new nU(nS,0,0);let nV="LruGarbageCollector",nW=1048576,nX=6e4,nY=3e5;function nZ([a,b],[c,d]){let e=eI(a,c);return 0===e?eI(b,d):e}class n${constructor(a){this.maxElements=a,this.buffer=new g3(nZ),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(a){let b=[a,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(b);else{let a=this.buffer.last();0>nZ(b,a)&&(this.buffer=this.buffer.delete(a).add(b))}}get maxValue(){return this.buffer.last()[0]}}class n_{constructor(a,b,c){this.garbageCollector=a,this.asyncQueue=b,this.localStore=c,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==nS&&this.scheduleGC(nX)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(a){em(nV,`Garbage collection scheduled in ${a}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",a,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(a){fw(a)?em(nV,"Ignoring IndexedDB error during garbage collection: ",a):await fn(a)}await this.scheduleGC(nY)})}}class n0{constructor(a,b){this.delegate=a,this.params=b}calculateTargetCount(a,b){return this.delegate.getSequenceNumberCount(a).next(a=>Math.floor(b/100*a))}nthSequenceNumber(a,b){if(0===b)return fo.resolve(fH.INVALID);let c=new n$(b);return this.delegate.forEachTarget(a,a=>c.addElement(a.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(a,a=>c.addElement(a))).next(()=>c.maxValue)}removeTargets(a,b,c){return this.delegate.removeTargets(a,b,c)}removeOrphanedDocuments(a,b){return this.delegate.removeOrphanedDocuments(a,b)}collect(a,b){return this.params.cacheSizeCollectionThreshold===nS?(em("LruGarbageCollector","Garbage collection skipped; disabled"),fo.resolve(nR)):this.getCacheSize(a).next(c=>c<this.params.cacheSizeCollectionThreshold?(em("LruGarbageCollector",`Garbage collection skipped; Cache size ${c} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nR):this.runGarbageCollection(a,b))}getCacheSize(a){return this.delegate.getCacheSize(a)}runGarbageCollection(a,b){let c,d,e,f,g,h,i,k=Date.now();return this.calculateTargetCount(a,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(em("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),d=this.params.maximumSequenceNumbersToCollect):d=b,f=Date.now(),this.nthSequenceNumber(a,d))).next(d=>(c=d,g=Date.now(),this.removeTargets(a,c,b))).next(b=>(e=b,h=Date.now(),this.removeOrphanedDocuments(a,c))).next(a=>(i=Date.now(),el()<=j.DEBUG&&em("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${f-k}ms
	Determined least recently used ${d} in ${g-f}ms
	Removed ${e} targets in ${h-g}ms
	Removed ${a} documents in ${i-h}ms
Total Duration: ${i-k}ms`),fo.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:e,documentsRemoved:a})))}}function n1(a,b){return new n0(a,b)}class n2{constructor(a,b){this.db=a,this.garbageCollector=n1(this,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.db.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachTarget(a,b){return this.db.getTargetCache().forEachTarget(a,b)}forEachOrphanedDocumentSequenceNumber(a,b){return this.forEachOrphanedDocument(a,(a,c)=>b(c))}addReference(a,b,c){return n5(a,c)}removeReference(a,b,c){return n5(a,c)}removeTargets(a,b,c){return this.db.getTargetCache().removeTargets(a,b,c)}markPotentiallyOrphaned(a,b){return n5(a,b)}isPinned(a,b){return nH(a,b)}removeOrphanedDocuments(a,b){let c=this.db.getRemoteDocumentCache().newChangeBuffer(),d=[],e=0;return this.forEachOrphanedDocument(a,(f,g)=>{if(g<=b){let b=this.isPinned(a,f).next(b=>{if(!b)return e++,c.getEntry(a,f).next(()=>(c.removeEntry(f,e5.min()),nQ(a).delete(n3(f))))});d.push(b)}}).next(()=>fo.waitFor(d)).next(()=>c.apply(a)).next(()=>e)}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(a,c)}updateLimboDocument(a,b){return n5(a,b)}forEachOrphanedDocument(a,b){let c,d=nQ(a),e=fH.INVALID;return d.iterate({index:gg},([a,d],{path:f,sequenceNumber:g})=>{0===a?(e!==fH.INVALID&&b(new eU(fP(c)),e),e=g,c=f):e=fH.INVALID}).next(()=>{e!==fH.INVALID&&b(new eU(fP(c)),e)})}getCacheSize(a){return this.db.getRemoteDocumentCache().getSize(a)}}function n3(a){return[0,fM(a.path)]}function n4(a,b){return{targetId:0,path:fM(a.path),sequenceNumber:b}}function n5(a,b){return nQ(a).put(n4(b,a.currentSequenceNumber))}class n6{constructor(){this.changes=new jA(a=>a.toString(),(a,b)=>a.isEqual(b)),this.changesApplied=!1}addEntry(a){this.assertNotApplied(),this.changes.set(a.key,a)}removeEntry(a,b){this.assertNotApplied(),this.changes.set(a,im.newInvalidDocument(a).setReadTime(b))}getEntry(a,b){this.assertNotApplied();let c=this.changes.get(b);return void 0!==c?fo.resolve(c):this.getFromCache(a,b)}getEntries(a,b){return this.getAllFromCache(a,b)}apply(a){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(a)}assertNotApplied(){}}class n7{constructor(a){this.serializer=a}setIndexManager(a){this.indexManager=a}addEntry(a,b,c){return ob(a).put(c)}removeEntry(a,b,c){return ob(a).delete(od(b,c))}updateMetadata(a,b){return this.getMetadata(a).next(c=>(c.byteSize+=b,this.setMetadata(a,c)))}getEntry(a,b){let c=im.newInvalidDocument(b);return ob(a).iterate({index:f4,range:IDBKeyRange.only(oc(b))},(a,d)=>{c=this.maybeDecodeDocument(b,d)}).next(()=>c)}getSizedEntry(a,b){let c={size:0,document:im.newInvalidDocument(b)};return ob(a).iterate({index:f4,range:IDBKeyRange.only(oc(b))},(a,d)=>{c={document:this.maybeDecodeDocument(b,d),size:nE(d)}}).next(()=>c)}getEntries(a,b){let c=jC();return this.forEachDbEntry(a,b,(a,b)=>{let d=this.maybeDecodeDocument(a,b);c=c.insert(a,d)}).next(()=>c)}getSizedEntries(a,b){let c=jC(),d=new g_(eU.comparator);return this.forEachDbEntry(a,b,(a,b)=>{let e=this.maybeDecodeDocument(a,b);c=c.insert(a,e),d=d.insert(a,nE(b))}).next(()=>({documents:c,sizeMap:d}))}forEachDbEntry(a,b,c){if(b.isEmpty())return fo.resolve();let d=new g3(of);b.forEach(a=>d=d.add(a));let e=IDBKeyRange.bound(oc(d.first()),oc(d.last())),f=d.getIterator(),g=f.getNext();return ob(a).iterate({index:f4,range:e},(a,b,d)=>{let e=eU.fromSegments([...b.prefixPath,b.collectionGroup,b.documentId]);for(;g&&0>of(g,e);)c(g,null),g=f.getNext();g&&g.isEqual(e)&&(c(g,b),g=f.hasNext()?f.getNext():null),g?d.skip(oc(g)):d.done()}).next(()=>{for(;g;)c(g,null),g=f.hasNext()?f.getNext():null})}getDocumentsMatchingQuery(a,b,c,d,e){let f=b.path,g=[f.popLast().toArray(),f.lastSegment(),mb(c.readTime),c.documentKey.path.isEmpty()?"":c.documentKey.path.lastSegment()],h=[f.popLast().toArray(),f.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ob(a).loadAll(IDBKeyRange.bound(g,h,!0)).next(a=>{e?.incrementDocumentReadCount(a.length);let c=jC();for(let e of a){let a=this.maybeDecodeDocument(eU.fromSegments(e.prefixPath.concat(e.collectionGroup,e.documentId)),e);a.isFoundDocument()&&(js(b,a)||d.has(a.key))&&(c=c.insert(a.key,a))}return c})}getAllFromCollectionGroup(a,b,c,d){let e=jC(),f=oe(b,c),g=oe(b,fj.max());return ob(a).iterate({index:f6,range:IDBKeyRange.bound(f,g,!0)},(a,b,c)=>{let f=this.maybeDecodeDocument(eU.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);(e=e.insert(f.key,f)).size===d&&c.done()}).next(()=>e)}newChangeBuffer(a){return new n9(this,!!a&&a.trackRemovals)}getSize(a){return this.getMetadata(a).next(a=>a.byteSize)}getMetadata(a){return oa(a).get(f9).next(a=>(es(!!a,20021),a))}setMetadata(a,b){return oa(a).put(f9,b)}maybeDecodeDocument(a,b){if(b){let a=l9(this.serializer,b);if(!(a.isNoDocument()&&a.version.isEqual(e5.min())))return a}return im.newInvalidDocument(a)}}function n8(a){return new n7(a)}class n9 extends n6{constructor(a,b){super(),this.documentCache=a,this.trackRemovals=b,this.documentStates=new jA(a=>a.toString(),(a,b)=>a.isEqual(b))}applyChanges(a){let b=[],c=0,d=new g3((a,b)=>eI(a.canonicalString(),b.canonicalString()));return this.changes.forEach((e,f)=>{let g=this.documentStates.get(e);if(b.push(this.documentCache.removeEntry(a,e,g.readTime)),f.isValidDocument()){let h=ma(this.documentCache.serializer,f);d=d.add(e.path.popLast());let i=nE(h);c+=i-g.size,b.push(this.documentCache.addEntry(a,e,h))}else if(c-=g.size,this.trackRemovals){let c=ma(this.documentCache.serializer,f.convertToNoDocument(e5.min()));b.push(this.documentCache.addEntry(a,e,c))}}),d.forEach(c=>{b.push(this.documentCache.indexManager.addToCollectionParentIndex(a,c))}),b.push(this.documentCache.updateMetadata(a,c)),fo.waitFor(b)}getFromCache(a,b){return this.documentCache.getSizedEntry(a,b).next(a=>(this.documentStates.set(b,{size:a.size,readTime:a.document.readTime}),a.document))}getAllFromCache(a,b){return this.documentCache.getSizedEntries(a,b).next(({documents:a,sizeMap:b})=>(b.forEach((b,c)=>{this.documentStates.set(b,{size:c,readTime:a.get(b).readTime})}),a))}}function oa(a){return gW(a,f8)}function ob(a){return gW(a,f2)}function oc(a){let b=a.path.toArray();return[b.slice(0,b.length-2),b[b.length-2],b[b.length-1]]}function od(a,b){let c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],mb(b),c[c.length-1]]}function oe(a,b){let c=b.documentKey.path.toArray();return[a,mb(b.readTime),c.slice(0,c.length-2),c.length>0?c[c.length-1]:""]}function of(a,b){let c=a.path.toArray(),d=b.path.toArray(),e=0;for(let a=0;a<c.length-2&&a<d.length-2;++a)if(e=eI(c[a],d[a]))return e;return(e=eI(c.length,d.length))||(e=eI(c[c.length-2],d[d.length-2]))?e:eI(c[c.length-1],d[d.length-1])}let og=18;class oh{constructor(a,b){this.overlayedDocument=a,this.mutatedFields=b}}class oi{constructor(a,b,c,d){this.remoteDocumentCache=a,this.mutationQueue=b,this.documentOverlayCache=c,this.indexManager=d}getDocument(a,b){let c=null;return this.documentOverlayCache.getOverlay(a,b).next(d=>(c=d,this.remoteDocumentCache.getEntry(a,b))).next(a=>(null!==c&&ke(c.mutation,a,g7.empty(),e4.now()),a))}getDocuments(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.getLocalViewOfDocuments(a,b,jN()).next(()=>b))}getLocalViewOfDocuments(a,b,c=jN()){let d=jH();return this.populateOverlays(a,d,b).next(()=>this.computeViews(a,b,d,c).next(a=>{let b=jE();return a.forEach((a,c)=>{b=b.insert(a,c.overlayedDocument)}),b}))}getOverlayedDocuments(a,b){let c=jH();return this.populateOverlays(a,c,b).next(()=>this.computeViews(a,b,c,jN()))}populateOverlays(a,b,c){let d=[];return c.forEach(a=>{b.has(a)||d.push(a)}),this.documentOverlayCache.getOverlays(a,d).next(a=>{a.forEach((a,c)=>{b.set(a,c)})})}computeViews(a,b,c,d){let e=jC(),f=jJ(),g=jF();return b.forEach((a,b)=>{let g=c.get(b.key);d.has(b.key)&&(void 0===g||g.mutation instanceof kk)?e=e.insert(b.key,b):void 0!==g?(f.set(b.key,g.mutation.getFieldMask()),ke(g.mutation,b,g.mutation.getFieldMask(),e4.now())):f.set(b.key,g7.empty())}),this.recalculateAndSaveOverlays(a,e).next(a=>(a.forEach((a,b)=>f.set(a,b)),b.forEach((a,b)=>g.set(a,new oh(b,f.get(a)??null))),g))}recalculateAndSaveOverlays(a,b){let c=jJ(),d=new g_((a,b)=>a-b),e=jN();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(a,b).next(a=>{for(let e of a)e.keys().forEach(a=>{let f=b.get(a);if(null===f)return;let g=c.get(a)||g7.empty();g=e.applyToLocalView(f,g),c.set(a,g);let h=(d.get(e.batchId)||jN()).add(a);d=d.insert(e.batchId,h)})}).next(()=>{let f=[],g=d.getReverseIterator();for(;g.hasNext();){let d=g.getNext(),h=d.key,i=d.value,j=jI();i.forEach(a=>{if(!e.has(a)){let d=kc(b.get(a),c.get(a));null!==d&&j.set(a,d),e=e.add(a)}}),f.push(this.documentOverlayCache.saveOverlays(a,h,j))}return fo.waitFor(f)}).next(()=>c)}recalculateAndSaveOverlaysForDocumentKeys(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.recalculateAndSaveOverlays(a,b))}getDocumentsMatchingQuery(a,b,c,d){return je(b)?this.getDocumentsMatchingDocumentQuery(a,b.path):jf(b)?this.getDocumentsMatchingCollectionGroupQuery(a,b,c,d):this.getDocumentsMatchingCollectionQuery(a,b,c,d)}getNextDocuments(a,b,c,d){return this.remoteDocumentCache.getAllFromCollectionGroup(a,b,c,d).next(e=>{let f=d-e.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(a,b,c.largestBatchId,d-e.size):fo.resolve(jH()),g=e6,h=e;return f.next(b=>fo.forEach(b,(b,c)=>(g<c.largestBatchId&&(g=c.largestBatchId),e.get(b))?fo.resolve():this.remoteDocumentCache.getEntry(a,b).next(a=>{h=h.insert(b,a)})).next(()=>this.populateOverlays(a,b,e)).next(()=>this.computeViews(a,h,b,jN())).next(a=>({batchId:g,changes:jG(a)})))})}getDocumentsMatchingDocumentQuery(a,b){return this.getDocument(a,new eU(b)).next(a=>{let b=jE();return a.isFoundDocument()&&(b=b.insert(a.key,a)),b})}getDocumentsMatchingCollectionGroupQuery(a,b,c,d){let e=b.collectionGroup,f=jE();return this.indexManager.getCollectionParents(a,e).next(g=>fo.forEach(g,g=>{let h=jb(b,g.child(e));return this.getDocumentsMatchingCollectionQuery(a,h,c,d).next(a=>{a.forEach((a,b)=>{f=f.insert(a,b)})})}).next(()=>f))}getDocumentsMatchingCollectionQuery(a,b,c,d){let e;return this.documentOverlayCache.getOverlaysForCollection(a,b.path,c.largestBatchId).next(f=>(e=f,this.remoteDocumentCache.getDocumentsMatchingQuery(a,b,c,e,d))).next(a=>{e.forEach((b,c)=>{let d=c.getKey();null===a.get(d)&&(a=a.insert(d,im.newInvalidDocument(d)))});let c=jE();return a.forEach((a,d)=>{let f=e.get(a);void 0!==f&&ke(f.mutation,d,g7.empty(),e4.now()),js(b,d)&&(c=c.insert(a,d))}),c})}}class oj{constructor(a){this.serializer=a,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(a,b){return fo.resolve(this.bundles.get(b))}saveBundleMetadata(a,b){return this.bundles.set(b.id,mq(b)),fo.resolve()}getNamedQuery(a,b){return fo.resolve(this.namedQueries.get(b))}saveNamedQuery(a,b){return this.namedQueries.set(b.name,mp(b)),fo.resolve()}}class ok{constructor(){this.overlays=new g_(eU.comparator),this.overlayByBatchId=new Map}getOverlay(a,b){return fo.resolve(this.overlays.get(b))}getOverlays(a,b){let c=jH();return fo.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){return c.forEach((c,d)=>{this.saveOverlay(a,b,d)}),fo.resolve()}removeOverlaysForBatchId(a,b,c){let d=this.overlayByBatchId.get(c);return void 0!==d&&(d.forEach(a=>this.overlays=this.overlays.remove(a)),this.overlayByBatchId.delete(c)),fo.resolve()}getOverlaysForCollection(a,b,c){let d=jH(),e=b.length+1,f=new eU(b.child("")),g=this.overlays.getIteratorFrom(f);for(;g.hasNext();){let a=g.getNext().value,f=a.getKey();if(!b.isPrefixOf(f.path))break;f.path.length===e&&a.largestBatchId>c&&d.set(a.getKey(),a)}return fo.resolve(d)}getOverlaysForCollectionGroup(a,b,c,d){let e=new g_((a,b)=>a-b),f=this.overlays.getIterator();for(;f.hasNext();){let a=f.getNext().value;if(a.getKey().getCollectionGroup()===b&&a.largestBatchId>c){let b=e.get(a.largestBatchId);null===b&&(b=jH(),e=e.insert(a.largestBatchId,b)),b.set(a.getKey(),a)}}let g=jH(),h=e.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((a,b)=>g.set(a,b)),!(g.size()>=d)););return fo.resolve(g)}saveOverlay(a,b,c){let d=this.overlays.get(c.key);if(null!==d){let a=this.overlayByBatchId.get(d.largestBatchId).delete(c.key);this.overlayByBatchId.set(d.largestBatchId,a)}this.overlays=this.overlays.insert(c.key,new kw(b,c));let e=this.overlayByBatchId.get(b);void 0===e&&(e=jN(),this.overlayByBatchId.set(b,e)),this.overlayByBatchId.set(b,e.add(c.key))}}class ol{constructor(){this.sessionToken=ha.EMPTY_BYTE_STRING}getSessionToken(a){return fo.resolve(this.sessionToken)}setSessionToken(a,b){return this.sessionToken=b,fo.resolve()}}class om{constructor(){this.refsByKey=new g3(on.compareByKey),this.refsByTarget=new g3(on.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(a,b){let c=new on(a,b);this.refsByKey=this.refsByKey.add(c),this.refsByTarget=this.refsByTarget.add(c)}addReferences(a,b){a.forEach(a=>this.addReference(a,b))}removeReference(a,b){this.removeRef(new on(a,b))}removeReferences(a,b){a.forEach(a=>this.removeReference(a,b))}removeReferencesForId(a){let b=new eU(new eR([])),c=new on(b,a),d=new on(b,a+1),e=[];return this.refsByTarget.forEachInRange([c,d],a=>{this.removeRef(a),e.push(a.key)}),e}removeAllReferences(){this.refsByKey.forEach(a=>this.removeRef(a))}removeRef(a){this.refsByKey=this.refsByKey.delete(a),this.refsByTarget=this.refsByTarget.delete(a)}referencesForId(a){let b=new eU(new eR([])),c=new on(b,a),d=new on(b,a+1),e=jN();return this.refsByTarget.forEachInRange([c,d],a=>{e=e.add(a.key)}),e}containsKey(a){let b=new on(a,0),c=this.refsByKey.firstAfterOrEqual(b);return null!==c&&a.isEqual(c.key)}}class on{constructor(a,b){this.key=a,this.targetOrBatchId=b}static compareByKey(a,b){return eU.comparator(a.key,b.key)||eI(a.targetOrBatchId,b.targetOrBatchId)}static compareByTargetId(a,b){return eI(a.targetOrBatchId,b.targetOrBatchId)||eU.comparator(a.key,b.key)}}class oo{constructor(a,b){this.indexManager=a,this.referenceDelegate=b,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new g3(on.compareByKey)}checkEmpty(a){return fo.resolve(0===this.mutationQueue.length)}addMutationBatch(a,b,c,d){let e=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let f=new ku(e,b,c,d);for(let b of(this.mutationQueue.push(f),d))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new on(b.key,e)),this.indexManager.addToCollectionParentIndex(a,b.key.path.popLast());return fo.resolve(f)}lookupMutationBatch(a,b){return fo.resolve(this.findMutationBatch(b))}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=this.indexOfBatchId(c),e=d<0?0:d;return fo.resolve(this.mutationQueue.length>e?this.mutationQueue[e]:null)}getHighestUnacknowledgedBatchId(){return fo.resolve(0===this.mutationQueue.length?ht:this.nextBatchId-1)}getAllMutationBatches(a){return fo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(a,b){let c=new on(b,0),d=new on(b,1/0),e=[];return this.batchesByDocumentKey.forEachInRange([c,d],a=>{let b=this.findMutationBatch(a.targetOrBatchId);e.push(b)}),fo.resolve(e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new g3(eI);return b.forEach(a=>{let b=new on(a,0),d=new on(a,1/0);this.batchesByDocumentKey.forEachInRange([b,d],a=>{c=c.add(a.targetOrBatchId)})}),fo.resolve(this.findMutationBatches(c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=c;eU.isDocumentKey(e)||(e=e.child(""));let f=new on(new eU(e),0),g=new g3(eI);return this.batchesByDocumentKey.forEachWhile(a=>{let b=a.key.path;return!!c.isPrefixOf(b)&&(b.length===d&&(g=g.add(a.targetOrBatchId)),!0)},f),fo.resolve(this.findMutationBatches(g))}findMutationBatches(a){let b=[];return a.forEach(a=>{let c=this.findMutationBatch(a);null!==c&&b.push(c)}),b}removeMutationBatch(a,b){es(0===this.indexOfExistingBatchId(b.batchId,"removed"),55003),this.mutationQueue.shift();let c=this.batchesByDocumentKey;return fo.forEach(b.mutations,d=>{let e=new on(d.key,b.batchId);return c=c.delete(e),this.referenceDelegate.markPotentiallyOrphaned(a,d.key)}).next(()=>{this.batchesByDocumentKey=c})}removeCachedMutationKeys(a){}containsKey(a,b){let c=new on(b,0),d=this.batchesByDocumentKey.firstAfterOrEqual(c);return fo.resolve(b.isEqual(d&&d.key))}performConsistencyCheck(a){return this.mutationQueue.length,fo.resolve()}indexOfExistingBatchId(a,b){return this.indexOfBatchId(a)}indexOfBatchId(a){return 0===this.mutationQueue.length?0:a-this.mutationQueue[0].batchId}findMutationBatch(a){let b=this.indexOfBatchId(a);return b<0||b>=this.mutationQueue.length?null:this.mutationQueue[b]}}let op="-9223372036854775808";function oq(){return new g_(eU.comparator)}class or{constructor(a){this.sizer=a,this.docs=oq(),this.size=0}setIndexManager(a){this.indexManager=a}addEntry(a,b){let c=b.key,d=this.docs.get(c),e=d?d.size:0,f=this.sizer(b);return this.docs=this.docs.insert(c,{document:b.mutableCopy(),size:f}),this.size+=f-e,this.indexManager.addToCollectionParentIndex(a,c.path.popLast())}removeEntry(a){let b=this.docs.get(a);b&&(this.docs=this.docs.remove(a),this.size-=b.size)}getEntry(a,b){let c=this.docs.get(b);return fo.resolve(c?c.document.mutableCopy():im.newInvalidDocument(b))}getEntries(a,b){let c=jC();return b.forEach(a=>{let b=this.docs.get(a);c=c.insert(a,b?b.document.mutableCopy():im.newInvalidDocument(a))}),fo.resolve(c)}getDocumentsMatchingQuery(a,b,c,d){let e=jC(),f=b.path,g=new eU(f.child("__id"+op+"__")),h=this.docs.getIteratorFrom(g);for(;h.hasNext();){let{key:a,value:{document:g}}=h.getNext();if(!f.isPrefixOf(a.path))break;!(a.path.length>f.length+1||0>=fk(fi(g),c))&&(d.has(g.key)||js(b,g))&&(e=e.insert(g.key,g.mutableCopy()))}return fo.resolve(e)}getAllFromCollectionGroup(a,b,c,d){eq(9500)}forEachDocumentKey(a,b){return fo.forEach(this.docs,a=>b(a))}newChangeBuffer(a){return new ot(this)}getSize(a){return fo.resolve(this.size)}}function os(a){return new or(a)}class ot extends n6{constructor(a){super(),this.documentCache=a}applyChanges(a){let b=[];return this.changes.forEach((c,d)=>{d.isValidDocument()?b.push(this.documentCache.addEntry(a,d)):this.documentCache.removeEntry(c)}),fo.waitFor(b)}getFromCache(a,b){return this.documentCache.getEntry(a,b)}getAllFromCache(a,b){return this.documentCache.getEntries(a,b)}}class ou{constructor(a){this.persistence=a,this.targets=new jA(a=>iX(a),iZ),this.lastRemoteSnapshotVersion=e5.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new om,this.targetCount=0,this.targetIdGenerator=nM.forTargetCache()}forEachTarget(a,b){return this.targets.forEach((a,c)=>b(c)),fo.resolve()}getLastRemoteSnapshotVersion(a){return fo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(a){return fo.resolve(this.highestSequenceNumber)}allocateTargetId(a){return this.highestTargetId=this.targetIdGenerator.next(),fo.resolve(this.highestTargetId)}setTargetsMetadata(a,b,c){return c&&(this.lastRemoteSnapshotVersion=c),b>this.highestSequenceNumber&&(this.highestSequenceNumber=b),fo.resolve()}saveTargetData(a){this.targets.set(a.target,a);let b=a.targetId;b>this.highestTargetId&&(this.targetIdGenerator=new nM(b),this.highestTargetId=b),a.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=a.sequenceNumber)}addTargetData(a,b){return this.saveTargetData(b),this.targetCount+=1,fo.resolve()}updateTargetData(a,b){return this.saveTargetData(b),fo.resolve()}removeTargetData(a,b){return this.targets.delete(b.target),this.references.removeReferencesForId(b.targetId),this.targetCount-=1,fo.resolve()}removeTargets(a,b,c){let d=0,e=[];return this.targets.forEach((f,g)=>{g.sequenceNumber<=b&&null===c.get(g.targetId)&&(this.targets.delete(f),e.push(this.removeMatchingKeysForTargetId(a,g.targetId)),d++)}),fo.waitFor(e).next(()=>d)}getTargetCount(a){return fo.resolve(this.targetCount)}getTargetData(a,b){let c=this.targets.get(b)||null;return fo.resolve(c)}addMatchingKeys(a,b,c){return this.references.addReferences(b,c),fo.resolve()}removeMatchingKeys(a,b,c){this.references.removeReferences(b,c);let d=this.persistence.referenceDelegate,e=[];return d&&b.forEach(b=>{e.push(d.markPotentiallyOrphaned(a,b))}),fo.waitFor(e)}removeMatchingKeysForTargetId(a,b){return this.references.removeReferencesForId(b),fo.resolve()}getMatchingKeysForTargetId(a,b){let c=this.references.referencesForId(b);return fo.resolve(c)}containsKey(a,b){return fo.resolve(this.references.containsKey(b))}}let ov="MemoryPersistence";class ow{constructor(a,b){this.mutationQueues={},this.overlays={},this.listenSequence=new fH(0),this._started=!1,this._started=!0,this.globalsCache=new ol,this.referenceDelegate=a(this),this.targetCache=new ou(this);let c=a=>this.referenceDelegate.documentSize(a);this.indexManager=new nt,this.remoteDocumentCache=os(c),this.serializer=new l8(b),this.bundleCache=new oj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(a){return this.indexManager}getDocumentOverlayCache(a){let b=this.overlays[a.toKey()];return b||(b=new ok,this.overlays[a.toKey()]=b),b}getMutationQueue(a,b){let c=this.mutationQueues[a.toKey()];return c||(c=new oo(b,this.referenceDelegate),this.mutationQueues[a.toKey()]=c),c}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){em(ov,"Starting transaction:",a);let d=new ox(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),c(d).next(a=>this.referenceDelegate.onTransactionCommitted(d).next(()=>a)).toPromise().then(a=>(d.raiseOnCommittedEvent(),a))}mutationQueuesContainKey(a,b){return fo.or(Object.values(this.mutationQueues).map(c=>()=>c.containsKey(a,b)))}}class ox extends fm{constructor(a){super(),this.currentSequenceNumber=a}}class oy{constructor(a){this.persistence=a,this.localViewReferences=new om,this._orphanedDocuments=null}static factory(a){return new oy(a)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw eq(60996)}addReference(a,b,c){return this.localViewReferences.addReference(c,b),this.orphanedDocuments.delete(c.toString()),fo.resolve()}removeReference(a,b,c){return this.localViewReferences.removeReference(c,b),this.orphanedDocuments.add(c.toString()),fo.resolve()}markPotentiallyOrphaned(a,b){return this.orphanedDocuments.add(b.toString()),fo.resolve()}removeTarget(a,b){this.localViewReferences.removeReferencesForId(b.targetId).forEach(a=>this.orphanedDocuments.add(a.toString()));let c=this.persistence.getTargetCache();return c.getMatchingKeysForTargetId(a,b.targetId).next(a=>{a.forEach(a=>this.orphanedDocuments.add(a.toString()))}).next(()=>c.removeTargetData(a,b))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(a){let b=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fo.forEach(this.orphanedDocuments,c=>{let d=eU.fromPath(c);return this.isReferenced(a,d).next(a=>{a||b.removeEntry(d,e5.min())})}).next(()=>(this._orphanedDocuments=null,b.apply(a)))}updateLimboDocument(a,b){return this.isReferenced(a,b).next(a=>{a?this.orphanedDocuments.delete(b.toString()):this.orphanedDocuments.add(b.toString())})}documentSize(a){return 0}isReferenced(a,b){return fo.or([()=>fo.resolve(this.localViewReferences.containsKey(b)),()=>this.persistence.getTargetCache().containsKey(a,b),()=>this.persistence.mutationQueuesContainKey(a,b)])}}class oz{constructor(a,b){this.persistence=a,this.orphanedSequenceNumbers=new jA(a=>fM(a.path),(a,b)=>a.isEqual(b)),this.garbageCollector=n1(this,b)}static factory(a,b){return new oz(a,b)}onTransactionStarted(){}onTransactionCommitted(a){return fo.resolve()}forEachTarget(a,b){return this.persistence.getTargetCache().forEachTarget(a,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.persistence.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachOrphanedDocumentSequenceNumber(a,b){return fo.forEach(this.orphanedSequenceNumbers,(c,d)=>this.isPinned(a,c,d).next(a=>a?fo.resolve():b(d)))}removeTargets(a,b,c){return this.persistence.getTargetCache().removeTargets(a,b,c)}removeOrphanedDocuments(a,b){let c=0,d=this.persistence.getRemoteDocumentCache(),e=d.newChangeBuffer();return d.forEachDocumentKey(a,d=>this.isPinned(a,d,b).next(a=>{a||(c++,e.removeEntry(d,e5.min()))})).next(()=>e.apply(a)).next(()=>c)}markPotentiallyOrphaned(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),fo.resolve()}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(a,c)}addReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),fo.resolve()}removeReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),fo.resolve()}updateLimboDocument(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),fo.resolve()}documentSize(a){let b=a.key.toString().length;return a.isFoundDocument()&&(b+=h0(a.data.value)),b}isPinned(a,b,c){return fo.or([()=>this.persistence.mutationQueuesContainKey(a,b),()=>this.persistence.getTargetCache().containsKey(a,b),()=>{let a=this.orphanedSequenceNumbers.get(b);return fo.resolve(void 0!==a&&a>c)}])}getCacheSize(a){return this.persistence.getRemoteDocumentCache().getSize(a)}}class oA{constructor(a){this.serializer=a}createOrUpgrade(a,b,c,d){let e=new fr("createOrUpgrade",b);c<1&&d>=1&&(oC(a),oD(a),oI(a),oF(a));let f=fo.resolve();return c<3&&d>=3&&(0!==c&&(oJ(a),oI(a)),f=f.next(()=>oL(e))),c<4&&d>=4&&(0!==c&&(f=f.next(()=>oE(a,e))),f=f.next(()=>{oM(a)})),c<5&&d>=5&&(f=f.next(()=>this.removeAcknowledgedMutations(e))),c<6&&d>=6&&(f=f.next(()=>(oH(a),this.addDocumentGlobal(e)))),c<7&&d>=7&&(f=f.next(()=>this.ensureSequenceNumbers(e))),c<8&&d>=8&&(f=f.next(()=>this.createCollectionParentIndex(a,e))),c<9&&d>=9&&(f=f.next(()=>{oK(a)})),c<10&&d>=10&&(f=f.next(()=>this.rewriteCanonicalIds(e))),c<11&&d>=11&&(f=f.next(()=>{oN(a),oO(a)})),c<12&&d>=12&&(f=f.next(()=>{oQ(a)})),c<13&&d>=13&&(f=f.next(()=>oG(a)).next(()=>this.rewriteRemoteDocumentCache(a,e)).next(()=>a.deleteObjectStore(fQ))),c<14&&d>=14&&(f=f.next(()=>this.runOverlayMigration(a,e))),c<15&&d>=15&&(f=f.next(()=>oP(a))),c<16&&d>=16&&(f=f.next(()=>{b.objectStore(gw).clear()}).next(()=>{b.objectStore(gA).clear()})),c<17&&d>=17&&(f=f.next(()=>{oR(a)})),c<18&&d>=18&&_()&&(f=f.next(()=>{b.objectStore(gw).clear()}).next(()=>{b.objectStore(gA).clear()})),f}addDocumentGlobal(a){let b=0;return a.store(fQ).iterate((a,c)=>{b+=nE(c)}).next(()=>{let c={byteSize:b};return a.store(f8).put(f9,c)})}removeAcknowledgedMutations(a){let b=a.store(fT),c=a.store(fV);return b.loadAll().next(b=>fo.forEach(b,b=>{let d=IDBKeyRange.bound([b.userId,ht],[b.userId,b.lastAcknowledgedBatchId]);return c.loadAll(fX,d).next(c=>fo.forEach(c,c=>{es(c.userId===b.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let d=mg(this.serializer,c);return nD(a,b.userId,d).next(()=>{})}))}))}ensureSequenceNumbers(a){let b=a.store(ge),c=a.store(fQ);return a.store(gj).get(gi).next(a=>{let d=c=>b.put({targetId:0,path:fM(c),sequenceNumber:a.highestListenSequenceNumber}),e=[];return c.iterate((a,c)=>{let f=new eR(a),g=oB(f);e.push(b.get(g).next(a=>a?fo.resolve():d(f)))}).next(()=>fo.waitFor(e))})}createCollectionParentIndex(a,b){a.createObjectStore(gk,{keyPath:gl});let c=b.store(gk),d=new nu,e=a=>{if(d.add(a)){let b=a.lastSegment(),d=a.popLast();return c.put({collectionId:b,parent:fM(d)})}};return b.store(fQ).iterate({keysOnly:!0},(a,b)=>e(new eR(a).popLast())).next(()=>b.store(f1).iterate({keysOnly:!0},([a,b,c],d)=>e(fP(b).popLast())))}rewriteCanonicalIds(a){let b=a.store(ga);return b.iterate((a,c)=>{let d=mh(c),e=mi(this.serializer,d);return b.put(e)})}rewriteRemoteDocumentCache(a,b){let c=b.store(fQ),d=[];return c.iterate((a,c)=>{let e=b.store(f2),f=oS(c).path.toArray(),g={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};d.push(e.put(g))}).next(()=>fo.waitFor(d))}runOverlayMigration(a,b){let c=b.store(fV),d=n8(this.serializer),e=new ow(oy.factory,this.serializer.remoteSerializer);return c.loadAll().next(a=>{let c=new Map;return a.forEach(a=>{let b=c.get(a.userId)??jN();mg(this.serializer,a).keys().forEach(a=>b=b.add(a)),c.set(a.userId,b)}),fo.forEach(c,(a,c)=>{let f=new eg(c),g=mA.forUser(this.serializer,f),h=e.getIndexManager(f);return new oi(d,nF.forUser(f,this.serializer,h,e.referenceDelegate),g,h).recalculateAndSaveOverlaysForDocumentKeys(new gV(b,fH.INVALID),a).next()})})}}function oB(a){return[0,fM(a)]}function oC(a){a.createObjectStore(fR)}function oD(a){a.createObjectStore(fT,{keyPath:fU}),a.createObjectStore(fV,{keyPath:fW,autoIncrement:!0}).createIndex(fX,fY,{unique:!0}),a.createObjectStore(f1)}function oE(a,b){return b.store(fV).loadAll().next(c=>{a.deleteObjectStore(fV),a.createObjectStore(fV,{keyPath:fW,autoIncrement:!0}).createIndex(fX,fY,{unique:!0});let d=b.store(fV),e=c.map(a=>d.put(a));return fo.waitFor(e)})}function oF(a){a.createObjectStore(fQ)}function oG(a){let b=a.createObjectStore(f2,{keyPath:f3});b.createIndex(f4,f5),b.createIndex(f6,f7)}function oH(a){a.createObjectStore(f8)}function oI(a){a.createObjectStore(ge,{keyPath:gf}).createIndex(gg,gh,{unique:!0}),a.createObjectStore(ga,{keyPath:gb}).createIndex(gc,gd,{unique:!0}),a.createObjectStore(gj)}function oJ(a){a.deleteObjectStore(ge),a.deleteObjectStore(ga),a.deleteObjectStore(gj)}function oK(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}function oL(a){let b=a.store(gj),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:e5.min().toTimestamp(),targetCount:0};return b.put(gi,c)}function oM(a){a.createObjectStore(gm,{keyPath:gn})}function oN(a){a.createObjectStore(go,{keyPath:gp})}function oO(a){a.createObjectStore(gq,{keyPath:gr})}function oP(a){a.createObjectStore(gs,{keyPath:gt,autoIncrement:!0}).createIndex(gu,gv,{unique:!1}),a.createObjectStore(gw,{keyPath:gx}).createIndex(gy,gz,{unique:!1}),a.createObjectStore(gA,{keyPath:gB}).createIndex(gC,gD,{unique:!1})}function oQ(a){let b=a.createObjectStore(gE,{keyPath:gF});b.createIndex(gG,gH,{unique:!1}),b.createIndex(gI,gJ,{unique:!1})}function oR(a){a.createObjectStore(gK,{keyPath:gL})}function oS(a){return a.document?new eU(eR.fromString(a.document.name).popFirst(5)):a.noDocument?eU.fromSegments(a.noDocument.path):a.unknownDocument?eU.fromSegments(a.unknownDocument.path):eq(36783)}let oT="IndexedDbPersistence",oU=18e5,oV=5e3,oW=4e3,oX="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oY="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",oZ="firestore_zombie",o$="main";class o_{constructor(a,b,c,d,e,f,g,h,i,j,k=og){if(this.allowTabSynchronization=a,this.persistenceKey=b,this.clientId=c,this.queue=e,this.window=f,this.document=g,this.sequenceNumberSyncer=i,this.forceOwningTab=j,this.schemaVersion=k,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=-1/0,this.primaryStateListener=a=>Promise.resolve(),!o_.isAvailable())throw new ev(eu.UNIMPLEMENTED,oY);this.referenceDelegate=new n2(this,d),this.dbName=b+o$,this.serializer=new l8(h),this.simpleDb=new fs(this.dbName,this.schemaVersion,new oA(this.serializer)),this.globalsCache=new mC,this.targetCache=new nN(this.referenceDelegate,this.serializer),this.remoteDocumentCache=n8(this.serializer),this.bundleCache=new mx,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===j&&en(oT,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ev(eu.FAILED_PRECONDITION,oX);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",a=>this.targetCache.getHighestSequenceNumber(a))}).then(a=>{this.listenSequence=new fH(a,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(a=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(a)))}setPrimaryStateListener(a){return this.primaryStateListener=async b=>{if(this.started)return a(b)},a(this.isPrimary)}setDatabaseDeletedListener(a){this.simpleDb.setVersionChangeListener(async b=>{null===b.newVersion&&await a()})}setNetworkEnabled(a){this.networkEnabled!==a&&(this.networkEnabled=a,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",a=>o1(a).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(a).next(a=>{a||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(a)).next(b=>this.isPrimary&&!b?this.releasePrimaryLeaseIfHeld(a).next(()=>!1):!!b&&this.acquireOrExtendPrimaryLease(a).next(()=>!0))).catch(a=>{if(fw(a))return em(oT,"Failed to extend owner lease: ",a),this.isPrimary;if(!this.allowTabSynchronization)throw a;return em(oT,"Releasing owner lease after error during lease refresh",a),!1}).then(a=>{this.isPrimary!==a&&this.queue.enqueueRetryable(()=>this.primaryStateListener(a)),this.isPrimary=a})}verifyPrimaryLease(a){return o0(a).get(fS).next(a=>fo.resolve(this.isLocalClient(a)))}removeClientMetadata(a){return o1(a).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,oU)){this.lastGarbageCollectionTime=Date.now();let a=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",a=>{let b=gW(a,gm);return b.loadAll().next(a=>{let c=this.filterActiveClients(a,oU),d=a.filter(a=>-1===c.indexOf(a));return fo.forEach(d,a=>b.delete(a.clientId)).next(()=>d)})}).catch(()=>[]);if(this.webStorage)for(let b of a)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(b.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",oW,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(a){return!!a&&a.ownerId===this.clientId}canActAsPrimary(a){return this.forceOwningTab?fo.resolve(!0):o0(a).get(fS).next(b=>{if(null!==b&&this.isWithinAge(b.leaseTimestampMs,oV)&&!this.isClientZombied(b.ownerId)){if(this.isLocalClient(b)&&this.networkEnabled)return!0;if(!this.isLocalClient(b)){if(!b.allowTabSynchronization)throw new ev(eu.FAILED_PRECONDITION,oX);return!1}}return!!this.networkEnabled&&!!this.inForeground||o1(a).loadAll().next(a=>void 0===this.filterActiveClients(a,oV).find(a=>{if(this.clientId!==a.clientId){let b=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(b||c&&d)return!0}return!1}))}).next(a=>(this.isPrimary!==a&&em(oT,`Client ${a?"is":"is not"} eligible for a primary lease.`),a))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[fR,gm],a=>{let b=new gV(a,fH.INVALID);return this.releasePrimaryLeaseIfHeld(b).next(()=>this.removeClientMetadata(b))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(a,b){return a.filter(a=>this.isWithinAge(a.updateTimeMs,b)&&!this.isClientZombied(a.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",a=>o1(a).loadAll().next(a=>this.filterActiveClients(a,oU).map(a=>a.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(a,b){return nF.forUser(a,this.serializer,b,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(a){return new nx(a,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(a){return mA.forUser(this.serializer,a)}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){let d;em(oT,"Starting transaction:",a);let e="readonly"===b?"readonly":"readwrite",f=gU(this.schemaVersion);return this.simpleDb.runTransaction(a,e,f,e=>(d=new gV(e,this.listenSequence?this.listenSequence.next():fH.INVALID),"readwrite-primary"===b)?this.verifyPrimaryLease(d).next(a=>!!a||this.canActAsPrimary(d)).next(b=>{if(!b)throw en(`Failed to obtain primary lease for action '${a}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new ev(eu.FAILED_PRECONDITION,fl);return c(d)}).next(a=>this.acquireOrExtendPrimaryLease(d).next(()=>a)):this.verifyAllowTabSynchronization(d).next(()=>c(d))).then(a=>(d.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(a){return o0(a).get(fS).next(a=>{if(null!==a&&this.isWithinAge(a.leaseTimestampMs,oV)&&!this.isClientZombied(a.ownerId)&&!this.isLocalClient(a)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!a.allowTabSynchronization))throw new ev(eu.FAILED_PRECONDITION,oX)})}acquireOrExtendPrimaryLease(a){let b={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return o0(a).put(fS,b)}static isAvailable(){return fs.isAvailable()}releasePrimaryLeaseIfHeld(a){let b=o0(a);return b.get(fS).next(a=>this.isLocalClient(a)?(em(oT,"Releasing primary lease."),b.delete(fS)):fo.resolve())}isWithinAge(a,b){let c=Date.now(),d=c-b,e=c;return!(a<d)&&(!(a>e)||(en(`Detected an update time that is in the future: ${a} > ${e}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){"function"==typeof this.window?.addEventListener&&(this.windowUnloadHandler=()=>{this.markClientZombied();let a=/(?:Version|Mobile)\/1[456]/;$()&&(navigator.appVersion.match(a)||navigator.userAgent.match(a))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(a){try{let b=this.webStorage?.getItem(this.zombiedClientLocalStorageKey(a))!==null;return em(oT,`Client '${a}' ${b?"is":"is not"} zombied in LocalStorage`),b}catch(a){return en(oT,"Failed to get zombied client id.",a),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(a){en("Failed to set zombie client id.",a)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(a){}}zombiedClientLocalStorageKey(a){return`${oZ}_${this.persistenceKey}_${a}`}}function o0(a){return gW(a,fR)}function o1(a){return gW(a,gm)}function o2(a,b){let c=a.projectId;return a.isDefaultDatabase||(c+="."+a.database),"firestore/"+b+"/"+c+"/"}function o3(a,b,c,d,e){b=[...b],(a=[...a]).sort(c),b.sort(c);let f=a.length,g=b.length,h=0,i=0;for(;h<g&&i<f;){let f=c(a[i],b[h]);f<0?e(a[i++]):f>0?d(b[h++]):(h++,i++)}for(;h<g;)d(b[h++]);for(;i<f;)e(a[i++])}function o4(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}let o5="LocalStore",o6=3e8;class o7{constructor(a,b,c,d){this.persistence=a,this.queryEngine=b,this.serializer=d,this.targetDataByTarget=new g_(eI),this.targetIdByTarget=new jA(a=>iX(a),iZ),this.collectionGroupReadTime=new Map,this.remoteDocuments=a.getRemoteDocumentCache(),this.targetCache=a.getTargetCache(),this.bundleCache=a.getBundleCache(),this.initializeUserComponents(c)}initializeUserComponents(a){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(a),this.indexManager=this.persistence.getIndexManager(a),this.mutationQueue=this.persistence.getMutationQueue(a,this.indexManager),this.localDocuments=new oi(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(a){return this.persistence.runTransaction("Collect garbage","readwrite-primary",b=>a.collect(b,this.targetDataByTarget))}}function o8(a,b,c,d){return new o7(a,b,c,d)}async function o9(a,b){let c=et(a);return await c.persistence.runTransaction("Handle user change","readonly",a=>{let d;return c.mutationQueue.getAllMutationBatches(a).next(e=>(d=e,c.initializeUserComponents(b),c.mutationQueue.getAllMutationBatches(a))).next(b=>{let e=[],f=[],g=jN();for(let a of d)for(let b of(e.push(a.batchId),a.mutations))g=g.add(b.key);for(let a of b)for(let b of(f.push(a.batchId),a.mutations))g=g.add(b.key);return c.localDocuments.getDocuments(a,g).next(a=>({affectedDocuments:a,removedBatchIds:e,addedBatchIds:f}))})})}function pa(a,b){let c,d,e=et(a),f=e4.now(),g=b.reduce((a,b)=>a.add(b.key),jN());return e.persistence.runTransaction("Locally write mutations","readwrite",a=>{let h=jC(),i=jN();return e.remoteDocuments.getEntries(a,g).next(a=>{(h=a).forEach((a,b)=>{b.isValidDocument()||(i=i.add(a))})}).next(()=>e.localDocuments.getOverlayedDocuments(a,h)).next(d=>{c=d;let g=[];for(let a of b){let b=kf(a,c.get(a.key).overlayedDocument);null!=b&&g.push(new kk(a.key,b,il(b.value.mapValue),j9.exists(!0)))}return e.mutationQueue.addMutationBatch(a,f,g,b)}).next(b=>{d=b;let f=b.applyToLocalDocumentSet(c,i);return e.documentOverlayCache.saveOverlays(a,b.batchId,f)})}).then(()=>({batchId:d.batchId,changes:jG(c)}))}function pb(a,b){let c=et(a);return c.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{let d=b.batch.keys(),e=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});return pq(c,a,b,e).next(()=>e.apply(a)).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b.batch.batchId)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,pc(b))).next(()=>c.localDocuments.getDocuments(a,d))})}function pc(a){let b=jN();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(b=b.add(a.batch.mutations[c].key));return b}function pd(a,b){let c=et(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",a=>{let d;return c.mutationQueue.lookupMutationBatch(a,b).next(b=>(es(null!==b,37113),d=b.keys(),c.mutationQueue.removeMutationBatch(a,b))).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,d)).next(()=>c.localDocuments.getDocuments(a,d))})}function pe(a){let b=et(a);return b.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>b.mutationQueue.getHighestUnacknowledgedBatchId(a))}function pf(a){let b=et(a);return b.persistence.runTransaction("Get last remote snapshot version","readonly",a=>b.targetCache.getLastRemoteSnapshotVersion(a))}function pg(a,b){let c=et(a),d=b.snapshotVersion,e=c.targetDataByTarget;return c.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{let f=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});e=c.targetDataByTarget;let g=[];b.targetChanges.forEach((f,h)=>{let i=e.get(h);if(!i)return;g.push(c.targetCache.removeMatchingKeys(a,f.removedDocuments,h).next(()=>c.targetCache.addMatchingKeys(a,f.addedDocuments,h)));let j=i.withSequenceNumber(a.currentSequenceNumber);null!==b.targetMismatches.get(h)?j=j.withResumeToken(ha.EMPTY_BYTE_STRING,e5.min()).withLastLimboFreeSnapshotVersion(e5.min()):f.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(f.resumeToken,d)),e=e.insert(h,j),pi(i,j,f)&&g.push(c.targetCache.updateTargetData(a,j))});let h=jC(),i=jN();if(b.documentUpdates.forEach(d=>{b.resolvedLimboDocuments.has(d)&&g.push(c.persistence.referenceDelegate.updateLimboDocument(a,d))}),g.push(ph(a,f,b.documentUpdates).next(a=>{h=a.changedDocuments,i=a.existenceChangedKeys})),!d.isEqual(e5.min())){let b=c.targetCache.getLastRemoteSnapshotVersion(a).next(b=>c.targetCache.setTargetsMetadata(a,a.currentSequenceNumber,d));g.push(b)}return fo.waitFor(g).next(()=>f.apply(a)).next(()=>c.localDocuments.getLocalViewOfDocuments(a,h,i)).next(()=>h)}).then(a=>(c.targetDataByTarget=e,a))}function ph(a,b,c){let d=jN(),e=jN();return c.forEach(a=>d=d.add(a)),b.getEntries(a,d).next(a=>{let d=jC();return c.forEach((c,f)=>{let g=a.get(c);f.isFoundDocument()!==g.isFoundDocument()&&(e=e.add(c)),f.isNoDocument()&&f.version.isEqual(e5.min())?(b.removeEntry(c,f.readTime),d=d.insert(c,f)):!g.isValidDocument()||f.version.compareTo(g.version)>0||0===f.version.compareTo(g.version)&&g.hasPendingWrites?(b.addEntry(f),d=d.insert(c,f)):em(o5,"Ignoring outdated watch update for ",c,". Current version:",g.version," Watch version:",f.version)}),{changedDocuments:d,existenceChangedKeys:e}})}function pi(a,b,c){return!!(0===a.resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-a.snapshotVersion.toMicroseconds()>=o6)||c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size>0}async function pj(a,b){let c=et(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",a=>fo.forEach(b,b=>fo.forEach(b.addedKeys,d=>c.persistence.referenceDelegate.addReference(a,b.targetId,d)).next(()=>fo.forEach(b.removedKeys,d=>c.persistence.referenceDelegate.removeReference(a,b.targetId,d)))))}catch(a){if(fw(a))em(o5,"Failed to update sequence numbers: "+a);else throw a}for(let a of b){let b=a.targetId;if(!a.fromCache){let a=c.targetDataByTarget.get(b),d=a.snapshotVersion,e=a.withLastLimboFreeSnapshotVersion(d);c.targetDataByTarget=c.targetDataByTarget.insert(b,e)}}}function pk(a,b){let c=et(a);return c.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===b&&(b=ht),c.mutationQueue.getNextMutationBatchAfterBatchId(a,b)))}function pl(a,b){let c=et(a);return c.persistence.runTransaction("read document","readonly",a=>c.localDocuments.getDocument(a,b))}function pm(a,b){let c=et(a);return c.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return c.targetCache.getTargetData(a,b).next(e=>e?(d=e,fo.resolve(d)):c.targetCache.allocateTargetId(a).next(e=>(d=new l7(b,e,"TargetPurposeListen",a.currentSequenceNumber),c.targetCache.addTargetData(a,d).next(()=>d))))}).then(a=>{let d=c.targetDataByTarget.get(a.targetId);return(null===d||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(c.targetDataByTarget=c.targetDataByTarget.insert(a.targetId,a),c.targetIdByTarget.set(b,a.targetId)),a})}function pn(a,b,c){let d=et(a),e=d.targetIdByTarget.get(c);return void 0!==e?fo.resolve(d.targetDataByTarget.get(e)):d.targetCache.getTargetData(b,c)}async function po(a,b,c){let d=et(a),e=d.targetDataByTarget.get(b),f=c?"readwrite":"readwrite-primary";try{c||await d.persistence.runTransaction("Release target",f,a=>d.persistence.referenceDelegate.removeTarget(a,e))}catch(a){if(fw(a))em(o5,`Failed to update sequence numbers for target ${b}: ${a}`);else throw a}d.targetDataByTarget=d.targetDataByTarget.remove(b),d.targetIdByTarget.delete(e.target)}function pp(a,b,c){let d=et(a),e=e5.min(),f=jN();return d.persistence.runTransaction("Execute query","readwrite",a=>pn(d,a,jh(b)).next(b=>{if(b)return e=b.lastLimboFreeSnapshotVersion,d.targetCache.getMatchingKeysForTargetId(a,b.targetId).next(a=>{f=a})}).next(()=>d.queryEngine.getDocumentsMatchingQuery(a,b,c?e:e5.min(),c?f:jN())).next(a=>(pw(d,jx(b),a),{documents:a,remoteKeys:f})))}function pq(a,b,c,d){let e=c.batch,f=e.keys(),g=fo.resolve();return f.forEach(a=>{g=g.next(()=>d.getEntry(b,a)).next(b=>{let f=c.docVersions.get(a);es(null!==f,48541),0>b.version.compareTo(f)&&(e.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(b,e))}function pr(a,b){let c=et(a),d=et(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",a=>d.lookupMutationKeys(a,b).next(b=>b?c.localDocuments.getDocuments(a,b):fo.resolve(null)))}function ps(a,b){et(et(a,o7).mutationQueue).removeCachedMutationKeys(b)}function pt(a){return et(et(a,o7).persistence).getActiveClients()}function pu(a,b){let c=et(a),d=et(c.targetCache),e=c.targetDataByTarget.get(b);return e?Promise.resolve(e.target):c.persistence.runTransaction("Get target data","readonly",a=>d.getTargetDataForTarget(a,b).next(a=>a?a.target:null))}function pv(a,b){let c=et(a),d=c.collectionGroupReadTime.get(b)||e5.min();return c.persistence.runTransaction("Get new document changes","readonly",a=>c.remoteDocuments.getAllFromCollectionGroup(a,b,fh(d,e6),Number.MAX_SAFE_INTEGER)).then(a=>(pw(c,b,a),a))}function pw(a,b,c){let d=a.collectionGroupReadTime.get(b)||e5.min();c.forEach((a,b)=>{b.readTime.compareTo(d)>0&&(d=b.readTime)}),a.collectionGroupReadTime.set(b,d)}function px(a){return jh(ja(eR.fromString(`__bundle__/docs/${a}`)))}async function py(a,b,c,d){let e=et(a),f=jN(),g=jC();for(let a of c){let c=b.toDocumentKey(a.metadata.name);a.document&&(f=f.add(c));let d=b.toMutableDocument(a);d.setReadTime(b.toSnapshotVersion(a.metadata.readTime)),g=g.insert(c,d)}let h=e.remoteDocuments.newChangeBuffer({trackRemovals:!0}),i=await pm(e,px(d));return e.persistence.runTransaction("Apply bundle documents","readwrite",a=>ph(a,h,g).next(b=>(h.apply(a),b)).next(b=>e.targetCache.removeMatchingKeysForTargetId(a,i.targetId).next(()=>e.targetCache.addMatchingKeys(a,f,i.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,b.changedDocuments,b.existenceChangedKeys)).next(()=>b.changedDocuments)))}function pz(a,b){let c=et(a),d=k6(b.createTime);return c.persistence.runTransaction("hasNewerBundle","readonly",a=>c.bundleCache.getBundleMetadata(a,b.id)).then(a=>!!a&&a.createTime.compareTo(d)>=0)}function pA(a,b){let c=et(a);return c.persistence.runTransaction("Save bundle","readwrite",a=>c.bundleCache.saveBundleMetadata(a,b))}function pB(a,b){let c=et(a);return c.persistence.runTransaction("Get named query","readonly",a=>c.bundleCache.getNamedQuery(a,b))}async function pC(a,b,c=jN()){let d=await pm(a,jh(mo(b.bundledQuery))),e=et(a);return e.persistence.runTransaction("Save named query","readwrite",a=>{let f=k6(b.readTime);if(d.snapshotVersion.compareTo(f)>=0)return e.bundleCache.saveNamedQuery(a,b);let g=d.withResumeToken(ha.EMPTY_BYTE_STRING,f);return e.targetDataByTarget=e.targetDataByTarget.insert(g.targetId,g),e.targetCache.updateTargetData(a,g).next(()=>e.targetCache.removeMatchingKeysForTargetId(a,d.targetId)).next(()=>e.targetCache.addMatchingKeys(a,c,d.targetId)).next(()=>e.bundleCache.saveNamedQuery(a,b))})}async function pD(a,b){let c=et(a),d=c.indexManager,e=[];return c.persistence.runTransaction("Configure indexes","readwrite",a=>d.getFieldIndexes(a).next(c=>o3(c,b,fc,b=>{e.push(d.addFieldIndex(a,b))},b=>{e.push(d.deleteFieldIndex(a,b))})).next(()=>fo.waitFor(e)))}function pE(a,b){et(a).queryEngine.indexAutoCreationEnabled=b}function pF(a){let b=et(a),c=b.indexManager;return b.persistence.runTransaction("Delete All Indexes","readwrite",a=>c.deleteAllFieldIndexes(a))}class pG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(a){this._documentReadCount+=a}}let pH=100;function pI(){return $()?8:ft(U())>0?6:4}class pJ{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=pH,this.relativeIndexReadCostPerDocument=pI()}initialize(a,b){this.localDocumentsView=a,this.indexManager=b,this.initialized=!0}getDocumentsMatchingQuery(a,b,c,d){let e={result:null};return this.performQueryUsingIndex(a,b).next(a=>{e.result=a}).next(()=>{if(!e.result)return this.performQueryUsingRemoteKeys(a,b,d,c).next(a=>{e.result=a})}).next(()=>{if(e.result)return;let c=new pG;return this.executeFullCollectionScan(a,b,c).next(d=>{if(e.result=d,this.indexAutoCreationEnabled)return this.createCacheIndexes(a,b,c,d.size)})}).next(()=>e.result)}createCacheIndexes(a,b,c,d){return c.documentReadCount<this.indexAutoCreationMinCollectionSize?(el()<=j.DEBUG&&em("QueryEngine","SDK will not create cache indexes for query:",jr(b),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),fo.resolve()):(el()<=j.DEBUG&&em("QueryEngine","Query:",jr(b),"scans",c.documentReadCount,"local documents and returns",d,"documents as results."),c.documentReadCount>this.relativeIndexReadCostPerDocument*d)?(el()<=j.DEBUG&&em("QueryEngine","The SDK decides to create cache indexes for query:",jr(b),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(a,jh(b))):fo.resolve()}performQueryUsingIndex(a,b){if(jc(b))return fo.resolve(null);let c=jh(b);return this.indexManager.getIndexType(a,c).next(d=>0===d?null:(null!==b.limit&&1===d&&(c=jh(b=jm(b,null,"F"))),this.indexManager.getDocumentsMatchingTarget(a,c).next(d=>{let e=jN(...d);return this.localDocumentsView.getDocuments(a,e).next(d=>this.indexManager.getMinOffset(a,c).next(c=>{let f=this.applyQuery(b,d);return this.needsRefill(b,f,e,c.readTime)?this.performQueryUsingIndex(a,jm(b,null,"F")):this.appendRemainingResults(a,f,b,c)}))})))}performQueryUsingRemoteKeys(a,b,c,d){return jc(b)||d.isEqual(e5.min())?fo.resolve(null):this.localDocumentsView.getDocuments(a,c).next(e=>{let f=this.applyQuery(b,e);return this.needsRefill(b,f,c,d)?fo.resolve(null):(el()<=j.DEBUG&&em("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),jr(b)),this.appendRemainingResults(a,f,b,fh(d,e6)).next(a=>a))})}applyQuery(a,b){let c=new g3(jy(a));return b.forEach((b,d)=>{js(a,d)&&(c=c.add(d))}),c}needsRefill(a,b,c,d){if(null===a.limit)return!1;if(c.size!==b.size)return!0;let e="F"===a.limitType?b.last():b.first();return!!e&&(e.hasPendingWrites||e.version.compareTo(d)>0)}executeFullCollectionScan(a,b,c){return el()<=j.DEBUG&&em("QueryEngine","Using full collection scan to execute query:",jr(b)),this.localDocumentsView.getDocumentsMatchingQuery(a,b,fj.min(),c)}appendRemainingResults(a,b,c,d){return this.localDocumentsView.getDocumentsMatchingQuery(a,c,d).next(a=>(b.forEach(b=>{a=a.insert(b.key,b)}),a))}}let pK="firestore_clients";function pL(a,b){return`${pK}_${a}_${b}`}let pM="firestore_mutations";function pN(a,b,c){let d=`${pM}_${a}_${c}`;return b.isAuthenticated()&&(d+=`_${b.uid}`),d}let pO="firestore_targets";function pP(a,b){return`${pO}_${a}_${b}`}let pQ="firestore_online_state";function pR(a){return`${pQ}_${a}`}let pS="firestore_bundle_loaded_v2";function pT(a){return`${pS}_${a}`}let pU="firestore_sequence_number";function pV(a){return`${pU}_${a}`}let pW="SharedClientState";class pX{constructor(a,b,c,d){this.user=a,this.batchId=b,this.state=c,this.error=d}static fromWebStorageEntry(a,b,c){let d,e=JSON.parse(c),f="object"==typeof e&&-1!==["pending","acknowledged","rejected"].indexOf(e.state)&&(void 0===e.error||"object"==typeof e.error);return(f&&e.error&&(f="string"==typeof e.error.message&&"string"==typeof e.error.code)&&(d=new ev(e.error.code,e.error.message)),f)?new pX(a,b,e.state,d):(en(pW,`Failed to parse mutation state for ID '${b}': ${c}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class pY{constructor(a,b,c){this.targetId=a,this.state=b,this.error=c}static fromWebStorageEntry(a,b){let c,d=JSON.parse(b),e="object"==typeof d&&-1!==["not-current","current","rejected"].indexOf(d.state)&&(void 0===d.error||"object"==typeof d.error);return(e&&d.error&&(e="string"==typeof d.error.message&&"string"==typeof d.error.code)&&(c=new ev(d.error.code,d.error.message)),e)?new pY(a,d.state,c):(en(pW,`Failed to parse target state for ID '${a}': ${b}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class pZ{constructor(a,b){this.clientId=a,this.activeTargetIds=b}static fromWebStorageEntry(a,b){let c=JSON.parse(b),d="object"==typeof c&&c.activeTargetIds instanceof Array,e=jP();for(let a=0;d&&a<c.activeTargetIds.length;++a)d=hw(c.activeTargetIds[a]),e=e.add(c.activeTargetIds[a]);return d?new pZ(a,e):(en(pW,`Failed to parse client data for instance '${a}': ${b}`),null)}}class p${constructor(a,b){this.clientId=a,this.onlineState=b}static fromWebStorageEntry(a){let b=JSON.parse(a);return"object"==typeof b&&-1!==["Unknown","Online","Offline"].indexOf(b.onlineState)&&"string"==typeof b.clientId?new p$(b.clientId,b.onlineState):(en(pW,`Failed to parse online state: ${a}`),null)}}class p_{constructor(){this.activeTargetIds=jP()}addQueryTarget(a){this.activeTargetIds=this.activeTargetIds.add(a)}removeQueryTarget(a){this.activeTargetIds=this.activeTargetIds.delete(a)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class p0{constructor(a,b,c,d,e){this.window=a,this.queue=b,this.persistenceKey=c,this.localClientId=d,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new g_(eI),this.started=!1,this.earlyEvents=[];let f=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=e,this.localClientStorageKey=pL(this.persistenceKey,this.localClientId),this.sequenceNumberKey=pV(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new p_),this.clientStateKeyRe=RegExp(`^${pK}_${f}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${pM}_${f}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${pO}_${f}_(\\d+)$`),this.onlineStateKey=pR(this.persistenceKey),this.bundleLoadedKey=pT(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(a){return!!(a&&a.localStorage)}async start(){for(let a of(await this.syncEngine.getActiveClients())){if(a===this.localClientId)continue;let b=this.getItem(pL(this.persistenceKey,a));if(b){let c=pZ.fromWebStorageEntry(a,b);c&&(this.activeClients=this.activeClients.insert(c.clientId,c))}}this.persistClientState();let a=this.storage.getItem(this.onlineStateKey);if(a){let b=this.fromWebStorageOnlineState(a);b&&this.handleOnlineStateEvent(b)}for(let a of this.earlyEvents)this.handleWebStorageEvent(a);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(a){this.setItem(this.sequenceNumberKey,JSON.stringify(a))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(a){let b=!1;return this.activeClients.forEach((c,d)=>{d.activeTargetIds.has(a)&&(b=!0)}),b}addPendingMutation(a){this.persistMutationState(a,"pending")}updateMutationState(a,b,c){this.persistMutationState(a,b,c),this.removeMutationState(a)}addLocalQueryTarget(a,b=!0){let c="not-current";if(this.isActiveQueryTarget(a)){let b=this.storage.getItem(pP(this.persistenceKey,a));if(b){let d=pY.fromWebStorageEntry(a,b);d&&(c=d.state)}}return b&&this.localClientState.addQueryTarget(a),this.persistClientState(),c}removeLocalQueryTarget(a){this.localClientState.removeQueryTarget(a),this.persistClientState()}isLocalQueryTarget(a){return this.localClientState.activeTargetIds.has(a)}clearQueryState(a){this.removeItem(pP(this.persistenceKey,a))}updateQueryState(a,b,c){this.persistQueryTargetState(a,b,c)}handleUserChange(a,b,c){b.forEach(a=>{this.removeMutationState(a)}),this.currentUser=a,c.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(a){this.persistOnlineState(a)}notifyBundleLoaded(a){this.persistBundleLoadedState(a)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(a){let b=this.storage.getItem(a);return em(pW,"READ",a,b),b}setItem(a,b){em(pW,"SET",a,b),this.storage.setItem(a,b)}removeItem(a){em(pW,"REMOVE",a),this.storage.removeItem(a)}handleWebStorageEvent(a){let b=a;if(b.storageArea===this.storage){if(em(pW,"EVENT",b.key,b.newValue),b.key===this.localClientStorageKey)return void en("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueRetryable(async()=>{if(!this.started)return void this.earlyEvents.push(b);if(null!==b.key){if(this.clientStateKeyRe.test(b.key))if(null!=b.newValue){let a=this.fromWebStorageClientState(b.key,b.newValue);if(a)return this.handleClientStateEvent(a.clientId,a)}else{let a=this.fromWebStorageClientStateKey(b.key);return this.handleClientStateEvent(a,null)}else if(this.mutationBatchKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageMutationMetadata(b.key,b.newValue);if(a)return this.handleMutationBatchEvent(a)}}else if(this.queryTargetKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageQueryTargetMetadata(b.key,b.newValue);if(a)return this.handleQueryTargetEvent(a)}}else if(b.key===this.onlineStateKey){if(null!==b.newValue){let a=this.fromWebStorageOnlineState(b.newValue);if(a)return this.handleOnlineStateEvent(a)}}else if(b.key===this.sequenceNumberKey){let a=p1(b.newValue);a!==fH.INVALID&&this.sequenceNumberHandler(a)}else if(b.key===this.bundleLoadedKey){let a=this.fromWebStoreBundleLoadedState(b.newValue);await Promise.all(a.map(a=>this.syncEngine.synchronizeWithChangedDocuments(a)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(a,b,c){let d=new pX(this.currentUser,a,b,c),e=pN(this.persistenceKey,this.currentUser,a);this.setItem(e,d.toWebStorageJSON())}removeMutationState(a){let b=pN(this.persistenceKey,this.currentUser,a);this.removeItem(b)}persistOnlineState(a){let b={clientId:this.localClientId,onlineState:a};this.storage.setItem(this.onlineStateKey,JSON.stringify(b))}persistQueryTargetState(a,b,c){let d=pP(this.persistenceKey,a),e=new pY(a,b,c);this.setItem(d,e.toWebStorageJSON())}persistBundleLoadedState(a){let b=JSON.stringify(Array.from(a));this.setItem(this.bundleLoadedKey,b)}fromWebStorageClientStateKey(a){let b=this.clientStateKeyRe.exec(a);return b?b[1]:null}fromWebStorageClientState(a,b){let c=this.fromWebStorageClientStateKey(a);return pZ.fromWebStorageEntry(c,b)}fromWebStorageMutationMetadata(a,b){let c=this.mutationBatchKeyRe.exec(a),d=Number(c[1]),e=void 0!==c[2]?c[2]:null;return pX.fromWebStorageEntry(new eg(e),d,b)}fromWebStorageQueryTargetMetadata(a,b){let c=Number(this.queryTargetKeyRe.exec(a)[1]);return pY.fromWebStorageEntry(c,b)}fromWebStorageOnlineState(a){return p$.fromWebStorageEntry(a)}fromWebStoreBundleLoadedState(a){return JSON.parse(a)}async handleMutationBatchEvent(a){return a.user.uid!==this.currentUser.uid?void em(pW,`Ignoring mutation for non-active user ${a.user.uid}`):this.syncEngine.applyBatchState(a.batchId,a.state,a.error)}handleQueryTargetEvent(a){return this.syncEngine.applyTargetState(a.targetId,a.state,a.error)}handleClientStateEvent(a,b){let c=b?this.activeClients.insert(a,b):this.activeClients.remove(a),d=this.extractActiveQueryTargets(this.activeClients),e=this.extractActiveQueryTargets(c),f=[],g=[];return e.forEach(a=>{d.has(a)||f.push(a)}),d.forEach(a=>{e.has(a)||g.push(a)}),this.syncEngine.applyActiveTargetsChange(f,g).then(()=>{this.activeClients=c})}handleOnlineStateEvent(a){this.activeClients.get(a.clientId)&&this.onlineStateHandler(a.onlineState)}extractActiveQueryTargets(a){let b=jP();return a.forEach((a,c)=>{b=b.unionWith(c.activeTargetIds)}),b}}function p1(a){let b=fH.INVALID;if(null!=a)try{let c=JSON.parse(a);es("number"==typeof c,30636,{seqString:a}),b=c}catch(a){en(pW,"Failed to read sequence number from WebStorage",a)}return b}class p2{constructor(){this.localState=new p_,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(a){}updateMutationState(a,b,c){}addLocalQueryTarget(a,b=!0){return b&&this.localState.addQueryTarget(a),this.queryState[a]||"not-current"}updateQueryState(a,b,c){this.queryState[a]=b}removeLocalQueryTarget(a){this.localState.removeQueryTarget(a)}isLocalQueryTarget(a){return this.localState.activeTargetIds.has(a)}clearQueryState(a){delete this.queryState[a]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(a){return this.localState.activeTargetIds.has(a)}start(){return this.localState=new p_,Promise.resolve()}handleUserChange(a,b,c){}setOnlineState(a){}shutdown(){}writeSequenceNumber(a){}notifyBundleLoaded(a){}}class p3{addCallback(a){}shutdown(){}}class p4{constructor(a){this.sendFn=a.sendFn,this.closeFn=a.closeFn}onConnected(a){this.wrappedOnConnected=a}onOpen(a){this.wrappedOnOpen=a}onClose(a){this.wrappedOnClose=a}onMessage(a){this.wrappedOnMessage=a}close(){this.closeFn()}send(a){this.sendFn(a)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(a){this.wrappedOnClose(a)}callOnMessage(a){this.wrappedOnMessage(a)}}let p5=null;function p6(){return 0x10000000+Math.round(0x80000000*Math.random())}function p7(){return null===p5?p5=p6():p5++,"0x"+p5.toString(16)}function p8(a){return new Promise((b,c)=>{a((a,d)=>{a?c(a):b(d)})})}let p9="1.9.15",qa="GrpcConnection",qb=`gl-node/${process.versions.node} fire/${eh} grpc/${p9}`;function qc(a,b,c,d){es(null===b||"OAuth"===b.type,36936);let e=new ec.OS;return b&&b.headers.forEach((a,b)=>e.set(b,a)),c&&c.headers.forEach((a,b)=>e.set(b,a)),d&&e.set("X-Firebase-GMPID",d),e.set("X-Goog-Api-Client",qb),e.set("Google-Cloud-Resource-Prefix",a),e.set("x-goog-request-params",a),e}class qd{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(a,b){this.databaseInfo=b,this.cachedStub=null,this.firestore=a.google.firestore.v1,this.databasePath=`projects/${b.databaseId.projectId}/databases/${b.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){em(qa,"Creating Firestore stub.");let a=this.databaseInfo.ssl?ec.z3.createSsl():ec.z3.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,a)}return this.cachedStub}invokeRPC(a,b,c,d,e){let f=p7(),g=this.ensureActiveStub(),h=qc(this.databasePath,d,e,this.databaseInfo.appId),i={database:this.databasePath,...c};return p8(b=>(em(qa,`RPC '${a}' ${f} invoked with request:`,c),g[a](i,h,(c,d)=>{c?(em(qa,`RPC '${a}' ${f} failed with error:`,c),b(new ev(kA(c.code),c.message))):(em(qa,`RPC '${a}' ${f} completed with response:`,d),b(void 0,d))})))}invokeStreamingRPC(a,b,c,d,e,f){let g=p7(),h=[],i=new ew;em(qa,`RPC '${a}' ${g} invoked (streaming) with request:`,c);let j=this.ensureActiveStub(),k=qc(this.databasePath,d,e,this.databaseInfo.appId),l={...c,database:this.databasePath},m=j[a](l,k),n=!1;return m.on("data",b=>{em(qa,`RPC ${a} ${g} received result:`,b),h.push(b),void 0!==f&&h.length===f&&(n=!0,i.resolve(h))}),m.on("end",()=>{em(qa,`RPC '${a}' ${g} completed.`),n||(n=!0,i.resolve(h))}),m.on("error",b=>{em(qa,`RPC '${a}' ${g} failed with error:`,b);let c=kA(b.code);i.reject(new ev(c,b.message))}),i.promise}openStream(a,b,c){let d=p7(),e=this.ensureActiveStub(),f=qc(this.databasePath,b,c,this.databaseInfo.appId),g=e[a](f),h=!1,i=a=>{h||(h=!0,j.callOnClose(a),g.end())},j=new p4({sendFn:b=>{if(h)em(qa,`RPC '${a}' stream ${d} not sending because gRPC stream is closed:`,b);else{em(qa,`RPC '${a}' stream ${d} sending:`,b);try{g.write(b)}catch(a){throw en("Failure sending:",b),en("Error:",a),a}}},closeFn:()=>{em(qa,`RPC '${a}' stream ${d} closed locally via close().`),i()}}),k=!1;return g.on("data",b=>{h||(em(qa,`RPC '${a}' stream ${d} received:`,b),k||(j.callOnConnected(),k=!0),j.callOnMessage(b))}),g.on("end",()=>{em(qa,`RPC '${a}' stream ${d} ended.`),i()}),g.on("error",b=>{h||(eo(qa,`RPC '${a}' stream ${d} error. Code:`,b.code,"Message:",b.message),i(new ev(kA(b.code),b.message)))}),em(qa,`Opening RPC '${a}' stream ${d} to ${this.databaseInfo.host}`),setTimeout(()=>{j.callOnOpen()},0),j}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let qe={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:0x44f2530,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var qf={nested:qe},qg=Object.freeze({__proto__:null,nested:qe,default:qf});let qh={longs:String,enums:String,defaults:!0,oneofs:!1};function qi(){let a=ed.rS(qg,qh);return ec.ex(a)}function qj(a){return new qd(qi(),a)}function qk(){return new p3}function ql(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function qm(){return null}function qn(a){return new kZ(a,!1)}let qo="ExponentialBackoff",qp=1e3,qq=1.5,qr=6e4;class qs{constructor(a,b,c=qp,d=qq,e=qr){this.queue=a,this.timerId=b,this.initialDelayMs=c,this.backoffFactor=d,this.maxDelayMs=e,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(a){this.cancel();let b=Math.floor(this.currentBaseMs+this.jitterDelayMs()),c=Math.max(0,Date.now()-this.lastAttemptTime),d=Math.max(0,b-c);d>0&&em(qo,`Backing off for ${d} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${b} ms, last attempt: ${c} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,d,()=>(this.lastAttemptTime=Date.now(),a())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let qt="PersistentStream",qu=6e4,qv=1e4;class qw{constructor(a,b,c,d,e,f,g,h){this.queue=a,this.idleTimerId=c,this.healthTimerId=d,this.connection=e,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=g,this.listener=h,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new qs(a,b)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state)return void this.performBackoff();this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,qu,()=>this.handleIdleCloseTimer()))}sendRequest(a){this.cancelIdleCheck(),this.stream.send(a)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(a,b){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==a?this.backoff.reset():b&&b.code===eu.RESOURCE_EXHAUSTED?(en(b.toString()),en("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):b&&b.code===eu.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=a,await this.listener.onClose(b)}tearDown(){}auth(){this.state=1;let a=this.getCloseGuardedDispatcher(this.closeCount),b=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,c])=>{this.closeCount===b&&this.startStream(a,c)},b=>{a(()=>{let a=new ev(eu.UNKNOWN,"Fetching auth token failed: "+b.message);return this.handleStreamClose(a)})})}startStream(a,b){let c=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(a,b),this.stream.onConnected(()=>{c(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{c(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,qv,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(a=>{c(()=>this.handleStreamClose(a))}),this.stream.onMessage(a=>{c(()=>1==++this.responseCount?this.onFirst(a):this.onNext(a))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(a){return em(qt,`close with error: ${a}`),this.stream=null,this.close(4,a)}getCloseGuardedDispatcher(a){return b=>{this.queue.enqueueAndForget(()=>this.closeCount===a?b():(em(qt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qx extends qw{constructor(a,b,c,d,e,f){super(a,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}startRpc(a,b){return this.connection.openStream("Listen",a,b)}onFirst(a){return this.onNext(a)}onNext(a){this.backoff.reset();let b=ln(this.serializer,a),c=lp(a);return this.listener.onWatchChange(b,c)}watch(a){let b={};b.database=le(this.serializer),b.addTarget=lG(this.serializer,a);let c=lE(this.serializer,a);c&&(b.labels=c),this.sendRequest(b)}unwatch(a){let b={};b.database=le(this.serializer),b.removeTarget=a,this.sendRequest(b)}}class qy extends qw{constructor(a,b,c,d,e,f){super(a,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(a,b){return this.connection.openStream("Write",a,b)}onFirst(a){return es(!!a.streamToken,31322),this.lastStreamToken=a.streamToken,es(!a.writeResults||0===a.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(a){es(!!a.streamToken,12678),this.lastStreamToken=a.streamToken,this.backoff.reset();let b=lv(a.writeResults,a.commitTime),c=k6(a.commitTime);return this.listener.onMutationResult(c,b)}writeHandshake(){let a={};a.database=le(this.serializer),this.sendRequest(a)}writeMutations(a){let b={streamToken:this.lastStreamToken,writes:a.map(a=>lq(this.serializer,a))};this.sendRequest(b)}}class qz{}class qA extends qz{constructor(a,b,c,d){super(),this.authCredentials=a,this.appCheckCredentials=b,this.connection=c,this.serializer=d,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new ev(eu.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(a,b,c,d){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,f])=>this.connection.invokeRPC(a,k8(b,c),d,e,f)).catch(a=>{if("FirebaseError"===a.name)throw a.code===eu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new ev(eu.UNKNOWN,a.toString())})}invokeStreamingRPC(a,b,c,d,e){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,g])=>this.connection.invokeStreamingRPC(a,k8(b,c),d,f,g,e)).catch(a=>{if("FirebaseError"===a.name)throw a.code===eu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new ev(eu.UNKNOWN,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function qB(a,b,c,d){return new qA(a,b,c,d)}async function qC(a,b){let c=et(a),d={writes:b.map(a=>lq(c.serializer,a))};await c.invokeRPC("Commit",c.serializer.databaseId,eR.emptyPath(),d)}async function qD(a,b){let c=et(a),d={documents:b.map(a=>la(c.serializer,a))},e=await c.invokeStreamingRPC("BatchGetDocuments",c.serializer.databaseId,eR.emptyPath(),d,b.length),f=new Map;e.forEach(a=>{let b=lm(c.serializer,a);f.set(b.key.toString(),b)});let g=[];return b.forEach(a=>{let b=f.get(a.toString());es(!!b,55234,{key:a}),g.push(b)}),g}async function qE(a,b,c){let d=et(a),{request:e,aliasMap:f,parent:g}=lB(d.serializer,ji(b),c);d.connection.shouldResourcePathBeIncludedInRequest||delete e.parent;let h=(await d.invokeStreamingRPC("RunAggregationQuery",d.serializer.databaseId,g,e,1)).filter(a=>!!a.result);es(1===h.length,64727);let i=h[0].result?.aggregateFields;return Object.keys(i).reduce((a,b)=>(a[f[b]]=i[b],a),{})}function qF(a,b,c){let d=et(a);return d.verifyInitialized(),new qy(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}function qG(a,b,c){let d=et(a);return d.verifyInitialized(),new qx(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}let qH="OnlineStateTracker",qI=1,qJ=1e4;class qK{constructor(a,b){this.asyncQueue=a,this.onlineStateHandler=b,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",qJ,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${qJ/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(a){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=qI&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${qI} times. Most recent error: ${a.toString()}`),this.setAndBroadcast("Offline")))}set(a){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===a&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(a)}setAndBroadcast(a){a!==this.state&&(this.state=a,this.onlineStateHandler(a))}logClientOfflineWarningIfNecessary(a){let b=`Could not reach Cloud Firestore backend. ${a}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(en(b),this.shouldWarnClientIsOffline=!1):em(qH,b)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let qL="RemoteStore",qM=10;class qN{constructor(a,b,c,d,e){this.localStore=a,this.datastore=b,this.asyncQueue=c,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=e,this.connectivityMonitor.addCallback(a=>{c.enqueueAndForget(async()=>{q$(this)&&(em(qL,"Restarting streams for network reachability change."),await ri(this))})}),this.onlineStateTracker=new qK(c,d)}}function qO(a,b,c,d,e){return new qN(a,b,c,d,e)}function qP(a){let b=et(a);return b.offlineCauses.delete(0),qQ(b)}async function qQ(a){if(q$(a))for(let b of a.onNetworkStatusChange)await b(!0)}async function qR(a){let b=et(a);b.offlineCauses.add(0),await qS(b),b.onlineStateTracker.set("Offline")}async function qS(a){for(let b of a.onNetworkStatusChange)await b(!1)}async function qT(a){let b=et(a);em(qL,"RemoteStore shutting down."),b.offlineCauses.add(5),await qS(b),b.connectivityMonitor.shutdown(),b.onlineStateTracker.set("Unknown")}function qU(a,b){let c=et(a);!c.listenTargets.has(b.targetId)&&(c.listenTargets.set(b.targetId,b),qZ(c)?qY(c):rl(c).isOpen()&&qW(c,b))}function qV(a,b){let c=et(a),d=rl(c);c.listenTargets.delete(b),d.isOpen()&&qX(c,b),0===c.listenTargets.size&&(d.isOpen()?d.markIdle():q$(c)&&c.onlineStateTracker.set("Unknown"))}function qW(a,b){if(a.watchChangeAggregator.recordPendingTargetRequest(b.targetId),b.resumeToken.approximateByteSize()>0||b.snapshotVersion.compareTo(e5.min())>0){let c=a.remoteSyncer.getRemoteKeysForTarget(b.targetId).size;b=b.withExpectedCount(c)}rl(a).watch(b)}function qX(a,b){a.watchChangeAggregator.recordPendingTargetRequest(b),rl(a).unwatch(b)}function qY(a){a.watchChangeAggregator=new kS({getRemoteKeysForTarget:b=>a.remoteSyncer.getRemoteKeysForTarget(b),getTargetDataForTarget:b=>a.listenTargets.get(b)||null,getDatabaseId:()=>a.datastore.serializer.databaseId}),rl(a).start(),a.onlineStateTracker.handleWatchStreamStart()}function qZ(a){return q$(a)&&!rl(a).isStarted()&&a.listenTargets.size>0}function q$(a){return 0===et(a).offlineCauses.size}function q_(a){a.watchChangeAggregator=void 0}async function q0(a){a.onlineStateTracker.set("Online")}async function q1(a){a.listenTargets.forEach((b,c)=>{qW(a,b)})}async function q2(a,b){q_(a),qZ(a)?(a.onlineStateTracker.handleWatchStreamFailure(b),qY(a)):a.onlineStateTracker.set("Unknown")}async function q3(a,b,c){if(a.onlineStateTracker.set("Online"),b instanceof kP&&2===b.state&&b.cause){try{await q7(a,b)}catch(c){em(qL,"Failed to remove targets %s: %s ",b.targetIds.join(","),c),await q4(a,c)}return}if(b instanceof kN?a.watchChangeAggregator.handleDocumentChange(b):b instanceof kO?a.watchChangeAggregator.handleExistenceFilter(b):a.watchChangeAggregator.handleTargetChange(b),!c.isEqual(e5.min()))try{let b=await pf(a.localStore);c.compareTo(b)>=0&&await q6(a,c)}catch(b){em(qL,"Failed to raise snapshot:",b),await q4(a,b)}}async function q4(a,b,c){if(fw(b))a.offlineCauses.add(1),await qS(a),a.onlineStateTracker.set("Offline"),c||(c=()=>pf(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{em(qL,"Retrying IndexedDB access"),await c(),a.offlineCauses.delete(1),await qQ(a)});else throw b}function q5(a,b){return b().catch(c=>q4(a,c,b))}function q6(a,b){let c=a.watchChangeAggregator.createRemoteEvent(b);return c.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let e=a.listenTargets.get(d);e&&a.listenTargets.set(d,e.withResumeToken(c.resumeToken,b))}}),c.targetMismatches.forEach((b,c)=>{let d=a.listenTargets.get(b);d&&(a.listenTargets.set(b,d.withResumeToken(ha.EMPTY_BYTE_STRING,d.snapshotVersion)),qX(a,b),qW(a,new l7(d.target,b,c,d.sequenceNumber)))}),a.remoteSyncer.applyRemoteEvent(c)}async function q7(a,b){let c=b.cause;for(let d of b.targetIds)a.listenTargets.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.listenTargets.delete(d),a.watchChangeAggregator.removeTarget(d))}async function q8(a){let b=et(a),c=rm(b),d=b.writePipeline.length>0?b.writePipeline[b.writePipeline.length-1].batchId:ht;for(;q9(b);)try{let a=await pk(b.localStore,d);if(null===a){0===b.writePipeline.length&&c.markIdle();break}d=a.batchId,ra(b,a)}catch(a){await q4(b,a)}rb(b)&&rc(b)}function q9(a){return q$(a)&&a.writePipeline.length<qM}function ra(a,b){a.writePipeline.push(b);let c=rm(a);c.isOpen()&&c.handshakeComplete&&c.writeMutations(b.mutations)}function rb(a){return q$(a)&&!rm(a).isStarted()&&a.writePipeline.length>0}function rc(a){rm(a).start()}async function rd(a){rm(a).writeHandshake()}async function re(a){let b=rm(a);for(let c of a.writePipeline)b.writeMutations(c.mutations)}async function rf(a,b,c){let d=a.writePipeline.shift(),e=kv.from(d,b,c);await q5(a,()=>a.remoteSyncer.applySuccessfulWrite(e)),await q8(a)}async function rg(a,b){b&&rm(a).handshakeComplete&&await rh(a,b),rb(a)&&rc(a)}async function rh(a,b){if(kz(b.code)){let c=a.writePipeline.shift();rm(a).inhibitBackoff(),await q5(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,b)),await q8(a)}}async function ri(a){let b=et(a);b.offlineCauses.add(4),await qS(b),b.onlineStateTracker.set("Unknown"),b.offlineCauses.delete(4),await qQ(b)}async function rj(a,b){let c=et(a);c.asyncQueue.verifyOperationInProgress(),em(qL,"RemoteStore received new credentials");let d=q$(c);c.offlineCauses.add(3),await qS(c),d&&c.onlineStateTracker.set("Unknown"),await c.remoteSyncer.handleCredentialChange(b),c.offlineCauses.delete(3),await qQ(c)}async function rk(a,b){let c=et(a);b?(c.offlineCauses.delete(2),await qQ(c)):b||(c.offlineCauses.add(2),await qS(c),c.onlineStateTracker.set("Unknown"))}function rl(a){return a.watchStream||(a.watchStream=qG(a.datastore,a.asyncQueue,{onConnected:q0.bind(null,a),onOpen:q1.bind(null,a),onClose:q2.bind(null,a),onWatchChange:q3.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.watchStream.inhibitBackoff(),qZ(a)?qY(a):a.onlineStateTracker.set("Unknown")):(await a.watchStream.stop(),q_(a))})),a.watchStream}function rm(a){return a.writeStream||(a.writeStream=qF(a.datastore,a.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:rd.bind(null,a),onClose:rg.bind(null,a),onHandshakeComplete:re.bind(null,a),onMutationResult:rf.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.writeStream.inhibitBackoff(),await q8(a)):(await a.writeStream.stop(),a.writePipeline.length>0&&(em(qL,`Stopping write stream with ${a.writePipeline.length} pending writes`),a.writePipeline=[]))})),a.writeStream}let rn="AsyncQueue";class ro{constructor(a,b,c,d,e){this.asyncQueue=a,this.timerId=b,this.targetTimeMs=c,this.op=d,this.removalCallback=e,this.deferred=new ew,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(a,b,c,d,e){let f=new ro(a,b,Date.now()+c,d,e);return f.start(c),f}start(a){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),a)}skipDelay(){return this.handleDelayElapsed()}cancel(a){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ev(eu.CANCELLED,"Operation cancelled"+(a?": "+a:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rp(a,b){if(en(rn,`${b}: ${a}`),fw(a))return new ev(eu.UNAVAILABLE,`${b}: ${a}`);throw a}class rq{static emptySet(a){return new rq(a.comparator)}constructor(a){a?this.comparator=(b,c)=>a(b,c)||eU.comparator(b.key,c.key):this.comparator=(a,b)=>eU.comparator(a.key,b.key),this.keyedMap=jE(),this.sortedSet=new g_(this.comparator)}has(a){return null!=this.keyedMap.get(a)}get(a){return this.keyedMap.get(a)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(a){let b=this.keyedMap.get(a);return b?this.sortedSet.indexOf(b):-1}get size(){return this.sortedSet.size}forEach(a){this.sortedSet.inorderTraversal((b,c)=>(a(b),!1))}add(a){let b=this.delete(a.key);return b.copy(b.keyedMap.insert(a.key,a),b.sortedSet.insert(a,null))}delete(a){let b=this.get(a);return b?this.copy(this.keyedMap.remove(a),this.sortedSet.remove(b)):this}isEqual(a){if(!(a instanceof rq)||this.size!==a.size)return!1;let b=this.sortedSet.getIterator(),c=a.sortedSet.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(!a.isEqual(d))return!1}return!0}toString(){let a=[];return(this.forEach(b=>{a.push(b.toString())}),0===a.length)?"DocumentSet ()":"DocumentSet (\n  "+a.join("  \n")+"\n)"}copy(a,b){let c=new rq;return c.comparator=this.comparator,c.keyedMap=a,c.sortedSet=b,c}}class rr{constructor(){this.changeMap=new g_(eU.comparator)}track(a){let b=a.doc.key,c=this.changeMap.get(b);if(!c){this.changeMap=this.changeMap.insert(b,a);return}0!==a.type&&3===c.type?this.changeMap=this.changeMap.insert(b,a):3===a.type&&1!==c.type?this.changeMap=this.changeMap.insert(b,{type:c.type,doc:a.doc}):2===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):2===a.type&&0===c.type?this.changeMap=this.changeMap.insert(b,{type:0,doc:a.doc}):1===a.type&&0===c.type?this.changeMap=this.changeMap.remove(b):1===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:1,doc:c.doc}):0===a.type&&1===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):eq(63341,{change:a,oldChange:c})}getChanges(){let a=[];return this.changeMap.inorderTraversal((b,c)=>{a.push(c)}),a}}class rs{constructor(a,b,c,d,e,f,g,h,i){this.query=a,this.docs=b,this.oldDocs=c,this.docChanges=d,this.mutatedKeys=e,this.fromCache=f,this.syncStateChanged=g,this.excludesMetadataChanges=h,this.hasCachedResults=i}static fromInitialDocuments(a,b,c,d,e){let f=[];return b.forEach(a=>{f.push({type:0,doc:a})}),new rs(a,b,rq.emptySet(b),f,c,d,!0,!1,e)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(a){if(this.fromCache!==a.fromCache||this.hasCachedResults!==a.hasCachedResults||this.syncStateChanged!==a.syncStateChanged||!this.mutatedKeys.isEqual(a.mutatedKeys)||!jp(this.query,a.query)||!this.docs.isEqual(a.docs)||!this.oldDocs.isEqual(a.oldDocs))return!1;let b=this.docChanges,c=a.docChanges;if(b.length!==c.length)return!1;for(let a=0;a<b.length;a++)if(b[a].type!==c[a].type||!b[a].doc.isEqual(c[a].doc))return!1;return!0}}class rt{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(a=>a.listensToRemoteStore())}}function ru(){return new rv}class rv{constructor(){this.queries=rw(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){rE(this,new ev(eu.ABORTED,"Firestore shutting down"))}}function rw(){return new jA(a=>jq(a),jp)}async function rx(a,b){let c=et(a),d=3,e=b.query,f=c.queries.get(e);f?!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(d=2):(f=new rt,d=+!b.listensToRemoteStore());try{switch(d){case 0:f.viewSnap=await c.onListen(e,!0);break;case 1:f.viewSnap=await c.onListen(e,!1);break;case 2:await c.onFirstRemoteStoreListen(e)}}catch(c){let a=rp(c,`Initialization of query '${jr(b.query)}' failed`);b.onError(a);return}c.queries.set(e,f),f.listeners.push(b),b.applyOnlineStateChange(c.onlineState),f.viewSnap&&b.onViewSnapshot(f.viewSnap)&&rF(c)}async function ry(a,b){let c=et(a),d=b.query,e=3,f=c.queries.get(d);if(f){let a=f.listeners.indexOf(b);a>=0&&(f.listeners.splice(a,1),0===f.listeners.length?e=+!b.listensToRemoteStore():!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(e=2))}switch(e){case 0:return c.queries.delete(d),c.onUnlisten(d,!0);case 1:return c.queries.delete(d),c.onUnlisten(d,!1);case 2:return c.onLastRemoteStoreUnlisten(d);default:return}}function rz(a,b){let c=et(a),d=!1;for(let a of b){let b=a.query,e=c.queries.get(b);if(e){for(let b of e.listeners)b.onViewSnapshot(a)&&(d=!0);e.viewSnap=a}}d&&rF(c)}function rA(a,b,c){let d=et(a),e=d.queries.get(b);if(e)for(let a of e.listeners)a.onError(c);d.queries.delete(b)}function rB(a,b){let c=et(a);c.onlineState=b;let d=!1;c.queries.forEach((a,c)=>{for(let a of c.listeners)a.applyOnlineStateChange(b)&&(d=!0)}),d&&rF(c)}function rC(a,b){et(a).snapshotsInSyncListeners.add(b),b.next()}function rD(a,b){et(a).snapshotsInSyncListeners.delete(b)}function rE(a,b){let c=et(a),d=c.queries;c.queries=rw(),d.forEach((a,c)=>{for(let a of c.listeners)a.onError(b)})}function rF(a){a.snapshotsInSyncListeners.forEach(a=>{a.next()})}!function(a){a.Default="default",a.Cache="cache"}(n||(n={}));class rG{constructor(a,b,c){this.query=a,this.queryObserver=b,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=c||{}}onViewSnapshot(a){if(!this.options.includeMetadataChanges){let b=[];for(let c of a.docChanges)3!==c.type&&b.push(c);a=new rs(a.query,a.docs,a.oldDocs,b,a.mutatedKeys,a.fromCache,a.syncStateChanged,!0,a.hasCachedResults)}let b=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(a)&&(this.queryObserver.next(a),b=!0):this.shouldRaiseInitialEvent(a,this.onlineState)&&(this.raiseInitialEvent(a),b=!0),this.snap=a,b}onError(a){this.queryObserver.error(a)}applyOnlineStateChange(a){this.onlineState=a;let b=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,a)&&(this.raiseInitialEvent(this.snap),b=!0),b}shouldRaiseInitialEvent(a,b){if(!a.fromCache||!this.listensToRemoteStore())return!0;let c="Offline"!==b;return(!this.options.waitForSyncWhenOnline||!c)&&(!a.docs.isEmpty()||a.hasCachedResults||"Offline"===b)}shouldRaiseEvent(a){if(a.docChanges.length>0)return!0;let b=this.snap&&this.snap.hasPendingWrites!==a.hasPendingWrites;return(!!a.syncStateChanged||!!b)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(a){a=rs.fromInitialDocuments(a.query,a.docs,a.mutatedKeys,a.fromCache,a.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(a)}listensToRemoteStore(){return this.options.source!==n.Cache}}class rH{constructor(a,b,c,d){this.targetId=a,this.fromCache=b,this.addedKeys=c,this.removedKeys=d}static fromSnapshot(a,b){let c=jN(),d=jN();for(let a of b.docChanges)switch(a.type){case 0:c=c.add(a.doc.key);break;case 1:d=d.add(a.doc.key)}return new rH(a,b.fromCache,c,d)}}class rI{constructor(a){this.serializer=a}toDocumentKey(a){return lb(this.serializer,a)}toMutableDocument(a){return a.metadata.exists?lj(this.serializer,a.document,!1):im.newNoDocument(this.toDocumentKey(a.metadata.name),this.toSnapshotVersion(a.metadata.readTime))}toSnapshotVersion(a){return k6(a)}}class rJ{constructor(a,b){this.bundleMetadata=a,this.serializer=b,this._queries=[],this._documents=[],this.collectionGroups=new Set,this.progress=rK(a)}get queries(){return this._queries}get documents(){return this._documents}addSizedElement(a){this.progress.bytesLoaded+=a.byteLength;let b=this.progress.documentsLoaded;if(a.payload.namedQuery)this._queries.push(a.payload.namedQuery);else if(a.payload.documentMetadata){this._documents.push({metadata:a.payload.documentMetadata}),!a.payload.documentMetadata.exists&&++b;let c=eR.fromString(a.payload.documentMetadata.name);this.collectionGroups.add(c.get(c.length-2))}else a.payload.document&&(this._documents[this._documents.length-1].document=a.payload.document,++b);return b!==this.progress.documentsLoaded?(this.progress.documentsLoaded=b,{...this.progress}):null}getQueryDocumentMapping(a){let b=new Map,c=new rI(this.serializer);for(let d of a)if(d.metadata.queries){let a=c.toDocumentKey(d.metadata.name);for(let c of d.metadata.queries){let d=(b.get(c)||jN()).add(a);b.set(c,d)}}return b}async completeAndStoreAsync(a){let b=await py(a,new rI(this.serializer),this._documents,this.bundleMetadata.id),c=this.getQueryDocumentMapping(this.documents);for(let b of this._queries)await pC(a,b,c.get(b.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:b}}}function rK(a){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}function rL(a){return{taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}class rM{constructor(a){this.key=a}}class rN{constructor(a){this.key=a}}class rO{constructor(a,b){this.query=a,this._syncedDocuments=b,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=jN(),this.mutatedKeys=jN(),this.docComparator=jy(a),this.documentSet=new rq(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(a,b){let c=b?b.changeSet:new rr,d=b?b.documentSet:this.documentSet,e=b?b.mutatedKeys:this.mutatedKeys,f=d,g=!1,h="F"===this.query.limitType&&d.size===this.query.limit?d.last():null,i="L"===this.query.limitType&&d.size===this.query.limit?d.first():null;if(a.inorderTraversal((a,b)=>{let j=d.get(a),k=js(this.query,b)?b:null,l=!!j&&this.mutatedKeys.has(j.key),m=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations),n=!1;j&&k?j.data.isEqual(k.data)?l!==m&&(c.track({type:3,doc:k}),n=!0):!this.shouldWaitForSyncedDocument(j,k)&&(c.track({type:2,doc:k}),n=!0,(h&&this.docComparator(k,h)>0||i&&0>this.docComparator(k,i))&&(g=!0)):!j&&k?(c.track({type:0,doc:k}),n=!0):j&&!k&&(c.track({type:1,doc:j}),n=!0,(h||i)&&(g=!0)),n&&(k?(f=f.add(k),e=m?e.add(a):e.delete(a)):(f=f.delete(a),e=e.delete(a)))}),null!==this.query.limit)for(;f.size>this.query.limit;){let a="F"===this.query.limitType?f.last():f.first();f=f.delete(a.key),e=e.delete(a.key),c.track({type:1,doc:a})}return{documentSet:f,changeSet:c,needsRefill:g,mutatedKeys:e}}shouldWaitForSyncedDocument(a,b){return a.hasLocalMutations&&b.hasCommittedMutations&&!b.hasLocalMutations}applyChanges(a,b,c,d){let e=this.documentSet;this.documentSet=a.documentSet,this.mutatedKeys=a.mutatedKeys;let f=a.changeSet.getChanges();f.sort((a,b)=>rP(a.type,b.type)||this.docComparator(a.doc,b.doc)),this.applyTargetChange(c),d=d??!1;let g=b&&!d?this.updateLimboDocuments():[],h=+!!(0===this.limboDocuments.size&&this.current&&!d),i=h!==this.syncState;return(this.syncState=h,0!==f.length||i)?{snapshot:new rs(this.query,a.documentSet,e,f,a.mutatedKeys,0===h,i,!1,!!c&&c.resumeToken.approximateByteSize()>0),limboChanges:g}:{limboChanges:g}}applyOnlineStateChange(a){return this.current&&"Offline"===a?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new rr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(a){return!this._syncedDocuments.has(a)&&!!this.documentSet.has(a)&&!this.documentSet.get(a).hasLocalMutations}applyTargetChange(a){a&&(a.addedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.add(a)),a.modifiedDocuments.forEach(a=>{}),a.removedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.delete(a)),this.current=a.current)}updateLimboDocuments(){if(!this.current)return[];let a=this.limboDocuments;this.limboDocuments=jN(),this.documentSet.forEach(a=>{this.shouldBeInLimbo(a.key)&&(this.limboDocuments=this.limboDocuments.add(a.key))});let b=[];return a.forEach(a=>{this.limboDocuments.has(a)||b.push(new rN(a))}),this.limboDocuments.forEach(c=>{a.has(c)||b.push(new rM(c))}),b}synchronizeWithPersistedState(a){this._syncedDocuments=a.remoteKeys,this.limboDocuments=jN();let b=this.computeDocChanges(a.documents);return this.applyChanges(b,!0)}computeInitialSnapshot(){return rs.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function rP(a,b){let c=a=>{switch(a){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return eq(20277,{change:a})}};return c(a)-c(b)}let rQ="SyncEngine";class rR{constructor(a,b,c){this.query=a,this.targetId=b,this.view=c}}class rS{constructor(a){this.key=a,this.receivedDocument=!1}}class rT{constructor(a,b,c,d,e,f){this.localStore=a,this.remoteStore=b,this.eventManager=c,this.sharedClientState=d,this.currentUser=e,this.maxConcurrentLimboResolutions=f,this.syncEngineListener={},this.queryViewsByQuery=new jA(a=>jq(a),jp),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new g_(eU.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new om,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=nM.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function rU(a,b,c,d,e,f,g){let h=new rT(a,b,c,d,e,f);return g&&(h._isPrimaryClient=!0),h}async function rV(a,b,c=!0){let d,e=st(a),f=e.queryViewsByQuery.get(b);return f?(e.sharedClientState.addLocalQueryTarget(f.targetId),d=f.view.computeInitialSnapshot()):d=await rX(e,b,c,!0),d}async function rW(a,b){let c=st(a);await rX(c,b,!0,!1)}async function rX(a,b,c,d){let e,f=await pm(a.localStore,jh(b)),g=f.targetId,h=a.sharedClientState.addLocalQueryTarget(g,c);return d&&(e=await rY(a,b,g,"current"===h,f.resumeToken)),a.isPrimaryClient&&c&&qU(a.remoteStore,f),e}async function rY(a,b,c,d,e){a.applyDocChanges=(b,c,d)=>sg(a,b,c,d);let f=await pp(a.localStore,b,!0),g=new rO(b,f.remoteKeys),h=g.computeDocChanges(f.documents),i=kM.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==a.onlineState,e),j=g.applyChanges(h,a.isPrimaryClient,i);sc(a,c,j.limboChanges);let k=new rR(b,c,g);return a.queryViewsByQuery.set(b,k),a.queriesByTarget.has(c)?a.queriesByTarget.get(c).push(b):a.queriesByTarget.set(c,[b]),j.snapshot}async function rZ(a,b,c){let d=et(a),e=d.queryViewsByQuery.get(b),f=d.queriesByTarget.get(e.targetId);if(f.length>1){d.queriesByTarget.set(e.targetId,f.filter(a=>!jp(a,b))),d.queryViewsByQuery.delete(b);return}d.isPrimaryClient?(d.sharedClientState.removeLocalQueryTarget(e.targetId),d.sharedClientState.isActiveQueryTarget(e.targetId)||await po(d.localStore,e.targetId,!1).then(()=>{d.sharedClientState.clearQueryState(e.targetId),c&&qV(d.remoteStore,e.targetId),sa(d,e.targetId)}).catch(fn)):(sa(d,e.targetId),await po(d.localStore,e.targetId,!0))}async function r$(a,b){let c=et(a),d=c.queryViewsByQuery.get(b),e=c.queriesByTarget.get(d.targetId);c.isPrimaryClient&&1===e.length&&(c.sharedClientState.removeLocalQueryTarget(d.targetId),qV(c.remoteStore,d.targetId))}async function r_(a,b,c){let d=su(a);try{let a=await pa(d.localStore,b);d.sharedClientState.addPendingMutation(a.batchId),r8(d,a.batchId,c),await sf(d,a.changes),await q8(d.remoteStore)}catch(b){let a=rp(b,"Failed to persist write");c.reject(a)}}async function r0(a,b){let c=et(a);try{let a=await pg(c.localStore,b);b.targetChanges.forEach((a,b)=>{let d=c.activeLimboResolutionsByTarget.get(b);d&&(es(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.receivedDocument=!0:a.modifiedDocuments.size>0?es(d.receivedDocument,14607):a.removedDocuments.size>0&&(es(d.receivedDocument,42227),d.receivedDocument=!1))}),await sf(c,a,b)}catch(a){await fn(a)}}function r1(a,b,c){let d=et(a);if(d.isPrimaryClient&&0===c||!d.isPrimaryClient&&1===c){let a=[];d.queryViewsByQuery.forEach((c,d)=>{let e=d.view.applyOnlineStateChange(b);e.snapshot&&a.push(e.snapshot)}),rB(d.eventManager,b),a.length&&d.syncEngineListener.onWatchChange(a),d.onlineState=b,d.isPrimaryClient&&d.sharedClientState.setOnlineState(b)}}async function r2(a,b,c){let d=et(a);d.sharedClientState.updateQueryState(b,"rejected",c);let e=d.activeLimboResolutionsByTarget.get(b),f=e&&e.key;if(f){let a=new g_(eU.comparator);a=a.insert(f,im.newNoDocument(f,e5.min()));let c=jN().add(f),e=new kL(e5.min(),new Map,new g_(eI),a,c);await r0(d,e),d.activeLimboTargetsByKey=d.activeLimboTargetsByKey.remove(f),d.activeLimboResolutionsByTarget.delete(b),se(d)}else await po(d.localStore,b,!1).then(()=>sa(d,b,c)).catch(fn)}async function r3(a,b){let c=et(a),d=b.batch.batchId;try{let a=await pb(c.localStore,b);r9(c,d,null),r6(c,d),c.sharedClientState.updateMutationState(d,"acknowledged"),await sf(c,a)}catch(a){await fn(a)}}async function r4(a,b,c){let d=et(a);try{let a=await pd(d.localStore,b);r9(d,b,c),r6(d,b),d.sharedClientState.updateMutationState(b,"rejected",c),await sf(d,a)}catch(a){await fn(a)}}async function r5(a,b){let c=et(a);q$(c.remoteStore)||em(rQ,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let a=await pe(c.localStore);if(a===ht)return void b.resolve();let d=c.pendingWritesCallbacks.get(a)||[];d.push(b),c.pendingWritesCallbacks.set(a,d)}catch(c){let a=rp(c,"Initialization of waitForPendingWrites() operation failed");b.reject(a)}}function r6(a,b){(a.pendingWritesCallbacks.get(b)||[]).forEach(a=>{a.resolve()}),a.pendingWritesCallbacks.delete(b)}function r7(a,b){a.pendingWritesCallbacks.forEach(a=>{a.forEach(a=>{a.reject(new ev(eu.CANCELLED,b))})}),a.pendingWritesCallbacks.clear()}function r8(a,b,c){let d=a.mutationUserCallbacks[a.currentUser.toKey()];d||(d=new g_(eI)),d=d.insert(b,c),a.mutationUserCallbacks[a.currentUser.toKey()]=d}function r9(a,b,c){let d=et(a),e=d.mutationUserCallbacks[d.currentUser.toKey()];if(e){let a=e.get(b);a&&(c?a.reject(c):a.resolve(),e=e.remove(b)),d.mutationUserCallbacks[d.currentUser.toKey()]=e}}function sa(a,b,c=null){for(let d of(a.sharedClientState.removeLocalQueryTarget(b),a.queriesByTarget.get(b)))a.queryViewsByQuery.delete(d),c&&a.syncEngineListener.onWatchError(d,c);a.queriesByTarget.delete(b),a.isPrimaryClient&&a.limboDocumentRefs.removeReferencesForId(b).forEach(b=>{a.limboDocumentRefs.containsKey(b)||sb(a,b)})}function sb(a,b){a.enqueuedLimboResolutions.delete(b.path.canonicalString());let c=a.activeLimboTargetsByKey.get(b);null!==c&&(qV(a.remoteStore,c),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.remove(b),a.activeLimboResolutionsByTarget.delete(c),se(a))}function sc(a,b,c){for(let d of c)d instanceof rM?(a.limboDocumentRefs.addReference(d.key,b),sd(a,d)):d instanceof rN?(em(rQ,"Document no longer in limbo: "+d.key),a.limboDocumentRefs.removeReference(d.key,b),a.limboDocumentRefs.containsKey(d.key)||sb(a,d.key)):eq(19791,{limboChange:d})}function sd(a,b){let c=b.key,d=c.path.canonicalString();a.activeLimboTargetsByKey.get(c)||a.enqueuedLimboResolutions.has(d)||(em(rQ,"New document in limbo: "+c),a.enqueuedLimboResolutions.add(d),se(a))}function se(a){for(;a.enqueuedLimboResolutions.size>0&&a.activeLimboTargetsByKey.size<a.maxConcurrentLimboResolutions;){let b=a.enqueuedLimboResolutions.values().next().value;a.enqueuedLimboResolutions.delete(b);let c=new eU(eR.fromString(b)),d=a.limboTargetIdGenerator.next();a.activeLimboResolutionsByTarget.set(d,new rS(c)),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.insert(c,d),qU(a.remoteStore,new l7(jh(ja(c.path)),d,"TargetPurposeLimboResolution",fH.INVALID))}}async function sf(a,b,c){let d=et(a),e=[],f=[],g=[];d.queryViewsByQuery.isEmpty()||(d.queryViewsByQuery.forEach((a,h)=>{g.push(d.applyDocChanges(h,b,c).then(a=>{if((a||c)&&d.isPrimaryClient){let b=a?!a.fromCache:c?.targetChanges.get(h.targetId)?.current;d.sharedClientState.updateQueryState(h.targetId,b?"current":"not-current")}if(a){e.push(a);let b=rH.fromSnapshot(h.targetId,a);f.push(b)}}))}),await Promise.all(g),d.syncEngineListener.onWatchChange(e),await pj(d.localStore,f))}async function sg(a,b,c,d){let e=b.view.computeDocChanges(c);e.needsRefill&&(e=await pp(a.localStore,b.query,!1).then(({documents:a})=>b.view.computeDocChanges(a,e)));let f=d&&d.targetChanges.get(b.targetId),g=d&&null!=d.targetMismatches.get(b.targetId),h=b.view.applyChanges(e,a.isPrimaryClient,f,g);return sc(a,b.targetId,h.limboChanges),h.snapshot}async function sh(a,b){let c=et(a);if(!c.currentUser.isEqual(b)){em(rQ,"User change. New user:",b.toKey());let a=await o9(c.localStore,b);c.currentUser=b,r7(c,"'waitForPendingWrites' promise is rejected due to a user change."),c.sharedClientState.handleUserChange(b,a.removedBatchIds,a.addedBatchIds),await sf(c,a.affectedDocuments)}}function si(a,b){let c=et(a),d=c.activeLimboResolutionsByTarget.get(b);if(d&&d.receivedDocument)return jN().add(d.key);{let a=jN(),d=c.queriesByTarget.get(b);if(!d)return a;for(let b of d){let d=c.queryViewsByQuery.get(b);a=a.unionWith(d.view.syncedDocuments)}return a}}async function sj(a,b){let c=et(a),d=await pp(c.localStore,b.query,!0),e=b.view.synchronizeWithPersistedState(d);return c.isPrimaryClient&&sc(c,b.targetId,e.limboChanges),e}async function sk(a,b){let c=et(a);return pv(c.localStore,b).then(a=>sf(c,a))}async function sl(a,b,c,d){let e=et(a),f=await pr(e.localStore,b);if(null===f)return void em(rQ,"Cannot apply mutation batch with id: "+b);"pending"===c?await q8(e.remoteStore):"acknowledged"===c||"rejected"===c?(r9(e,b,d||null),r6(e,b),ps(e.localStore,b)):eq(6720,"Unknown batchState",{batchState:c}),await sf(e,f)}async function sm(a,b){let c=et(a);if(st(c),su(c),!0===b&&!0!==c._isPrimaryClient){let a=c.sharedClientState.getAllActiveQueryTargets(),b=await so(c,a.toArray());for(let a of(c._isPrimaryClient=!0,await rk(c.remoteStore,!0),b))qU(c.remoteStore,a)}else if(!1===b&&!1!==c._isPrimaryClient){let a=[],b=Promise.resolve();c.queriesByTarget.forEach((d,e)=>{c.sharedClientState.isLocalQueryTarget(e)?a.push(e):b=b.then(()=>(sa(c,e),po(c.localStore,e,!0))),qV(c.remoteStore,e)}),await b,await so(c,a),sn(c),c._isPrimaryClient=!1,await rk(c.remoteStore,!1)}}function sn(a){let b=et(a);b.activeLimboResolutionsByTarget.forEach((a,c)=>{qV(b.remoteStore,c)}),b.limboDocumentRefs.removeAllReferences(),b.activeLimboResolutionsByTarget=new Map,b.activeLimboTargetsByKey=new g_(eU.comparator)}async function so(a,b,c){let d=et(a),e=[],f=[];for(let a of b){let b,c=d.queriesByTarget.get(a);if(c&&0!==c.length)for(let a of(b=await pm(d.localStore,jh(c[0])),c)){let b=d.queryViewsByQuery.get(a),c=await sj(d,b);c.snapshot&&f.push(c.snapshot)}else{let c=await pu(d.localStore,a);b=await pm(d.localStore,c),await rY(d,sp(c),a,!1,b.resumeToken)}e.push(b)}return d.syncEngineListener.onWatchChange(f),e}function sp(a){return i9(a.path,a.collectionGroup,a.orderBy,a.filters,a.limit,"F",a.startAt,a.endAt)}function sq(a){return pt(et(a).localStore)}async function sr(a,b,c,d){let e=et(a);if(e._isPrimaryClient)return void em(rQ,"Ignoring unexpected query state notification.");let f=e.queriesByTarget.get(b);if(f&&f.length>0)switch(c){case"current":case"not-current":{let a=await pv(e.localStore,jx(f[0])),d=kL.createSynthesizedRemoteEventForCurrentChange(b,"current"===c,ha.EMPTY_BYTE_STRING);await sf(e,a,d);break}case"rejected":await po(e.localStore,b,!0),sa(e,b,d);break;default:eq(64155,c)}}async function ss(a,b,c){let d=st(a);if(d._isPrimaryClient){for(let a of b){if(d.queriesByTarget.has(a)&&d.sharedClientState.isActiveQueryTarget(a)){em(rQ,"Adding an already active target "+a);continue}let b=await pu(d.localStore,a),c=await pm(d.localStore,b);await rY(d,sp(b),c.targetId,!1,c.resumeToken),qU(d.remoteStore,c)}for(let a of c)d.queriesByTarget.has(a)&&await po(d.localStore,a,!1).then(()=>{qV(d.remoteStore,a),sa(d,a)}).catch(fn)}}function st(a){let b=et(a);return b.remoteStore.remoteSyncer.applyRemoteEvent=r0.bind(null,b),b.remoteStore.remoteSyncer.getRemoteKeysForTarget=si.bind(null,b),b.remoteStore.remoteSyncer.rejectListen=r2.bind(null,b),b.syncEngineListener.onWatchChange=rz.bind(null,b.eventManager),b.syncEngineListener.onWatchError=rA.bind(null,b.eventManager),b}function su(a){let b=et(a);return b.remoteStore.remoteSyncer.applySuccessfulWrite=r3.bind(null,b),b.remoteStore.remoteSyncer.rejectFailedWrite=r4.bind(null,b),b}function sv(a,b,c){let d=et(a);sw(d,b,c).then(a=>{d.sharedClientState.notifyBundleLoaded(a)})}async function sw(a,b,c){try{let d=await b.getMetadata();if(await pz(a.localStore,d))return await b.close(),c._completeWith(rL(d)),Promise.resolve(new Set);c._updateProgress(rK(d));let e=new rJ(d,b.serializer),f=await b.nextElement();for(;f;){let a=await e.addSizedElement(f);a&&c._updateProgress(a),f=await b.nextElement()}let g=await e.completeAndStoreAsync(a.localStore);return await sf(a,g.changedDocs,void 0),await pA(a.localStore,d),c._completeWith(g.progress),Promise.resolve(g.changedCollectionGroups)}catch(a){return eo(rQ,`Loading bundle failed with ${a}`),c._failWith(a),Promise.resolve(new Set)}}class sx{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(a){this.serializer=qn(a.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(a),this.persistence=this.createPersistence(a),await this.persistence.start(),this.localStore=this.createLocalStore(a),this.gcScheduler=this.createGarbageCollectionScheduler(a,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(a,this.localStore)}createGarbageCollectionScheduler(a,b){return null}createIndexBackfillerScheduler(a,b){return null}createLocalStore(a){return o8(this.persistence,new pJ,a.initialUser,this.serializer)}createPersistence(a){return new ow(oy.factory,this.serializer)}createSharedClientState(a){return new p2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sx.provider={build:()=>new sx};class sy extends sx{constructor(a){super(),this.cacheSizeBytes=a}createGarbageCollectionScheduler(a,b){return es(this.persistence.referenceDelegate instanceof oz,46915),new n_(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createPersistence(a){let b=void 0!==this.cacheSizeBytes?nU.withCacheSize(this.cacheSizeBytes):nU.DEFAULT;return new ow(a=>oz.factory(a,b),this.serializer)}}class sz extends sx{constructor(a,b,c){super(),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.forceOwnership=c,this.kind="persistent",this.synchronizeTabs=!1}async initialize(a){await super.initialize(a),await this.onlineComponentProvider.initialize(this,a),await su(this.onlineComponentProvider.syncEngine),await q8(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(a){return o8(this.persistence,new pJ,a.initialUser,this.serializer)}createGarbageCollectionScheduler(a,b){return new n_(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createIndexBackfillerScheduler(a,b){let c=new fG(b,this.persistence);return new fF(a.asyncQueue,c)}createPersistence(a){let b=o2(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey),c=void 0!==this.cacheSizeBytes?nU.withCacheSize(this.cacheSizeBytes):nU.DEFAULT;return new o_(this.synchronizeTabs,b,a.clientId,c,a.asyncQueue,ql(),qm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(a){return new p2}}class sA extends sz{constructor(a,b){super(a,b,!1),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.synchronizeTabs=!0}async initialize(a){await super.initialize(a);let b=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof p0&&(this.sharedClientState.syncEngine={applyBatchState:sl.bind(null,b),applyTargetState:sr.bind(null,b),applyActiveTargetsChange:ss.bind(null,b),getActiveClients:sq.bind(null,b),synchronizeWithChangedDocuments:sk.bind(null,b)},await this.sharedClientState.start()),await this.persistence.setPrimaryStateListener(async a=>{await sm(this.onlineComponentProvider.syncEngine,a),this.gcScheduler&&(a&&!this.gcScheduler.started?this.gcScheduler.start():a||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(a&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():a||this.indexBackfillerScheduler.stop())})}createSharedClientState(a){let b=ql();if(!p0.isAvailable(b))throw new ev(eu.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let c=o2(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey);return new p0(b,a.asyncQueue,c,a.clientId,a.initialUser)}}class sB{async initialize(a,b){this.localStore||(this.localStore=a.localStore,this.sharedClientState=a.sharedClientState,this.datastore=this.createDatastore(b),this.remoteStore=this.createRemoteStore(b),this.eventManager=this.createEventManager(b),this.syncEngine=this.createSyncEngine(b,!a.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>r1(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=sh.bind(null,this.syncEngine),await rk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(a){return ru()}createDatastore(a){let b=qn(a.databaseInfo.databaseId),c=qj(a.databaseInfo);return qB(a.authCredentials,a.appCheckCredentials,c,b)}createRemoteStore(a){return qO(this.localStore,this.datastore,a.asyncQueue,a=>r1(this.syncEngine,a,0),qk())}createSyncEngine(a,b){return rU(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,a.initialUser,a.maxConcurrentLimboResolutions,b)}async terminate(){await qT(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}sB.provider={build:()=>new sB};let sC=10240;function sD(a,b=sC){let c=0;return{async read(){if(c<a.byteLength){let d={value:a.slice(c,c+b),done:!1};return c+=b,d}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}function sE(a,b){if(!(a instanceof Uint8Array))throw new ev(eu.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${eZ(a)}`);return sD(a,b)}class sF{constructor(a){this.observer=a,this.muted=!1}next(a){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,a)}error(a){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,a):en("Uncaught Error in snapshot listener:",a.toString()))}mute(){this.muted=!0}scheduleEvent(a,b){setTimeout(()=>{this.muted||a(b)},0)}}class sG{constructor(a,b){this.payload=a,this.byteLength=b}isBundleMetadata(){return"metadata"in this.payload}}class sH{constructor(a,b){this.reader=a,this.serializer=b,this.metadata=new ew,this.buffer=new Uint8Array,this.textDecoder=kF(),this.nextElementImpl().then(a=>{a&&a.isBundleMetadata()?this.metadata.resolve(a.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(a?.payload)}`))},a=>this.metadata.reject(a))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let a=await this.readLength();if(null===a)return null;let b=this.textDecoder.decode(a),c=Number(b);return isNaN(c)&&this.raiseError(`length string (${b}) is not valid number`),new sG(JSON.parse(await this.readJsonString(c)),a.length+c)}indexOfOpenBracket(){return this.buffer.findIndex(a=>123===a)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let a=this.indexOfOpenBracket();a<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let b=this.buffer.slice(0,a);return this.buffer=this.buffer.slice(a),b}async readJsonString(a){for(;this.buffer.length<a;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let b=this.textDecoder.decode(this.buffer.slice(0,a));return this.buffer=this.buffer.slice(a),b}raiseError(a){throw this.reader.cancel(),Error(`Invalid bundle format: ${a}`)}async pullMoreDataToBuffer(){let a=await this.reader.read();if(!a.done){let b=new Uint8Array(this.buffer.length+a.value.length);b.set(this.buffer),b.set(a.value,this.buffer.length),this.buffer=b}return a.done}}function sI(a,b){return new sH(a,b)}class sJ{constructor(a,b){this.bundleData=a,this.serializer=b,this.cursor=0,this.elements=[];let c=this.nextElement();if(c&&c.isBundleMetadata())this.metadata=c;else throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(c?.payload)}`);do null!==(c=this.nextElement())&&this.elements.push(c);while(null!==c)}getMetadata(){return this.metadata}getElements(){return this.elements}nextElement(){if(this.cursor===this.bundleData.length)return null;let a=this.readLength();return new sG(JSON.parse(this.readJsonString(a)),a)}readJsonString(a){if(this.cursor+a>this.bundleData.length)throw new ev(eu.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=a)}readLength(){let a=this.cursor,b=this.cursor;for(;b<this.bundleData.length;){if("{"===this.bundleData[b]){if(b===a)throw Error("First character is a bracket and not a number");return this.cursor=b,Number(this.bundleData.slice(a,b))}b++}throw Error("Reached the end of bundle when more is expected.")}}function sK(a,b){return new sJ(a,b)}class sL{constructor(a){this.datastore=a,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(a){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ev(eu.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let b=await qD(this.datastore,a);return b.forEach(a=>this.recordVersion(a)),b}set(a,b){this.write(b.toMutation(a,this.precondition(a))),this.writtenDocs.add(a.toString())}update(a,b){try{this.write(b.toMutation(a,this.preconditionForUpdate(a)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(a.toString())}delete(a){this.write(new kq(a,this.precondition(a))),this.writtenDocs.add(a.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let a=this.readVersions;this.mutations.forEach(b=>{a.delete(b.key.toString())}),a.forEach((a,b)=>{let c=eU.fromPath(b);this.mutations.push(new kt(c,this.precondition(c)))}),await qC(this.datastore,this.mutations),this.committed=!0}recordVersion(a){let b;if(a.isFoundDocument())b=a.version;else if(a.isNoDocument())b=e5.min();else throw eq(50498,{documentName:a.constructor.name});let c=this.readVersions.get(a.key.toString());if(c){if(!b.isEqual(c))throw new ev(eu.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(a.key.toString(),b)}precondition(a){let b=this.readVersions.get(a.toString());return this.writtenDocs.has(a.toString())||!b?j9.none():b.isEqual(e5.min())?j9.exists(!1):j9.updateTime(b)}preconditionForUpdate(a){let b=this.readVersions.get(a.toString());if(this.writtenDocs.has(a.toString())||!b)return j9.exists(!0);if(b.isEqual(e5.min()))throw new ev(eu.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return j9.updateTime(b)}write(a){this.ensureCommitNotCalled(),this.mutations.push(a)}ensureCommitNotCalled(){}}class sM{constructor(a,b,c,d,e){this.asyncQueue=a,this.datastore=b,this.options=c,this.updateFunction=d,this.deferred=e,this.attemptsRemaining=c.maxAttempts,this.backoff=new qs(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let a=new sL(this.datastore),b=this.tryRunUpdateFunction(a);b&&b.then(b=>{this.asyncQueue.enqueueAndForget(()=>a.commit().then(()=>{this.deferred.resolve(b)}).catch(a=>{this.handleTransactionError(a)}))}).catch(a=>{this.handleTransactionError(a)})})}tryRunUpdateFunction(a){try{let b=this.updateFunction(a);if(hu(b)||!b.catch||!b.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return b}catch(a){return this.deferred.reject(a),null}}handleTransactionError(a){this.attemptsRemaining>0&&this.isRetryableTransactionError(a)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(a)}isRetryableTransactionError(a){if(a?.name==="FirebaseError"){let b=a.code;return"aborted"===b||"failed-precondition"===b||"already-exists"===b||!ky(b)}return!1}}let sN="FirestoreClient",sO=100,sP=11,sQ=20,sR=22;class sS{constructor(a,b,c,d,e){this.authCredentials=a,this.appCheckCredentials=b,this.asyncQueue=c,this.databaseInfo=d,this.user=eg.UNAUTHENTICATED,this.clientId=eH.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=e,this.authCredentials.start(c,async a=>{em(sN,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(c,a=>(em(sN,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:sO}}setCredentialChangeListener(a){this.authCredentialListener=a}setAppCheckTokenChangeListener(a){this.appCheckCredentialListener=a}terminate(){this.asyncQueue.enterRestrictedMode();let a=new ew;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),a.resolve()}catch(c){let b=rp(c,"Failed to shutdown persistence");a.reject(b)}}),a.promise}}async function sT(a,b){a.asyncQueue.verifyOperationInProgress(),em(sN,"Initializing OfflineComponentProvider");let c=a.configuration;await b.initialize(c);let d=c.initialUser;a.setCredentialChangeListener(async a=>{d.isEqual(a)||(await o9(b.localStore,a),d=a)}),b.persistence.setDatabaseDeletedListener(()=>a.terminate()),a._offlineComponents=b}async function sU(a,b){a.asyncQueue.verifyOperationInProgress();let c=await sW(a);em(sN,"Initializing OnlineComponentProvider"),await b.initialize(c,a.configuration),a.setCredentialChangeListener(a=>rj(b.remoteStore,a)),a.setAppCheckTokenChangeListener((a,c)=>rj(b.remoteStore,c)),a._onlineComponents=b}function sV(a){return"FirebaseError"===a.name?a.code===eu.FAILED_PRECONDITION||a.code===eu.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||a.code===sR||a.code===sQ||a.code===sP}async function sW(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){em(sN,"Using user provided OfflineComponentProvider");try{await sT(a,a._uninitializedComponentsProvider._offline)}catch(c){let b=c;if(!sV(b))throw b;eo("Error using user provided cache. Falling back to memory cache: "+b),await sT(a,new sx)}}else em(sN,"Using default OfflineComponentProvider"),await sT(a,new sy(void 0));return a._offlineComponents}async function sX(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(em(sN,"Using user provided OnlineComponentProvider"),await sU(a,a._uninitializedComponentsProvider._online)):(em(sN,"Using default OnlineComponentProvider"),await sU(a,new sB))),a._onlineComponents}function sY(a){return sW(a).then(a=>a.persistence)}function sZ(a){return sW(a).then(a=>a.localStore)}function s$(a){return sX(a).then(a=>a.remoteStore)}function s_(a){return sX(a).then(a=>a.syncEngine)}function s0(a){return sX(a).then(a=>a.datastore)}async function s1(a){let b=await sX(a),c=b.eventManager;return c.onListen=rV.bind(null,b.syncEngine),c.onUnlisten=rZ.bind(null,b.syncEngine),c.onFirstRemoteStoreListen=rW.bind(null,b.syncEngine),c.onLastRemoteStoreUnlisten=r$.bind(null,b.syncEngine),c}function s2(a,b,c,d){let e=new sF(d),f=new rG(b,e,c);return a.asyncQueue.enqueueAndForget(async()=>rx(await s1(a),f)),()=>{e.mute(),a.asyncQueue.enqueueAndForget(async()=>ry(await s1(a),f))}}function s3(a,b,c={}){let d=new ew;return a.asyncQueue.enqueueAndForget(async()=>s7(await s1(a),a.asyncQueue,b,c,d)),d.promise}function s4(a,b,c){let d=new ew;return a.asyncQueue.enqueueAndForget(async()=>{try{let e=await s0(a);d.resolve(qE(e,b,c))}catch(a){d.reject(a)}}),d.promise}function s5(a,b){let c=new ew;return a.asyncQueue.enqueueAndForget(async()=>r_(await s_(a),b,c)),c.promise}async function s6(a,b,c){try{let d=await pl(a,b);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new ev(eu.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){let a=rp(d,`Failed to get document '${b} from cache`);c.reject(a)}}function s7(a,b,c,d,e){let f=new sF({next:h=>{f.mute(),b.enqueueAndForget(()=>ry(a,g));let i=h.docs.has(c);!i&&h.fromCache?e.reject(new ev(eu.UNAVAILABLE,"Failed to get document because the client is offline.")):i&&h.fromCache&&d&&"server"===d.source?e.reject(new ev(eu.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e.resolve(h)},error:a=>e.reject(a)}),g=new rG(ja(c.path),f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return rx(a,g)}async function s8(a,b,c){try{let d=await pp(a,b,!0),e=new rO(b,d.remoteKeys),f=e.computeDocChanges(d.documents),g=e.applyChanges(f,!1);c.resolve(g.snapshot)}catch(d){let a=rp(d,`Failed to execute query '${b} against cache`);c.reject(a)}}function s9(a,b,c,d,e){let f=new sF({next:c=>{f.mute(),b.enqueueAndForget(()=>ry(a,g)),c.fromCache&&"server"===d.source?e.reject(new ev(eu.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e.resolve(c)},error:a=>e.reject(a)}),g=new rG(c,f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return rx(a,g)}function ta(a,b,c,d){let e=tc(c,qn(b));a.asyncQueue.enqueueAndForget(async()=>{sv(await s_(a),e,d)})}function tb(a,b){return a.asyncQueue.enqueue(async()=>pB(await sZ(a),b))}function tc(a,b){let c;return sI(sE(c="string"==typeof a?kE().encode(a):a),b)}function td(a,b){return a.asyncQueue.enqueue(async()=>pE(await sZ(a),b))}function te(a,b){return a.timeoutSeconds===b.timeoutSeconds}function tf(a){let b={};return void 0!==a.timeoutSeconds&&(b.timeoutSeconds=a.timeoutSeconds),b}let tg="ComponentProvider",th=new Map;function ti(a){let b=th.get(a);b&&(em(tg,"Removing Datastore"),th.delete(a),b.terminate())}function tj(a,b,c,d){return new hp(a,b,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,tf(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}let tk="firestore.googleapis.com",tl=!0,tm=5,tn=30,to=!0;class tp{constructor(a){if(void 0===a.host){if(void 0!==a.ssl)throw new ev(eu.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tk,this.ssl=tl}else this.host=a.host,this.ssl=a.ssl??tl;if(this.isUsingEmulator=void 0!==a.emulatorOptions,this.credentials=a.credentials,this.ignoreUndefinedProperties=!!a.ignoreUndefinedProperties,this.localCache=a.localCache,void 0===a.cacheSizeBytes)this.cacheSizeBytes=nT;else if(a.cacheSizeBytes!==nS&&a.cacheSizeBytes<nW)throw new ev(eu.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${nW}`);else this.cacheSizeBytes=a.cacheSizeBytes;eW("experimentalForceLongPolling",a.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",a.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!a.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===a.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=to:this.experimentalAutoDetectLongPolling=!!a.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tf(a.experimentalLongPollingOptions??{}),tq(this.experimentalLongPollingOptions),this.useFetchStreams=!!a.useFetchStreams}isEqual(a){return this.host===a.host&&this.ssl===a.ssl&&this.credentials===a.credentials&&this.cacheSizeBytes===a.cacheSizeBytes&&this.experimentalForceLongPolling===a.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===a.experimentalAutoDetectLongPolling&&te(this.experimentalLongPollingOptions,a.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===a.ignoreUndefinedProperties&&this.useFetchStreams===a.useFetchStreams}}function tq(a){if(void 0!==a.timeoutSeconds){if(isNaN(a.timeoutSeconds))throw new ev(eu.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<tm)throw new ev(eu.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is ${tm})`);if(a.timeoutSeconds>tn)throw new ev(eu.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is ${tn})`)}}class tr{constructor(a,b,c,d){this._authCredentials=a,this._appCheckCredentials=b,this._databaseId=c,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ev(eu.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(a){if(this._settingsFrozen)throw new ev(eu.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tp(a),this._emulatorOptions=a.emulatorOptions||{},void 0!==a.credentials&&(this._authCredentials=eF(a.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return ti(this),Promise.resolve()}}function ts(a,b,c,d={}){a=e_(a,tr);let e=M(b),f=a._getSettings(),g={...f,emulatorOptions:a._getEmulatorOptions()},h=`${b}:${c}`;e&&(N(`https://${h}`),T("Firestore",!0)),f.host!==tk&&f.host!==h&&eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let i={...f,host:h,ssl:e,emulatorOptions:d};if(!ai(i,g)&&(a._setSettings(i),d.mockUserToken)){let b,c;if("string"==typeof d.mockUserToken)b=d.mockUserToken,c=eg.MOCK_USER;else{b=O(d.mockUserToken,a._app?.options.projectId);let e=d.mockUserToken.sub||d.mockUserToken.user_id;if(!e)throw new ev(eu.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new eg(e)}a._authCredentials=new ez(new ex(b,c))}}class tt{constructor(a,b,c){this.converter=b,this._query=c,this.type="query",this.firestore=a}withConverter(a){return new tt(this.firestore,a,this._query)}}class tu{constructor(a,b,c){this.converter=b,this._key=c,this.type="document",this.firestore=a}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tv(this.firestore,this.converter,this._key.path.popLast())}withConverter(a){return new tu(this.firestore,a,this._key)}toJSON(){return{type:tu._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(a,b,c){if(e1(b,tu._jsonSchema))return new tu(a,c||null,new eU(eR.fromString(b.referencePath)))}}tu._jsonSchemaVersion="firestore/documentReference/1.0",tu._jsonSchema={type:e0("string",tu._jsonSchemaVersion),referencePath:e0("string")};class tv extends tt{constructor(a,b,c){super(a,b,ja(c)),this._path=c,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let a=this._path.popLast();return a.isEmpty()?null:new tu(this.firestore,null,new eU(a))}withConverter(a){return new tv(this.firestore,a,this._path)}}function tw(a,b,...c){if(a=ar(a),1==arguments.length&&(b=eH.newId()),eV("doc","path",b),a instanceof tr){let d=eR.fromString(b,...c);return eX(d),new tu(a,null,new eU(d))}{if(!(a instanceof tu)&&!(a instanceof tv))throw new ev(eu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=a._path.child(eR.fromString(b,...c));return eX(d),new tu(a.firestore,a instanceof tv?a.converter:null,new eU(d))}}let tx="AsyncQueue";class ty{constructor(a=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new qs(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=a}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(a){this.enqueue(a)}enqueueAndForgetEvenWhileRestricted(a){this.verifyNotFailed(),this.enqueueInternal(a)}enterRestrictedMode(a){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=a||!1)}enqueue(a){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let b=new ew;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(a().then(b.resolve,b.reject),b.promise)).then(()=>b.promise)}enqueueRetryable(a){this.enqueueAndForget(()=>(this.retryableOps.push(a),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(a){if(fw(a))em(tx,"Operation failed with retryable error: "+a);else throw a}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(a){let b=this.tail.then(()=>(this.operationInProgress=!0,a().catch(a=>{throw this.failure=a,this.operationInProgress=!1,en("INTERNAL UNHANDLED ERROR: ",tz(a)),a}).then(a=>(this.operationInProgress=!1,a))));return this.tail=b,b}enqueueAfterDelay(a,b,c){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(a)>-1&&(b=0);let d=ro.createAndSchedule(this,a,b,c,a=>this.removeDelayedOperation(a));return this.delayedOperations.push(d),d}verifyNotFailed(){this.failure&&eq(47125,{messageOrStack:tz(this.failure)})}verifyOperationInProgress(){}async drain(){let a;do a=this.tail,await a;while(a!==this.tail)}containsDelayedOperation(a){for(let b of this.delayedOperations)if(b.timerId===a)return!0;return!1}runAllDelayedOperationsUntil(a){return this.drain().then(()=>{for(let b of(this.delayedOperations.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.delayedOperations))if(b.skipDelay(),"all"!==a&&b.timerId===a)break;return this.drain()})}skipDelaysForTimerId(a){this.timerIdsToSkip.push(a)}removeDelayedOperation(a){let b=this.delayedOperations.indexOf(a);this.delayedOperations.splice(b,1)}}function tz(a){let b=a.message||"";return a.stack&&(b=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),b}class tA{constructor(){this._progressObserver={},this._taskCompletionResolver=new ew,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(a,b,c){this._progressObserver={next:a,error:b,complete:c}}catch(a){return this._taskCompletionResolver.promise.catch(a)}then(a,b){return this._taskCompletionResolver.promise.then(a,b)}_completeWith(a){this._updateProgress(a),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(a)}_failWith(a){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(a),this._taskCompletionResolver.reject(a)}_updateProgress(a){this._lastProgress=a,this._progressObserver.next&&this._progressObserver.next(a)}}class tB extends tr{constructor(a,b,c,d){super(a,b,c,d),this.type="firestore",this._queue=new ty,this._persistenceKey=d?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let a=this._firestoreClient.terminate();this._queue=new ty(a),this._firestoreClient=void 0,await a}}}function tC(a,b){let c="object"==typeof a?a:bi(),d="string"==typeof a?a:b||hq,e=ba(c,"firestore").getImmediate({identifier:d});if(!e._initialized){let a=J("firestore");a&&ts(e,...a)}return e}function tD(a){if(a._terminated)throw new ev(eu.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||tE(a),a._firestoreClient}function tE(a){let b=a._freezeSettings(),c=tj(a._databaseId,a._app?.options.appId||"",a._persistenceKey,b);!a._componentsProvider&&b.localCache?._offlineComponentProvider&&b.localCache?._onlineComponentProvider&&(a._componentsProvider={_offline:b.localCache._offlineComponentProvider,_online:b.localCache._onlineComponentProvider}),a._firestoreClient=new sS(a._authCredentials,a._appCheckCredentials,a._queue,c,a._componentsProvider&&tF(a._componentsProvider))}function tF(a){let b=a?._online.build();return{_offline:a?._offline.build(b),_online:b}}function tG(a,b){let c=tD(a=e_(a,tB)),d=new tA;return ta(c,a._databaseId,b,d),d}function tH(a,b){return tb(tD(a=e_(a,tB)),b).then(b=>b?new tt(a,null,b.query):null)}function tI(a,b=!0){ei(bg),a9(new as("firestore",(a,{instanceIdentifier:c,options:d})=>{let e=a.getProvider("app").getImmediate(),f=new tB(new eA(a.getProvider("auth-internal")),new eE(e,a.getProvider("app-check-internal")),hs(e,c),e);return d={useFetchStreams:b,...d},f._setSettings(d),f},"PUBLIC").setMultipleInstances(!0)),bl(ee,ef,a),bl(ee,ef,"esm2020")}class tJ{constructor(a,b,c){this.alias=a,this.aggregateType=b,this.fieldPath=c}}class tK{constructor(a="count",b){this._internalFieldPath=b,this.type="AggregateField",this.aggregateType=a}}class tL{constructor(a,b,c){this._userDataWriter=b,this._data=c,this.type="AggregateQuerySnapshot",this.query=a}data(){return this._userDataWriter.convertObjectMap(this._data)}}class tM{constructor(a){this._byteString=a}static fromBase64String(a){try{return new tM(ha.fromBase64String(a))}catch(a){throw new ev(eu.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+a)}}static fromUint8Array(a){return new tM(ha.fromUint8Array(a))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(a){return this._byteString.isEqual(a._byteString)}toJSON(){return{type:tM._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(a){if(e1(a,tM._jsonSchema))return tM.fromBase64String(a.bytes)}}tM._jsonSchemaVersion="firestore/bytes/1.0",tM._jsonSchema={type:e0("string",tM._jsonSchemaVersion),bytes:e0("string")};class tN{constructor(...a){for(let b=0;b<a.length;++b)if(0===a[b].length)throw new ev(eu.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new eT(a)}isEqual(a){return this._internalPath.isEqual(a._internalPath)}}class tO{constructor(a){this._methodName=a}}class tP{constructor(a,b){if(!isFinite(a)||a<-90||a>90)throw new ev(eu.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+a);if(!isFinite(b)||b<-180||b>180)throw new ev(eu.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+b);this._lat=a,this._long=b}get latitude(){return this._lat}get longitude(){return this._long}isEqual(a){return this._lat===a._lat&&this._long===a._long}_compareTo(a){return eI(this._lat,a._lat)||eI(this._long,a._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tP._jsonSchemaVersion}}static fromJSON(a){if(e1(a,tP._jsonSchema))return new tP(a.latitude,a.longitude)}}tP._jsonSchemaVersion="firestore/geoPoint/1.0",tP._jsonSchema={type:e0("string",tP._jsonSchemaVersion),latitude:e0("number"),longitude:e0("number")};class tQ{constructor(a){this._values=(a||[]).map(a=>a)}toArray(){return this._values.map(a=>a)}isEqual(a){return o4(this._values,a._values)}toJSON(){return{type:tQ._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(a){if(e1(a,tQ._jsonSchema)){if(Array.isArray(a.vectorValues)&&a.vectorValues.every(a=>"number"==typeof a))return new tQ(a.vectorValues);throw new ev(eu.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}tQ._jsonSchemaVersion="firestore/vectorValue/1.0",tQ._jsonSchema={type:e0("string",tQ._jsonSchemaVersion),vectorValues:e0("object")};let tR=/^__.*__$/;class tS{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return null!==this.fieldMask?new kk(a,this.data,this.fieldMask,b,this.fieldTransforms):new kh(a,this.data,b,this.fieldTransforms)}}class tT{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return new kk(a,this.data,this.fieldMask,b,this.fieldTransforms)}}function tU(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw eq(40011,{dataSource:a})}}class tV{constructor(a,b,c,d,e,f){this.settings=a,this.databaseId=b,this.serializer=c,this.ignoreUndefinedProperties=d,void 0===e&&this.validatePath(),this.fieldTransforms=e||[],this.fieldMask=f||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(a){return new tV({...this.settings,...a},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(a){let b=this.path?.child(a),c=this.contextWith({path:b,arrayElement:!1});return c.validatePathSegment(a),c}childContextForFieldPath(a){let b=this.path?.child(a),c=this.contextWith({path:b,arrayElement:!1});return c.validatePath(),c}childContextForArray(a){return this.contextWith({path:void 0,arrayElement:!0})}createError(a){return uh(a,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(a){return void 0!==this.fieldMask.find(b=>a.isPrefixOf(b))||void 0!==this.fieldTransforms.find(b=>a.isPrefixOf(b.field))}validatePath(){if(this.path)for(let a=0;a<this.path.length;a++)this.validatePathSegment(this.path.get(a))}validatePathSegment(a){if(0===a.length)throw this.createError("Document fields must not be empty");if(tU(this.dataSource)&&tR.test(a))throw this.createError('Document fields cannot begin and end with "__"')}}class tW{constructor(a,b,c){this.databaseId=a,this.ignoreUndefinedProperties=b,this.serializer=c||qn(a)}createContext(a,b,c,d=!1){return new tV({dataSource:a,methodName:b,targetDoc:c,path:eT.emptyPath(),arrayElement:!1,hasConverter:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tX(a){let b=a._freezeSettings(),c=qn(a._databaseId);return new tW(a._databaseId,!!b.ignoreUndefinedProperties,c)}function tY(a,b,c,d,e,f={}){let g,h,i=a.createContext(f.merge||f.mergeFields?2:0,b,c,e);ud("Data must be an object, but it was:",i,d);let j=t7(d,i);if(f.merge)g=new g7(i.fieldMask),h=i.fieldTransforms;else if(f.mergeFields){let a=[];for(let d of f.mergeFields){let e=ue(b,d,c);if(!i.contains(e))throw new ev(eu.INVALID_ARGUMENT,`Field '${e}' is specified in your field mask but missing from your input data.`);ui(a,e)||a.push(e)}g=new g7(a),h=i.fieldTransforms.filter(a=>g.covers(a.field))}else g=null,h=i.fieldTransforms;return new tS(new ik(j),g,h)}class tZ extends tO{_toFieldTransform(a){if(2===a.dataSource)a.fieldMask.push(a.path);else if(1===a.dataSource)throw a.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw a.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(a){return a instanceof tZ}}function t$(a,b,c){return new tV({dataSource:3,targetDoc:b.settings.targetDoc,methodName:a._methodName,arrayElement:c},b.databaseId,b.serializer,b.ignoreUndefinedProperties)}class t_ extends null{_toFieldTransform(a){return new j5(a.path,new jY)}isEqual(a){return a instanceof t_}}class t0 extends tO{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=t$(this,a,!0),c=new jZ(this._elements.map(a=>t6(a,b)));return new j5(a.path,c)}isEqual(a){return a instanceof t0&&ai(this._elements,a._elements)}}class t1 extends tO{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=t$(this,a,!0),c=new j_(this._elements.map(a=>t6(a,b)));return new j5(a.path,c)}isEqual(a){return a instanceof t1&&ai(this._elements,a._elements)}}class t2 extends tO{constructor(a,b){super(a),this._operand=b}_toFieldTransform(a){let b=new j1(a.serializer,jS(a.serializer,this._operand));return new j5(a.path,b)}isEqual(a){return a instanceof t2&&this._operand===a._operand}}function t3(a,b,c,d){let e=a.createContext(1,b,c);ud("Data must be an object, but it was:",e,d);let f=[],g=ik.empty();return gY(d,(a,d)=>{let h=ug(b,a,c);d=ar(d);let i=e.childContextForFieldPath(h);if(d instanceof tZ)f.push(h);else{let a=t6(d,i);null!=a&&(f.push(h),g.set(h,a))}}),new tT(g,new g7(f),e.fieldTransforms)}function t4(a,b,c,d,e,f){let g=a.createContext(1,b,c),h=[ue(b,d,c)],i=[e];if(f.length%2!=0)throw new ev(eu.INVALID_ARGUMENT,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let a=0;a<f.length;a+=2)h.push(ue(b,f[a])),i.push(f[a+1]);let j=[],k=ik.empty();for(let a=h.length-1;a>=0;--a)if(!ui(j,h[a])){let b=h[a],c=i[a];c=ar(c);let d=g.childContextForFieldPath(b);if(c instanceof tZ)j.push(b);else{let a=t6(c,d);null!=a&&(j.push(b),k.set(b,a))}}return new tT(k,new g7(j),g.fieldTransforms)}function t5(a,b,c,d=!1){return t6(c,a.createContext(d?4:3,b))}function t6(a,b){if(uc(a=ar(a)))return ud("Unsupported field value:",b,a),t7(a,b);if(a instanceof tO)return t9(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),!(a instanceof Array))return ua(a,b);if(b.settings.arrayElement&&4!==b.dataSource)throw b.createError("Nested arrays are not supported");return t8(a,b)}function t7(a,b){let c={};return g$(a)?b.path&&b.path.length>0&&b.fieldMask.push(b.path):gY(a,(a,d)=>{let e=t6(d,b.childContextForField(a));null!=e&&(c[a]=e)}),{mapValue:{fields:c}}}function t8(a,b){let c=[],d=0;for(let e of a){let a=t6(e,b.childContextForArray(d));null==a&&(a={nullValue:"NULL_VALUE"}),c.push(a),d++}return{arrayValue:{values:c}}}function t9(a,b){if(!tU(b.dataSource))throw b.createError(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.createError(`${a._methodName}() is not currently supported inside arrays`);let c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)}function ua(a,b){if(null===(a=ar(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a)return jS(b.serializer,a);if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){let c=e4.fromDate(a);return{timestampValue:k1(b.serializer,c)}}else if(a instanceof e4){let c=new e4(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:k1(b.serializer,c)}}else if(a instanceof tP)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};else if(a instanceof tM)return{bytesValue:k3(b.serializer,a._byteString)};else if(a instanceof tu){let c=b.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw b.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:k7(a.firestore._databaseId||b.databaseId,a._key.path)}}else if(a instanceof tQ)return ub(a,b);else throw b.createError(`Unsupported field value: ${eZ(a)}`)}function ub(a,b){return{mapValue:{fields:{[hx]:{stringValue:hA},[hB]:{arrayValue:{values:a.toArray().map(a=>{if("number"!=typeof a)throw b.createError("VectorValues must only contain numeric values.");return jQ(b.serializer,a)})}}}}}}function uc(a){return"object"==typeof a&&null!==a&&!(a instanceof Array)&&!(a instanceof Date)&&!(a instanceof e4)&&!(a instanceof tP)&&!(a instanceof tM)&&!(a instanceof tu)&&!(a instanceof tO)&&!(a instanceof tQ)}function ud(a,b,c){if(!uc(c)||!eY(c)){let d=eZ(c);if("an object"===d)throw b.createError(a+" a custom object");throw b.createError(a+" "+d)}}function ue(a,b,c){if((b=ar(b))instanceof tN)return b._internalPath;if("string"==typeof b)return ug(a,b);throw uh("Field path arguments must be of type string or ",a,!1,void 0,c)}let uf=RegExp("[~\\*/\\[\\]]");function ug(a,b,c){if(b.search(uf)>=0)throw uh(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new tN(...b.split("."))._internalPath}catch(d){throw uh(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function uh(a,b,c,d,e){let f=d&&!d.isEmpty(),g=void 0!==e,h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new ev(eu.INVALID_ARGUMENT,h+a+i)}function ui(a,b){return a.some(a=>a.isEqual(b))}class uj{constructor(a,b,c,d,e){this._firestore=a,this._userDataWriter=b,this._key=c,this._document=d,this._converter=e}get id(){return this._key.path.lastSegment()}get ref(){return new tu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let a=new uk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(a)}}}get(a){if(this._document){let b=this._document.data.field(ul("DocumentSnapshot.get",a));if(null!==b)return this._userDataWriter.convertValue(b)}}}class uk extends uj{data(){return super.data()}}function ul(a,b){return"string"==typeof b?ug(a,b):b instanceof tN?b._internalPath:b._delegate._internalPath}function um(a){if("L"===a.limitType&&0===a.explicitOrderBy.length)throw new ev(eu.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class un{}class uo extends un{}class up extends uo{constructor(a,b,c){super(),this._field=a,this._op=b,this._value=c,this.type="where"}static _create(a,b,c){return new up(a,b,c)}_apply(a){let b=this._parse(a);return uD(a._query,b),new tt(a.firestore,a.converter,jk(a._query,b))}_parse(a){let b=tX(a.firestore);return uw(a._query,"where",b,a.firestore._databaseId,this._field,this._op,this._value)}}class uq extends un{constructor(a,b){super(),this.type=a,this._queryConstraints=b}static _create(a,b){return new uq(a,b)}_parse(a){let b=this._queryConstraints.map(b=>b._parse(a)).filter(a=>a.getFilters().length>0);return 1===b.length?b[0]:iA.create(b,this._getOperator())}_apply(a){let b=this._parse(a);return 0===b.getFilters().length?a:(uE(a._query,b),new tt(a.firestore,a.converter,jk(a._query,b)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class ur extends uo{constructor(a,b){super(),this._field=a,this._direction=b,this.type="orderBy"}static _create(a,b){return new ur(a,b)}_apply(a){let b=ux(a._query,this._field,this._direction);return new tt(a.firestore,a.converter,jl(a._query,b))}}class us extends uo{constructor(a,b,c){super(),this.type=a,this._limit=b,this._limitType=c}static _create(a,b,c){return new us(a,b,c)}_apply(a){return new tt(a.firestore,a.converter,jm(a._query,this._limit,this._limitType))}}class ut extends uo{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new ut(a,b,c)}_apply(a){let b=uv(a,this.type,this._docOrFields,this._inclusive);return new tt(a.firestore,a.converter,jn(a._query,b))}}class uu extends uo{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new uu(a,b,c)}_apply(a){let b=uv(a,this.type,this._docOrFields,this._inclusive);return new tt(a.firestore,a.converter,jo(a._query,b))}}function uv(a,b,c,d){if(c[0]=ar(c[0]),c[0]instanceof uj)return uy(a._query,a.firestore._databaseId,b,c[0]._document,d);{let e=tX(a.firestore);return uz(a._query,a.firestore._databaseId,e,b,c,d)}}function uw(a,b,c,d,e,f,g){let h;if(e.isKeyField())if("array-contains"===f||"array-contains-any"===f)throw new ev(eu.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);else if("in"===f||"not-in"===f){uB(g,f);let b=[];for(let c of g)b.push(uA(d,a,c));h={arrayValue:{values:b}}}else h=uA(d,a,g);else("in"===f||"not-in"===f||"array-contains-any"===f)&&uB(g,f),h=t5(c,b,g,"in"===f||"not-in"===f);return iz.create(e,f,h)}function ux(a,b,c){if(null!==a.startAt)throw new ev(eu.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new ev(eu.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new iu(b,c)}function uy(a,b,c,d,e){if(!d)throw new ev(eu.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let f=[];for(let c of jg(a))if(c.field.isKeyField())f.push(h3(b,d.key));else{let a=d.data.field(c.field);if(hl(a))throw new ev(eu.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==a)f.push(a);else{let a=c.field.canonicalString();throw new ev(eu.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${a}' (used as the orderBy) does not exist.`)}}return new ip(f,e)}function uz(a,b,c,d,e,f){let g=a.explicitOrderBy;if(e.length>g.length)throw new ev(eu.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let h=[];for(let f=0;f<e.length;f++){let i=e[f];if(g[f].field.isKeyField()){if("string"!=typeof i)throw new ev(eu.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof i}`);if(!jf(a)&&-1!==i.indexOf("/"))throw new ev(eu.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${i}' contains a slash.`);let c=a.path.child(eR.fromString(i));if(!eU.isDocumentKey(c))throw new ev(eu.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${c}' is not because it contains an odd number of segments.`);let e=new eU(c);h.push(h3(b,e))}else{let a=t5(c,d,i);h.push(a)}}return new ip(h,f)}function uA(a,b,c){if("string"==typeof(c=ar(c))){if(""===c)throw new ev(eu.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jf(b)&&-1!==c.indexOf("/"))throw new ev(eu.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);let d=b.path.child(eR.fromString(c));if(!eU.isDocumentKey(d))throw new ev(eu.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return h3(a,new eU(d))}if(c instanceof tu)return h3(a,c._key);throw new ev(eu.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${eZ(c)}.`)}function uB(a,b){if(!Array.isArray(a)||0===a.length)throw new ev(eu.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`)}function uC(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function uD(a,b){let c=uF(a.filters,uC(b.op));if(null!==c)if(c===b.op)throw new ev(eu.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`);else throw new ev(eu.INVALID_ARGUMENT,`Invalid query. You cannot use '${b.op.toString()}' filters with '${c.toString()}' filters.`)}function uE(a,b){let c=a;for(let a of b.getFlattenedFilters())uD(c,a),c=jk(c,a)}function uF(a,b){for(let c of a)for(let a of c.getFlattenedFilters())if(b.indexOf(a.op)>=0)return a.op;return null}class uG{convertValue(a,b="none"){switch(hD(a)){case 0:return null;case 1:return a.booleanValue;case 2:return hf(a.integerValue||a.doubleValue);case 3:return this.convertTimestamp(a.timestampValue);case 4:return this.convertServerTimestamp(a,b);case 5:return a.stringValue;case 6:return this.convertBytes(hg(a.bytesValue));case 7:return this.convertReference(a.referenceValue);case 8:return this.convertGeoPoint(a.geoPointValue);case 9:return this.convertArray(a.arrayValue,b);case 11:return this.convertObject(a.mapValue,b);case 10:return this.convertVectorValue(a.mapValue);default:throw eq(62114,{value:a})}}convertObject(a,b){return this.convertObjectMap(a.fields,b)}convertObjectMap(a,b="none"){let c={};return gY(a,(a,d)=>{c[a]=this.convertValue(d,b)}),c}convertVectorValue(a){return new tQ(a.fields?.[hB].arrayValue?.values?.map(a=>hf(a.doubleValue)))}convertGeoPoint(a){return new tP(hf(a.latitude),hf(a.longitude))}convertArray(a,b){return(a.values||[]).map(a=>this.convertValue(a,b))}convertServerTimestamp(a,b){switch(b){case"previous":let c=hn(a);if(null==c)return null;return this.convertValue(c,b);case"estimate":return this.convertTimestamp(ho(a));default:return null}}convertTimestamp(a){let b=he(a);return new e4(b.seconds,b.nanos)}convertDocumentKey(a,b){let c=eR.fromString(a);es(l6(c),9688,{name:a});let d=new hr(c.get(1),c.get(3)),e=new eU(c.popFirst(5));return d.isEqual(b)||en(`Document ${e} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${b.projectId}/${b.database}) instead.`),e}}function uH(a,b,c){let d;return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class uI extends uG{constructor(a){super(),this.firestore=a}convertBytes(a){return new tM(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new tu(this.firestore,null,b)}}function uJ(a){return uK(a,["next","error","complete"])}function uK(a,b){if("object"!=typeof a||null===a)return!1;let c=a;for(let a of b)if(a in c&&"function"==typeof c[a])return!0;return!1}let uL=kE();function uM(a){let b=JSON.stringify(a),c=uL.encode(b).byteLength;return`${c}${b}`}uM({metadata:{id:"test-bundle",createTime:{seconds:0x5e0be105,nanos:6},version:1,totalDocuments:1,totalBytes:416}}),uM({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}}),uM({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}}),uM({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}}),uM({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}}),uM({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}}),uM({namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:0x5ec5a5f3,nanos:191164e3}}}),uM({namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:0x5ec5a5f3,nanos:543063e3}}});let uN=1;class uO{constructor(a,b){this.firestore=a,this.bundleId=b,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new e4(0,0),this.databaseId=a._databaseId,this.serializer=new kZ(this.databaseId,!0),this.userDataReader=new tW(this.databaseId,!0,this.serializer)}addBundleDocument(a,b){let c=this.documents.get(a.documentPath),d=c?.metadata.queries,e=a.readTime,f=c?.metadata.readTime?k2(c.metadata.readTime):null,g=!e&&null==f,h=void 0!==e&&(null==f||f<e);if((g||h)&&this.documents.set(a.documentPath,{document:this.toBundleDocument(a),metadata:{name:la(this.serializer,a.documentKey),readTime:e?k1(this.serializer,e):void 0,exists:a.documentExists}}),e&&e>this.latestReadTime&&(this.latestReadTime=e),b){let c=this.documents.get(a.documentPath);c.metadata.queries=d||[],c.metadata.queries.push(b)}}addBundleQuery(a){if(this.namedQueries.has(a.name))throw Error(`Query name conflict: ${name} has already been added.`);let b=new e4(0,0);for(let c of a.docBundleDataArray)this.addBundleDocument(c,a.name),c.readTime&&c.readTime>b&&(b=c.readTime);let c=lA(this.serializer,jh(a.query)),d={parent:a.parent,structuredQuery:c.queryTarget.structuredQuery};this.namedQueries.set(a.name,{name:a.name,bundledQuery:d,readTime:k1(this.serializer,b)})}toBundleDocument(a){let b=this.userDataReader.createContext(4,"internal toBundledDocument"),c=t7(a.documentData,b);return{name:la(this.serializer,a.documentKey),fields:c.mapValue.fields,updateTime:k1(this.serializer,a.versionTime),createTime:k1(this.serializer,a.createdTime)}}lengthPrefixedString(a){let b=JSON.stringify(a),c=uL.encode(b).byteLength;return`${c}${b}`}build(){let a="";for(let b of this.namedQueries.values())a+=this.lengthPrefixedString({namedQuery:b});for(let b of this.documents.values()){let c=b.metadata;a+=this.lengthPrefixedString({documentMetadata:c});let d=b.document;d&&(a+=this.lengthPrefixedString({document:d}))}let b={id:this.bundleId,createTime:k1(this.serializer,this.latestReadTime),version:uN,totalDocuments:this.documents.size,totalBytes:uL.encode(a).length};return this.lengthPrefixedString({metadata:b})+a}}function uP(a,b,c,d){let e=new uO(a,eH.newId());return e.addBundleDocument(uR(d,c,b)),e.build()}function uQ(a,b,c,d,e,f,g){let h=[];for(let a=0;a<f.length;a++)h.push(uR(e[a],g[a],f[a]));let i={name:c,query:b,parent:d,docBundleDataArray:h},j=new uO(a,c);return j.addBundleQuery(i),j.build()}function uR(a,b,c){return{documentData:b,documentKey:c.mutableCopy().key,documentPath:a,documentExists:!0,createdTime:c.createTime.toTimestamp(),readTime:c.readTime.toTimestamp(),versionTime:c.version.toTimestamp()}}class uS{constructor(a,b){this.hasPendingWrites=a,this.fromCache=b}isEqual(a){return this.hasPendingWrites===a.hasPendingWrites&&this.fromCache===a.fromCache}}class uT extends uj{constructor(a,b,c,d,e,f){super(a,b,c,d,f),this._firestore=a,this._firestoreImpl=a,this.metadata=e}exists(){return super.exists()}data(a={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,a.serverTimestamps);{let b=new uU(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(b,a)}}}get(a,b={}){if(this._document){let c=this._document.data.field(ul("DocumentSnapshot.get",a));if(null!==c)return this._userDataWriter.convertValue(c,b.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ev(eu.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let a=this._document,b={};if(b.type=uT._jsonSchemaVersion,b.bundle="",b.bundleSource="DocumentSnapshot",b.bundleName=this._key.toString(),!a||!a.isValidDocument()||!a.isFoundDocument())return b;let c=this._userDataWriter.convertObjectMap(a.data.value.mapValue.fields,"previous");return b.bundle=uP(this._firestore,a,c,this.ref.path),b}}uT._jsonSchemaVersion="firestore/documentSnapshot/1.0",uT._jsonSchema={type:e0("string",uT._jsonSchemaVersion),bundleSource:e0("string","DocumentSnapshot"),bundleName:e0("string"),bundle:e0("string")};class uU extends uT{data(a={}){return super.data(a)}}class uV{constructor(a,b,c,d){this._firestore=a,this._userDataWriter=b,this._snapshot=d,this.metadata=new uS(d.hasPendingWrites,d.fromCache),this.query=c}get docs(){let a=[];return this.forEach(b=>a.push(b)),a}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(a,b){this._snapshot.docs.forEach(c=>{a.call(b,new uU(this._firestore,this._userDataWriter,c.key,c,new uS(this._snapshot.mutatedKeys.has(c.key),this._snapshot.fromCache),this.query.converter))})}docChanges(a={}){let b=!!a.includeMetadataChanges;if(b&&this._snapshot.excludesMetadataChanges)throw new ev(eu.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===b||(this._cachedChanges=uW(this,b),this._cachedChangesIncludeMetadataChanges=b),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ev(eu.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let a={};a.type=uV._jsonSchemaVersion,a.bundleSource="QuerySnapshot",a.bundleName=eH.newId();let b=this._firestore._databaseId.database,c=this._firestore._databaseId.projectId,d=`projects/${c}/databases/${b}/documents`,e=[],f=[],g=[];return this.docs.forEach(a=>{null!==a._document&&(e.push(a._document),f.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),g.push(a.ref.path))}),a.bundle=uQ(this._firestore,this.query._query,a.bundleName,d,g,e,f),a}}function uW(a,b){if(a._snapshot.oldDocs.isEmpty()){let b=0;return a._snapshot.docChanges.map(c=>{let d=new uU(a._firestore,a._userDataWriter,c.doc.key,c.doc,new uS(a._snapshot.mutatedKeys.has(c.doc.key),a._snapshot.fromCache),a.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:b++}})}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(a=>b||3!==a.type).map(b=>{let d=new uU(a._firestore,a._userDataWriter,b.doc.key,b.doc,new uS(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter),e=-1,f=-1;return 0!==b.type&&(e=c.indexOf(b.doc.key),c=c.delete(b.doc.key)),1!==b.type&&(f=(c=c.add(b.doc)).indexOf(b.doc.key)),{type:uX(b.type),doc:d,oldIndex:e,newIndex:f}})}}function uX(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return eq(61501,{type:a})}}function uY(a){a=e_(a,tu);let b=e_(a.firestore,tB);return s3(tD(b),a._key).then(c=>u1(b,a,c))}uV._jsonSchemaVersion="firestore/querySnapshot/1.0",uV._jsonSchema={type:e0("string",uV._jsonSchemaVersion),bundleSource:e0("string","QuerySnapshot"),bundleName:e0("string"),bundle:e0("string")};class uZ extends uG{constructor(a){super(),this.firestore=a}convertBytes(a){return new tM(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new tu(this.firestore,null,b)}}function u$(a,b,c){a=e_(a,tu);let d=e_(a.firestore,tB),e=uH(a.converter,b,c),f=tY(tX(d),"setDoc",a._key,e,null!==a.converter,c).toMutation(a._key,j9.none());return u0(d,[f])}function u_(a,...b){let c,d,e;a=getModularInstance(a);let f={includeMetadataChanges:!1,source:"default"},g=0;"object"!=typeof b[0]||uJ(b[g])||(f=b[g++]);let h={includeMetadataChanges:f.includeMetadataChanges,source:f.source};if(uJ(b[g])){let a=b[g];b[g]=a.next?.bind(a),b[g+1]=a.error?.bind(a),b[g+2]=a.complete?.bind(a)}if(a instanceof tu)d=e_(a.firestore,tB),e=ja(a._key.path),c={next:c=>{b[g]&&b[g](u1(d,a,c))},error:b[g+1],complete:b[g+2]};else{let f=e_(a,tt);d=e_(f.firestore,tB),e=f._query;let h=new uZ(d);c={next:a=>{b[g]&&b[g](new uV(d,h,f,a))},error:b[g+1],complete:b[g+2]},um(a._query)}return s2(tD(d),e,h,c)}function u0(a,b){return s5(tD(a),b)}function u1(a,b,c){let d=c.docs.get(b._key),e=new uZ(a);return new uT(a,e,b._key,d,new uS(c.hasPendingWrites,c.fromCache),b.converter)}function u2(a,b,c){return new tL(b,new uZ(a),c)}class u3{constructor(a){this.forceOwnership=a,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(a){this._onlineComponentProvider=sB.provider,this._offlineComponentProvider={build:b=>new sz(b,a?.cacheSizeBytes,this.forceOwnership)}}}function u4(a){return new u3(a?.forceOwnership)}function u5(a,b){if((a=ar(a)).firestore===b)return a;throw new ev(eu.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.")}class u6{constructor(a,b){this._firestore=a,this._transaction=b,this._dataReader=tX(a)}get(a){let b=u5(a,this._firestore),c=new uI(this._firestore);return this._transaction.lookup([b._key]).then(a=>{if(!a||1!==a.length)return eq(24041);let d=a[0];if(d.isFoundDocument())return new uj(this._firestore,c,d.key,d,b.converter);if(d.isNoDocument())return new uj(this._firestore,c,b._key,null,b.converter);throw eq(18433,{doc:d})})}set(a,b,c){let d=u5(a,this._firestore),e=uH(d.converter,b,c),f=tY(this._dataReader,"Transaction.set",d._key,e,null!==d.converter,c);return this._transaction.set(d._key,f),this}update(a,b,c,...d){let e,f=u5(a,this._firestore);return e="string"==typeof(b=ar(b))||b instanceof tN?t4(this._dataReader,"Transaction.update",f._key,b,c,d):t3(this._dataReader,"Transaction.update",f._key,b),this._transaction.update(f._key,e),this}delete(a){let b=u5(a,this._firestore);return this._transaction.delete(b._key),this}}function u7(a){try{return JSON.parse(a)}catch(a){throw new ev(eu.INVALID_ARGUMENT,"Failed to parse JSON: "+a?.message)}}function u8(a,b){if("string"!=typeof a[b])throw new ev(eu.INVALID_ARGUMENT,"Missing string value for: "+b);return a[b]}new WeakMap;class u9{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return va||kD(va=new u9),va}notifyOnExistenceFilterMismatch(a){this.existenceFilterMismatchCallbacksById.forEach(b=>b(a))}onExistenceFilterMismatch(a){let b=Symbol(),c=this.existenceFilterMismatchCallbacksById;return c.set(b,a),()=>c.delete(b)}}let va=null;tI("node");let vb="firebasestorage.googleapis.com",vc="storageBucket",vd=12e4,ve=6e5,vf=1e3;class vg extends ad{constructor(a,b,c=0){super(vh(a),`Firebase Storage: ${b} (${vh(a)})`),this.status_=c,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vg.prototype)}get status(){return this.status_}set status(a){this.status_=a}_codeEquals(a){return vh(a)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(a){this.customData.serverResponse=a,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function vh(a){return"storage/"+a}function vi(){let a="An unknown error occurred, please check the error payload for server response.";return new vg(o.UNKNOWN,a)}function vj(a){return new vg(o.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")}function vk(a){return new vg(o.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function vl(){let a="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new vg(o.UNAUTHENTICATED,a)}function vm(){return new vg(o.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function vn(a){return new vg(o.UNAUTHORIZED,"User does not have permission to access '"+a+"'.")}function vo(){return new vg(o.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vp(){return new vg(o.CANCELED,"User canceled the upload/download.")}function vq(a){return new vg(o.INVALID_URL,"Invalid URL '"+a+"'.")}function vr(a){return new vg(o.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+a+"'.")}function vs(){return new vg(o.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vc+"' property when initializing the app?")}function vt(){return new vg(o.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function vu(){return new vg(o.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function vv(){return new vg(o.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function vw(a){return new vg(o.INVALID_ARGUMENT,a)}function vx(){return new vg(o.APP_DELETED,"The Firebase app was deleted.")}function vy(a){return new vg(o.INVALID_ROOT_OPERATION,"The operation '"+a+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vz(a,b){return new vg(o.INVALID_FORMAT,"String does not match format '"+a+"': "+b)}function vA(a){throw new vg(o.INTERNAL_ERROR,"Internal error: "+a)}!function(a){a.UNKNOWN="unknown",a.OBJECT_NOT_FOUND="object-not-found",a.BUCKET_NOT_FOUND="bucket-not-found",a.PROJECT_NOT_FOUND="project-not-found",a.QUOTA_EXCEEDED="quota-exceeded",a.UNAUTHENTICATED="unauthenticated",a.UNAUTHORIZED="unauthorized",a.UNAUTHORIZED_APP="unauthorized-app",a.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",a.INVALID_CHECKSUM="invalid-checksum",a.CANCELED="canceled",a.INVALID_EVENT_NAME="invalid-event-name",a.INVALID_URL="invalid-url",a.INVALID_DEFAULT_BUCKET="invalid-default-bucket",a.NO_DEFAULT_BUCKET="no-default-bucket",a.CANNOT_SLICE_BLOB="cannot-slice-blob",a.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",a.NO_DOWNLOAD_URL="no-download-url",a.INVALID_ARGUMENT="invalid-argument",a.INVALID_ARGUMENT_COUNT="invalid-argument-count",a.APP_DELETED="app-deleted",a.INVALID_ROOT_OPERATION="invalid-root-operation",a.INVALID_FORMAT="invalid-format",a.INTERNAL_ERROR="internal-error",a.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(o||(o={}));class vB{constructor(a,b){this.bucket=a,this.path_=b}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let a=encodeURIComponent;return"/b/"+a(this.bucket)+"/o/"+a(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(a,b){let c;try{c=vB.makeFromUrl(a,b)}catch(b){return new vB(a,"")}if(""===c.path)return c;throw vr(a)}static makeFromUrl(a,b){let c=null,d="([A-Za-z0-9.\\-_]+)";function e(a){"/"===a.path.charAt(a.path.length-1)&&(a.path_=a.path_.slice(0,-1))}let f=RegExp("^gs://"+d+"(/(.*))?$","i"),g={bucket:1,path:3};function h(a){a.path_=decodeURIComponent(a.path)}let i="v[A-Za-z0-9_]+",j=b.replace(/[.]/g,"\\."),k="(/([^?#]*).*)?$",l=RegExp(`^https?://${j}/${i}/b/${d}/o${k}`,"i"),m=b===vb?"(?:storage.googleapis.com|storage.cloud.google.com)":b,n="([^?#]*)",o=[{regex:f,indices:g,postModify:e},{regex:l,indices:{bucket:1,path:3},postModify:h},{regex:RegExp(`^https?://${m}/${d}/${n}`,"i"),indices:{bucket:1,path:2},postModify:h}];for(let b=0;b<o.length;b++){let d=o[b],e=d.regex.exec(a);if(e){let a=e[d.indices.bucket],b=e[d.indices.path];b||(b=""),c=new vB(a,b),d.postModify(c);break}}if(null==c)throw vq(a);return c}}class vC{constructor(a){this.promise_=Promise.reject(a)}getPromise(){return this.promise_}cancel(a=!1){}}function vD(a,b,c){let d=1,e=null,f=null,g=!1,h=0;function i(){return 2===h}let j=!1;function k(...a){j||(j=!0,b.apply(null,a))}function l(b){e=setTimeout(()=>{e=null,a(n,i())},b)}function m(){f&&clearTimeout(f)}function n(a,...b){let c;if(j)return void m();if(a||i()||g){m(),k.call(null,a,...b);return}d<64&&(d*=2),1===h?(h=2,c=0):c=(d+Math.random())*1e3,l(c)}let o=!1;function p(a){o||(o=!0,m(),!j&&(null!==e?(a||(h=2),clearTimeout(e),l(0)):a||(h=1)))}return l(0),f=setTimeout(()=>{g=!0,p(!0)},c),p}function vE(a){a(!1)}function vF(a){return void 0!==a}function vG(a){return"function"==typeof a}function vH(a){return"object"==typeof a&&!Array.isArray(a)}function vI(a){return"string"==typeof a||a instanceof String}function vJ(a){return vK()&&a instanceof Blob}function vK(){return"undefined"!=typeof Blob}function vL(a,b,c,d){if(d<b)throw vw(`Invalid value for '${a}'. Expected ${b} or greater.`);if(d>c)throw vw(`Invalid value for '${a}'. Expected ${c} or less.`)}function vM(a,b,c){let d=b;return null==c&&(d=`https://${b}`),`${c}://${d}/v0${a}`}function vN(a){let b=encodeURIComponent,c="?";for(let d in a)a.hasOwnProperty(d)&&(c=c+(b(d)+"=")+b(a[d])+"&");return c.slice(0,-1)}function vO(a,b){let c=a>=500&&a<600,d=-1!==[408,429].indexOf(a),e=-1!==b.indexOf(a);return c||d||e}!function(a){a[a.NO_ERROR=0]="NO_ERROR",a[a.NETWORK_ERROR=1]="NETWORK_ERROR",a[a.ABORT=2]="ABORT"}(p||(p={}));class vP{constructor(a,b,c,d,e,f,g,h,i,j,k,l=!0,m=!1){this.url_=a,this.method_=b,this.headers_=c,this.body_=d,this.successCodes_=e,this.additionalRetryCodes_=f,this.callback_=g,this.errorCallback_=h,this.timeout_=i,this.progressCallback_=j,this.connectionFactory_=k,this.retry=l,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((a,b)=>{this.resolve_=a,this.reject_=b,this.start_()})}start_(){let a=(a,b)=>{if(b)return void a(!1,new vQ(!1,null,!0));let c=this.connectionFactory_();this.pendingConnection_=c;let d=a=>{let b=a.loaded,c=a.lengthComputable?a.total:-1;null!==this.progressCallback_&&this.progressCallback_(b,c)};null!==this.progressCallback_&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&c.removeUploadProgressListener(d),this.pendingConnection_=null;let b=c.getErrorCode()===p.NO_ERROR,e=c.getStatus();if(!b||vO(e,this.additionalRetryCodes_)&&this.retry)return void a(!1,new vQ(!1,null,c.getErrorCode()===p.ABORT));a(!0,new vQ(-1!==this.successCodes_.indexOf(e),c))})},b=(a,b)=>{let c=this.resolve_,d=this.reject_,e=b.connection;if(b.wasSuccessCode)try{let a=this.callback_(e,e.getResponse());vF(a)?c(a):c()}catch(a){d(a)}else if(null!==e){let a=vi();a.serverResponse=e.getErrorText(),d(this.errorCallback_?this.errorCallback_(e,a):a)}else d(b.canceled?this.appDelete_?vx():vp():vo())};this.canceled_?b(!1,new vQ(!1,null,!0)):this.backoffId_=vD(a,b,this.timeout_)}getPromise(){return this.promise_}cancel(a){this.canceled_=!0,this.appDelete_=a||!1,null!==this.backoffId_&&vE(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class vQ{constructor(a,b,c){this.wasSuccessCode=a,this.connection=b,this.canceled=!!c}}function vR(a,b){null!==b&&b.length>0&&(a.Authorization="Firebase "+b)}function vS(a,b){a["X-Firebase-Storage-Version"]="webjs/"+(b??"AppManager")}function vT(a,b){b&&(a["X-Firebase-GMPID"]=b)}function vU(a,b){null!==b&&(a["X-Firebase-AppCheck"]=b)}function vV(a,b,c,d,e,f,g=!0,h=!1){let i=vN(a.urlParams),j=a.url+i,k=Object.assign({},a.headers);return vT(k,b),vR(k,c),vS(k,f),vU(k,d),new vP(j,a.method,k,a.body,a.successCodes,a.additionalRetryCodes,a.handler,a.errorHandler,a.timeout,a.progressCallback,e,g,h)}function vW(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function vX(...a){let b=vW();if(void 0!==b){let c=new b;for(let b=0;b<a.length;b++)c.append(a[b]);return c.getBlob()}if(vK())return new Blob(a);throw new vg(o.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function vY(a,b,c){return a.webkitSlice?a.webkitSlice(b,c):a.mozSlice?a.mozSlice(b,c):a.slice?a.slice(b,c):null}function vZ(a){if(/[^-A-Za-z0-9+/=]/.test(a))throw vz("base64","Invalid character found");return Buffer.from(a,"base64").toString("binary")}let v$={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class v_{constructor(a,b){this.data=a,this.contentType=b||null}}function v0(a,b){switch(a){case v$.RAW:return new v_(v1(b));case v$.BASE64:case v$.BASE64URL:return new v_(v3(a,b));case v$.DATA_URL:return new v_(v5(b),v6(b))}throw vi()}function v1(a){let b=[];for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);d<=127?b.push(d):d<=2047?b.push(192|d>>6,128|63&d):(64512&d)==55296?c<a.length-1&&(64512&a.charCodeAt(c+1))==56320?(d=65536|(1023&d)<<10|1023&a.charCodeAt(++c),b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d)):b.push(239,191,189):(64512&d)==56320?b.push(239,191,189):b.push(224|d>>12,128|d>>6&63,128|63&d)}return new Uint8Array(b)}function v2(a){let b;try{b=decodeURIComponent(a)}catch(a){throw vz(v$.DATA_URL,"Malformed data URL.")}return v1(b)}function v3(a,b){let c;switch(a){case v$.BASE64:{let c=-1!==b.indexOf("-"),d=-1!==b.indexOf("_");if(c||d)throw vz(a,"Invalid character '"+(c?"-":"_")+"' found: is it base64url encoded?");break}case v$.BASE64URL:{let c=-1!==b.indexOf("+"),d=-1!==b.indexOf("/");if(c||d)throw vz(a,"Invalid character '"+(c?"+":"/")+"' found: is it base64 encoded?");b=b.replace(/-/g,"+").replace(/_/g,"/")}}try{c=vZ(b)}catch(b){if(b.message.includes("polyfill"))throw b;throw vz(a,"Invalid character found")}let d=new Uint8Array(c.length);for(let a=0;a<c.length;a++)d[a]=c.charCodeAt(a);return d}class v4{constructor(a){this.base64=!1,this.contentType=null;let b=a.match(/^data:([^,]+)?,/);if(null===b)throw vz(v$.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let c=b[1]||null;null!=c&&(this.base64=v7(c,";base64"),this.contentType=this.base64?c.substring(0,c.length-7):c),this.rest=a.substring(a.indexOf(",")+1)}}function v5(a){let b=new v4(a);return b.base64?v3(v$.BASE64,b.rest):v2(b.rest)}function v6(a){return new v4(a).contentType}function v7(a,b){return a.length>=b.length&&a.substring(a.length-b.length)===b}class v8{constructor(a,b){let c=0,d="";vJ(a)?(this.data_=a,c=a.size,d=a.type):a instanceof ArrayBuffer?(b?this.data_=new Uint8Array(a):(this.data_=new Uint8Array(a.byteLength),this.data_.set(new Uint8Array(a))),c=this.data_.length):a instanceof Uint8Array&&(b?this.data_=a:(this.data_=new Uint8Array(a.length),this.data_.set(a)),c=a.length),this.size_=c,this.type_=d}size(){return this.size_}type(){return this.type_}slice(a,b){if(!vJ(this.data_))return new v8(new Uint8Array(this.data_.buffer,a,b-a),!0);{let c=vY(this.data_,a,b);return null===c?null:new v8(c)}}static getBlob(...a){if(vK()){let b=a.map(a=>a instanceof v8?a.data_:a);return new v8(vX.apply(null,b))}{let b=a.map(a=>vI(a)?v0(v$.RAW,a).data:a.data_),c=0;b.forEach(a=>{c+=a.byteLength});let d=new Uint8Array(c),e=0;return b.forEach(a=>{for(let b=0;b<a.length;b++)d[e++]=a[b]}),new v8(d,!0)}}uploadData(){return this.data_}}function v9(a){let b;try{b=JSON.parse(a)}catch(a){return null}return vH(b)?b:null}function wa(a){if(0===a.length)return null;let b=a.lastIndexOf("/");return -1===b?"":a.slice(0,b)}function wb(a,b){let c=b.split("/").filter(a=>a.length>0).join("/");return 0===a.length?c:a+"/"+c}function wc(a){let b=a.lastIndexOf("/",a.length-2);return -1===b?a:a.slice(b+1)}function wd(a,b){return b}class we{constructor(a,b,c,d){this.server=a,this.local=b||a,this.writable=!!c,this.xform=d||wd}}let wf=null;function wg(a){return!vI(a)||a.length<2?a:wc(a)}function wh(){if(wf)return wf;let a=[];function b(a,b){return wg(b)}a.push(new we("bucket")),a.push(new we("generation")),a.push(new we("metageneration")),a.push(new we("name","fullPath",!0));let c=new we("name");function d(a,b){return void 0!==b?Number(b):b}c.xform=b,a.push(c);let e=new we("size");return e.xform=d,a.push(e),a.push(new we("timeCreated")),a.push(new we("updated")),a.push(new we("md5Hash",null,!0)),a.push(new we("cacheControl",null,!0)),a.push(new we("contentDisposition",null,!0)),a.push(new we("contentEncoding",null,!0)),a.push(new we("contentLanguage",null,!0)),a.push(new we("contentType",null,!0)),a.push(new we("metadata","customMetadata",!0)),wf=a}function wi(a,b){function c(){let c=new vB(a.bucket,a.fullPath);return b._makeStorageReference(c)}Object.defineProperty(a,"ref",{get:c})}function wj(a,b,c){let d={};d.type="file";let e=c.length;for(let a=0;a<e;a++){let e=c[a];d[e.local]=e.xform(d,b[e.server])}return wi(d,a),d}function wk(a,b,c){let d=v9(b);return null===d?null:wj(a,d,c)}function wl(a,b,c,d){let e=v9(b);if(null===e||!vI(e.downloadTokens))return null;let f=e.downloadTokens;if(0===f.length)return null;let g=encodeURIComponent;return f.split(",").map(b=>{let e=a.bucket,f=a.fullPath;return vM("/b/"+g(e)+"/o/"+g(f),c,d)+vN({alt:"media",token:b})})[0]}function wm(a,b){let c={},d=b.length;for(let e=0;e<d;e++){let d=b[e];d.writable&&(c[d.server]=a[d.local])}return JSON.stringify(c)}let wn="prefixes",wo="items";function wp(a,b,c){let d={prefixes:[],items:[],nextPageToken:c.nextPageToken};if(c[wn])for(let e of c[wn]){let c=e.replace(/\/$/,""),f=a._makeStorageReference(new vB(b,c));d.prefixes.push(f)}if(c[wo])for(let e of c[wo]){let c=a._makeStorageReference(new vB(b,e.name));d.items.push(c)}return d}function wq(a,b,c){let d=v9(c);return null===d?null:wp(a,b,d)}class wr{constructor(a,b,c,d){this.url=a,this.method=b,this.handler=c,this.timeout=d,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ws(a){if(!a)throw vi()}function wt(a,b){return function(c,d){let e=wk(a,d,b);return ws(null!==e),e}}function wu(a,b){return function(c,d){let e=wq(a,b,d);return ws(null!==e),e}}function wv(a,b){return function(c,d){let e=wk(a,d,b);return ws(null!==e),wl(e,d,a.host,a._protocol)}}function ww(a){return function(b,c){let d;return(d=401===b.getStatus()?b.getErrorText().includes("Firebase App Check token is invalid")?vm():vl():402===b.getStatus()?vk(a.bucket):403===b.getStatus()?vn(a.path):c).status=b.getStatus(),d.serverResponse=c.serverResponse,d}}function wx(a){let b=ww(a);return function(c,d){let e=b(c,d);return 404===c.getStatus()&&(e=vj(a.path)),e.serverResponse=d.serverResponse,e}}function wy(a,b,c){let d=vM(b.fullServerUrl(),a.host,a._protocol),e="GET",f=a.maxOperationRetryTime,g=new wr(d,e,wt(a,c),f);return g.errorHandler=wx(b),g}function wz(a,b,c,d,e){let f={};b.isRoot?f.prefix="":f.prefix=b.path+"/",c&&c.length>0&&(f.delimiter=c),d&&(f.pageToken=d),e&&(f.maxResults=e);let g=vM(b.bucketOnlyServerUrl(),a.host,a._protocol),h="GET",i=a.maxOperationRetryTime,j=new wr(g,h,wu(a,b.bucket),i);return j.urlParams=f,j.errorHandler=ww(b),j}function wA(a,b,c){let d=new wr(vM(b.fullServerUrl(),a.host,a._protocol)+"?alt=media","GET",(a,b)=>b,a.maxOperationRetryTime);return d.errorHandler=wx(b),void 0!==c&&(d.headers.Range=`bytes=0-${c}`,d.successCodes=[200,206]),d}function wB(a,b,c){let d=vM(b.fullServerUrl(),a.host,a._protocol),e="GET",f=a.maxOperationRetryTime,g=new wr(d,e,wv(a,c),f);return g.errorHandler=wx(b),g}function wC(a,b,c,d){let e=vM(b.fullServerUrl(),a.host,a._protocol),f="PATCH",g=wm(c,d),h={"Content-Type":"application/json; charset=utf-8"},i=a.maxOperationRetryTime,j=new wr(e,f,wt(a,d),i);return j.headers=h,j.body=g,j.errorHandler=wx(b),j}function wD(a,b){let c=new wr(vM(b.fullServerUrl(),a.host,a._protocol),"DELETE",function(a,b){},a.maxOperationRetryTime);return c.successCodes=[200,204],c.errorHandler=wx(b),c}function wE(a,b){return a&&a.contentType||b&&b.type()||"application/octet-stream"}function wF(a,b,c){let d=Object.assign({},c);return d.fullPath=a.path,d.size=b.size(),d.contentType||(d.contentType=wE(null,b)),d}function wG(a,b,c,d,e){let f=b.bucketOnlyServerUrl(),g={"X-Goog-Upload-Protocol":"multipart"},h=function(){let a="";for(let b=0;b<2;b++)a+=Math.random().toString().slice(2);return a}();g["Content-Type"]="multipart/related; boundary="+h;let i=wF(b,d,e),j="--"+h+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+wm(i,c)+"\r\n--"+h+"\r\nContent-Type: "+i.contentType+"\r\n\r\n",k="\r\n--"+h+"--",l=v8.getBlob(j,d,k);if(null===l)throw vt();let m={name:i.fullPath},n=vM(f,a.host,a._protocol),o="POST",p=a.maxUploadRetryTime,q=new wr(n,o,wt(a,c),p);return q.urlParams=m,q.headers=g,q.body=l.uploadData(),q.errorHandler=ww(b),q}class wH{constructor(a,b,c,d){this.current=a,this.total=b,this.finalized=!!c,this.metadata=d||null}}function wI(a,b){let c=null;try{c=a.getResponseHeader("X-Goog-Upload-Status")}catch(a){ws(!1)}let d=b||["active"];return ws(!!c&&-1!==d.indexOf(c)),c}function wJ(a,b,c,d,e){let f=b.bucketOnlyServerUrl(),g=wF(b,d,e),h={name:g.fullPath},i=vM(f,a.host,a._protocol),j="POST",k={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${d.size()}`,"X-Goog-Upload-Header-Content-Type":g.contentType,"Content-Type":"application/json; charset=utf-8"},l=wm(g,c),m=new wr(i,j,function(a){let b;wI(a);try{b=a.getResponseHeader("X-Goog-Upload-URL")}catch(a){ws(!1)}return ws(vI(b)),b},a.maxUploadRetryTime);return m.urlParams=h,m.headers=k,m.body=l,m.errorHandler=ww(b),m}function wK(a,b,c,d){let e={"X-Goog-Upload-Command":"query"},f=new wr(c,"POST",function(a){let b=wI(a,["active","final"]),c=null;try{c=a.getResponseHeader("X-Goog-Upload-Size-Received")}catch(a){ws(!1)}c||ws(!1);let e=Number(c);return ws(!isNaN(e)),new wH(e,d.size(),"final"===b)},a.maxUploadRetryTime);return f.headers=e,f.errorHandler=ww(b),f}let wL=null;function wM(a,b,c,d,e,f,g,h){let i=new wH(0,0);if(g?(i.current=g.current,i.total=g.total):(i.current=0,i.total=d.size()),d.size()!==i.total)throw vu();let j=i.total-i.current,k=j;e>0&&(k=Math.min(k,e));let l=i.current,m=l+k,n="",o={"X-Goog-Upload-Command":n=0===k?"finalize":j===k?"upload, finalize":"upload","X-Goog-Upload-Offset":`${i.current}`},p=d.slice(l,m);if(null===p)throw vt();let q=new wr(c,"POST",function(a,c){let e,g=wI(a,["active","final"]),h=i.current+k,j=d.size();return e="final"===g?wt(b,f)(a,c):null,new wH(h,j,"final"===g,e)},b.maxUploadRetryTime);return q.headers=o,q.body=p.uploadData(),q.progressCallback=h||null,q.errorHandler=ww(a),q}let wN={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function wO(a){switch(a){case"running":case"pausing":case"canceling":return wN.RUNNING;case"paused":return wN.PAUSED;case"success":return wN.SUCCESS;case"canceled":return wN.CANCELED;default:return wN.ERROR}}class wP{constructor(a,b,c){if(vG(a)||null!=b||null!=c)this.next=a,this.error=b??void 0,this.complete=c??void 0;else{let b=a;this.next=b.next,this.error=b.error,this.complete=b.complete}}}function wQ(a){return(...b)=>{Promise.resolve().then(()=>a(...b))}}let wR=null;class wS{constructor(){this.errorText_="",this.sent_=!1,this.errorCode_=p.NO_ERROR}async send(a,b,c,d,e){if(this.sent_)throw vA("cannot .send() more than once");this.sent_=!0;try{let f=await wY(a,b,c,e,d);this.headers_=f.headers,this.statusCode_=f.status,this.errorCode_=p.NO_ERROR,this.body_=await f.arrayBuffer()}catch(a){this.errorText_=a?.message,this.statusCode_=0,this.errorCode_=p.NETWORK_ERROR}}getErrorCode(){if(void 0===this.errorCode_)throw vA("cannot .getErrorCode() before receiving response");return this.errorCode_}getStatus(){if(void 0===this.statusCode_)throw vA("cannot .getStatus() before receiving response");return this.statusCode_}getErrorText(){return this.errorText_}abort(){}getResponseHeader(a){if(!this.headers_)throw vA("cannot .getResponseHeader() before receiving response");return this.headers_.get(a)}addUploadProgressListener(a){}removeUploadProgressListener(a){}}class wT extends null{getResponse(){if(!this.body_)throw vA("cannot .getResponse() before receiving response");return Buffer.from(this.body_).toString("utf-8")}}function wU(){return wR?wR():new wT}class wV extends null{getResponse(){if(!this.body_)throw vA("cannot .getResponse() before sending");return this.body_}}function wW(){return new wV}class wX extends wS{constructor(){super(...arguments),this.stream_=null}async send(a,b,c,d,e){if(this.sent_)throw vA("cannot .send() more than once");this.sent_=!0;try{let f=await wY(a,b,c,e,d);this.headers_=f.headers,this.statusCode_=f.status,this.errorCode_=p.NO_ERROR,this.stream_=f.body}catch(a){this.errorText_=a?.message,this.statusCode_=0,this.errorCode_=p.NETWORK_ERROR}}getResponse(){if(!this.stream_)throw vA("cannot .getResponse() before sending");return this.stream_}}function wY(a,b,c,d,e){let f={method:b,headers:d||{},body:e};return M(a)&&c&&(f.credentials="include"),fetch(a,f)}function wZ(){return new wX}class w${isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(a,b,c=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=a,this._blob=b,this._metadata=c,this._mappings=wh(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{if(this._request=void 0,this._chunkMultiplier=1,a._codeEquals(o.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let b=this.isExponentialBackoffExpired();if(vO(a.status,[]))if(b)a=vo();else{this.sleepTime=Math.max(2*this.sleepTime,vf),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=a,this._transition("error")}},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals(o.CANCELED)?this.completeTransitions_():(this._error=a,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((a,b)=>{this._resolve=a,this._reject=b,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let a=this._transferred;return b=>this._updateProgress(a+b)}_shouldDoResumable(a){return a.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(a){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([b,c])=>{switch(this._state){case"running":a(b,c);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((a,b)=>{let c=wJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,wU,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let a=this._uploadUrl;this._resolveToken((b,c)=>{let d=wK(this._ref.storage,this._ref._location,a,this._blob),e=this._ref.storage._makeRequest(d,wU,b,c);this._request=e,e.getPromise().then(a=>{this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let a=wL*this._chunkMultiplier,b=new wH(this._transferred,this._blob.size()),c=this._uploadUrl;this._resolveToken((d,e)=>{let f;try{f=wM(this._ref._location,this._ref.storage,c,this._blob,a,this._mappings,b,this._makeProgressCallback())}catch(a){this._error=a,this._transition("error");return}let g=this._ref.storage._makeRequest(f,wU,d,e,!1);this._request=g,g.getPromise().then(a=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(a.current),a.finalized?(this._metadata=a.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){2*(wL*this._chunkMultiplier)<0x2000000&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((a,b)=>{let c=wy(this._ref.storage,this._ref._location,this._mappings),d=this._ref.storage._makeRequest(c,wU,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((a,b)=>{let c=wG(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,wU,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(a){let b=this._transferred;this._transferred=a,this._transferred!==b&&this._notifyObservers()}_transition(a){if(this._state!==a)switch(a){case"canceling":case"pausing":this._state=a,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let b="paused"===this._state;this._state=a,b&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=a,this._notifyObservers();break;case"canceled":this._error=vp(),this._state=a,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){let a=wO(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:a,metadata:this._metadata,task:this,ref:this._ref}}on(a,b,c,d){let e=new wP(b||void 0,c||void 0,d||void 0);return this._addObserver(e),()=>{this._removeObserver(e)}}then(a,b){return this._promise.then(a,b)}catch(a){return this.then(null,a)}_addObserver(a){this._observers.push(a),this._notifyObserver(a)}_removeObserver(a){let b=this._observers.indexOf(a);-1!==b&&this._observers.splice(b,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(a=>{this._notifyObserver(a)})}_finishPromise(){if(void 0!==this._resolve){let a=!0;switch(wO(this._state)){case wN.SUCCESS:wQ(this._resolve.bind(null,this.snapshot))();break;case wN.CANCELED:case wN.ERROR:wQ(this._reject.bind(null,this._error))();break;default:a=!1}a&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(a){switch(wO(this._state)){case wN.RUNNING:case wN.PAUSED:a.next&&wQ(a.next.bind(a,this.snapshot))();break;case wN.SUCCESS:a.complete&&wQ(a.complete.bind(a))();break;case wN.CANCELED:case wN.ERROR:default:a.error&&wQ(a.error.bind(a,this._error))()}}resume(){let a="paused"===this._state||"pausing"===this._state;return a&&this._transition("running"),a}pause(){let a="running"===this._state;return a&&this._transition("pausing"),a}cancel(){let a="running"===this._state||"pausing"===this._state;return a&&this._transition("canceling"),a}}class w_{constructor(a,b){this._service=a,b instanceof vB?this._location=b:this._location=vB.makeFromUrl(b,a.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(a,b){return new w_(a,b)}get root(){let a=new vB(this._location.bucket,"");return this._newRef(this._service,a)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wc(this._location.path)}get storage(){return this._service}get parent(){let a=wa(this._location.path);if(null===a)return null;let b=new vB(this._location.bucket,a);return new w_(this._service,b)}_throwIfRoot(a){if(""===this._location.path)throw vy(a)}}function w0(a,b,c){a._throwIfRoot("uploadBytes");let d=wG(a.storage,a._location,wh(),new v8(b,!0),c);return a.storage.makeRequestWithTokens(d,wU).then(b=>({metadata:b,ref:a}))}async function w1(a,b,c){let d={pageToken:c},e=await w2(a,d);b.prefixes.push(...e.prefixes),b.items.push(...e.items),null!=e.nextPageToken&&await w1(a,b,e.nextPageToken)}function w2(a,b){null!=b&&"number"==typeof b.maxResults&&vL("options.maxResults",1,1e3,b.maxResults);let c=b||{},d=wz(a.storage,a._location,"/",c.pageToken,c.maxResults);return a.storage.makeRequestWithTokens(d,wU)}function w3(a,b){let c=wb(a._location.path,b),d=new vB(a._location.bucket,c);return new w_(a.storage,d)}function w4(a){return/^[A-Za-z]+:\/\//.test(a)}function w5(a,b){return new w_(a,b)}function w6(a,b){if(a instanceof w9){let c=a;if(null==c._bucket)throw vs();let d=new w_(c,c._bucket);return null!=b?w6(d,b):d}return void 0!==b?w3(a,b):a}function w7(a,b){let c=b?.[vc];return null==c?null:vB.makeFromBucketSpec(c,a)}function w8(a,b,c,d={}){a.host=`${b}:${c}`;let e=M(b);e&&(N(`https://${a.host}/b`),T("Storage",!0)),a._isUsingEmulator=!0,a._protocol=e?"https":"http";let{mockUserToken:f}=d;f&&(a._overrideAuthToken="string"==typeof f?f:O(f,a.app.options.projectId))}class w9{constructor(a,b,c,d,e,f=!1){this.app=a,this._authProvider=b,this._appCheckProvider=c,this._url=d,this._firebaseVersion=e,this._isUsingEmulator=f,this._bucket=null,this._host=vb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=vd,this._maxUploadRetryTime=ve,this._requests=new Set,null!=d?this._bucket=vB.makeFromBucketSpec(d,this._host):this._bucket=w7(this._host,this.app.options)}get host(){return this._host}set host(a){this._host=a,null!=this._url?this._bucket=vB.makeFromBucketSpec(this._url,a):this._bucket=w7(a,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(a){vL("time",0,1/0,a),this._maxUploadRetryTime=a}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(a){vL("time",0,1/0,a),this._maxOperationRetryTime=a}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let a=this._authProvider.getImmediate({optional:!0});if(a){let b=await a.getToken();if(null!==b)return b.accessToken}return null}async _getAppCheckToken(){if(bc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let a=this._appCheckProvider.getImmediate({optional:!0});return a?(await a.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(a=>a.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(a){return new w_(this,a)}_makeRequest(a,b,c,d,e=!0){if(this._deleted)return new vC(vx());{let f=vV(a,this._appId,c,d,b,this._firebaseVersion,e,this._isUsingEmulator);return this._requests.add(f),f.getPromise().then(()=>this._requests.delete(f),()=>this._requests.delete(f)),f}}async makeRequestWithTokens(a,b){let[c,d]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(a,b,c,d).getPromise()}}let xa="@firebase/storage",xb="0.14.0",xc="storage";function xd(a=bi(),b){let c=ba(a=ar(a),xc).getImmediate({identifier:b}),d=J("storage");return d&&xe(c,...d),c}function xe(a,b,c,d={}){w8(a,b,c,d)}function xf(a,{instanceIdentifier:b}){let c=a.getProvider("app").getImmediate();return new w9(c,a.getProvider("auth-internal"),a.getProvider("app-check-internal"),b,bg)}!function(){a9(new as(xc,xf,"PUBLIC").setMultipleInstances(!0)),bl(xa,xb)}();let xg={apiKey:"AIzaSyCQtWBB_PL4Gi8P5Td0RCgKc7tUQLzsATg",authDomain:"naughtyden-app.firebaseapp.com",projectId:"naughtyden-app",storageBucket:"naughtyden-app.firebasestorage.app",messagingSenderId:"1038096287210",appId:"1:1038096287210:web:e2f569629036cd00125e93",measurementId:"G-RYREQGMGB1"},xh=["NEXT_PUBLIC_FIREBASE_API_KEY","NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN","NEXT_PUBLIC_FIREBASE_PROJECT_ID","NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET","NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID","NEXT_PUBLIC_FIREBASE_APP_ID"].filter(a=>!process.env[a]);if(xh.length>0)throw Error(`Missing required environment variables: ${xh.join(", ")}`);try{f=0===bj().length?bh(xg):bj()[0],g=d1(f),h=tC(f),i=xd(f)}catch(a){throw console.error("Firebase initialization failed:",a),Error("Failed to initialize Firebase")}class xi extends r.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:{code:"COMPONENT_ERROR",message:a.message,details:a}}}componentDidCatch(a,b){console.error("ErrorBoundary caught an error:",a,b),this.props.onError&&this.props.onError({code:"COMPONENT_ERROR",message:a.message,details:a},b)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,q.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center p-4",children:(0,q.jsxs)("div",{className:"bg-gray-900 rounded-lg p-8 max-w-md w-full text-center",children:[(0,q.jsxs)("div",{className:"mb-6",children:[(0,q.jsx)("svg",{className:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,q.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Something went wrong"}),(0,q.jsx)("p",{className:"text-gray-400 mb-4",children:"We're sorry, but something unexpected happened. Please try refreshing the page."})]}),this.state.error&&(0,q.jsxs)("div",{className:"mb-6 p-4 bg-gray-800 rounded-lg text-left",children:[(0,q.jsx)("h3",{className:"text-sm font-semibold text-red-400 mb-2",children:"Error Details:"}),(0,q.jsx)("p",{className:"text-xs text-gray-300 break-words",children:this.state.error.message})]}),(0,q.jsxs)("div",{className:"space-y-3",children:[(0,q.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full py-3 px-4 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors font-bold",children:"Refresh Page"}),(0,q.jsx)("button",{onClick:()=>window.location.href="/",className:"w-full py-3 px-4 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors",children:"Go Home"})]})]})}):this.props.children}}let xj=({size:a="md",color:b="pink",text:c,fullScreen:d=!1})=>{let e={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},f={pink:"text-pink-600",white:"text-white",gray:"text-gray-400"},g=(0,q.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,q.jsx)("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-transparent ${e[a]} ${f[b]}`}),c&&(0,q.jsx)("p",{className:`text-sm ${f[b]}`,children:c})]});return d?(0,q.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:g}):g},xk=()=>(0,q.jsxs)("div",{className:"bg-gray-900 rounded-xl overflow-hidden animate-pulse",children:[(0,q.jsx)("div",{className:"w-full h-64 bg-gray-700"}),(0,q.jsxs)("div",{className:"p-4 space-y-3",children:[(0,q.jsx)("div",{className:"h-6 bg-gray-700 rounded w-3/4"}),(0,q.jsxs)("div",{className:"flex justify-between",children:[(0,q.jsx)("div",{className:"h-4 bg-gray-700 rounded w-1/4"}),(0,q.jsx)("div",{className:"h-4 bg-gray-700 rounded w-1/4"})]}),(0,q.jsx)("div",{className:"h-4 bg-gray-700 rounded w-1/2"}),(0,q.jsx)("div",{className:"h-10 bg-gray-700 rounded"})]})]}),xl={Button:({text:a="Loading..."})=>(0,q.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,q.jsx)(xj,{size:"sm",color:"white"}),(0,q.jsx)("span",{children:a})]}),CreatorGrid:({count:a=8})=>(0,q.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:Array.from({length:a}).map((a,b)=>(0,q.jsx)(xk,{},b))})},xm=({user:a,userProfile:b,onLoginClick:c,onLogout:d})=>(0,q.jsxs)("header",{className:"relative z-50 py-4 px-6 md:px-12 flex justify-between items-center",children:[(0,q.jsx)("div",{className:"h-10 w-auto",children:(0,q.jsx)("img",{src:"/logo.png",alt:"Naughty Den Logo",width:100,height:40,className:"h-10 w-auto"})}),(0,q.jsxs)("nav",{className:"hidden md:flex space-x-6 text-gray-400",children:[(0,q.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Home"}),(0,q.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Creators"}),(0,q.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Search photos..."}),(0,q.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Get Naughty"}),(0,q.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Contact"})]}),(0,q.jsxs)("div",{className:"flex items-center space-x-4",children:[a&&b?.isCreator&&(0,q.jsx)("a",{href:"#",className:"hidden md:block text-gray-400 hover:text-white transition-colors",children:"Creator dashboard"}),a?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[b?.photoURL&&(0,q.jsx)("img",{src:b.photoURL,alt:"Profile",width:32,height:32,className:"w-8 h-8 rounded-full border border-pink-600"}),(0,q.jsxs)("span",{className:"text-white",children:["Hi, ",b?.displayName||a.displayName||"User"]}),b?.isProfileComplete&&(0,q.jsx)("span",{className:"text-green-500 text-lg",children:"✅"})]}),(0,q.jsx)("button",{className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors hidden md:block",children:"View My Profile"}),(0,q.jsx)("button",{onClick:d,className:"px-4 py-2 rounded-lg border border-pink-600 text-pink-600 hover:bg-pink-600 hover:text-white transition-colors",children:"Logout"})]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("button",{onClick:c,className:"px-4 py-2 rounded-lg border border-pink-600 text-pink-600 hover:bg-pink-600 hover:text-white transition-colors",children:"Login"}),(0,q.jsx)("button",{className:"px-4 py-2 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors",children:"Get Pro"})]})]})]});var xn=c(87516),xo=c.n(xn);let xp=()=>(0,q.jsxs)("section",{className:"relative h-[80vh] flex items-center justify-center text-center",children:[(0,q.jsxs)("div",{className:"absolute inset-0",children:[(0,q.jsx)(xo(),{src:"https://images.unsplash.com/photo-1648064139778-7ab990300d6e?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Hero Background",fill:!0,className:"object-cover",priority:!0}),(0,q.jsx)("div",{className:"absolute inset-0 bg-black opacity-50"}),(0,q.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-950 via-transparent to-transparent"})]}),(0,q.jsxs)("div",{className:"relative z-10 max-w-2xl px-4",children:[(0,q.jsxs)("h1",{className:"text-5xl font-extrabold mb-4",children:["Capture the ",(0,q.jsx)("span",{className:"text-pink-600",children:"Extraordinary"})]}),(0,q.jsx)("p",{className:"text-lg text-gray-300 mb-8",children:"Create stunning and unique content. Join thousands of photographers worldwide. Find the perfect image for your next project."}),(0,q.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,q.jsx)("button",{className:"px-6 py-3 rounded-full bg-pink-600 hover:bg-pink-700 transition-colors",children:"Creator Dashboard →"}),(0,q.jsx)("button",{className:"px-6 py-3 rounded-full border border-gray-400 text-gray-300 hover:text-white hover:border-white transition-colors",children:"Browse Gallery →"})]})]})]}),xq=({creator:a,onViewProfile:b,onLike:c})=>{let[d,e]=(0,r.useState)(!1),f=()=>{c(a.id),e(!0)};return(0,q.jsxs)("div",{onClick:()=>b(a),className:"relative overflow-hidden rounded-xl shadow-lg transform transition-transform duration-300 hover:scale-105 cursor-pointer",children:[(0,q.jsx)("div",{children:(0,q.jsx)("img",{src:a.image,alt:a.name,width:400,height:400,className:"w-full h-auto object-cover"})}),(0,q.jsx)("div",{className:"absolute top-2 right-2 flex space-x-2",children:a.isAd&&(0,q.jsx)("span",{className:"text-xs font-semibold bg-pink-600 text-white px-2 py-1 rounded-full uppercase",children:"Ad"})}),(0,q.jsxs)("div",{className:"p-4 bg-gray-900 text-white",children:[(0,q.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,q.jsx)("h3",{className:"text-lg font-semibold",children:a.name}),(0,q.jsxs)("div",{className:"flex items-center space-x-1 cursor-pointer",onClick:a=>{a.stopPropagation(),f()},children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 text-pink-500 transition-transform ${d?"animate-pulse-glow":""}`,onAnimationEnd:()=>e(!1),children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.936 0-3.694 1.353-4.321 3.235-.916-1.882-2.685-3.235-4.621-3.235C4.599 3.75 2.5 5.765 2.5 8.25c0 3.867 3.93 7.825 8.762 11.233a.5.5 0 00.5.158c.49 0 4.838-3.958 8.762-11.233z"})}),(0,q.jsx)("span",{className:"text-sm",children:a.likes})]})]}),(0,q.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-400 mb-2",children:[(0,q.jsx)("span",{children:a.type}),(0,q.jsxs)("div",{className:"flex items-center",children:[(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-yellow-400 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,q.jsx)("path",{d:"M9.049 2.927c.3-.921 1.63-0.921 1.932 0l1.258 3.864a1 1 0 00.95.691h4.072c.969 0 1.371 1.243.588 1.81l-3.297 2.388a1 1 0 00-.364 1.118l1.258 3.864c.3.921-.755 1.688-1.54 1.118l-3.297-2.388a1 1 0 00-1.176 0l-3.297 2.388c-.784.57-1.84-.197-1.54-1.118l1.258-3.864a1 1 0 00-.364-1.118L2.091 9.29c-.783-.567-.381-1.81.588-1.81h4.072a1 1 0 00.95-.691l1.258-3.864z"})}),(0,q.jsx)("span",{children:a.rating})]})]}),(0,q.jsxs)("div",{className:"flex justify-between items-center text-sm font-bold text-white mb-4",children:[(0,q.jsxs)("span",{children:["$",a.price]}),(0,q.jsx)("span",{className:"text-gray-400",children:"/hour"})]}),(0,q.jsx)("div",{className:"flex space-x-2",children:(0,q.jsx)("button",{className:"flex-1 py-2 rounded-lg border border-pink-600 text-pink-600 hover:bg-pink-600 hover:text-white transition-colors",children:"Chat"})})]})]})},xr=[{id:1,name:"Jon Ly",rating:4.8,price:34.5,isAd:!1,image:"https://images.unsplash.com/photo-1630280717628-7d0d071cf2e3?q=80&w=1160&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:124},{id:2,name:"Seth Doyle",rating:4.6,price:32,isAd:!0,image:"https://images.unsplash.com/photo-1630520707335-9d4e79b731c3?q=80&w=1160&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:210},{id:3,name:"Riyaan Khan",rating:4.9,price:35.5,isAd:!1,image:"https://images.unsplash.com/photo-1550428083-7019ebe39b45?q=80&w=1102&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:315},{id:4,name:"Maria Rodriguez",rating:4.7,price:32.5,isAd:!1,image:"https://images.unsplash.com/photo-1728463087178-a8c804a5eec2?q=80&w=1160&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:98},{id:5,name:"Sofia Mykyte",rating:4.7,price:37,isAd:!0,image:"https://images.unsplash.com/photo-1673379421016-b84b1dc410ca?q=80&w=1092&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:156},{id:6,name:"Hao Leong",rating:4.8,price:38,isAd:!1,image:"https://images.unsplash.com/photo-1584996433468-6e702c8fc9d9?q=80&w=1160&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:421},{id:7,name:"Jordan Travers",rating:4.5,price:30,isAd:!1,image:"https://images.unsplash.com/photo-1676328012648-ee16da2e08d8?q=80&w=1233&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:85},{id:8,name:"Jordan Travers",rating:4.5,price:30,isAd:!1,image:"https://images.unsplash.com/photo-1676328012648-ee16da2e08d8?q=80&w=1233&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",type:"Subscription",likes:150}],xs=()=>{let[a,b]=(0,r.useState)(xr),[c,d]=(0,r.useState)(!1),e=a=>{b(b=>b.map(b=>b.id===a?{...b,likes:b.likes+1}:b))},f=a=>{console.log("Viewing profile:",a.name)};return c?(0,q.jsxs)("section",{className:"py-16 px-6 md:px-12 bg-gray-950",children:[(0,q.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,q.jsx)("h2",{className:"text-3xl font-bold text-gray-200",children:"Featured Creators"})}),(0,q.jsx)(xl.CreatorGrid,{count:8})]}):(0,q.jsxs)("section",{className:"py-16 px-6 md:px-12 bg-gray-950",children:[(0,q.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,q.jsx)("h2",{className:"text-3xl font-bold text-gray-200",children:"Featured Creators"}),(0,q.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-pink-600",children:[(0,q.jsx)("span",{children:"All (15,000+)"}),(0,q.jsx)("span",{children:"|"}),(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Browse all creators"})]})]}),(0,q.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:a.map(a=>(0,q.jsx)(xq,{creator:a,onViewProfile:f,onLike:e},a.id))})]})},xt=()=>(0,q.jsxs)("footer",{className:"bg-gray-900 py-16 px-6 md:px-12 text-gray-400 text-sm",children:[(0,q.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-8",children:[(0,q.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,q.jsx)("h4",{className:"text-lg font-bold text-white mb-2",children:"Naughty Den"}),(0,q.jsx)("p",{children:"A global community for creators and photo seekers. Connect, create, and get inspired."})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h4",{className:"text-lg font-bold text-white mb-2",children:"Explore"}),(0,q.jsxs)("ul",{children:[(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Gallery"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Get Naughty"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Community"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Creator Events"})})]})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h4",{className:"text-lg font-bold text-white mb-2",children:"Resources"}),(0,q.jsxs)("ul",{children:[(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Help & FAQs"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Privacy Policy"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Terms of Service"})}),(0,q.jsx)("li",{className:"mb-1",children:(0,q.jsx)("a",{href:"#",className:"hover:underline",children:"Press & Media"})})]})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("h4",{className:"text-lg font-bold text-white mb-2",children:"Stay in the loop"}),(0,q.jsx)("p",{className:"mb-2",children:"Subscribe to our newsletter for exclusive content and updates."}),(0,q.jsxs)("div",{className:"flex",children:[(0,q.jsx)("input",{type:"email",placeholder:"Email Address",className:"flex-1 p-2 rounded-l-lg bg-gray-800 border border-gray-700 focus:outline-none"}),(0,q.jsx)("button",{className:"px-4 py-2 rounded-r-lg bg-pink-600 hover:bg-pink-700 transition-colors",children:"Subscribe"})]})]})]}),(0,q.jsx)("div",{className:"text-center mt-8 pt-8 border-t border-gray-800",children:"\xa9 2025 Naughty Den. All rights reserved."})]});class xu extends Error{constructor(a,b,c){super(a),this.name="AppError",this.code=b,this.details=c}}let xv={AUTH_REQUIRED:"You must be logged in to perform this action",AUTH_INVALID_CREDENTIALS:"Invalid email or password",AUTH_EMAIL_ALREADY_EXISTS:"An account with this email already exists",AUTH_WEAK_PASSWORD:"Password must be at least 6 characters long",AUTH_USER_NOT_FOUND:"No account found with this email",VALIDATION_INVALID_PASSWORD:"Password must be at least 6 characters",NETWORK_ERROR:"Network error. Please check your connection",FIREBASE_ERROR:"Database error occurred",FIREBASE_PERMISSION_DENIED:"You do not have permission to perform this action",FIREBASE_NOT_FOUND:"Requested resource not found",UNKNOWN_ERROR:"An unexpected error occurred"};function xw(a){if(console.error("Error occurred:",a),a?.code?.startsWith("auth/"))switch(a.code){case"auth/user-not-found":return{code:"AUTH_USER_NOT_FOUND",message:xv.AUTH_USER_NOT_FOUND};case"auth/wrong-password":case"auth/invalid-credential":return{code:"AUTH_INVALID_CREDENTIALS",message:xv.AUTH_INVALID_CREDENTIALS};case"auth/email-already-in-use":return{code:"AUTH_EMAIL_ALREADY_EXISTS",message:xv.AUTH_EMAIL_ALREADY_EXISTS};case"auth/weak-password":return{code:"AUTH_WEAK_PASSWORD",message:xv.AUTH_WEAK_PASSWORD};default:return{code:"AUTH_REQUIRED",message:a.message||xv.AUTH_REQUIRED}}if(a?.code?.startsWith("firestore/"))switch(a.code){case"firestore/permission-denied":return{code:"FIREBASE_PERMISSION_DENIED",message:xv.FIREBASE_PERMISSION_DENIED};case"firestore/not-found":return{code:"FIREBASE_NOT_FOUND",message:xv.FIREBASE_NOT_FOUND};default:return{code:"FIREBASE_ERROR",message:xv.FIREBASE_ERROR}}return a?.name==="NetworkError"||a?.code==="NETWORK_ERROR"?{code:"NETWORK_ERROR",message:xv.NETWORK_ERROR}:a instanceof xu?{code:a.code,message:a.message,details:a.details}:{code:"UNKNOWN_ERROR",message:a?.message||xv.UNKNOWN_ERROR,details:a}}function xx(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}function xy(a){return a.length<6?{isValid:!1,message:xv.VALIDATION_INVALID_PASSWORD}:{isValid:!0}}function xz(a){let b={};return a.email.trim()?xx(a.email)||(b.email="Please enter a valid email address"):b.email="Email is required",a.password.trim()?a.password.length<6&&(b.password="Password must be at least 6 characters"):b.password="Password is required",{isValid:0===Object.keys(b).length,errors:b}}function xA(a){let b={};if(a.email.trim()?xx(a.email)||(b.email="Please enter a valid email address"):b.email="Email is required",a.password.trim()){let c=xy(a.password);c.isValid||(b.password=c.message||"Invalid password")}else b.password="Password is required";return a.displayName.trim()?a.displayName.trim().length<2?b.displayName="Display name must be at least 2 characters":a.displayName.trim().length>50&&(b.displayName="Display name must be less than 50 characters"):b.displayName="Display name is required",{isValid:0===Object.keys(b).length,errors:b}}function xB(a){let b={};return a.displayName.trim()?a.displayName.trim().length<2?b.displayName="Display name must be at least 2 characters":a.displayName.trim().length>50&&(b.displayName="Display name must be less than 50 characters"):b.displayName="Display name is required",a.bio&&a.bio.length>500&&(b.bio="Bio must be less than 500 characters"),a.categories&&a.categories.length>10&&(b.categories="You can select up to 10 categories"),{isValid:0===Object.keys(b).length,errors:b}}let xC=({onClose:a,onLogin:b})=>{let[c,d]=(0,r.useState)("login-choice"),[e,f]=(0,r.useState)({email:"",password:"",displayName:"",isCreator:!1}),[g,h]=(0,r.useState)({}),[i,j]=(0,r.useState)(!1),k=a=>{let{name:b,value:c,type:d,checked:e}=a.target;f(a=>({...a,[b]:"checkbox"===d?e:c})),g[b]&&h(a=>({...a,[b]:""}))},l=async c=>{c.preventDefault(),j(!0),h({});try{let c=xz({email:e.email,password:e.password});if(!c.isValid)return void h(c.errors);await new Promise(a=>setTimeout(a,1e3)),b(!1),a()}catch(a){h({general:xw(a).message})}finally{j(!1)}},m=async c=>{c.preventDefault(),j(!0),h({});try{let c=xA({email:e.email,password:e.password,displayName:e.displayName,isCreator:e.isCreator});if(!c.isValid)return void h(c.errors);await new Promise(a=>setTimeout(a,1e3)),b(e.isCreator),a()}catch(a){h({general:xw(a).message})}finally{j(!1)}},n=async()=>{j(!0),h({});try{await new Promise(a=>setTimeout(a,1e3)),b(!1),a()}catch(a){h({general:xw(a).message})}finally{j(!1)}};return(0,q.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-[100]",children:(0,q.jsxs)("div",{className:"bg-gray-900 rounded-lg p-8 w-full max-w-md mx-4 relative",children:[(0,q.jsx)("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors",disabled:i,children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),"login-choice"===c&&(0,q.jsxs)("div",{className:"space-y-4",children:[(0,q.jsx)("h2",{className:"text-xl font-bold text-white text-center",children:"Choose your path"}),(0,q.jsx)("button",{onClick:()=>{d("login"),f(a=>({...a,isCreator:!1}))},className:"w-full py-3 rounded-lg bg-gray-800 border border-gray-700 text-white hover:bg-gray-700 transition-colors",disabled:i,children:"Log In as a User"}),(0,q.jsx)("button",{onClick:()=>{d("login"),f(a=>({...a,isCreator:!0}))},className:"w-full py-3 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors text-white font-bold",disabled:i,children:"Log In as a Creator"}),(0,q.jsxs)("div",{className:"text-center text-sm mt-4",children:["Don't have an account yet?"," ",(0,q.jsx)("button",{onClick:()=>d("signup"),className:"text-pink-600 font-bold hover:underline",children:"CREATE ONE NOW"})]})]}),("login"===c||"signup"===c)&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("form",{onSubmit:"login"===c?l:m,className:"space-y-4",children:[(0,q.jsx)("h2",{className:"text-xl font-bold text-white text-center",children:"login"===c?"Log In":"Sign Up"}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"sr-only",htmlFor:"email",children:"Email Address"}),(0,q.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"Email Address",value:e.email,onChange:k,className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg py-3 px-4 focus:outline-none focus:border-pink-600",disabled:i}),g.email&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:g.email})]}),"signup"===c&&(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"sr-only",htmlFor:"displayName",children:"Display Name"}),(0,q.jsx)("input",{type:"text",id:"displayName",name:"displayName",placeholder:"Display Name",value:e.displayName,onChange:k,className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg py-3 px-4 focus:outline-none focus:border-pink-600",disabled:i}),g.displayName&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:g.displayName})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"sr-only",htmlFor:"password",children:"Password"}),(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"Password",value:e.password,onChange:k,className:"w-full bg-gray-800 text-white border border-gray-700 rounded-lg py-3 px-4 focus:outline-none focus:border-pink-600",disabled:i}),"login"===c&&(0,q.jsx)("button",{type:"button",className:"absolute top-1/2 right-4 -translate-y-1/2 text-xs text-gray-500 hover:underline",children:"Forgot"})]}),g.password&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:g.password})]}),"signup"===c&&(0,q.jsxs)("div",{className:"flex justify-center space-x-4 text-sm text-white",children:[(0,q.jsxs)("label",{className:"flex items-center",children:[(0,q.jsx)("input",{type:"radio",name:"accountType",value:"user",checked:!e.isCreator,onChange:()=>f(a=>({...a,isCreator:!1})),className:"mr-2",disabled:i}),"I'm a User"]}),(0,q.jsxs)("label",{className:"flex items-center",children:[(0,q.jsx)("input",{type:"radio",name:"accountType",value:"creator",checked:e.isCreator,onChange:()=>f(a=>({...a,isCreator:!0})),className:"mr-2",disabled:i}),"I'm a Creator"]})]}),g.general&&(0,q.jsx)("p",{className:"text-red-500 text-center text-sm",children:g.general}),(0,q.jsx)("button",{type:"submit",className:"w-full py-3 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:i?(0,q.jsx)(xl.Button,{text:"login"===c?"Logging in...":"Creating account..."}):"login"===c?"LOG IN":"CREATE ACCOUNT"})]}),(0,q.jsxs)("div",{className:"flex items-center my-6",children:[(0,q.jsx)("div",{className:"flex-grow border-t border-gray-700"}),(0,q.jsx)("span",{className:"mx-4 text-gray-500",children:"or"}),(0,q.jsx)("div",{className:"flex-grow border-t border-gray-700"})]}),(0,q.jsxs)("button",{onClick:n,className:"w-full flex items-center justify-center py-3 rounded-lg bg-gray-800 border border-gray-700 hover:bg-gray-700 transition-colors disabled:opacity-50",disabled:i,children:[(0,q.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",className:"w-5 h-5 mr-2",children:[(0,q.jsx)("path",{d:"M22.675 12.012c0-.503-.043-.997-.123-1.48H12.287v2.8H19.034c-.309 1.583-1.259 2.92-2.585 3.86v2.33h2.99c1.758-1.614 2.772-3.992 2.772-6.61Z",fill:"#4285F4"}),(0,q.jsx)("path",{d:"M12.287 23.996c2.724 0 5.006-.902 6.674-2.433L15.97 19.233c-1.07.72-2.45 1.148-3.683 1.148-2.84 0-5.26-1.92-6.115-4.524H3.01v2.417C4.77 21.365 8.16 23.996 12.287 23.996Z",fill:"#34A853"}),(0,q.jsx)("path",{d:"M6.172 14.542c-.22-.61-.34-1.258-.34-1.927s.12-1.317.34-1.927V8.27h-3.16C2.39 9.53 2.014 10.74 2.014 12.016s.376 2.486 1.002 3.743l3.156-2.217Z",fill:"#FBBC04"}),(0,q.jsx)("path",{d:"M12.287 5.75c1.47 0 2.784.507 3.824 1.492l2.673-2.673C17.3 2.75 15.004 1.996 12.287 1.996c-4.127 0-7.517 2.63-9.28 6.58L6.172 10.8c.854-2.604 3.274-4.523 6.115-4.523Z",fill:"#EA4335"})]}),"Sign in with Google"]}),(0,q.jsx)("div",{className:"text-center mt-6 text-sm",children:"login"===c?(0,q.jsxs)(q.Fragment,{children:["Don't have an account yet?"," ",(0,q.jsx)("button",{onClick:()=>d("signup"),className:"text-pink-600 font-bold hover:underline",children:"CREATE ONE NOW"})]}):(0,q.jsxs)(q.Fragment,{children:["Already have an account?"," ",(0,q.jsx)("button",{onClick:()=>d("login-choice"),className:"text-pink-600 font-bold hover:underline",children:"LOG IN"})]})})]})]})})},xD=({profile:a,onClose:b,onSave:c,isCreator:d,user:e})=>{let[f,g]=(0,r.useState)({displayName:a.displayName,bio:a.bio||"",categories:a.categories||[]}),[h,i]=(0,r.useState)(null),[j,k]=(0,r.useState)({}),[l,m]=(0,r.useState)(!1),n=["Popular / Trending","New Releases","Amateur","Professional Studio","Solo Performances","Couples","Group","Live Streams","Virtual Reality (VR)","Romantic","Hardcore","Roleplay / Fantasy","Fetish / Kink","Softcore / Artistic","Straight","LGBTQ+","Men-focused","Women-focused","Mixed","Short Clips","Full-Length Videos","Premium Only","Free Content"],o=a=>{let{name:b,value:c}=a.target;g(a=>({...a,[b]:c})),j[b]&&k(a=>({...a,[b]:""}))},p=a=>{g(b=>({...b,categories:b.categories.includes(a)?b.categories.filter(b=>b!==a):[...b.categories,a]}))},s=a=>{let b=a.target.files?.[0];b&&i(b)},t=async()=>{m(!0),k({});try{let d=xB(f);if(!d.isValid)return void k(d.errors);let e=a.photoURL;h&&(await new Promise(a=>setTimeout(a,1e3)),e=URL.createObjectURL(h)),await c({...f,photoURL:e,isProfileComplete:!0}),b()}catch(a){k({general:xw(a).message})}finally{m(!1)}};return(0,q.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-[101] p-4",children:(0,q.jsxs)("div",{className:"bg-gray-900 rounded-lg p-8 w-full max-w-lg relative text-white max-h-[90vh] overflow-y-auto",children:[(0,q.jsx)("button",{onClick:b,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors",disabled:l,children:(0,q.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),(0,q.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Edit Profile"}),(0,q.jsxs)("div",{className:"space-y-6",children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"displayName",className:"block text-sm font-medium mb-1",children:"Display Name"}),(0,q.jsx)("input",{id:"displayName",name:"displayName",type:"text",value:f.displayName,onChange:o,className:"w-full p-2 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-pink-600",disabled:l}),j.displayName&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.displayName})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"photoURL",className:"block text-sm font-medium mb-1",children:"Profile Picture"}),(0,q.jsx)("input",{id:"photoURL",name:"photoURL",type:"file",onChange:s,accept:"image/*",className:"w-full text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-pink-600 file:text-white hover:file:bg-pink-700",disabled:l}),h&&(0,q.jsxs)("p",{className:"mt-2 text-sm text-gray-400",children:["Selected file: ",h.name]}),(0,q.jsxs)("p",{className:"mt-2 text-sm text-gray-400",children:["Current photo: ",a.photoURL]})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium mb-1",children:"Bio"}),(0,q.jsx)("textarea",{id:"bio",name:"bio",value:f.bio,onChange:o,rows:4,className:"w-full p-2 rounded-lg bg-gray-800 border border-gray-700 resize-none focus:outline-none focus:border-pink-600",disabled:l}),j.bio&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.bio})]}),d&&(0,q.jsxs)("div",{children:[(0,q.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Interests"}),(0,q.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:n.map(a=>(0,q.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,q.jsx)("input",{type:"checkbox",checked:f.categories.includes(a),onChange:()=>p(a),className:"form-checkbox text-pink-600 bg-gray-800 border-gray-600 rounded",disabled:l}),(0,q.jsx)("span",{children:a})]},a))}),j.categories&&(0,q.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.categories})]}),j.general&&(0,q.jsx)("p",{className:"text-red-500 text-sm text-center",children:j.general}),(0,q.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,q.jsx)("button",{onClick:b,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-400 hover:bg-gray-700 hover:text-white transition-colors",disabled:l,children:"Cancel"}),(0,q.jsx)("button",{onClick:t,className:"px-4 py-2 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors font-bold disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?(0,q.jsx)(xl.Button,{text:"Saving..."}):"Save Changes"})]})]})]})})},xE=({onConfirm:a,onExit:b})=>(0,q.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-[100]",children:(0,q.jsxs)("div",{className:"bg-gray-900 rounded-lg p-8 w-full max-w-md mx-4 text-white text-center shadow-lg border border-pink-600",children:[(0,q.jsx)("div",{className:"flex justify-center mb-4",children:(0,q.jsx)("img",{src:"/logo.png",alt:"Naughty Den Logo",className:"w-24 h-auto"})}),(0,q.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Adult Content Warning"}),(0,q.jsx)("p",{className:"mb-4",children:"This app contains adult content. You must be 18+ (or legal age in your region) to enter."}),(0,q.jsx)("p",{className:"mb-6",children:"By continuing, you confirm that you meet the age requirement and consent to view explicit material."}),(0,q.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,q.jsx)("button",{onClick:a,className:"px-6 py-3 rounded-lg bg-pink-600 hover:bg-pink-700 transition-colors font-bold",children:"I Am 18+"}),(0,q.jsx)("button",{onClick:b,className:"px-6 py-3 rounded-lg border border-gray-600 text-gray-400 hover:bg-gray-700 hover:text-white transition-colors font-bold",children:"Exit"})]})]})}),xF=()=>{let[a,b]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[e,f]=(0,r.useState)(!1),[i,j]=(0,r.useState)(null),[k,l]=(0,r.useState)(null),[m,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{"true"===localStorage.getItem("ageConfirmed")&&n(!0);let a=dQ(g,async a=>{if(j(a),a){d(!1);let b=tw(h,"profiles",a.uid),c=await uY(b),e=c.exists()?c.data():null;if(e)l(e),e.isProfileComplete||f(!0);else{let c={uid:a.uid,displayName:a.displayName||"Anonymous",email:a.email||"",photoURL:a.photoURL||"https://placehold.co/100x100",isCreator:!1,bio:"",categories:[],isProfileComplete:!1};await u$(b,c),l(c),f(!0)}}else l(null)});return setTimeout(()=>{b(!1)},2e3),()=>a()},[]);let o=()=>{localStorage.setItem("ageConfirmed","true"),n(!0)},p=()=>{window.location.href="https://www.google.com/"},s=async()=>{try{await dR(g)}catch(a){console.error("Logout failed:",a)}},t=a=>{console.log("User logged in as:",a?"Creator":"User")},u=async a=>{if(h&&i?.uid){tw(h,"profiles",i.uid);try{l(b=>({...b,...a})),f(!1)}catch(a){console.error("Failed to update profile:",a)}}};return a?(0,q.jsx)(xj,{size:"lg",text:"Loading Naughty Den...",fullScreen:!0}):m?(0,q.jsx)(xi,{children:(0,q.jsxs)("div",{className:"bg-gray-950 text-white min-h-screen font-sans",children:[(0,q.jsx)(xm,{user:i,userProfile:k,onLoginClick:()=>d(!0),onLogout:s}),(0,q.jsx)(xp,{}),(0,q.jsx)(xs,{}),(0,q.jsx)(xt,{}),c&&(0,q.jsx)(xC,{onClose:()=>d(!1),onLogin:t}),e&&k&&(0,q.jsx)(xD,{profile:k,onClose:()=>f(!1),onSave:u,isCreator:k.isCreator,user:i})]})}):(0,q.jsx)(xE,{onConfirm:o,onExit:p})}},97659:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],[38,38],"php_generic_services"],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},98079:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CallCredentials=void 0;let d=c(64105);function e(a){return"getRequestHeaders"in a&&"function"==typeof a.getRequestHeaders}class f{static createFromMetadataGenerator(a){return new h(a)}static createFromGoogleCredential(a){return f.createFromMetadataGenerator((b,c)=>{let f;(f=e(a)?a.getRequestHeaders(b.service_url):new Promise((c,d)=>{a.getRequestMetadata(b.service_url,(a,b)=>a?void d(a):b?void c(b):void d(Error("Headers not set by metadata plugin")))})).then(a=>{let b=new d.Metadata;for(let c of Object.keys(a))b.add(c,a[c]);c(null,b)},a=>{c(a)})})}static createEmpty(){return new i}}b.CallCredentials=f;class g extends f{constructor(a){super(),this.creds=a}async generateMetadata(a){let b=new d.Metadata;for(let c of(await Promise.all(this.creds.map(b=>b.generateMetadata(a)))))b.merge(c);return b}compose(a){return new g(this.creds.concat([a]))}_equals(a){return this===a||a instanceof g&&this.creds.every((b,c)=>b._equals(a.creds[c]))}}class h extends f{constructor(a){super(),this.metadataGenerator=a}generateMetadata(a){return new Promise((b,c)=>{this.metadataGenerator(a,(a,d)=>{void 0!==d?b(d):c(a)})})}compose(a){return new g([this,a])}_equals(a){return this===a||a instanceof h&&this.metadataGenerator===a.metadataGenerator}}class i extends f{generateMetadata(a){return Promise.resolve(new d.Metadata)}compose(a){return a}_equals(a){return a instanceof i}}},99130:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.channelOptionsEqual=b.recognizedOptions=void 0,b.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},b.channelOptionsEqual=function(a,b){let c=Object.keys(a).sort(),d=Object.keys(b).sort();if(c.length!==d.length)return!1;for(let e=0;e<c.length;e+=1)if(c[e]!==d[e]||a[c[e]]!==b[d[e]])return!1;return!0}},99408:(a,b,c)=>{"use strict";a.exports=j;var d,e=c(72481);((j.prototype=Object.create(e.prototype)).constructor=j).className="Field";var f=c(27791),g=c(18657),h=c(90290),i=/^required|optional|repeated$/;function j(a,b,c,d,f,j,k){if(h.isObject(d)?(k=f,j=d,d=f=void 0):h.isObject(f)&&(k=j,j=f,f=void 0),e.call(this,a,j),!h.isInteger(b)||b<0)throw TypeError("id must be a non-negative integer");if(!h.isString(c))throw TypeError("type must be a string");if(void 0!==d&&!i.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==f&&!h.isString(f))throw TypeError("extend must be a string");"proto3_optional"===d&&(d="optional"),this.rule=d&&"optional"!==d?d:void 0,this.type=c,this.id=b,this.extend=f||void 0,this.repeated="repeated"===d,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!h.Long&&void 0!==g.long[c],this.bytes="bytes"===c,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=k}j.fromJSON=function(a,b){var c=new j(a,b.id,b.type,b.rule,b.extend,b.options,b.comment);return b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},Object.defineProperty(j.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(j.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(j.prototype,"delimited",{get:function(){return this.resolvedType instanceof d&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(j.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(j.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),j.prototype.setOption=function(a,b,c){return e.prototype.setOption.call(this,a,b,c)},j.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return h.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},j.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=g.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof d?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof f&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof f||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=h.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var a;h.base64.test(this.typeDefault)?h.base64.decode(this.typeDefault,a=h.newBuffer(h.base64.length(this.typeDefault)),0):h.utf8.write(this.typeDefault,a=h.newBuffer(h.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=h.emptyObject:this.repeated?this.defaultValue=h.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof d&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},j.prototype._inferLegacyProtoFeatures=function(a){if("proto2"!==a&&"proto3"!==a)return{};var b={};if("required"===this.rule&&(b.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===g.defaults[this.type]){var c=this.parent.get(this.type.split(".").pop());c&&c instanceof d&&c.group&&(b.message_encoding="DELIMITED")}return!0===this.getOption("packed")?b.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(b.repeated_field_encoding="EXPANDED"),b},j.prototype._resolveFeatures=function(a){return e.prototype._resolveFeatures.call(this,this._edition||a)},j.d=function(a,b,c,d){return"function"==typeof b?b=h.decorateType(b).name:b&&"object"==typeof b&&(b=h.decorateEnum(b).name),function(e,f){h.decorateType(e.constructor).add(new j(f,a,b,c,{default:d}))}},j._configure=function(a){d=a}},99442:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\mmmed\\\\Desktop\\\\Github\\\\naughty-den\\\\src\\\\components\\\\App.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\mmmed\\Desktop\\Github\\naughty-den\\src\\components\\App.tsx","default")},99967:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionFilterFactory=b.CompressionFilter=void 0;let d=c(74075),e=c(1887),f=c(50615),g=c(37842),h=c(18031),i=a=>"number"==typeof a&&"string"==typeof e.CompressionAlgorithms[a];class j{async writeMessage(a,b){let c=a;b&&(c=await this.compressMessage(c));let d=Buffer.allocUnsafe(c.length+5);return d.writeUInt8(+!!b,0),d.writeUInt32BE(c.length,1),c.copy(d,5),d}async readMessage(a){let b=1===a.readUInt8(0),c=a.slice(5);return b&&(c=await this.decompressMessage(c)),c}}class k extends j{async compressMessage(a){return a}async writeMessage(a,b){let c=Buffer.allocUnsafe(a.length+5);return c.writeUInt8(0,0),c.writeUInt32BE(a.length,1),a.copy(c,5),c}decompressMessage(a){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class l extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.deflate(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createInflate();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class m extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.gzip(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createGunzip();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class n extends j{constructor(a){super(),this.compressionName=a}compressMessage(a){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(a){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function o(a,b){switch(a){case"identity":return new k;case"deflate":return new l(b);case"gzip":return new m(b);default:return new n(a)}}class p extends g.BaseFilter{constructor(a,b){var c,d;super(),this.sharedFilterConfig=b,this.sendCompression=new k,this.receiveCompression=new k,this.currentCompressionAlgorithm="identity";let g=a["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!=(c=a["grpc.max_receive_message_length"])?c:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==g)if(i(g)){let a=e.CompressionAlgorithms[g],c=null==(d=b.serverSupportedEncodingHeader)?void 0:d.split(",");(!c||c.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=o(this.currentCompressionAlgorithm,-1))}else h.log(f.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${g}`)}async sendMetadata(a){let b=await a;return b.set("grpc-accept-encoding","identity,deflate,gzip"),b.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?b.remove("grpc-encoding"):b.set("grpc-encoding",this.currentCompressionAlgorithm),b}receiveMetadata(a){let b=a.get("grpc-encoding");if(b.length>0){let a=b[0];"string"==typeof a&&(this.receiveCompression=o(a,this.maxReceiveMessageLength))}a.remove("grpc-encoding");let c=a.get("grpc-accept-encoding")[0];return c&&(this.sharedFilterConfig.serverSupportedEncodingHeader=c,c.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new k,this.currentCompressionAlgorithm="identity")),a.remove("grpc-accept-encoding"),a}async sendMessage(a){var b;let c,d=await a;return c=!(this.sendCompression instanceof k)&&((null!=(b=d.flags)?b:0)&2)==0,{message:await this.sendCompression.writeMessage(d.message,c),flags:d.flags}}async receiveMessage(a){return this.receiveCompression.readMessage(await a)}}b.CompressionFilter=p;class q{constructor(a,b){this.options=b,this.sharedFilterConfig={}}createFilter(){return new p(this.options,this.sharedFilterConfig)}}b.CompressionFilterFactory=q}};var __webpack_require__=require("../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=a=>__webpack_require__(__webpack_require__.s=a),__webpack_exports__=__webpack_require__.X(0,[586,267],()=>__webpack_exec__(34816));module.exports=__webpack_exports__})();